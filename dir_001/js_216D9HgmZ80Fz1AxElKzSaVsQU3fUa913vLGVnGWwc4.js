(function($){Drupal.behaviors.radioactivity={config:'',attached:false,activeIncidents:[],attach:function(context,settings){if(typeof settings.radioactivity=='undefined'){return;}
var config=settings.radioactivity.config;var emitters=settings.radioactivity.emitters;settings.radioactivity.emitters=[];this.config=config;$.each(emitters,function(callback,incidents){$.each(incidents,function(index,incident){var config=Drupal.behaviors.radioactivity.config;var key='radioactivity_'+incident['checksum'];if(config.fpEnabled){if(Drupal.behaviors.radioactivity.fetch(key)){return;}else{var exp=new Date();exp.setTime(exp.getTime()+(config.fpTimeout*60*1000));Drupal.behaviors.radioactivity.store(key,true,exp);}}else{Drupal.behaviors.radioactivity.store(key,null,new Date());}
var rnd=Math.random()*100;if(rnd>=incident.accuracy){return;}
Drupal.behaviors.radioactivity.activeIncidents.push(incident);});if(Drupal.behaviors.radioactivity.activeIncidents.length>0){Drupal.behaviors.radioactivity[callback](Drupal.behaviors.radioactivity.activeIncidents);Drupal.behaviors.radioactivity.activeIncidents=[];}});},hardStore:function(key,value,exp){try{if(typeof(Storage)!=="undefined"){localStorage.setItem(key,JSON.stringify({value:value,expire:exp.getTime()}));sessionStorage.setItem(key,JSON.stringify({value:value,expire:exp.getTime()}));}}catch(e){$.cookie(key,value,{expires:exp});}
$.cookie(key,value,{expires:exp});},hardFetch:function(key){var data=null;if(typeof(Storage)!=="undefined"){try{data=localStorage.getItem(key)
if(!data){data=sessionStorage.getItem(key);}}catch(e){}}
if(!data){data=$.cookie(key);}
return data;},store:function(key,value,exp){if(typeof(Storage)!=="undefined"){try{localStorage.setItem(key,JSON.stringify({value:value,expire:exp.getTime()}));}catch(e){$.cookie(key,value,{expires:exp});}}else{$.cookie(key,value,{expires:exp});}},fetch:function(key){var now=new Date();if(typeof(Storage)!=="undefined"){try{var data=localStorage.getItem(key);if(data){data=JSON.parse(data);if(now.getTime()<data.expire){return data.value;}}
return null;}catch(e){return $.cookie(key);}}
return $.cookie(key);},emitDefault:function(incidents){$.ajax({url:this.config.emitPath,data:{'incidents':incidents},type:'POST',cache:false,dataType:"html"});}};})(jQuery);;;(function($){Drupal.behaviors.improved_multi_select={attach:function(context,settings){if(settings.improved_multi_select&&settings.improved_multi_select.selectors){var selectors=settings.improved_multi_select.selectors;for(var key in selectors){var selector=selectors[key];$(selector,context).once('improvedselect',function(){$(this).parent().append('<div class="improvedselect" sid="'+$(this).attr('id')+'" id="improvedselect-'+$(this).attr('id')+'"><div class="improvedselect-text-wrapper"><input type="text" class="improvedselect_filter" sid="'+$(this).attr('id')+'" prev="" /></div><ul class="improvedselect_sel"></ul><ul class="improvedselect_all"></ul><div class="improvedselect_control"><span class="add" sid="'+$(this).attr('id')+'">&gt;</span><span class="del" sid="'+$(this).attr('id')+'">&lt;</span><span class="add_all" sid="'+$(this).attr('id')+'">&raquo;</span><span class="del_all" sid="'+$(this).attr('id')+'">&laquo;</span><span class="move_up" sid="'+$(this).attr('id')+'">Move Up</span><span class="move_down" sid="'+$(this).attr('id')+'">Move Down</span></div><div class="clear" /></div>');var improvedselect_id=$(this).attr('id');$(this).find('option').each(function(){if($(this).attr('selected')){$('#improvedselect-'+improvedselect_id+' .improvedselect_sel',context).append('<li so="'+$(this).attr('value')+'">'+$(this).text()+'</li>');}else{$('#improvedselect-'+improvedselect_id+' .improvedselect_all',context).append('<li so="'+$(this).attr('value')+'">'+$(this).text()+'</li>');}});$('#improvedselect-'+improvedselect_id+' li',context).click(function(){$(this).toggleClass('selected');});$(this).hide();});}
$('.improvedselect_filter',context).keyup(function(){var text=$(this).val();if(text.length&&text!=$(this).attr('prev')){$(this).attr('prev',text);var patt=new RegExp(text,'i');$('#improvedselect-'+$(this).attr('sid')+' .improvedselect_all li',context).each(function(){var str=$(this).text();if(str.match(patt)){$(this).show();}else{$(this).hide();}});}else{$(this).attr('prev','')
$('#improvedselect-'+$(this).attr('sid')+' .improvedselect_all li',context).each(function(){$(this).show();});}});$('.improvedselect .add',context).click(function(){var sid=$(this).attr('sid');$('#improvedselect-'+sid+' .improvedselect_all .selected',context).each(function(){$(this).removeClass('selected');$(this).show();$('#improvedselect-'+sid+' .improvedselect_sel',context).append($(this));});improvedselectUpdate(sid,context);});$('.improvedselect .del',context).click(function(){var sid=$(this).attr('sid');$('#improvedselect-'+sid+' .improvedselect_sel .selected',context).each(function(){$(this).removeClass('selected');$('#improvedselect-'+sid+' .improvedselect_all',context).append($(this));});improvedselectUpdate(sid,context);});$('.improvedselect .add_all',context).click(function(){var sid=$(this).attr('sid');$('#improvedselect-'+sid+' .improvedselect_all li',context).each(function(){if($(this).css('display')!='none'){$(this).removeClass('selected');$('#improvedselect-'+sid+' .improvedselect_sel',context).append($(this));}});improvedselectUpdate(sid,context);});$('.improvedselect .del_all',context).click(function(){var sid=$(this).attr('sid');$('#improvedselect-'+sid+' input',context).val('');$('#improvedselect-'+sid+' input',context).attr('prev','');$('#improvedselect-'+sid+' .improvedselect_sel li',context).each(function(){$(this).removeClass('selected');$('#improvedselect-'+sid+' .improvedselect_all',context).append($(this));});$('#improvedselect-'+sid+' .improvedselect_all li',context).each(function(){$(this).show();});improvedselectUpdate(sid,context);});$('.improvedselect .move_up',context).click(function(){var sid=$(this).attr('sid');$('#improvedselect-'+sid+' .improvedselect_sel .selected',context).each(function(){var $selected=$(this);$selected.prev(':not(.selected)').before($selected);});improvedselectUpdate(sid,context);});$('.improvedselect .move_down',context).click(function(){var sid=$(this).attr('sid');$($('#improvedselect-'+sid+' .improvedselect_sel .selected',context).get().reverse()).each(function(){var $selected=$(this);$selected.next(':not(.selected)').after($selected);});improvedselectUpdate(sid,context);});}}};function improvedselectUpdate(sid,context){var selectedOpts=$('#improvedselect-'+sid+' .improvedselect_sel li',context).map(function(){return this.getAttribute('so');});$('#'+sid+' option',context).each(function(idx,el){var isSelected=$.inArray(el.getAttribute('value'),selectedOpts)!==-1;isSelected?el.setAttribute('selected','selected'):el.removeAttribute("selected");});var $select=$('#'+sid);$select.find('option, optgroup').remove();$('#improvedselect-'+sid+' .improvedselect_sel li',context).each(function(){var $li=$(this);$select.append($('<option></option>').attr('value',$li.attr('so')).prop('selected',true).text($li.text()));});}})(jQuery,Drupal);;
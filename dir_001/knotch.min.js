!function(e){try{!function(){function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return i(n||e)},d,d.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}return e}()({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("./Validators"),u=r(e("./vanillaHelpers")),c=e("./Utils"),d=e("./constants/videoConstants"),l=function(){function e(t,n,r,a){i(this,e),this.bugsnag=t,this.isSmartUnitTester=r,this.accountId=n,this.configs=a}return o(e,[{key:"getLastParagraphNode",value:function(e){var t=e.node,n=e.index,r=void 0===n?1:n,i=e.accountId,a=u.default.getNodeDescription(t),o=(0,c.textNodesUnder)(t),l=(0,s.lastNodeValidation)({nodes:o,isSmartUnitTester:this.isSmartUnitTester,configs:this.configs});if((0,c.isNodeBlacklisted)(t,this.configs))return this.bugsnag.pushBreadCrumb({name:"".concat(a," is blacklisted")}),null;if(0===l.length){var h=t.querySelectorAll(d.videoSelectors);return h.length>0?t:(this.bugsnag.pushBreadCrumb({name:"".concat(a," is not validated")}),null)}var f=t.children;if(0===f.length)return this.bugsnag.pushBreadCrumb({name:"".concat(a," has no children")}),t;for(var p=f.length-r,v=f[p],m=0;m<f.length;m++)if((0,c.isNodeBlacklisted)(f[m],this.configs)){var g=m-1;if(g<0)continue;return f[g]}if((0,c.isNodeContainer)(v)){var y=this.getLastParagraphNode({node:v,accountId:i});return y?y:r===f.length-1?(this.bugsnag.pushBreadCrumb({name:"iterated through all sub nodes for ".concat(a,", no valid child found")}),null):(this.isSmartUnitTester&&v.setAttribute("style","background: rgb(255, 255, 0, 0.8)"),this.getLastParagraphNode({node:t,index:r+1,accountId:i}))}for(var b=f.length-1,k=f.length-1;k>=0;k--){var T=f[k];((0,c.nodeContainsBlacklistedNode)(T,this.configs)||(0,c.isNodeBlacklisted)(T,this.configs))&&(b=k-1)}return b<0?(this.bugsnag.pushBreadCrumb({name:"all children nodes of ".concat(a," are blacklisted")}),null):(this.isSmartUnitTester&&(f[b].setAttribute("style","background: #007AFF"),console.log("[KNOTCH] last node",f[b])),f[b])}}]),e}(),h=l;n.default=h},{"./Utils":5,"./Validators":6,"./constants/videoConstants":16,"./vanillaHelpers":18}],2:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=i(t("./PageDOMUtils.js")),c=i(t("./LastNodeFinder")),d=t("./constants/pageConstants"),l=t("./constants/configURLs"),h=i(t("./vanillaHelpers")),f=t("./configMethods"),p=function(e,t){return t(!0)},v=5,m=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p,o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,d=arguments.length>7?arguments[7]:void 0;a(this,t),this.node=e,this.url=h.default.getCanonicalURL(),this.urlMap=n,this.injected=!1,this.scrollTimeout=null,this.accountId=u,this.isSmartUnitTester=d,this.touchEndListener=function(){return r.onScroll()},this.scrollListener=function(){return r.onScroll()},this.keyDownListener=function(e){return r.onKeyDown(e)},this.pageValidate=i,this.bugsnag=s,this.config=c,this.retries=0,this.inject=function(e){var t=e.pageBodyNode,i=e.lastParagraphNode,a=e.videoPlayer,s=e.knotchPlaceholder;return o({pageNode:r.node,pageBodyNode:t,lastParagraphNode:i,videoPlayer:a,urlMap:n,url:r.url,injectedCallback:function(){return r.injected=!0},unbindListeners:function(){return r.unbindListeners()},bugsnag:r.bugsnag,knotchPlaceholder:s})},this.init()}return s(t,[{key:"init",value:function(){var t=this;h.default.isMobile()?document.addEventListener("touchend",this.touchEndListener):(document.addEventListener("scroll",this.scrollListener),document.addEventListener("keydown",this.keyDownListener)),h.default.get("".concat(l.URLS[e.Knotch.config.env],"/").concat(this.accountId,".json"),{},function(e){t.handleBlacklistFetch(e)},function(e,n,r,i,a){return t.bugsnag.reportError(n,{data:{readyState:r,responseText:i,responseHeaders:a,status:e},severity:"info"})},this.bugsnag,{handle400:!0})}},{key:"handleBlacklistFetch",value:function(t){var n=this;this.blacklistKeywords=(0,f.combineBlacklists)(t),this.pageDOMUtils=new u.default(this.node,this.url,this.bugsnag,this.accountId,this.isSmartUnitTester,this.blacklistKeywords),this.lastNodeFinder=new c.default(this.bugsnag,this.accountId,this.isSmartUnitTester,this.blacklistKeywords),this.checkVisibility(),setTimeout(function(){n.injected||(n.checkVisibilityInterval=setInterval(function(){return n.checkVisibility()},1e3),e.setTimeout(function(){return clearInterval(n.checkVisibilityInterval)},1e4))},500)}},{key:"getYPos",value:function(){return e.pageYOffset+e.innerHeight}},{key:"onScroll",value:function(){var e=this;this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.injected?this.unbindListeners():this.scrollTimeout=setTimeout(function(){return e.checkVisibility()},1e3)}},{key:"onKeyDown",value:function(e){var t=(e.code||"").toLowerCase();"space"!==t&&"arrowdown"!==t||this.onScroll()}},{key:"checkVisibility",value:function(){var t=this;if(this.injected)return void this.unbindListeners();var n=this.node.getBoundingClientRect(),r=n.top+n.height>=d.INVIEW_OFFSET&&n.top<e.innerHeight/2;if(r){if(this.url=h.default.getCanonicalURL(),!this.url)return this.unbindListeners(),this.bugsnag.pushBreadCrumb({name:"Canonical URL not found",type:"node finder"});if(this.infographic=this.pageDOMUtils.checkForInfographic(),this.urlMap){var i=this.getMatchingUrl();if(!i||!i.length)return this.bugsnag.pushBreadCrumb({name:"No map found for this URL",metaData:{url:this.url}}),this.unbindListeners();var a=this.node.querySelector(".knotch_placeholder"),o=this.node.querySelector('div[class*="knotch_'.concat(i[0],'"]'));o||(a?this.inject({urlMap:this.urlMap,url:this.url,surveyId:i[0],bugsnag:this.bugsnag,knotchPlaceholder:a}):this.pageValidate(i[0],function(e){return t.validatePageBodyNode(e)}))}else{var s=this.findPageBodyNode();this.injectPage(s)}}}},{key:"getMatchingUrl",value:function(){if(this.urlMap[this.url])return this.urlMap[this.url];var e=h.default.removeSearch(this.url.trim());if(this.urlMap[e])return this.urlMap[e];for(var t in this.urlMap){if(!t||!t.length)return null;var n=""+t.trim(),r=""+t.trim().substring(0,t.length-1),i=t.trim()+"/",a=""+e.substring(0,e.length-1);if(i===this.url||n===this.url||r===this.url||a===this.url)return this.urlMap[t]}}},{key:"validatePageBodyNode",value:function(e){var t=this;if(!e)return this.bugsnag.pushBreadCrumb({name:"Page validation failed",metaData:{url:this.url}}),this.unbindListeners();var n=this.findPageBodyNode();n?this.injectPage(n):this.infographic?this.injectPage(null):this.retries<v&&(this.retries+=1,setTimeout(function(){t.checkVisibility()},2e3),this.bugsnag.pushBreadCrumb({name:"findPageBodyNode retry #".concat(this.retries)}))}},{key:"findPageBodyNode",value:function(){var e;return e=this.config.pageBodySelectors?(0,f.getConfigPageBodyNode)(this.config.pageBodySelectors):this.pageDOMUtils.getPageBodyNode()}},{key:"injectPage",value:function(e){if(e){var t=this.pageDOMUtils.getVideoNodes(e),n=t&&t.length?t[0]:null,r=this.lastNodeFinder.getLastParagraphNode({node:e,accountId:this.accountId});!r&&this.infographic?this.inject({pageBodyNode:e,lastParagraphNode:this.infographic}):this.inject({pageBodyNode:e,lastParagraphNode:r,videoPlayer:n})}else if(this.infographic){var i=this.infographic.parentNode;this.inject({pageBodyNode:i,lastParagraphNode:this.infographic})}else this.unbindListeners()}},{key:"unbindListeners",value:function(){document.removeEventListener("scroll",this.scrollListener),document.removeEventListener("keydown",this.keyDownListener),document.removeEventListener("touchend",this.touchEndListener)}}]),t}(),g=m;r.default=g},{"./LastNodeFinder":1,"./PageDOMUtils.js":3,"./configMethods":9,"./constants/configURLs":11,"./constants/pageConstants":14,"./vanillaHelpers":18}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=e("./Validators"),s=e("./Utils"),u=e("./constants/pageConstants"),c=e("./constants/nodeValidation"),d=e("./constants/videoConstants"),l=function(){function e(t,n,i,a,o,s){r(this,e),this.pageNode=t,this.url=n,this.bugsnag=i,this.isSmartUnitTester=o,this.accountId=a,this.configs=s}return a(e,[{key:"getPageBodyNode",value:function(){var e=this.getTopTextNodes(),t=this.getVideoNodes();if(this.isSmartUnitTester)if(t){console.groupCollapsed("found ".concat(t.length," video nodes:"));for(var n=0;n<t.length;n++)console.log(t[n]);console.groupEnd()}else console.log("no valid video nodes found");var r=[];if(e&&0!==e.length){var i=e.map(function(e){return e.textContent});this.bugsnag.pushBreadCrumb({name:"Found text nodes",metaData:{nodes:i.length,url:this.url,method:"getPageBodyNode()"}}),r=t&&t.length?(0,s.getCommonAncestors)(e.concat((0,s.nodeListToArray)(t))):(0,s.getCommonAncestors)(e)}else this.bugsnag.pushBreadCrumb({name:"No text nodes found for this page",metaData:{url:this.url}}),t&&t.length>0&&(r=1===t.length?[t[0].parentNode]:(0,s.getCommonAncestors)((0,s.nodeListToArray)(t)));if(r.length>0){if(this.isSmartUnitTester){console.groupCollapsed("found ".concat(r.length," parent nodes:"));for(var a=0;a<r.length;a++)console.log(r[a]);console.groupEnd()}this.bugsnag.pushBreadCrumb({name:"Found parent nodes",metaData:{parentNodes:r.length,url:this.url,method:"getPageBodyNode()"}});var o=(0,s.mode)(r);return this.isSmartUnitTester&&(o.setAttribute("style","border: 5px solid #007AFF"),console.groupCollapsed("found most common parent nodes:"),console.log(o),console.groupEnd()),o}return this.bugsnag.pushBreadCrumb({name:"No parent nodes found for this page",metaData:{url:this.url}})}},{key:"getTopTextNodes",value:function(){var e=(0,s.textNodesUnder)(this.pageNode),t=[];if(e.length){var n=0;for(t=(0,o.pageNodeValidation)({nodes:e,thresholdIndex:n,accountId:this.accountId,isSmartUnitTester:this.isSmartUnitTester,configs:this.configs});t.length<c.MIN_VALIDATED_NODES&&n<=c.THRESHOLD_INDEX_MAX;)n+=1,t=(0,o.pageNodeValidation)({nodes:e,thresholdIndex:n,accountId:this.accountId,isSmartUnitTester:this.isSmartUnitTester,configs:this.configs})}else this.bugsnag.pushBreadCrumb({name:"No text nodes found for this page",metaData:{url:this.url}});if(t=t.sort(function(e,t){return t.length-e.length}),t.length>=c.MIN_VALIDATED_NODES){if(this.bugsnag.pushBreadCrumb({name:"Found valid nodes",metaData:{validNodes:t.length,url:this.url,method:"getTopTextNode()"}}),this.isSmartUnitTester){console.groupCollapsed("found ".concat(t.length," validated nodes"));for(var r=0;r<t.length;r++)console.log(t[r]);console.groupEnd()}return t.slice(0,u.NODE_SAMPLE_SIZE)}return this.bugsnag.pushBreadCrumb({name:"No text nodes passed validation",metaData:{url:this.url}})}},{key:"getVideoNodes",value:function(e){return e?e.querySelectorAll(d.videoSelectors):document.querySelectorAll(d.videoSelectors)}},{key:"checkForInfographic",value:function(){for(var e,t=0,n=document.querySelectorAll("img"),r=0;r<n.length;r++){var i=n[r],a=i.getBoundingClientRect();a.height>t&&(t=i.height,e=i)}if(e){var o=e.width,s=t/o;if(s>u.MIN_IMAGE_HEIGHT_RATIO)return e}return this.bugsnag.pushBreadCrumb({name:"infographic not found"}),null}}]),e}(),h=l;n.default=h},{"./Utils":5,"./Validators":6,"./constants/nodeValidation":13,"./constants/pageConstants":14,"./constants/videoConstants":16}],4:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(t){this.pages=[],this.pageNodes=[],this.urlMap=t.urlMap||e.localURLToUnitList,this.pageValidate=t.pageValidate,this.isSmartUnitTester=t.isSmartUnitTester,this.accountId=t.accountId,this.bugsnag=t.bugsnag,this.inject=t.inject,this.canonicalUrl=u.default.getCanonicalURL(),this.accounts=(0,o.default)(this.canonicalUrl,this.accountId),this.knotchConfig=e.Knotch.config,this.init()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(t("./accounts/AccountExtractor")),s=i(t("./Page")),u=i(t("./vanillaHelpers")),c=t("./constants/configURLs"),d=t("./configMethods");a.prototype={init:function(){var e=this;u.default.get("".concat(c.URLS[this.knotchConfig.env],"/").concat(this.accountId,".json"),{},function(t){e.combineConfig(t)},function(t,n,r,i,a){return e.bugsnag.reportError(n,{data:{readyState:r,responseText:i,responseHeaders:a,status:t},severity:"info"})},this.bugsnag,{handle400:!0})},combineConfig:function(e){var t=this;this.config=(0,d.getConfig)(this.canonicalUrl,e),this.config&&this.config.waitUntilType?d.WAIT_UNTIL[this.config.waitUntilType].call(this,function(){return t.checkForNewPages()}):this.checkForNewPages()},checkForNewPages:function(){var t=this;this.checkPageNodesInterval=setInterval(function(){return t.checkPageNodes()},2e3),e.setTimeout(function(){return clearInterval(t.checkPageNodesInterval)},18e5),this.checkPageNodes()},checkPageNodes:function(){for(var e=document.querySelectorAll(this.config.scrollSelector),t=u.default.getCanonicalURL(),n=0;n<e.length;n++)(this.pageNodes.indexOf(e[n])<0||this.canonicalUrl!==t)&&(this.pages.push(new s.default(e[n],this.urlMap,this.pageValidate,this.inject,this.bugsnag,this.accountId,this.config,this.isSmartUnitTester)),this.pageNodes.push(e[n]),this.canonicalUrl=t,this.accounts=(0,o.default)(this.canonicalUrl,this.accountId))}};var l=a;r.default=l},{"./Page":2,"./accounts/AccountExtractor":7,"./configMethods":9,"./constants/configURLs":11,"./vanillaHelpers":18}],5:[function(e,t,n){"use strict";function r(e){return o(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function o(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}Object.defineProperty(n,"__esModule",{value:!0}),n.fromHex=n.toHex=n.nodeListToArray=n.isNodeContainer=n.isNodeBlacklisted=n.nodeContainsBlacklistedNode=n.mode=n.getCommonAncestors=n.findFirstCommonAncestor=n.getAncestors=n.constructNodeBlacklist=n.textNodesUnder=void 0;var s=e("./constants/blacklists"),u=function(e){if(!e)return[];for(var t,n=[],r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);t=r.nextNode();)t.textContent.trim().length>0&&n.push(t);for(var i=0;i<n.length-1;i++)i>0&&n[i].parentNode.parentNode===n[i-1].parentNode&&n[i].parentNode.parentNode===n[i+1].parentNode&&n.splice(i-1,3,n[i-1].parentNode);return n};n.textNodesUnder=u;var c=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,i=e.map(function(e){var t,i=n.querySelectorAll(e),a=n.querySelectorAll("[class*=".concat(e,"]")),o=n.querySelectorAll("[id*=".concat(e,"]")),s=[].concat(r(Array.prototype.slice.call(i)),r(Array.prototype.slice.call(a)),r(Array.prototype.slice.call(o))),c=s.map(function(e){return u(e)});return(t=Array.prototype).concat.apply(t,r(c))});return(t=Array.prototype).concat.apply(t,r(i))};n.constructNodeBlacklist=c;var d=function e(t){return t!==document?[t].concat(e(t.parentNode)):[t]};n.getAncestors=d;var l=function e(t,n,r){if(t===n)return null;var i=r||d(n);return 0===i.length?null:i.indexOf(t)>-1?t:t===document?null:e(t.parentNode,n,i)};n.findFirstCommonAncestor=l;var h=function(e){var t,n,r=[];for(t=e.slice(),n=e.slice(),n.reverse();t.length;){var i=t.pop(),a=n[0]===i?n.pop():n.shift(),o=l(i,a);o&&r.push(o)}return r};n.getCommonAncestors=h;var f=function(e,t){for(var n=t.parentNode;null!=n;){if(n==e)return!0;n=n.parentNode}return!1},p=function(e,t){for(var n in e)if(f(e[n].node,t)&&"BODY"!==e[n].node.nodeName)return e[n].node;return t},v=function(e){var t=e.reduce(function(e,t){var n=e.filter(function(e){return e.node===t});return n.length>0?n[0].count++:e.push({node:t,count:1}),e},[]),n=t.reduce(function(e,t){return t.count>e.count?t:e},{count:0}),r=p(t,n.node);return r};n.mode=v;var m=function(e,t){for(var n=t[s.PAGEBODY_KEY],r=t[s.LASTNODE_KEY],i=!1,a=!1,o=0;o<n.length;o++){var u=c(n,e);(u.length>0||null===e.parentNode.offsetParent)&&(i=!0)}for(var d=0;d<r.length;d++){var l=c(r,e);(l.length>0||null===e.parentNode.offsetParent)&&(a=!0)}};n.nodeContainsBlacklistedNode=m;var g=function(e,t){var n=t[s.PAGEBODY_KEY],r=t[s.LASTNODE_KEY];if(n.indexOf(e.id)!==-1)return!0;for(var i=0;i<e.classList.length;i++)if(n.indexOf(e.classList[i])!==-1||r.indexOf(e.classList[i])!==-1)return!0};n.isNodeBlacklisted=g;var y=function(e){return e&&"DIV"===e.tagName&&e.children.length>0};n.isNodeContainer=y;var b=function(e){return Array.prototype.slice.call(e)};n.nodeListToArray=b;var k=function(e){for(var t="",n=0;n<e.length;n++)t+=e.charCodeAt(n).toString(16);return t};n.toHex=k;var T=function(e){var t;try{t=decodeURIComponent(e.replace(/(..)/g,"%$1"))}catch(e){t=null}return t};n.fromHex=T},{"./constants/blacklists":10}],6:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.lastNodeValidation=n.pageNodeValidation=void 0;var s=e("./Utils"),u=e("./constants/nodeValidation"),c=e("./constants/blacklists"),d=r(e("./constants/validatorLogger")),l=[function(e){var t=e.nodeToCheck;return d.default[0].totalNodesChecked++,void 0!==t?(d.default[0].passed.push(t),!0):(d.default[0].failed.push(t),!1)},function(e){var t=e.nodeToCheck;d.default[1].totalNodesChecked++;var n=t.parentNode;return n&&"SCRIPT"!==n.tagName&&"NOSCRIPT"!==n.tagName?(d.default[1].passed.push(t),!0):(d.default[1].failed.push(t),!1)},function(e){var t=e.nodeToCheck;d.default[2].totalNodesChecked++;var n=t.parentNode;return n&&"STYLE"!==n.tagName&&"STYLE"!==n.tagName?(d.default[2].passed.push(t),!0):(d.default[2].failed.push(t),!1)},function(e){var t=e.nodeToCheck;d.default[3].totalNodesChecked++;var n=/footer/i,r=t.id,i=t.className;return t.parentNode&&n.test(t.parentNode.tagName)?(d.default[3].failed.push(t),!1):n.test(r)||n.test(i)?(d.default[3].failed.push(t),!1):(d.default[3].passed.push(t),!0)},function(e){var t=e.nodeToCheck;d.default[4].totalNodesChecked++;var n=t.parentNode;return n&&null!==n.offsetParent?(d.default[4].passed.push(t),!0):(d.default[4].failed.push(t),!1)},function(e){var t=e.nodeToCheck,n=e.options.blacklist;d.default[5].totalNodesChecked++;var r=n.indexOf(t)===-1;return r?d.default[5].passed.push(t):d.default[5].failed.push(t),r}],h=function(e){var t=e.nodeToCheck,n=e.options.thresholdIndex;return d.default[6].totalNodesChecked++,t.textContent.trim().length>u.TEXT_LENGTH_THRESHOLD-20*n?(d.default[6].passed.push(t),!0):(d.default[6].failed.push(t),!1)},f=function(e){var t=e.nodes,n=e.thresholdIndex,r=(e.accountId,e.isSmartUnitTester),i=e.configs,o=i[c.PAGEBODY_KEY],u=(0,s.constructNodeBlacklist)(o),f=[].concat(l,[h]),p=t.filter(function(e){var t=f.reduce(function(t,r){return t&&r({nodeToCheck:e,options:{thresholdIndex:n,blacklist:u}})},!0);if(r){var i=3===e.nodeType?e.parentNode:e;t?i.setAttribute("style","background: rgba(0,255,0,0.5);"):i.style.background||i.setAttribute("style","background: rgba(255,0,0,0.5);")}return t});if(r){console.groupCollapsed("Text Node validation");var v=d.default.map(function(e){return a({},e,{numPassed:e.passed.length,numFailed:e.failed.length})});console.table(v),console.groupEnd();for(var m=0;m<d.default.length-1;m++)d.default[m].totalNodesChecked=0,d.default[m].passed=[],d.default[m].failed=[]}return p};n.pageNodeValidation=f;var p=function(e){var t=e.nodes,n=e.isSmartUnitTester,r=e.configs,i=r[c.LASTNODE_KEY],o=(0,s.constructNodeBlacklist)(i),u=t.filter(function(e){var t=l.reduce(function(t,n){return t&&n({nodeToCheck:e,options:{blacklist:o}})},!0);if(n){var r=e.parentNode;t?r.setAttribute("style","background: rgba(0,255,0,0.5);"):r.style.background||r.setAttribute("style","background: rgba(255,0,0,0.5);")}return t});if(n){console.groupCollapsed("Last Node validation");var h=d.default.map(function(e){return a({},e,{numPassed:e.passed.length,numFailed:e.failed.length})});console.table(h),console.groupEnd();for(var f=0;f<d.default.length-1;f++)d.default[f].totalNodesChecked=0,d.default[f].passed=[],d.default[f].failed=[]}return u};n.lastNodeValidation=p},{"./Utils":5,"./constants/blacklists":10,"./constants/nodeValidation":13,"./constants/validatorLogger":15}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("./accountValidators.js"),i=e("../Utils"),a=function(e,t){var n=r.encryptions[t],a={default:t,subAccounts:[]};if(!n)return null;for(var o in n)for(var s=n[o],u=0;u<s.length;u++){var c=(0,i.fromHex)(s[u]),d=new RegExp(c);if(!d.test(e))return null;a.subAccounts.push(o)}return a},o=a;n.default=o},{"../Utils":5,"./accountValidators.js":8}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.encryptions=void 0;var r={"518afb38-d89b-4aa0-9b73-31ad26d491a6":{"15b3956bc9d8c9946c803ab80886ec74":["U2FsdGVkX1/C2X3X7pBEnAsXRWekDe3LuMdGGrevSEE50dB0Ve+EhyFKWTBBIHdV"],"7a53d7e2e57d8fbe5680e61358d23536":["U2FsdGVkX1/OXvPXbkoSsKXxPfG45+tXkiyse1puGVDNiAgQqg8tzJoPGatet4MUNWXPO8LSZ0O0k9vnSKBB6A==","U2FsdGVkX18Jf9fJlNGPRWdgktYusIjwqeDBw19tScNmMbLcEWLP1fZVPLk8drUK/pkPQy42hQzqIEWhGt53ZQ==","U2FsdGVkX19S7fI7yVo0Z7oNU5IdoS93j5S7GW1cvpCvBKFfaqK7MR9GuKFN6lei","U2FsdGVkX1978OVs1CXlStVfOqYszJmiEpfQLwV+IGZfYG/A7PqQKRXtTlnDnDIiwfE5CutGpUBSXzCIQfeN4w=="]},"59a8732185a483543bb543a3":{"1b24359f30b5b9407066a1eec22bd3f1":["U2FsdGVkX1/Ky5rMUtj1Un4F1Kc1nSuz1jiKrlLDqUJGjeNMuPuKlBxsh2o6C1RH"],abfc3a65538a6ec86502b2b498b6b4a6:["U2FsdGVkX19NYin5lY3CC81pvyQ9ywPw4rS5tK6MuPL4jOGnNxHlUQW7CnCjewc1"]},"b6b10bf5-6f47-466b-92fc-06a4d0465004":{bdd2b4735520a67128c5c41e13ba242b:["U2FsdGVkX1/ra5g+n0ONjyX8Owtd9kQ6cH+uWvd2EWSN5HHxfJEdtbaY+Xy/6GDR"],"4a4e823cd1c23ca5208dda302d47c4fe":["U2FsdGVkX19woCMy+Gc1ez/tvavScHa/Nj63oIX8pECGLOimBUZ0RvC1dy0uv8Sr"],"4c09c1c6592314382399dca560827142":["U2FsdGVkX18F1DDxVshKlDxLDxClxUaQfm2Y+Cnrb0Gl8FG9bu6hdwiZlECrITCR"]},"bce4b311-6d20-4d7f-89b8-de0ba080d5bb":{ab68f1b12242c0f27fd60fc1455df93f:["U2FsdGVkX1+ur52QbinpZ6rrucN6FXr6+tljSp77DW8TgBHlFQFy29o0jcLsYeVM"],baea48cd2b5a47254e40011531452fd7:["U2FsdGVkX18VNRJgq+wsj85LImghIumCERPqdwyxFoWD3INvGznzFZFbSSDMBjOJ","U2FsdGVkX1//swH9aJ7a51iYbMvFggSteKMg9qC1zr++hqc/yuMQ2Ukjf5i4Ga2WE/vRzXDtYSQHu3y/Om70UxOWIHveOI578eNDYtrxXVo="],"4aa6f508502e1c32214f480ab5ce559e":["U2FsdGVkX193i0oP0eprT0aIvg+c/2C4LflYnBTnik0l7/evAuafFru2uUjFJ2jGLGacMvYal26/U1HBGmw/7bmUXVL/5hi21tSBYgcDqx8="],"5f2a13115f830fd9487f8cd48ba988f6":["U2FsdGVkX1+KDIkyiGtfJg1kcGlOA844FhoTp+6kNRCcB7Kot6jaokBamvEgxziNdNbPjfDlInU3UoosZSkhunmwzvNnOl+X1Cg7/t4nMhk="]},"5babf273636f6fc04d62e363":{"34583e6829c62fded991aa86a5a99939":["U2FsdGVkX18AOs+7BwgiiNjBJVnGleJumNVvlFUdBcPRH3V6123xQ9/11CD+JKVd"],"2409eb721f8ebb8602068bb94b1db8ed":["U2FsdGVkX18xGicJKBNajCruAF+R3NJv5iDXERzkLN8UA7LFGCxCiF7MIrQnG+ys"]}};n.encryptions=r},{}],9:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.combineBlacklists=r.getConfig=r.urlHasConfig=r.getConfigPageBodyNode=r.WAIT_UNTIL=void 0;var a=t("./Utils"),o=i(t("./vanillaHelpers")),s=i(t("./constants/defaultConfig")),u=t("./constants/blacklists"),c="default",d={nuxt:function(t){var n=e.setInterval(function(){try{if(e.$nuxt&&e.$nuxt.$loading._isMounted)return t(),clearInterval(n),!0}catch(e){console.log(e.message)}},100);e.setTimeout(function(){return clearInterval(n)},18e5)}};r.WAIT_UNTIL=d;var l=function(e){for(var t=0;t<e.length;t++)if(document.querySelector(e[t]))return document.querySelector(e[t])};r.getConfigPageBodyNode=l;var h=function(e,t){if(e===c)return!0;var n=(0,a.fromHex)(e);if(!n)return!1;var r=new RegExp(n);return r.test(t)};r.urlHasConfig=h;var f=function(e,t){var n,r=s.default.default&&s.default.default.config;for(var i in t){var a=p(t,i);h(i,e)&&(n=o.default.extend(n,a))}return o.default.extend(r,n)};r.getConfig=f;var p=function(e,t){var n=e[t].config,r=n&&Object.keys(n).length>0;return r?n:{}},v=function(e){var t=o.default.getCanonicalURL(),n=s.default.default&&s.default.default.blacklist.pageBodyBlacklist,r=s.default.default&&s.default.default.blacklist.lastNodeBlacklist,i={pageBodyBlacklist:n,lastNodeBlacklist:r};for(var a in e){var c=m(e,a,u.PAGEBODY_KEY),d=m(e,a,u.LASTNODE_KEY);h(a,t)&&(i.pageBodyBlacklist=i.pageBodyBlacklist.concat(c),i.lastNodeBlacklist=i.lastNodeBlacklist.concat(d))}return i};r.combineBlacklists=v;var m=function(e,t,n){var r=e[t].blacklist,i=r&&Object.keys(r).length>0;if(i){var a=e[t].blacklist[n];if(Array.isArray(a)&&a.length>0)return a}return[]}},{"./Utils":5,"./constants/blacklists":10,"./constants/defaultConfig":12,"./vanillaHelpers":18}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LASTNODE_KEY=n.PAGEBODY_KEY=void 0;var r="pageBodyBlacklist";n.PAGEBODY_KEY=r;var i="lastNodeBlacklist";n.LASTNODE_KEY=i},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.URLS=void 0;var r={development:"https://assets.knotch.host/crawl-config",test:"https://assets.knotch.host/crawl-config",production:"https://www.knotch-cdn.com/crawl-config"};n.URLS=r},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r={default:{blacklist:{pageBodyBlacklist:["comment","disclaimer","footer","modal","about-wrapper","related-content-grid","resourceSlider","todolistcontainer"],lastNodeBlacklist:["tag-display","related-content","tag-cloud"]},config:{scrollSelector:"body"}}},i=r;n.default=i},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MIN_VALIDATED_NODES=n.THRESHOLD_INDEX_MAX=n.TEXT_LENGTH_THRESHOLD_MIN=n.TEXT_LENGTH_THRESHOLD=void 0;var r=200;n.TEXT_LENGTH_THRESHOLD=r;var i=80;n.TEXT_LENGTH_THRESHOLD_MIN=i;var a=6;n.THRESHOLD_INDEX_MAX=a;var o=3;n.MIN_VALIDATED_NODES=o},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MIN_IMAGE_HEIGHT_RATIO=n.INVIEW_OFFSET=n.NODE_SAMPLE_SIZE=void 0;var r=50;n.NODE_SAMPLE_SIZE=r;var i=100;n.INVIEW_OFFSET=i;var a=2;n.MIN_IMAGE_HEIGHT_RATIO=a},{}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=[{name:"Undefined Check",totalNodesChecked:0,passed:[],failed:[]},{name:"Script Tag Check",totalNodesChecked:0,passed:[],failed:[]},{name:"Style Tag Check",totalNodesChecked:0,passed:[],failed:[]},{name:"Footer Check",totalNodesChecked:0,passed:[],failed:[]},{name:"Visible Check",totalNodesChecked:0,passed:[],failed:[]},{name:"Blacklist Check",totalNodesChecked:0,passed:[],failed:[]},{name:"Text Threshold Check",totalNodesChecked:0,passed:[],failed:[]}],i=r;n.default=i},{}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.videoSelectors=void 0;var r="iframe[src*=youtube], [class*=brightcove], [class*=fave-player-INPUT], .jwplayer, [id^=wistia_simple_video], video";n.videoSelectors=r},{}],17:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=r(e("./Tracker"));t.exports=function(e){return new i.default(e)}},{"./Tracker":4}],18:[function(t,n,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.h=void 0;var i={isMobile:function(){return"ontouchstart"in e||navigator.msMaxTouchPoints||navigator.userAgent.indexOf("IEMobile")!==-1},isEmptyObject:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},isValidNumber:function(e){return"number"==typeof e&&!isNaN(e)},isValidTagId:function(e){var t=/^[A-F\d]{8}-[A-F\d]{4}-4[A-F\d]{3}-[89AB][A-F\d]{3}-[A-F\d]{12}$/i;return e&&"string"==typeof e&&e.length>0&&(t.test(e)||e.match(/^[0-9a-fA-F]{24}$/))},getAccountId:function(){return i.getScriptAttribute("data-account")},getNodeDescription:function(e){if(!e)return null;var t=e.tagName;return e.id&&(t+="#".concat(e.id)),e.className&&e.className.length&&(t+=e.className.split(" ").join(".")),t},getScriptFlag:function(e){try{var t=document.querySelector('script[src*="knotch"]')||document.currentScript,n=""===t.getAttribute(e),r="true"===t.getAttribute(e)||"1"===t.getAttribute(e);return n||r}catch(e){return!1}},getScriptAttribute:function(e){try{var t=document.currentScript||document.querySelector('script[src*="knotch"]');return t.getAttribute(e)}catch(e){return!1}},validateURL:function(e){return/^((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/.test(e)},removeSearch:function(e){return e&&e.indexOf("?")!==-1?e.split("?")[0]:e},getCanonicalURL:function(){var e=document.querySelector("meta[property='og:url']"),t=document.querySelector("link[rel=canonical]"),n=document.querySelector("meta[name='canonical']");if(t&&t.getAttribute("href").length>0){var r=t.getAttribute("href");if(this.validateURL(r))return r}if(e&&e.getAttribute("content").length>0){var i=e.getAttribute("content");if(this.validateURL(i))return i}if(n&&n.getAttribute("content").length>0){var a=n.getAttribute("content");if(this.validateURL(a))return a}return console.warn("no valid canonical url was found"),null},getBrowserURL:function(t){var n=null;return document.URL?n=document.URL:e.location.href?n=e.location.href:e.location.host&&e.location.pathname&&(n="".concat(e.location.protocol,"//").concat(e.location.host).concat(e.location.pathname)),n?n:(t.reportError(new Error("browser URL doesn't exist"),this.localData),null)},get:function(t,n,r,i,a,o){var s,u="undefined"!=typeof XMLHttpRequest.DONE?XMLHttpRequest.DONE:4;return s=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),s.onerror=function(){return s.status>=500&&a.reportError(new Error(s.responseText),{name:"".concat(s.status," request error"),data:n}),!1},s.onreadystatechange=function(){if(s.readyState===u)if(200===s.status){var e=s.responseText;if(e)try{var n=JSON.parse(e)}catch(n){a.reportError(n,{name:"failed to parse request response",data:{responseText:e,url:t}})}r(n)}else s.status>=400&&o&&o.handle400?r(n):s.status>=500?i(s.status,s.statusText,s.readyState,s.responseText,s.getAllResponseHeaders()):0===s.status&&i(s.status,s.statusText,s.readyState)},s.open("GET",t,!0),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.send(JSON.stringify(n)),s},post:function(t,n,r,i,a){var o,s="undefined"!=typeof XMLHttpRequest.DONE?XMLHttpRequest.DONE:4;return o=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),o.onloadend=function(){return o.status>=400&&a.reportError(new Error(o.responseText),{name:"404 - not found",data:n}),!1},o.onerror=function(){return o.status>=500&&a.reportError(new Error(o.responseText),{name:"".concat(o.status," request error"),data:n}),!1},o.onreadystatechange=function(){if(o.readyState===s){var e=o.responseText;if(e&&!e.match(/</))try{var n=JSON.parse(e)}catch(n){a.reportError(n,{name:"failed to parse request response",data:{responseText:e,url:t}})}200===o.status?r(n):0===o.stats&&i(o.status,o.statusText)}},o.open("POST",t,!0),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.send(JSON.stringify(n)),o},extend:function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e}};r.h=i;var a=i;r.default=a},{}],19:[function(t,n,r){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var u=function(e,t){var n;return function(){var r=this,i=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(r,i)},t)}},c=function(t){var n=!1,r=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",i),e.removeEventListener("load",i)):(document.detachEvent("onreadystatechange",i),e.detachEvent("onload",i))},i=function(){n||!document.addEventListener&&"load"!==event.type&&"complete"!==document.readyState||(n=!0,r(),t())};if("complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState||document.body)t();else if(document.addEventListener)document.addEventListener("DOMContentLoaded",i),e.addEventListener("load",i);else{document.attachEvent("onreadystatechange",i),e.attachEvent("onload",i);var a=!1;try{a=null==e.frameElement&&document.documentElement}catch(e){}a&&a.doScroll&&function e(){if(!n){try{a.doScroll("left")}catch(t){return setTimeout(e,50)}n=!0,r(),t()}}()}},d=function(){return"ontouchstart"in e||navigator.msMaxTouchPoints||-1!==navigator.userAgent.indexOf("IEMobile")},l=function(e){for(var t="",n=e,r="BODY"!==n.tagName;n!==document.body;){var i="";if(i+=n.tagName.toLowerCase(),n.id&&(i+="#".concat(n.id)),r&&n.className){var a=n.className.replace(/(\r\n|\n|\r)/gm," ");i+=".".concat(a.split(" ").filter(function(e){return e.length>0}).join("."))}n=n.parentNode,t=0===t.length?i:"".concat(i,">").concat(t)}return t},h=function(e){return e.src?e.src:e.href?e.href:null},f=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"A",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(null===t)return null;var i=r-1;return t.tagName===n?t:0===i?null:e(t.parentElement,n,i)},p=["scroll","keydown","click","focus","mousemove"],v=["touchstart","touchmove","touchend"],m=function(){function e(t){var n=this,r=t.callback;a(this,e);var i=u(function(){return n.trackEngagedTimeOnPage()},3e3);this.callback=r,c(function(){!function(e,t,n){function r(e,t){for(var r=0;r<t.length;r++)try{e.addEventListener?e.addEventListener(t[r],n,!1):e.attachEvent&&e.attachEvent("on".concat(t[r]),n)}catch(n){Knotch.bugsnag.reportError(n,{name:"Error while attaching event listener",data:{node:e,events:t}})}}if(t){var i=null;if(i=Array.isArray(e)&&e.length>0?e:[e],t instanceof NodeList||t instanceof HTMLCollection){t.length||(t=[t]);for(var a=0;a<t.length;a++)r(t[a],i)}else r(t instanceof Array?t[0]:t,i)}}(d()?v:p,document,function(){n.timeEngagedStart||(n.timeEngagedStart=Date.now()),i()})})}return s(e,[{key:"trackEngagedTimeOnPage",value:function(){var e=Date.now()-this.timeEngagedStart-3e3;if(this.timeEngagedStart=null,e>0&&!isNaN(e)){var t={type:"time_on_page_engaged",engaged_time:e};this.callback(t)}}}]),e}(),g=function(){var t,n,r,i,a,o,s,u,c,d,l,h,f,p,v,m;return u={},r=document,d=!1,l="active",o=6e4,a=!1,v={},p="__ceGUID",n={add:function(e,t,n){return e[p]=void 0,e[p]||(e[p]="ifvisible.object.event.identifier"),v[e[p]]||(v[e[p]]={}),v[e[p]][t]||(v[e[p]][t]=[]),v[e[p]][t].push(n)},remove:function(e,t,n){var r,i,a,o,s;if(n){if(e[p]&&v[e[p]]&&v[e[p]][t])for(i=a=0,o=(s=v[e[p]][t]).length;a<o;i=++a)if((r=s[i])===n)return v[e[p]][t].splice(i,1),r}else if(e[p]&&v[e[p]]&&v[e[p]][t])return delete v[e[p]][t]},fire:function(e,t,n){var r,i,a,o,s;if(e[p]&&v[e[p]]&&v[e[p]][t]){for(s=[],i=0,a=(o=v[e[p]][t]).length;i<a;i++)r=o[i],s.push(r(n||{}));return s}}},m=!1,t=function(e,t,n){return m||(m=e.addEventListener?function(e,t,n){return e.addEventListener(t,n,!1)}:e.attachEvent?function(e,t,n){return e.attachEvent("on"+t,n,!1)}:function(e,t,n){return e["on"+t]=n}),m(e,t,n)},s=function(){var e,t,n,i;for(i=3,n=r.createElement("div"),e=n.getElementsByTagName("i"),t=function(){return n.innerHTML="<!--[if gt IE "+ ++i+"]><i></i><![endif]-->",e[0]};t(););return i>4?i:void 0}(),i=!1,f=void 0,void 0!==r.hidden?(i="hidden",f="visibilitychange"):void 0!==r.mozHidden?(i="mozHidden",f="mozvisibilitychange"):void 0!==r.msHidden?(i="msHidden",f="msvisibilitychange"):void 0!==r.webkitHidden&&(i="webkitHidden",f="webkitvisibilitychange"),h=function(){var n,i;return n=[],(i=function(){return n.map(clearTimeout),"active"!==l&&u.wakeup(),a=+new Date,n.push(setTimeout(function(){if("active"===l)return u.idle()},o))})(),t(r,"mousemove",i),t(r,"keyup",i),t(r,"touchstart",i),t(e,"scroll",i),u.focus(i),u.wakeup(i)},c=function(){var n;return!!d||(!1===i?(n="blur",s<9&&(n="focusout"),t(e,n,function(){return u.blur()}),t(e,"focus",function(){return u.focus()})):t(r,f,function(){return r[i]?u.blur():u.focus()},!1),d=!0,h())},u={setIdleDuration:function(e){return o=1e3*e},getIdleDuration:function(){return o},getIdleInfo:function(){var e,t;return e=+new Date,t={},"idle"===l?(t.isIdle=!0,t.idleFor=e-a,t.timeLeft=0,t.timeLeftPer=100):(t.isIdle=!1,t.idleFor=e-a,t.timeLeft=a+o-e,t.timeLeftPer=(100-100*t.timeLeft/o).toFixed(2)),t},focus:function(e){return"function"==typeof e?this.on("focus",e):(l="active",n.fire(this,"focus"),n.fire(this,"wakeup"),n.fire(this,"statusChanged",{status:l})),this},blur:function(e){return"function"==typeof e?this.on("blur",e):(l="hidden",n.fire(this,"blur"),n.fire(this,"idle"),n.fire(this,"statusChanged",{status:l})),this},idle:function(e){return"function"==typeof e?this.on("idle",e):(l="idle",n.fire(this,"idle"),n.fire(this,"statusChanged",{status:l})),this},wakeup:function(e){return"function"==typeof e?this.on("wakeup",e):(l="active",n.fire(this,"wakeup"),n.fire(this,"statusChanged",{status:l})),this},on:function(e,t){return c(),n.add(this,e,t),this},off:function(e,t){return c(),n.remove(this,e,t),this},onEvery:function(e,t){var n,r;return c(),n=!1,t&&(r=setInterval(function(){if("active"===l&&!1===n)return t()},1e3*e)),{stop:function(){return clearInterval(r)},pause:function(){return n=!0},resume:function(){return n=!1},code:r,callback:t}},now:function(e){return c(),l===(e||"active")}}}(),y=function(){function t(e){var n=e.callback;a(this,t),this.callback=n,this.interval=null,this.pingCount=0,this.currentFreq=5e3,this.running=!1,this.init()}return s(t,[{key:"init",value:function(){var t=this;!function(t){var n=!1,r=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",i),e.removeEventListener("load",i)):(document.detachEvent("onreadystatechange",i),e.detachEvent("onload",i))},i=function(){n||!document.addEventListener&&"load"!==event.type&&"complete"!==document.readyState||(n=!0,r(),t())};if("complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState||document.body)t();else if(document.addEventListener)document.addEventListener("DOMContentLoaded",i),e.addEventListener("load",i);else{document.attachEvent("onreadystatechange",i),e.attachEvent("onload",i);var a=!1;try{a=null==e.frameElement&&document.documentElement}catch(e){}a&&a.doScroll&&function e(){if(!n){try{a.doScroll("left")}catch(t){return setTimeout(e,50)}n=!0,r(),t()}}()}}(function(){var e=function(){return t.startPing()},n=function(){return t.stopPing()};e(),g.setIdleDuration(3600),g.on("blur",n),g.on("focus",e),g.on("idle",n),g.on("wakeup",e)})}},{key:"startPing",value:function(){this.running||(this.running=!0,this.trackPingTimeOnPage())}},{key:"stopPing",value:function(){this.running=!1,clearInterval(this.interval)}},{key:"trackPingTimeOnPage",value:function(){var e=this;this.running&&(this.interval&&clearInterval(this.interval),this.interval=setTimeout(function(){e.callback({type:"time_on_page_ping",freq:e.currentFreq}),e.pingCount+=1,8===e.pingCount&&e.stopPing(),e.currentFreq=2*e.currentFreq,e.trackPingTimeOnPage()},this.currentFreq))}}]),t}(),b=function(){function t(e){var n=this,r=e.selector,i=e.callback;a(this,t),this.callback=i,this.node=this.getTrackedNode(r),this.scrollTimeout=null,this.touchEndListener=function(){return n.onScroll()},this.scrollListener=u(function(){return n.onScroll()},200),this.keyDownListener=function(e){return n.onKeyDown(e)},this.thresholds={100:!1,75:!1,50:!1,25:!1,0:!1},this.node&&(this.yPosMax=this.getYPos(),c(function(){n.shouldTrackThreshold(),d()?document.addEventListener("touchend",n.touchEndListener):(document.addEventListener("scroll",n.scrollListener),document.addEventListener("keydown",n.keyDownListener))}))}return s(t,[{key:"getTrackedNode",value:function(t){return t?document.querySelector(t)?document.querySelector(t):e.Knotch.bugsnag.pushBreadCrumb({name:"Node unavailable for scroll depth tracking"}):document.documentElement?document.documentElement:e.Knotch.bugsnag.pushBreadCrumb({name:"Node unavailable for scroll depth tracking"})}},{key:"onScroll",value:function(){this.hasReachedBottomOfContent()&&(document.removeEventListener("scroll",this.scrollListener),document.removeEventListener("keydown",this.keyDownListener),document.removeEventListener("touchend",this.touchEndListener)),this.shouldTrackThreshold()}},{key:"shouldTrackThreshold",value:function(){var t=this,n=100*this.getYPos()/this.node.scrollHeight;for(var r in this.thresholds){var a=parseInt(r,10);if(!this.thresholds[a]&&n>=a){var o=function(){if(t.thresholds[a]=!0,clearTimeout(t.scrollTimeout),t.yPosMax=t.getYPos(),"number"!=typeof t.yPosMax||isNaN(t.yPosMax)||!t.node)return{v:e.Knotch.bugsnag.reportError(new Error("invalid scrolldepth yPosMax"),{data:{yPosMax:t.yPosMax}})};var n=Math.floor(100*t.yPosMax/t.node.scrollHeight);n<1&&(n=1);var r={type:"scroll_depth",scroll_position:t.yPosMax,scroll_pct:n};t.scrollTimeout=setTimeout(function(){return t.callback(r)},100)}();if("object"===i(o))return o.v}}}},{key:"onKeyDown",value:function(e){var t=(e.code||"").toLowerCase();"space"!==t&&"arrowdown"!==t||this.onScroll()}},{key:"getYPos",value:function(){return e.scrollY+e.innerHeight}},{key:"hasReachedBottomOfContent",value:function(){return!!this.node&&this.yPosMax&&this.yPosMax>=this.node.scrollHeight}}]),t}(),k=["textContent","className","id","href"],T=function(){function t(n){var r=this,i=n.callback;a(this,t),this.callback=i,document.addEventListener("click",function(e){return r.handleClick(e)}),document.addEventListener("auxclick",function(e){return r.handleClick(e)}),e.addEventListener("blur",function(e){setTimeout(function(){"IFRAME"===document.activeElement.tagName&&r.handleClick({target:document.activeElement,pageX:document.activeElement.offsetLeft,pageY:document.activeElement.offsetTop})})})}return s(t,[{key:"checkForHTML",value:function(e){return k.reduce(function(t,n){return t||(r=e[n])&&/<\s?[^\>]*\/?\s?>/.test(r);var r},!1)}},{key:"validateForNull",value:function(e){return k.reduce(function(t,n){return t||!!e[n]},!1)}},{key:"handleClick",value:function(e){var t,n,r,i,a=e.target,o=f(a,"A",3),s=o||a;if(n=s,r=["A","BUTTON","SVG","IMG","SPAN","H1","H2","H3","DIV","IFRAME","OPTION","LABEL"],(i=[function(e){return r.indexOf(e.tagName)>-1},function(e){return e.tagName===e.textContent.length<=50},function(e){return"INPUT"===e.tagName&&"submit"===e.type}]).reduce(function(e,t,r){return e||i[r](n)},!1)&&!this.checkForHTML(s)&&this.validateForNull(s)){var u={type:"content_interaction",interaction_type:"click",target_class:s.className,target_id:s.id,target_text:(t=s,"INPUT"===t.tagName?t.value:"IFRAME"===t.tagName?t.title:t.textContent&&t.textContent.trim().substring(0,50)),target_path:l(s),target_url:h(s),target_x:e.pageX,target_y:e.pageY};this.callback(u)}}}]),t}();n.exports={ScrollDepthTracker:b,PingTimeOnPageTracker:y,EngagedTimeOnPageTracker:m,ContentInteractionTracker:T}},{}],20:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(t){this.config=t||{},this.url="https://notify.bugsnag.com/js?",this.user={},this.device={},this.startTime=(new Date).getTime(),this.isDebug=e.Knotch&&e.Knotch.debug,this.isDebug&&(this.DebugUI=new s.default),this.breadcrumbs=[{name:"Bugsnag Loaded",timestamp:this.startTime,type:"navigation"}]}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(t("./vanillaHelper")),s=i(t("./DebugUI")),u=30;a.prototype={setUser:function(e){this.user=e},setDevice:function(e){this.device=e},pushBreadCrumb:function(e){e.timestamp=(new Date).getTime(),e.type||(e.type="process"),this.breadcrumbs.push(e),this.breadcrumbs.length>u&&this.breadcrumbs.shift(),this.isDebug&&(o.default.log(e),this.DebugUI.addBreadcrumb(e))},reportError:function(e,t){var n=this.config,r=n.env,i=n.version;if("development"===r||"test"===r||this.isDebug||"development"===i)return void console.error(e);var a=o.default.serialize(this.payloadData(e,t)),s=new Image;s.src=this.url+a},payloadData:function(t,n){if(t)return n||(n={}),{apiKey:"581f50d456b1fa142bae175bdea5d2d8",breadcrumbs:this.breadcrumbs,context:e.location.href,ct:"img",cb:(new Date).getTime(),language:"en-US",message:t.message,metaData:n.data,name:n.name||t.message,notifierVersion:"3.0.7",payloadVersion:"3",releaseStage:this.config.env,severity:n.severity||"error",stacktrace:t.stack,url:e.location.href,user:this.user||n.user,userAgent:navigator.userAgent,appVersion:this.config.version||"dev"}}},self!==top&&(e.bugsnag=new a(e.knotchConfig));var c=a;r.default=c},{"./DebugUI":22,"./vanillaHelper":25}],21:[function(t,n,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i={set:function(t,n,r,i){var a;return t?(i||(i={}),r&&(a=(new Date).getTime()+1e3*r),e.document.cookie=[encodeURIComponent(t),"=",encodeURIComponent(String(n)),a?"; expires="+new Date(a).toUTCString():"","; path="+(i.path?i.path:"/"),i.domain?"; domain="+i.domain:"",e.location&&"https:"===e.location.protocol?"; Secure; SameSite=None":""].join("")):null},get:function(t,n){return(n=new RegExp("(?:^|; )"+encodeURIComponent(t)+"=([^;]*)").exec(e.document.cookie))?decodeURIComponent(n[1]):null},delete:function(e,t){i.set(e,null,-1,t)}},a=i;r.default=a},{}],22:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=r(e("./vanillaHelper")),u={position:"fixed",top:"0",left:"0",height:"400px",width:"50%",overflowY:"scroll",background:"#eee",fontFamily:"sans-serif",fontSize:"12px",cursor:"move",padding:"10"},c=function(e){return{display:"inline-block",padding:"2px",width:e}},d=function(){function e(){var t=this;i(this,e),s.default.ready(function(){return t.init()}),this.root=null,this.queue=[]}return o(e,[{key:"init",value:function(){this.root||this.createRoot()}},{key:"createRoot",value:function(){var e=this;this.root||(this.root=s.default.el({type:"div",style:u}),this.root.addEventListener("mousedown",function(){e.isDown=!0},!0),document.addEventListener("mouseup",function(){e.isDown=!1},!0),this.root.addEventListener("mousemove",function(t){if(t.preventDefault(),e.isDown){var n=t.movementX,r=t.movementY,i=e.root.getBoundingClientRect();e.root.style.left="".concat(i.x+n,"px"),e.root.style.top="".concat(i.y+r,"px")}},!1),document.body.appendChild(this.root),this.processQueue())}},{key:"addBreadcrumb",value:function(e){if(!this.root)return this.queue.push(e);var t=e.name,n=e.metadata,r=e.type,i=e.timestamp,a=s.default.el({type:"div",style:c("70%"),content:t}),o=s.default.el({type:"div",style:c("30%"),content:JSON.stringify(n)}),u=s.default.el({type:"div",content:"".concat(r," - ").concat(new Date(i).toLocaleTimeString()),style:{color:"#929191"}});a.appendChild(u);var d=s.default.el({type:"div"});d.appendChild(a),d.appendChild(o),this.root.prepend(d)}},{key:"processQueue",value:function(){for(var e=this.queue.length,t=0;t<e;t++){var n=this.queue.pop();this.addBreadcrumb(n)}}}]),e}(),l=d;n.default=l},{"./vanillaHelper":25}],23:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var l=i(t("./vanillaHelper")),h=function(){function t(n){var r=this;u(this,t),this.ready=!1,this.queue=[],this.DOM=this.createFrame(n),n.container&&l.default.ready(function(){return n.container.appendChild(r.DOM)}),l.default.listen("message",e,function(e){var t=e.data,i=t.eventType,a=t.data;a&&a.id&&"knotch_handshake_iFrame_ready"===i&&a.id===n.id&&(r.ready=!0,r.flush())})}return d(t,[{key:"createFrame",value:function(e){var t=e.src,n=e.title,r=e.attributes,i=void 0===r?{}:r,a=e.id,s=e.width,u=e.height,c=document.createElement("iframe");return l.default.extend(c,o({name:name||"",title:n||"",src:t,frameBorder:"0",id:a,width:s,height:u},i)),c}},{key:"sendMessage",value:function(e){return this.ready?void this.DOM.contentWindow.postMessage(e,"*"):this.queue.push(e)}},{key:"flush",value:function(){for(var e=this.queue.length,t=0;t<e;t++){var n=this.queue.pop();this.sendMessage(n)}}}]),t}(),f=h;r.default=f},{"./vanillaHelper":25}],24:[function(t,n,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(){var t,n,r,i,a,o,s,u,c,d,l,h,f,p;return c={},r=document,l=!1,h="active",s=6e4,o=!1,n=function(){var e,t,n,r,i,a,o;return e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},i=function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},a={},n="__ceGUID",t=function(e,t,r){return e[n]=void 0,e[n]||(e[n]="ifvisible.object.event.identifier"),a[e[n]]||(a[e[n]]={}),a[e[n]][t]||(a[e[n]][t]=[]),a[e[n]][t].push(r)},r=function(e,t,r){var i,o,s,u,c;if(e[n]&&a[e[n]]&&a[e[n]][t]){for(u=a[e[n]][t],c=[],o=0,s=u.length;o<s;o++)i=u[o],c.push(i(r||{}));return c}},o=function(e,t,r){var i,o,s,u,c;if(r){if(e[n]&&a[e[n]]&&a[e[n]][t])for(c=a[e[n]][t],o=s=0,u=c.length;s<u;o=++s)if(i=c[o],i===r)return a[e[n]][t].splice(o,1),i}else if(e[n]&&a[e[n]]&&a[e[n]][t])return delete a[e[n]][t]},{add:t,remove:o,fire:r}}(),t=function(){var e;return e=!1,function(t,n,r){return e||(e=t.addEventListener?function(e,t,n){return e.addEventListener(t,n,!1)}:t.attachEvent?function(e,t,n){return e.attachEvent("on"+t,n,!1)}:function(e,t,n){return e["on"+t]=n}),e(t,n,r)}}(),i=function(e,t){var n;return r.createEventObject?e.fireEvent("on"+t,n):(n=r.createEvent("HTMLEvents"),n.initEvent(t,!0,!0),!e.dispatchEvent(n))},u=function(){var e,t,n,i,a;for(i=void 0,a=3,n=r.createElement("div"),e=n.getElementsByTagName("i"),t=function(){return n.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->",e[0]};t(););return a>4?a:i}(),a=!1,p=void 0,"undefined"!=typeof r.hidden?(a="hidden",p="visibilitychange"):"undefined"!=typeof r.mozHidden?(a="mozHidden",p="mozvisibilitychange"):"undefined"!=typeof r.msHidden?(a="msHidden",p="msvisibilitychange"):"undefined"!=typeof r.webkitHidden&&(a="webkitHidden",p="webkitvisibilitychange"),f=function(){var n,i;return n=[],i=function(){return n.map(clearTimeout),"active"!==h&&c.wakeup(),o=+new Date,n.push(setTimeout(function(){if("active"===h)return c.idle()},s))},i(),t(r,"mousemove",i),t(r,"keyup",i),t(r,"touchstart",i),t(e,"scroll",i),c.focus(i),c.wakeup(i)},d=function(){var n;return!!l||(a===!1?(n="blur",u<9&&(n="focusout"),t(e,n,function(){return c.blur()}),t(e,"focus",function(){return c.focus()})):t(r,p,function(){return r[a]?c.blur():c.focus()},!1),l=!0,f())},c={setIdleDuration:function(e){return s=1e3*e},getIdleDuration:function(){return s},getIdleInfo:function(){var e,t;return e=+new Date,t={},"idle"===h?(t.isIdle=!0,t.idleFor=e-o,t.timeLeft=0,t.timeLeftPer=100):(t.isIdle=!1,t.idleFor=e-o,t.timeLeft=o+s-e,t.timeLeftPer=(100-100*t.timeLeft/s).toFixed(2)),t},focus:function(e){return"function"==typeof e?this.on("focus",e):(h="active",n.fire(this,"focus"),n.fire(this,"wakeup"),n.fire(this,"statusChanged",{status:h})),this},blur:function(e){return"function"==typeof e?this.on("blur",e):(h="hidden",n.fire(this,"blur"),n.fire(this,"idle"),n.fire(this,"statusChanged",{status:h})),this},idle:function(e){return"function"==typeof e?this.on("idle",e):(h="idle",n.fire(this,"idle"),n.fire(this,"statusChanged",{status:h})),this},wakeup:function(e){return"function"==typeof e?this.on("wakeup",e):(h="active",n.fire(this,"wakeup"),n.fire(this,"statusChanged",{status:h})),this},on:function(e,t){return d(),n.add(this,e,t),this},off:function(e,t){return d(),n.remove(this,e,t),this},onEvery:function(e,t){var n,r;return d(),n=!1,t&&(r=setInterval(function(){if("active"===h&&n===!1)return t()},1e3*e)),{stop:function(){return clearInterval(r)},pause:function(){return n=!0},resume:function(){return n=!1},code:r,callback:t}},now:function(e){return d(),h===(e||"active")}}}();r.default=i},{}],25:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e){"@babel/helpers - typeof";return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return d(e)||c(e)||u(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function c(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e){if(Array.isArray(e))return l(e)}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var h=i(t("./Cookies.js"));!function(){function t(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r?this:e,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(r.prototype=this.prototype),i.prototype=new r,i}),e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),"function"!=typeof e.CustomEvent&&(t.prototype=e.Event.prototype,e.CustomEvent=t)}();var f={el:function e(t){var n=t.type,r=t.className,i=t.content,a=t.bg,o=t.bgColor,s=t.href,u=t.style,c=t.src,e=document.createElement(n);return c&&e.setAttribute("src",c),u&&this.extend(e.style,u),r&&e.setAttribute("class",r),a&&(e.style.backgroundImage='url("'.concat(a,'")')),o&&(e.style.backgroundColor=o),s&&(e.setAttribute("href",s),e.setAttribute("target","_blank")),i&&(e.textContent=i),e},getNodeDescription:function(e){if(!e)return null;var t=e.tagName;return e.id&&(t+="#".concat(e.id)),e.className&&e.className.length&&(t+=e.className.split(" ").join(".")),t},getQueryParams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getBrowserURL(),t=e.split("?")[1],n=t?t.split("&"):[];return n.reduce(function(e,t){var n=t.split("=");return e[n[0]]=n[1],e},{})},getSentimentType:function(e){if("number"!=typeof e)return null;var t="";return e>10?t="positive":10===e?t="neutral":e<10&&(t="negative"),t},log:function(){var e=["%cJS Tag","color: #fb1359; background: #ffcad4; padding: 4px"].concat(o(Array.prototype.slice.call(arguments)));console.log.apply(console,e)},isMobile:function(){return"ontouchstart"in e||navigator.msMaxTouchPoints||navigator.userAgent.indexOf("IEMobile")!==-1},isEmptyObject:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},isValidNumber:function(e){return"number"==typeof e&&!isNaN(e)},isValidTagId:function(e){var t=/^[A-F\d]{8}-[A-F\d]{4}-4[A-F\d]{3}-[89AB][A-F\d]{3}-[A-F\d]{12}$/i;return e&&"string"==typeof e&&e.length>0&&(t.test(e)||e.match(/^[0-9a-fA-F]{24}$/))},isTopFrame:function(){return e.top===e},inKnotchPage:function(){var e=["views/unit.html","assets.knotch.host","www.knotch-cdn.com","/survey/"];return e.reduce(function(e,t){return e||location.href.indexOf(t)!==-1},!1)},inDevTestPage:function(){var t=e.location.hostname.indexOf("knotch.test")!==-1,n="test"===e.Knotch.config.env||"development"===e.Knotch.config.env;if(t&&n)return!0},isDemo:function(){var e=f.getScriptFlag("demo"),t="true"===h.default.get("knotch_demo");return!(!e&&!t)},isDebug:function(){var e=!this.isTopFrame()&&document.referrer?document.referrer:this.getBrowserURL(),t=Object.keys(this.getQueryParams(e)),n=t.indexOf("knotch_debug");return n!==-1||f.getScriptFlag("debug")},isAnalysis:function(){var e=!this.isTopFrame()&&document.referrer?document.referrer:this.getBrowserURL(),t=Object.keys(this.getQueryParams(e)),n=t.indexOf("knotch_analysis");return n!==-1||f.getScriptFlag("analysis")},getAccountId:function(){return f.getScriptAttribute("data-account")},getScriptFlag:function(e){try{var t=document.querySelector('script[src*="knotch"]')||document.currentScript,n=""===t.getAttribute(e),r="true"===t.getAttribute(e)||"1"===t.getAttribute(e);return n||r}catch(e){return!1}},getScriptAttribute:function(e){try{var t,n=document.currentScript,r=document.querySelector('script[src*="knotch.js"]'),i=document.querySelector('script[src*="knotch.min.js"]');if(r)t=r;else if(i)t=i;else{if(!n)return Knotch.debug.reportError(new Error("script not found"));t=n}return t.getAttribute(e)}catch(e){return!1}},getRelativePath:function(){var e,t=this.getScriptAttribute("src");t.indexOf("knotch.js")>-1?e=t.indexOf("knotch.js"):t.indexOf("knotch.min.js")>-1?e=t.indexOf("knotch.min.js"):Knotch.bugsnag.reportError(new Error("knotch script not on page"));var n=t.slice(0,e);return n},getReferrer:function(){return f.isTopFrame()?document.querySelector("link[rel=canonical]")?document.querySelector("link[rel=canonical]").getAttribute("href"):e.location.origin+e.location.pathname:this.localData.referrer=document.referrer},validateURL:function(e){return/^((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/.test(e)},removeSearch:function(e){return e&&e.length>0&&e.indexOf("?")!==-1?e.split("?")[0]:e},getCanonicalURL:function(){var e=document.querySelector("meta[property='og:url']"),t=document.querySelector("link[rel=canonical]"),n=document.querySelector("meta[name='canonical']");if(t&&t.getAttribute("href")&&t.getAttribute("href").length>0){var r=t.getAttribute("href");if(this.validateURL(r))return r}if(e&&e.getAttribute("content")&&e.getAttribute("content").length>0){var i=e.getAttribute("content");if(this.validateURL(i))return i}if(n&&n.getAttribute("content")&&n.getAttribute("content").length>0){var a=n.getAttribute("content");if(this.validateURL(a))return a}return null},getBrowserURL:function(){var t=null;return document.URL?t=document.URL:e.location.href?t=e.location.href:e.location.host&&e.location.pathname&&(t="".concat(e.location.protocol,"//").concat(e.location.host).concat(e.location.pathname)),t?t:(e.Knotch.bugsnag.reportError(new Error("browser URL doesn't exist"),this.localData),null)},show:function(e){e&&(e.style.display="block")},hide:function(e){e&&(e.style.display="none")},hasClass:function(e,t){return!!e&&(e.classList&&e.classList.contains(t))},addClass:function(e,t){if(e)if(e instanceof NodeList||e instanceof HTMLCollection)for(var n=0,r=e.length;n<r;n++)this.hasClass(e[n],t)||e[n].classList.add(t);else e.classList.add(t)},removeClass:function(e,t){if(e)if(e instanceof NodeList||e instanceof HTMLCollection)for(var n=0,r=e.length;n<r;n++)this.hasClass(e[n],t)&&e[n].classList.remove(t);else e.classList.remove(t)},removeNode:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},has3dSupport:function(){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(null!==n.exec(t)){var r=parseFloat(RegExp.$1);return r>10}var i,a=document.createElement("p"),o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(a,null);for(var s in o)if(void 0!==a.style[s]){a.style[s]="translate3d(1px,1px,1px)";var u=e.getComputedStyle(a);i=u&&u.getPropertyValue(o[s])}return document.body.removeChild(a),i&&i.length>0&&"none"!==i},fadeIn:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;if(t){t.style.opacity=0,t.style.display="block";var r=+new Date,i=function i(){t.style.opacity=+t.style.opacity+(new Date-r)/n,r=+new Date,+t.style.opacity<1?e.requestAnimationFrame&&e.requestAnimationFrame(i)||setTimeout(i,16):t.style.opacity=1};i()}},fadeOut:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;if(t){t.style.opacity=1;var r=+new Date,i=function i(){t.style.opacity=+t.style.opacity-(new Date-r)/n,r=+new Date,+t.style.opacity>0?e.requestAnimationFrame&&e.requestAnimationFrame(i)||setTimeout(i,16):(t.style.opacity=0,t.style.display="none")};i()}},get:function(t,n,r,i){var a,o="undefined"!=typeof XMLHttpRequest.DONE?XMLHttpRequest.DONE:4;return a=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a.onerror=function(){return a.status>=500&&Knotch.bugsnag.reportError(new Error(a.responseText),{name:"".concat(a.status," request error"),data:n}),!1},a.onreadystatechange=function(){if(a.readyState===o)if(200===a.status){var e=a.responseText;if(e)try{var n=JSON.parse(e)}catch(n){Knotch.bugsnag.reportError(n,{name:"failed to parse request response",data:{responseText:e,url:t}})}r(n)}else a.status>=500&&i(a.status,a.statusText,a.readyState,a.responseText,a.getAllResponseHeaders())},a.open("GET",t,!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.send(JSON.stringify(n)),a},post:function(t,n,r,i){var a,o="undefined"!=typeof XMLHttpRequest.DONE?XMLHttpRequest.DONE:4;return a=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a.onloadend=function(){return a.status>=400&&Knotch.bugsnag.reportError(new Error(a.responseText),{name:"404 - not found",data:n}),!1},a.onerror=function(){return a.status>=500&&Knotch.bugsnag.reportError(new Error(a.responseText),{name:"".concat(a.status," request error"),data:n}),!1},a.onreadystatechange=function(){if(a.readyState===o){var e=a.responseText;if(e&&!e.match(/</))try{var n=JSON.parse(e)}catch(n){Knotch.bugsnag.reportError(n,{name:"failed to parse request response",data:{responseText:e,url:t}})}200===a.status?r(n):a.status>=400?i(a.status,a.statusText):0===a.stats&&i(a.status,a.statusText)}},a.open("POST",t,!0),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.send(JSON.stringify(n)),a},onEvent:function(e,t,n){function r(e,t){for(var r=0;r<t.length;r++)try{e.addEventListener?e.addEventListener(t[r],n,!1):e.attachEvent&&e.attachEvent("on".concat(t[r]),n)}catch(n){Knotch.bugsnag.reportError(n,{name:"Error while attaching event listener",data:{node:e,events:t}})}}if(t){var i=null;if(i=Array.isArray(e)&&e.length>0?e:[e],t instanceof NodeList||t instanceof HTMLCollection){t.length||(t=[t]);for(var a=0;a<t.length;a++)r(t[a],i)}else{var o=t instanceof Array?t[0]:t;r(o,i)}}},offEvent:function(t,n,r){var i=[t];if(t.split(" ").length>1&&(i=t.split(" ")),n)if(n!==e){n.length||(n=[n]);for(var a=n.length,o=0;o<a;o++)for(var s=0;s<i.length;s++)try{if(1===n.length,n[o].removeEventListener)return n[o].removeEventListener(i[s],r,!1),!0;if(n[o].detachEvent)return n[o].detachEvent("on".concat(i[s]),r)}catch(e){Knotch.bugsnag.reportError(e,{name:"Error while detaching event listener",data:{nodeList:n,events:i}})}}else try{for(var s=0;s<i.length;s++)e.top.removeEventListener?e.top.removeEventListener(i[s],r,!1):e.top.detachEvent&&e.top.detachEvent("on".concat(i[s]),r)}catch(e){Knotch.bugsnag.reportError(e,{name:"Error while detaching event listener",data:{nodeList:n,events:i}})}},trigger:function(t,n,r){var i=null;e.CustomEvent?i=new CustomEvent(n,r):(i=document.createEvent("CustomEvent"),i.initCustomEvent(n,!0,!0,r)),t.dispatchEvent(i)},parents:function(e,t){var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;for(e=e.parentElement;e&&!n.call(e,t);)e=e.parentElement;return e},animate:function(e,t,n,r){e.style.transition="all ".concat(n/1e3,"s ease-out"),Object.keys(t).forEach(function(n){e.style[n]=t[n]}),r&&setTimeout(function(){e.removeAttribute("style")},n)},ready:function t(n){var t=!1,r=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",i),e.removeEventListener("load",i)):(document.detachEvent("onreadystatechange",i),e.detachEvent("onload",i))},i=function(){t||!document.addEventListener&&"load"!==event.type&&"complete"!==document.readyState||(t=!0,r(),n())};if("complete"!==document.readyState&&"loaded"!==document.readyState||!document.body)if(document.addEventListener)document.addEventListener("DOMContentLoaded",i),e.addEventListener("load",i);else{document.attachEvent("onreadystatechange",i),e.attachEvent("onload",i);var a=!1;try{a=null==e.frameElement&&document.documentElement}catch(e){}a&&a.doScroll&&!function e(){if(!t){try{a.doScroll("left")}catch(t){return setTimeout(e,50)}t=!0,r(),n()}}()}else e.Knotch&&e.Knotch.bugsnag.pushBreadCrumb({name:"calling callback because one of the following is true ",metaData:{documentReadyStateComplete:"complete"===document.readyState,documentReadyStateLoaded:"loaded"===document.readyState,documentReadyStateInteractive:"interactive"===document.readyState,documentBody:document.body}}),n()},extend:function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&(e[n]=arguments[t][n]);return e},listen:function(e,t,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent(e,n)},scrollToY:function(t,n,r){function i(){o+=1/60;var n=o/s,c=u[r](n);n<1?(requestAnimFrame(i),e.scrollTo(0,a+(t-a)*c)):e.scrollTo(0,t)}var a=e.scrollY||document.documentElement.scrollTop,t=t||0,n=n||2e3,r=r||"easeOutSine",o=0,s=Math.max(.1,Math.min(Math.abs(a-t)/n,.8)),u={easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInOutQuint:function(e){return(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2)}};i()},isChildOf:function(e,t){for(;(e=e.parentNode)&&e!==t;);return!!e},serialize:function(e,t){var n,r=[];for(n in e)if(e.hasOwnProperty(n)){var i=t?"".concat(t,"[").concat(n,"]"):n,o=e[n];r.push(null!==o&&"object"===a(o)?this.serialize(o,i):"".concat(encodeURIComponent(i),"=").concat(encodeURIComponent(o)))}return r.join("&")},extractIdFromNode:function(e){if(!e)return null;var t=e.getAttribute("class");if(!t||t.length<1||"string"!=typeof t)return null;var n=t.split(" "),r=n.filter(function(e){return e.indexOf("knotch_")!==-1&&"knotch_placeholder"!==e})[0];if(!r)return null;var i=r.split("_")[1];return i?i:null},stringContains:function(e,t){return e&&e.length&&t&&t.length?e.indexOf(t)!==-1:null},debounce:function(e,t){var n;return function(){var r=this,i=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(r,i)},t)}},getLargestZIndex:function(t){var n,r=null,i=[];if(document.createTreeWalker){for(var a=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null,!1);n=a.nextNode();){var o=parseInt(e.getComputedStyle(n).zIndex,10);if(o&&o>-1){var s=parseInt(e.getComputedStyle(n).zIndex,10);i.push(s)}}if(0===i.length)return null;r=i.reduce(function(e,t){return Math.max(e,t)})}else for(var u=parent.children,c=0;c<u.length;c++){var d=parseInt(e.getComputedStyle(u[c]).zIndex,10);d>r&&(r=d+1)}return r},isStandalone:function(e){return!!e&&(f.isTopFrame()&&f.inKnotchPage()&&"inline"===e.layout&&null===e.videoType)},isValidSentimentValue:function(e){var t=parseInt(e,10);return"undefined"!=typeof e&&!Number.isNaN(t)&&[0,4,10,16,20].indexOf(t)!==-1}},p=f;r.default=p},{"./Cookies.js":21}],26:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=i(t("@knotchlabs/nodefinder")),c=i(t("../helpers/vanillaHelper.js")),d=t("./SmartUnitUtils.js"),l=function(){function t(e){var n=e.accountId,r=e.knotchConfig,i=e.bugsnag,o=e.debug;a(this,t),this.accountId=n,this.config=r,this.bugsnag=i,this.debug=o,this.smartUnitTracker=null,this.init()}return s(t,[{key:"init",value:function(){var t=this;c.default.ready(function(){e.localURLToUnitList?t.startNodefinder(e.localURLToUnitList):(0,d.getUnitList)(t.accountId,function(e){t.startNodefinder(e)})})}},{key:"startNodefinder",value:function(e){var t=this;this.smartUnitTracker=(0,u.default)({accountId:this.accountId,inject:d.inject,pageValidate:function(e,n){return(0,d.bypassSurveylessUnit)(e,n,t.bugsnag)},urlMap:e,bugsnag:this.bugsnag,debug:this.debug})}}]),t}(),h=l;r.default=h},{"../helpers/vanillaHelper.js":25,"./SmartUnitUtils.js":27,"@knotchlabs/nodefinder":17}],27:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.testInject=r.inject=r.getUnitList=r.bypassSurveylessUnit=void 0;var a=i(t("../helpers/vanillaHelper.js")),o=t("../../../tmp/config.js"),s=function(t){var n=t.pageNode,r=t.lastParagraphNode,i=t.urlMap,s=t.url,u=t.injectedCallback,c=t.unbindListeners,d=t.bugsnag,l=t.videoPlayer,h=t.knotchPlaceholder,f=a.default.removeSearch(s),p=i[s]||i[f];if(!p||!p.length)return c&&c(),d.pushBreadCrumb({name:"No placeholder ID found for this URL, URL is not linked.",unitsForPage:p});var v=p[0],m=function(e){if(null!==e.videoType){if(!l)return d.reportError(new Error("did not receive video player from nodefinder",{data:{url:s}}));l.setAttribute("data-knotch",v)}else{if(document.querySelector(".knotch_".concat(v))&&(d.pushBreadCrumb({name:"Unit already found on the page",unitsForPage:p}),n))return c();if(h&&h.className.indexOf("knotch_".concat(v))===-1)return h.className+=" knotch_".concat(v),h.setAttribute("style","clear: both;"),void d.pushBreadCrumb({name:"injecting unit into generic smartunit placeholder"});var t=document.createElement("div");if(t.setAttribute("class","knotch_".concat(v)),t.setAttribute("style","clear: both;"),!r)return c(),d.reportError(new Error("Last paragraph node could not be found"),{data:{url:s}});r.insertAdjacentElement("afterend",t),u(),c(),d.pushBreadCrumb({name:"Appended placeholder to page body",metaData:{tagName:r.tagName,class:r.className,id:r.id}})}};e.knotchData.units&&e.knotchData.units[v]?m(e.knotchData.units[v]):a.default.get("".concat(o.knotchConfig.metadata,"/").concat(v,".json"),{},function(t){e.knotchData.units[t.public_id]=t,m(t)})};r.inject=s;var u=function(e){var t=e.pageBodyNode,n=e.lastParagraphNode,r=e.injectedCallback,i=e.unbindListeners,a=e.knotchPlaceholder,o=document.createElement("div");if(o.setAttribute("class","knotch_unit"),o.setAttribute("style","clear: both; background-color: pink; height: 200px; text-align: center;"),o.innerText="KNOTCH SMART UNIT",a)document.querySelector(".knotch_unit")||(o.style.height=a.getAttribute("data-height"),o.style.width=a.getAttribute("data-width"),a.appendChild(o));else{if(!t)return alert("Page is not smart unit compatible");if(t.querySelector(".knotch_unit"))return t.querySelector(".knotch_unit")?(i(),alert("knotch unit already on page")):(i(),alert("page not compatible"));n.insertAdjacentElement("afterend",o),r(),i(),o.scrollIntoView(),alert("Succesfully appended smart unit to page body")}};r.testInject=u;var c=function(t,n){return t?e.urlMap?e.urlMap:(e.Knotch.bugsnag.pushBreadCrumb({name:"Fetching Unit to URL map"}),void a.default.get("https://units.knotch.it/url-map/".concat(t,".json"),null,function(t){return t&&!a.default.isEmptyObject(t)?n(t):e.Knotch.bugsnag.pushBreadCrumb({name:"Empty or invalid URL map provided",metaData:{data:t}})},function(n,r,i,a,o){e.Knotch.bugsnag.reportError(new Error("Failed to fetch unit list"),{data:{status:n,statusText:r,readyState:i,responseText:a,responseHeaders:o,accountId:t,url:"https://units.knotch.it/url-map/".concat(t,".json")}})})):e.Knotch.bugsnag.reportError(new Error("No account ID provided"),t)};r.getUnitList=c;var d=function(t,n,r){if(e.knotchData.units&&e.knotchData.units[t]){var i=e.knotchData.units[t];if(i&&i.surveyless){var s=document.createElement("div");return s.setAttribute("class","knotch_".concat(t)),document.body.appendChild(s),n(!1)}return n(!0)}a.default.get("".concat(o.knotchConfig.metadata,"/").concat(t,".json"),{},function(r){var i=r;if(e.knotchData.units[r.public_id]=r,i&&i.surveyless){var a=document.createElement("div");return a.setAttribute("class","knotch_".concat(t)),document.body.appendChild(a),n(!1)}return n(!0)},function(e,i,a,o,s){return r.reportError(i,{data:{id:t,readyState:a,responseText:o,responseHeaders:s,status:e},severity:"info"}),n(!1)})};r.bypassSurveylessUnit=d},{"../../../tmp/config.js":55,"../helpers/vanillaHelper.js":25}],28:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e){"@babel/helpers - typeof";return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=t("../../../tmp/config"),d=i(t("../helpers/vanillaHelper")),l=function(){function t(n){o(this,t),this.iframe=this.createFrame(n),this.ready=!1,this.inIframe=n.inIframe,this.units={},this.queue=[],e.Knotch.bugsnag.pushBreadCrumb({name:"Added reporter"})}return u(t,[{key:"createFrame",value:function(e){var t=e.debug,n=document.createElement("iframe"),r=c.knotchConfig.reporter;return t&&(r+="?debug=true"),d.default.extend(n,{name:"measurementKnotchReporter",title:"Knotch Reporter Frame",src:r,frameBorder:"0",display:"none",id:"measurementKnotchReporter",width:"0",height:"0",ariaHidden:!0}),n.style.display="none",d.default.ready(function(){return document.body.appendChild(n)}),n}},{key:"init",value:function(){this.ready=!0,this.flush()}},{key:"flush",value:function(){for(var e=this.queue.length,t=0;t<e;t++){var n=this.queue.pop();this.send(n)}}},{key:"getPagePayload",value:function(){var t={content_type:"web",browser_url:document.referrer,user_agent:e.navigator.userAgent,unit_type:"iframe",unit_version:c.knotchConfig.version};return this.inIframe||d.default.extend(t,this.getDynamicPagePayload()),t}},{key:"getDynamicPagePayload",value:function(){var e={unit_type:"jstag"};return d.default.extend(e,{browser_url:d.default.getBrowserURL(),canonical_url:d.default.getCanonicalURL(),referrer_url:document.referrer}),document.body&&d.default.extend(e,{content_height:document.body.scrollHeight,content_width:document.body.scrollWidth}),e}},{key:"initUnit",value:function(t){var n=t.config&&t.config.thirdPartyPixels,r={organization_id:t.organizationId,survey_language:t.languageCode,survey_type:null!==t.videoType?"video":"article",survey_variation:t.public_id,survey_id:t.public_id},i=this.getPagePayload(),a=d.default.extend({},i,r);this.send({eventType:"updateUnitData",data:a,surveyId:t.public_id,productType:"measurement"}),n&&n.length&&(e.Knotch.bugsnag.pushBreadCrumb({name:"Sending third party pixel to reporter",metaData:t}),this.send({eventType:"thirdPartyPixel",data:n,surveyId:t.public_id,productType:"measurement"}))}},{key:"send",value:function(t){if(!this.iframe||!this.iframe.contentWindow||!this.ready)return e.Knotch.bugsnag.pushBreadCrumb({name:"iframe not ready yet",event:t.eventType,payloadType:t.data.type}),this.queue.push(t);var n=a(this.iframe.contentWindow.postMessage);return"function"!==n?(e.Knotch.bugsnag.pushBreadCrumb({name:"postMessage should be a function"}),this.queue.push(t)):t.eventType?void this.iframe.contentWindow.postMessage(t,c.knotchConfig.reporter):e.Knotch.bugsnag.pushBreadCrumb({name:"payload must have an eventType"})}},{key:"sendUnitEvent",value:function(e){var t=e.data,n=e.surveyId,r=e.timer,i=this.inIframe?{}:this.getDynamicPagePayload(),a=d.default.extend({},i,t,{timer:r});this.send({eventType:"unitEvent",data:a,surveyId:n,productType:"measurement"})}}]),t}(),h=l;r.default=h},{"../../../tmp/config":55,"../helpers/vanillaHelper":25}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PLACEHOLDER_CHECK_OPTIONS=void 0;var r={startInterval:200,startExpIndex:1,countsToIncrease:10,maxTime:18e5,autoStart:!0};n.PLACEHOLDER_CHECK_OPTIONS=r},{}],30:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){this.isMobile=o.default.isMobile(),this.isVideo=null!==t.videoType,this.videoType=this.isVideo&&t.videoType,this.isInIframe=!o.default.isTopFrame(),this.inKnotchPage=o.default.inKnotchPage(),this.inDevTestPage=o.default.inDevTestPage(),this.inGenerator=o.default.getScriptFlag("generator"),this.isValid=!0,this.data=t,this.node=e,this.parentNode=e.parentNode,this.container=document.querySelector(".knotch_".concat(t.public_id)),this.iframeHandler=new s.default({title:"Feedback Question By Knotch",id:"knotchframe_".concat(t.public_id),src:"".concat(o.default.getRelativePath(),"unit.html?id=knotchframe_").concat(t.public_id)}),this.iframe=this.iframeHandler.DOM,this.setup(),this.trackRemoval()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(t("../../helpers/vanillaHelper.js")),s=i(t("../../helpers/IframeHandler.js")),u=i(t("../../helpers/Cookies.js")),c=t("../../../../tmp/config.js"),d={BRIGHTCOVE:0,YOUTUBE:1,VIMEO:2,OOYALA:3,NYLON:4,HTML5:5,JWPLAYER:7,VPAID:8,WISTIA:9,FAVE:10,SMPLAYER:11},l=[d.YOUTUBE,d.VIMEO,d.VPAID,d.BRIGHTCOVE],h={width:"100%",height:"100%",position:"absolute",top:0,left:0},f={borderRadius:"6px"},p="100%",v="320px";a.prototype={trackRemoval:function(){var t=this;if(e.MutationObserver){var n=new MutationObserver(function(n,r){n.forEach(function(n){var i=[].slice.call(n.removedNodes),a=i.indexOf(t.iframe)>-1,o=i.filter(function(e){return e.contains(t.iframe)}),s=o.length>0;a||!e.Knotch.units[t.data.public_id]?(r.disconnect(),e.Knotch.bugsnag.pushBreadCrumb({name:"Knotch Unit was removed"})):s&&(r.disconnect(),e.Knotch.bugsnag.pushBreadCrumb({name:"Knotch Unit Placeholder was removed"}),e.Knotch.bugsnag.pushBreadCrumb({name:"Reinjecting Knotch Unit Placeholder"}),t.parentNode.appendChild(o[0]),t.injectIframe())})});n.observe(this.container.parentNode,{subtree:!0,childList:!0})}},setup:function(){if(null!==this.node.querySelector("[id^=knotchframe_]"))return this.isValid=!1,e.Knotch.bugsnag.pushBreadCrumb({name:"A unit already exists"});o.default.onEvent("touchstart",this.iframe,function(e){return e.preventDefault()});var t=o.default.hasClass(this.node,"knotchArticleEmbed"),n=o.default.hasClass(this.node,"knotchVideoEmbed"),r=this.isVideo&&t||!this.isVideo&&n,i=l.indexOf(this.videoType)!==-1;if(this.inGenerator||this.isInIframe||i)e.Knotch.bugsnag.pushBreadCrumb({name:"Bypassing mismatch check ".concat(this.data.public_id)});else if(r)return this.isValid=!1,e.Knotch.bugsnag.pushBreadCrumb({name:"Mismatch between data & integration ".concat(this.data.public_id)});return this.isInIframe&&(this.inKnotchPage||this.inDevTestPage||this.inGenerator)?this.inKnotchIframe():this.inKnotchPage?this.onKnotchPage():this.onClientPage(),this.isValid?this.node.appendChild(this.iframe):e.Knotch.bugsnag.pushBreadCrumb({name:"Invalid unit integration: ".concat(this.data.public_id)})},getIframe:function(){return this.isValid?this.iframe:null},inKnotchIframe:function(){this.setLang(),this.isVideo&&!this.inGenerator&&this.createVidContainer(),o.default.extend(this.iframe.style,h);var e=document.querySelector(".centerContainer");e&&o.default.extend(e.style,{width:"100%",height:"100%",margin:0,top:0,left:0});var t=document.querySelector("#knotchFullPage > .overlay");document.getElementById("knotchFullPage").style.position="absolute",t&&o.default.removeNode(t)},injectIframe:function(){var t,n=document.querySelector(".knotch_".concat(this.data.public_id)),r=n.getAttribute("data-layout"),i=o.default.getQueryParams();try{t=JSON.stringify(this.data)}catch(t){return e.Knotch.bugsnag.reportError(t)}var a=e.knotchData.themes&&e.knotchData.themes[this.data.themeId],s={knotchedSentiment:u.default.get("knotched:".concat(this.data.public_id)),followedUp:u.default.get("followup:".concat(this.data.public_id)),isMobile:e.Knotch.isMobile,isDemo:e.Knotch.demo,survey:t,inGenerator:this.inGenerator,customLayout:JSON.stringify(r),knotchConfig:JSON.stringify(c.knotchConfig),standalone:o.default.isStandalone(this.data)};a&&(s.theme=JSON.stringify(a)),o.default.isTopFrame()&&o.default.inKnotchPage()&&i.ext_knotch_stm&&(s.externalKnotchSentiment=i.ext_knotch_stm);var d="";for(var l in s)d+="".concat("<script> window.").concat(l," = ").concat(s[l],"</scr")+"ipt>";var h=o.default.getRelativePath(),f="".concat(d).concat("<scri"+"pt src=".concat(h).concat(JSON.parse(s.knotchConfig).measurementUnit,">  </scri")+"pt>"),p=this.getIframeDoc();if(p){e.Knotch.bugsnag.pushBreadCrumb({name:"Injecting template in iframe  ".concat(this.data.public_id)});try{p.open(),p.writeln(f),p.close()}catch(t){e.Knotch.bugsnag.reportError(t)}}else e.Knotch.bugsnag.pushBreadCrumb({name:"Unable to find iFrame's document ".concat(this.data.public_id)})},setLang:function(){document.documentElement.setAttribute("lang",this.data.languageCode)},onKnotchPage:function(){this.setLang(),o.default.extend(this.iframe.style,h),this.isMobile?o.default.extend(this.container.style,h):"inline"!==this.data.layout&&o.default.extend(this.iframe.style,f),this.isVideo&&this.createVidContainer(),this.setupOwnedPageStyle(this.data)},onClientPage:function(){this.isVideo?this.onClientPageVideo():this.onClientPageArticle()},setupOwnedPageStyle:function(){var e=document.getElementById("knotchFullPage"),t=this.data;e&&t&&(t.imageUrl&&o.default.extend(e.style,{backgroundImage:"url(".concat(t.imageUrl,")")}),t.bgcolor&&(o.default.extend(e.style,{backgroundColor:t.bgcolor}),document.querySelector(".overlay").style.opacity="0.5"))},setThemeBackground:function(e){var t=e.global,n=t.bgColor,r=t.bgOverlay,i=t.bgImage,a=document.getElementById("knotchFullPage"),s=document.querySelector(".overlay"),u=this.data.imageUrl||this.data.bgcolor;a&&!u&&(i?(o.default.extend(a.style,{backgroundImage:"url(".concat(i,")")}),o.default.extend(s.style,{backgroundColor:r})):n&&(o.default.extend(a.style,{backgroundColor:n}),document.querySelector(".overlay").style.opacity="0"))},createVidContainer:function(){if(l.indexOf(this.videoType)!==-1){var e=document.createElement("div");e.id="knotchVideo",e.frameBorder="0",e.setAttribute("data-knotch",this.data.public_id),o.default.extend(this.container.style,h,{zIndex:-1,display:"none"}),o.default.extend(e.style,h,{zIndex:1}),this.node.parentNode.insertBefore(e,this.node)}},onClientPageArticle:function(){var e=p,t=v;this.node.hasAttribute("data-width")&&(e=this.node.getAttribute("data-width").match(/[\d\.]+(%|px)/g)),this.node.hasAttribute("data-height")&&(t=this.node.getAttribute("data-height").match(/[\d\.]+(%|px)/g)),o.default.extend(this.iframe.style,{width:e,height:t,margin:"18px auto",display:"block"})},onClientPageVideo:function(){var t=this,n=this.container.parentNode,r=document.querySelector('[data-knotch="'.concat(this.data.public_id,'"]'));if(this.videoType===d.BRIGHTCOVE&&(r=document.querySelector('video[data-knotch="'.concat(this.data.public_id,'"]'))||document.querySelector('[data-knotch="'.concat(this.data.public_id,'"]'))),!r)return void(this.isValid=!1);var i=e.getComputedStyle(n).position;"static"!==i&&""!==i||(n.style.position="relative");var a=r.offsetTop>-1?"".concat(r.offsetTop,"px"):0,s=r.offsetLeft>-1?"".concat(r.offsetLeft,"px"):0,u=e.getComputedStyle(r).transform||"none";o.default.extend(this.container.style,h,{zIndex:-1,display:"none"});var c=this.getUnitContainerSizing(r),l={top:a,left:s,height:"100%"},f=function(e){switch(e){case d.YOUTUBE:return{top:a,left:s,height:c.height,width:c.width,transform:u,maxWidth:c.maxWidth,maxHeight:c.maxHeight};default:return{top:a,left:s,maxWidth:c.maxWidth,maxHeight:c.maxHeight}}};o.default.extend(this.container.style,f(this.videoType)||l),o.default.extend(this.iframe.style,{height:"100%",width:"100%",maxWidth:c.width,maxHeight:c.height,margin:"auto",display:"none"}),o.default.onEvent("resize",e,o.default.debounce(function(){var e=t.getUnitContainerSizing(r),n={width:e.width,height:e.height,maxWidth:e.maxWidth,maxHeight:e.maxHeight};o.default.extend(t.container.style,n),o.default.extend(t.iframe.style,n)},500))},getUnitContainerSizing:function(e){var t={width:"100%",height:"100%"},n=getComputedStyle(e),r=n.width,i=n.height,a=e.getBoundingClientRect(),o=e.width,s=e.offsetWidth,u=e.height,c=e.offsetHeight;return r&&parseInt(r,10)>0?t.maxWidth=r:o?t.maxWidth="".concat(o,"px"):s>0?t.maxWidth="".concat(s,"px"):a.width&&(t.maxWidth="".concat(a.width,"px")),i&&parseInt(i,10)>0?t.maxHeight=i:u?t.maxHeight="".concat(u,"px"):c>0?t.maxHeight="".concat(c,"px"):a.height&&(t.maxHeight="".concat(a.height,"px")),t},getIframeDoc:function(){if(this.isValid)if(this.iframe&&this.iframe.nodeType===Node.ELEMENT_NODE)try{var t=this.iframe.document;if(this.iframe.contentDocument?t=this.iframe.contentDocument:this.iframe.contentWindow&&(t=this.iframe.contentWindow.document),t)return t;e.Knotch.bugsnag.pushBreadCrumb({name:"Invalid iframe document"})}catch(t){e.Knotch.bugsnag.reportError(t)}else e.Knotch.bugsnag.pushBreadCrumb({name:"Invalid node passed to getIframeDoc"});else e.Knotch.bugsnag.pushBreadCrumb({name:"Request iframe document from invalid unit"});return!1},fadeIn:function(){var e=this,t=this.node.parentElement,n=o.default.getLargestZIndex(t);n?this.container.style.zIndex=n:this.container.style.zIndex="auto",o.default.show(this.container),o.default.fadeIn(this.iframe,300),setTimeout(function(){e.iframe&&"function"==typeof e.iframe.focus&&e.iframe.focus()},400)},fadeOut:function(){var e=this;o.default.fadeOut(this.iframe,300),setTimeout(function(){e.container.style.zIndex=-1,o.default.hide(e.container)},300)},onIframeEvent:function(e,t){o.default.onEvent(e,this.iframe,t)}};var m=a;r.default=m},{"../../../../tmp/config.js":55,"../../helpers/Cookies.js":21,"../../helpers/IframeHandler.js":23,"../../helpers/vanillaHelper.js":25}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e){return!(!e.children||!e.children[0]||"SOURCE"!==e.children[0].tagName)},i=function(e){return!!(e.src&&e.src.length>0)},a=function(e){return"IFRAME"===e.tagName},o=function(e){return"VIDEO"===e.tagName},s=function(e){var t=e.querySelector("video"),n="VIDEO-JS"===e.tagName;return!!t&&(n&&(r(t)||i(t)))},u={brightcove:function(e){return s(e)||o(e)&&(r(e)||i(e))},FAVE:function(e){return e.className.indexOf("FavePlayer")!==-1},html5video:function(e){return o(e)&&(r(e)||i(e))},jwplayer:function(e){return e.className.indexOf("jwplayer")!==-1},kaltura:function(e){return a(e)&&e.id.indexOf("_ifp")!==-1},VPAID:function(e){return e.className.indexOf("knotchVpaid")!==-1},youtube:function(e){return a(e)&&i(e)},smplayer:function(e){return a(e)&&e.className.indexOf("sm-iframe")!==-1}},c=u;n.default=c},{}],32:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=i(t("../helpers/Bugsnag.js")),c=i(t("../helpers/vanillaHelper.js")),d=i(t("./tracker.js")),l=i(t("./dom/UnitDOMHandler.js")),h=i(t("./dom/VideoDOMChecks.js")),f=i(t("../helpers/Cookies.js")),p=i(t("../smartunits/SmartUnitTracker.js")),v=t("../../../tmp/config.js"),m=i(t("./timers/DecayInterval.js")),g=t("./constants.js"),y=i(t("./trackers/GAFrameTracker.js")),b=i(t("./trackers/TrackCurrentOnlyManager.js")),k={init:function(){k.analysis&&performance.mark("starting_tag_init"),k.config=v.knotchConfig,k.debug=c.default.isDebug(),k.bugsnag=new u.default(v.knotchConfig),k.units={},k.analysis=c.default.isAnalysis(),k.isMobile=c.default.isMobile(),k.inIframe=!c.default.isTopFrame(),k.inKnotchPage=c.default.inKnotchPage(),k.demo=c.default.isDemo(),e.knotchData.units||(e.knotchData={units:{}});var t={demo:k.demo,inIframe:k.inIframe,inKnotchPage:k.inKnotchPage},n=c.default.getAccountId();n&&(k.SmartUnitTracker=new p.default({accountId:n,knotchConfig:v.knotchConfig,bugsnag:k.bugsnag,debug:k.debug})),k.tracker=new d.default(t),k.decayInterval=new m.default(o({callback:k.checkPlaceholders},g.PLACEHOLDER_CHECK_OPTIONS)),k.analysis&&(performance.mark("ending_tag_init"),performance.measure("tag_init_method","starting_tag_init","ending_tag_init")),this.checkOptout()},addUnit:function(t){if(!c.default.isValidTagId(t))return void console.warn("[Knotch#addUnit] The Unit ID ".concat(t," is not valid"));if(k.units[t]||document.getElementById("knotchframe_55ed7ee027ba796e6ff35103"))return void console.warn("[Knotch#addUnit] Unit ".concat(t," already exists"));var n=document.querySelector('div[class*="knotch_'.concat(t,'"]')),r=document.querySelector('[data-knotch="'.concat(t,'"]'));if(n)n.removeAttribute("knotch-ignore");else{if(!r)return void console.warn("[Knotch#addUnit] No placeholders found for id ".concat(t));r.removeAttribute("knotch-ignore")}e.Knotch.bugsnag.pushBreadCrumb({name:"[public API] Adding Unit",metaData:{id:t}}),k.checkPlaceholders()},enableUnit:function(t){if(!c.default.isValidTagId(t))return void console.warn("[Knotch#enableUnit] The Unit ID ".concat(t," is not valid"));var n=document.querySelector('div[class*="knotch_'.concat(t,'"]'));return n?(k.units[t]||console.warn("[Knotch#enableUnit] Unit ".concat(t," does not exist")),n.removeAttribute("hidden"),e.Knotch.bugsnag.pushBreadCrumb({name:"[public API] Enabling Unit",metaData:{id:t}}),k.units[t].disabled=!1,void k.tracker.enableUnit(t)):void console.warn("[Knotch#enableUnit] There is no placeholder with the id ".concat(t))},disableUnit:function(t){if(!c.default.isValidTagId(t))return void console.warn("[Knotch#disableUnit] The Unit ID ".concat(t," is not valid"));k.units[t]||console.warn("[Knotch#disableUnit] Unit ".concat(t," does not exist"));var n=document.querySelector('div[class*="knotch_'.concat(t,'"]'));return n?(n.setAttribute("hidden",!0),e.Knotch.bugsnag.pushBreadCrumb({name:"[public API] Disabling Unit",metaData:{id:t}}),k.units[t].disabled=!0,void k.tracker.disableUnit(t)):void console.warn("[Knotch#disableUnit] There is no placeholder with the id ".concat(t))},removeUnit:function(t){if(!c.default.isValidTagId(t))return void console.warn("[Knotch#removeUnit] The Unit ID ".concat(t," is not valid"));if(!k.units[t])return k.bugsnag.pushBreadCrumb({name:"unit does not exist"}),void console.warn("[Knotch#removeUnit] Unit does not exist or has already been removed");var n=document.querySelector('div[class*="knotch_'.concat(t,'"]'));if(!n)return void console.warn("[Knotch#removeUnit] There is no placeholder with the id ".concat(t));if(e.Knotch.bugsnag.pushBreadCrumb({name:"[public API] Removing Unit",metaData:{id:t}}),n.setAttribute("knotch-ignore",!0),c.default.hasClass(n,"knotchArticleEmbed")){var r=document.getElementById("knotchframe_".concat(t));if(!r)return void console.warn("[Knotch#removeUnit] No unit frame detected for ".concat(t));c.default.removeClass(n,"knotchArticleEmbed"),c.default.removeNode(r),delete k.units[t]}if(c.default.hasClass(n,"knotchVideoEmbed")){var i=document.querySelector('[data-knotch="'.concat(t,'"]'));if(!i)return void console.warn("[Knotch#removeUnit] No video player found with data-knotch = ".concat(t));i.setAttribute("knotch-ignore",!0),c.default.removeNode(n),delete k.units[t]}k.tracker.removeUnit(t)},setFocus:function(t){return c.default.isValidTagId(t)?(e.Knotch.bugsnag.pushBreadCrumb({name:"[Knotch#setFocus] Setting focus to unit ".concat(t),metaData:{id:t}}),Object.keys(k.units).map(function(e){e!==t&&k.removeUnit(e)}),void k.addUnit(t)):void console.warn("[Knotch#setFocus] The Unit ID ".concat(t," is not valid"))},checkPlaceholders:function(){k.analysis&&performance.mark("starting_checkplaceholders");for(var t=document.querySelectorAll('div[class*="knotch_"]'),n=document.querySelectorAll("[data-knotch]"),r=0;r<t.length;r++)if(!t[r].hasAttribute("knotch-ignore")&&!c.default.hasClass(t[r],"knotchArticleEmbed")){var i=c.default.extractIdFromNode(t[r]);if(i||e.Knotch.bugsnag.pushBreadCrumb({name:"id was not properly extracted"}),c.default.isValidTagId(i)&&!k.units[i]){e.Knotch.bugsnag.pushBreadCrumb({name:"fetching unit data"}),k.units[i]={},c.default.addClass(t[r],"knotchArticleEmbed");var a=t[r].getAttribute("data-track-current-only");a&&(k.trackCurrentOnly||(k.trackCurrentOnly=new b.default({knotch:k})),k.trackCurrentOnly.addUnit(i)),k.fetchData(i)}}for(var o=0;o<n.length;o++){var s=n[o];if(!s.hasAttribute("knotch-ignore")&&!c.default.hasClass(t[o],"knotchVideoEmbed")&&("DIV"!==s.tagName&&"VIDEO-JS"!==s.tagName||!(s.className.indexOf("video-js")>-1||s.className.indexOf("vjs")>-1))){var u=s.getAttribute("data-knotch");if(c.default.isValidTagId(u)&&!k.units[u]){var d=!1;for(var l in h.default)d=d||h.default[l](s);if(!d)return k.bugsnag.pushBreadCrumb({name:"the data-knotch attribute is on an unsupported node"});k.units[u]={};var f=document.createElement("div");f.className="knotch_".concat(u," knotchVideoEmbed");var p=document.querySelector('[data-knotch-video-container="'.concat(u,'"]'));p?p.appendChild(f):n[o].parentNode.insertBefore(f,n[o].nextSibling),k.fetchData(u)}}}k.analysis&&(performance.mark("ending_checkplaceholders"),performance.measure("checkplaceholders_method","starting_checkplaceholders","ending_checkplaceholders"))},fetchData:function(t){k.analysis&&performance.mark("starting_fetchData"),e.knotchData.units&&e.knotchData.units[t]?k.fillIframe(e.knotchData.units[t]):e.knotchUnits&&e.knotchUnits[t]?k.fillIframe(e.knotchUnits[t]):c.default.get("".concat(v.knotchConfig.metadata,"/").concat(t,".json"),{},function(e){k.fillIframe(e),k.analysis&&(performance.mark("ending_fetchData"),performance.measure("fetchData_method","starting_fetchData","ending_fetchData"))},function(e,n,r,i,a){return k.bugsnag.reportError(n,{data:{id:t,readyState:r,responseText:i,responseHeaders:a,status:e},severity:"info"})})},fillIframe:function(t){if(t){try{JSON.stringify(t)}catch(e){return k.bugsnag.reportError(e)}if(k.analysis&&performance.mark("starting_fillIframe"),!k.units[t.public_id]||!k.units[t.public_id].data){k.units[t.public_id].data=t,e.knotchData.units[t.public_id]=t,k.bugsnag.pushBreadCrumb({name:"Valid Unit Data returned ".concat(t.public_id)});var n=document.querySelector(".knotch_".concat(t.public_id));if(!n)return k.bugsnag.pushBreadCrumb({name:"No available placeholder for unit setup ".concat(t.public_id)});if(t.surveyless)k.bugsnag.pushBreadCrumb({name:"Adding surveyless unit"}),k.units[t.public_id].isVisible=!1;else{var r=new l.default(n,t);if(k.units[t.public_id].DOMHandler=r,k.units[t.public_id].isVisible=!0,!r.isValid)return k.bugsnag.pushBreadCrumb({name:"No iframe created ".concat(t.public_id)});var i=f.default.get("knotched:".concat(t.public_id)),a="string"==typeof i?parseInt(i,10):null;r.iframeHandler.sendMessage({eventType:"globalVars",data:{knotchedSentiment:a,followedUp:f.default.get("followup:".concat(t.public_id)),isMobile:k.isMobile,isDemo:k.demo,survey:t,customLayout:n.getAttribute("data-layout"),knotchConfig:v.knotchConfig}})}if(k.tracker.addUnit(t),k.analysis){performance.mark("ending_fillIframe"),performance.measure("fillIframe_method","starting_fillIframe","ending_fillIframe");var o=performance.getEntriesByType("measure");o.forEach(function(e){console.log("[ttfe_measure] ".concat(e.name,": ").concat(e.duration))})}}}},setDemo:function(t){if("boolean"!=typeof t)return console.warn("[Knotch#setDemo] Please pass in a boolean value (true/false)");t&&k.demo===!0&&e.Knotch.bugsnag.pushBreadCrumb({name:"already in demo mode"}),e.Knotch.bugsnag.pushBreadCrumb({name:"setting demo mode"});var n=t===!0?"true":"false";f.default.set("knotch_demo",n),k.demo=t,k.tracker.demo=t,k.bugsnag.demo=t},checkOptout:function(){"0"===f.default.get("knotch_optout")&&this.setOptout(!0)},setOptout:function(t){return"boolean"!=typeof t?console.warn("[Knotch#setOptout] Please pass in a boolean value (true/false)"):(this.optoutGaFrame=new y.default({knotchId:"optout",optedOut:t,accountId:c.default.getAccountId()}),void(t?(e.Knotch.bugsnag.pushBreadCrumb({name:"[public API] Opted out!"}),f.default.set("knotch_optout",1,31536e3)):(e.Knotch.bugsnag.pushBreadCrumb({name:"[public API] Opted in!"}),f.default.delete("knotch_optout"))))}};e.Knotch||(e.Knotch=k,e.knotchData||(e.knotchData={units:{},themes:{}}),k.init())},{"../../../tmp/config.js":55,"../helpers/Bugsnag.js":20,"../helpers/Cookies.js":21,"../helpers/vanillaHelper.js":25,"../smartunits/SmartUnitTracker.js":26,"./constants.js":29,"./dom/UnitDOMHandler.js":30,"./dom/VideoDOMChecks.js":31,"./timers/DecayInterval.js":33,"./tracker.js":37,"./trackers/GAFrameTracker.js":38,"./trackers/TrackCurrentOnlyManager.js":41}],33:[function(t,n,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=function(e){return 100*Math.pow(2,e)},u=function(){function t(e){var n=this,r=e.callback,a=e.startInterval,o=e.startExpIndex,u=e.countsToIncrease,c=e.newIntervalCalc,d=e.maxTime,l=e.autoStart;i(this,t),this.callback=r,this.interval=a,this.expIndex=o,this.newIntervalCalc=c||s,this.countsToIncrease=u,this.maxTime=d,this.count=0,this.timer=null,this.autoStart=l,this.autoStart&&setTimeout(function(){return n.startInterval()},0),setTimeout(function(){return n.stopInterval()},this.maxTime)}return o(t,[{key:"getNewInterval",value:function(){this.count++,this.count%this.countsToIncrease===0&&(e.Knotch.bugsnag.pushBreadCrumb({name:"incremented decay timer index"}),this.expIndex++),this.interval=this.newIntervalCalc(this.expIndex)}},{key:"startInterval",value:function(){this.getNewInterval(),this.callback(),this.nextInterval()}},{key:"stopInterval",value:function(){e.Knotch.bugsnag.pushBreadCrumb({name:"stopping decay timer"}),clearTimeout(this.timer)}},{key:"nextInterval",value:function(){clearTimeout(this.timer),this.timer=e.setTimeout(this.startInterval.bind(this),this.interval)}}]),t}(),c=u;r.default=c},{}],34:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.startStopTimes={},this.options=t,this.event=e,this.events={},this.debug=!1,this.disabled=!1,this.mobile=o.default.isMobile(),this.mobile&&this.mobileListeners()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(t("../../helpers/vanillaHelper.js")),s=i(t("../../helpers/ifvisible.js"));a.prototype={init:function(){var t=this;try{this.setIdleDurationInSeconds(9999);var n=function(){return t.startTimer()},r=function(){return t.stopTimer()};"time_playing_video"!==this.event&&(s.default.on("blur",r),s.default.on("focus",n),s.default.on("idle",r),s.default.on("wakeup",n))}catch(t){e.Knotch.bugsnag.reportError(t)}},startTimer:function(){function t(){return!(!e.performance||!e.performance.timing)}if(!this.disabled)if(void 0===this.startStopTimes[this.event])this.startStopTimes[this.event]=[];else{var n=this.startStopTimes[this.event],r=n[n.length-1];if(void 0!==r&&void 0===r.stopTime)return}var i=(new Date).getTime();t()&&"time_on_page"===this.event&&(i=e.performance.timing.navigationStart),this.startStopTimes[this.event].push({startTime:i,stopTime:void 0}),this.trigger("start")},stopTimer:function(){var e=this.startStopTimes[this.event];void 0!==e&&0!==e.length&&(void 0===e[e.length-1].stopTime&&(e[e.length-1].stopTime=(new Date).getTime()),this.trigger("stop"))},isStarted:function(){var e=this.startStopTimes[this.event];return"undefined"!=typeof e&&void 0===e[e.length-1].stopTime},resetRecordedPageTime:function(e){this.startStopTimes[e]=[]},resetAllRecordedPageTimes:function(){for(var e=Object.keys(this.startStopTimes),t=0;t<e.length;t++)this.resetRecordedPageTime(e[t])},setIdleDurationInSeconds:function(e){var t=parseFloat(e);if(isNaN(t)!==!1)throw new Error("An invalid duration time (".concat(e,") was provided."));s.default.setIdleDuration(t)},getTimeOnCurrentPage:function(){var t=this.startStopTimes[this.event];if(void 0===t)return void e.Knotch.bugsnag.pushBreadCrumb({name:"timer not started yet",metaData:{startStopTimes:this.startStopTimes,event:this.event}});for(var n=t[0].startTime,r=t[t.length-1].stopTime,i=0,a=0;a<t.length;a++){var o=t[a].startTime,s=t[a].stopTime;void 0===s&&(a<t.length-1&&e.Knotch.bugsnag.pushBreadCrumb({name:"setting stop time at interval ".concat(a+1,"/").concat(t.length," to current time: ").concat((new Date).getTime())}),s=(new Date).getTime(),r=s);var u=s-o;u<0&&e.Knotch.bugsnag.pushBreadCrumb({name:"negative time difference start",metaData:{startTime:o,stopTime:s,array:JSON.stringify(t)}});var c=parseInt(i,10)+parseInt(u,10);if(c>this.options.maxTime){this.disabled=!0,this.stopTimer(),this.clearBindings();break}i=c}return{startTime:n,endTime:r,timeSpent:i}},on:function(e,t){var n=this.events[e]||[];n.push(t),this.events[e]=n},clearBindings:function(){this.events[this.event]=[]},off:function(t,n){var r=this.events[t];return r?void(this.events[t]=r.filter(function(e){return e.name!==n.name})):e.Knotch.bugsnag.reportError(new Error("Event trying to be removed is not present"),{data:{events:this.events,event:t}})},trigger:function(e,t){var n=this.events[e];!n||n.length<1||[].forEach.call(n,function(e){e(t)})},mobileListeners:function(){var t=this;try{var n,r;if("undefined"!=typeof document.hidden)n="hidden",r="visibilitychange";else if("undefined"!=typeof document.mozHidden)n="mozHidden",r="mozvisibilitychange";else if("undefined"!=typeof document.msHidden)n="msHidden",r="msvisibilitychange";else{if("undefined"==typeof document.webkitHidden)return;n="webkitHidden",r="webkitvisibilitychange"}"undefined"==typeof document.addEventListener?(e.Knotch.bugsnag.reportError(new Error("addEventListener not supported")),this.stopTimer(),this.disabled=!0):document.addEventListener(r,function(){document[n]?t.stopTimer():t.startTimer()},!1)}catch(t){e.Knotch.bugsnag.reportError(t,{name:"Error in attaching mobile page visibility changes"})}}};var u=a;r.default=u},{"../../helpers/ifvisible.js":24,"../../helpers/vanillaHelper.js":25}],35:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(t){var n=t.timer,r=t.event,i=t.tracker,a=t.id,o=t.logOptions,s=t.autoStart;this.logOptions=o||{},this.id=a,this.timer=n,this.tracker=i,this.interval=1e3,this.autoStart=s,this.count=0,this.event=r,this.started=!1,this.url="/log/".concat(this.event),r||e.Knotch.bugsnag.reportError(new Error("Event Type required for Logging Timer.")),this.init()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=i(t("../../helpers/vanillaHelper.js")),d=i(t("./DecayInterval.js"));u.prototype={init:function(){var t=this;e.Knotch.bugsnag.pushBreadCrumb({name:"initializing TimerLogger"}),this.autoStart&&(e.Knotch.bugsnag.pushBreadCrumb({name:"autostart, starting timer"}),this.startTimer());try{this.decayInterval=new d.default({callback:this._poll.bind(this),startInterval:this.interval,startExpIndex:this.logOptions.startExpIndex,countsToIncrease:this.logOptions.countsToIncrease,newIntervalCalc:function(e){return 1e3*(Math.pow(2,e)-1)},maxTime:this.logOptions.maxTime,autoStart:this.autoStart}),this.timer.on("start",function(){return t.decayInterval.startInterval()}),this.timer.on("stop",function(){return t.decayInterval.stopInterval()}),c.default.onEvent("click",document.getElementById("killtop"),function(){t.timer.disabled=!0,t.stopTimer()})}catch(t){e.Knotch.bugsnag.reportError(t)}},startTimer:function(){e.Knotch.bugsnag.pushBreadCrumb({name:"".concat(this.event," timer started")}),this.started=!0,this.timer.startTimer()},stopTimer:function(){e.Knotch.bugsnag.pushBreadCrumb({name:"".concat(this.event," timer stopped")}),this.started=!1,this._logDataSync()},endTimer:function(){this.timer.disabled=!0,this.timer.stopTimer()},resetRecordedPageTime:function(e){this.startStopTimes[e]=[]},getTimeOnCurrentPage:function(){return this.timer.getTimeOnCurrentPage()},setMaxDuration:function(e){this.logOptions.maxTime=e},_poll:function(){var t=this.getTimeOnCurrentPage();if(!this.tracker.demo&&!this.timer.disabled&&t){var n=this.logOptions.maxTime,r=t.timeSpent>n,i={type:this.event,survey_id:this.id};if("time_playing_video"===this.event&&(i.video_seconds_watched=t.timeSpent),t.timeSpent<0||t.end<t.begin){this.decayInterval.stopInterval();var a=o(o({},this.data),{},{count:this.count});e.Knotch.bugsnag.reportError(new Error("Negative time difference, killing"),{data:a}),this.endTimer(),this.removeListeners()}else r?this.decayInterval?this.decayInterval.stopInterval():e.Knotch.bugsnag.reportError(new Error("DecayInterval does not exist yet"),{data:{timeData:t,maxTime:n,overTime:r}}):this.pollRequest=this.tracker.record(i)}},_logDataSync:function(){this.timer.stopTimer(),this.pollRequest&&this.pollRequest.abort(),this._poll()},errorHandler:function(t,n,r){this.decayInterval.stopInterval(),e.Knotch.bugsnag.reportError(r,{data:t})},removeListeners:function(){var e=this;this.timer.off("start",function(){return e.decayInterval.startInterval()}),this.timer.off("stop",function(){return e.decayInterval.stopInterval()})}};var l=u;r.default=l},{"../../helpers/vanillaHelper.js":25,"./DecayInterval.js":33}],36:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.THROTTLED_TIME_ON_PAGE_IDS=n.LOG_OPTIONS_TIME_PLAYING_VIDEO=n.LOG_OPTIONS_TIME_ON_PAGE_THROTTLED=n.LOG_OPTIONS_TIME_ON_PAGE=void 0;var r={countsToIncrease:16,startExpIndex:3,maxTime:36e5};n.LOG_OPTIONS_TIME_ON_PAGE=r;var i={countsToIncrease:16,startExpIndex:4,maxTime:3e5};n.LOG_OPTIONS_TIME_ON_PAGE_THROTTLED=i;var a={countsToIncrease:16,startExpIndex:3,maxTime:72e5};n.LOG_OPTIONS_TIME_PLAYING_VIDEO=a;var o=["518afb38-d89b-4aa0-9b73-31ad26d491a6"];n.THROTTLED_TIME_ON_PAGE_IDS=o},{}],37:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){this.demo=e.demo,this.inIframe=e.inIframe,this.inKnotchPage=e.inKnotchPage,this.inAdIframe=this.isInAdIframe(),this.inGenerator=c.default.getScriptFlag("generator"),this.mobile=c.default.hasClass(document.body,"mobile"),this.debug=c.default.isDebug(),this.analysis=c.default.isAnalysis(),this.units={},this.queue=[],this.init()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=i(t("../helpers/vanillaHelper")),d=i(t("./timers/TimerLogger")),l=i(t("./timers/SophistiTimer")),h=i(t("./ReporterHandler")),f=i(t("../helpers/Cookies")),p=i(t("./trackers/ViewabilityTracker")),v=i(t("./trackers/VideoTracker.js")),m=i(t("./trackers/ScrolledPastTracker")),g=i(t("./trackers/ScrollDepthManager")),y=t("./timers/constants.js"),b=i(t("./trackers/GAFrameTracker")),k=7e3;u.prototype={isInAdIframe:function(){var e=c.default.getBrowserURL();if(e){var t=/^(http|https):\/\/tpc\.googlesyndication/gm;return this.inIframe&&t.test(e)}return!1},init:function(){this.demo||(this.reporter=new h.default({inIframe:this.inIframe,debug:this.debug}),this.timeOnPageTimer=new l.default("time_on_page",y.LOG_OPTIONS_TIME_ON_PAGE),this.timeOnPageTimer.init(),this.timeOnPageTimer.startTimer(),this.viewability=new p.default(this),this.inIframe||this.inKnotchPage||(this.scrollDepth=new g.default({tracker:this})),c.default.listen("message",e,this.handleEvents.bind(this)))},handleEvents:function(e){var t=e.data,n=t.data,r=t.eventType,i=t.id;switch(r){case"hideIframe":this.hideIframe(i);break;case"knotchEvent":this.record(n);break;case"knotchHandshake":this.reporter.init();break;case"knotchThemeLoaded":this.updateWithTheme(e.data);break;case"updateUnitData":this.connectKTag(e.data)}},connectKTag:function(t){var n=t.data;if(n&&e.ktag&&n.survey_id&&n.render_id){var r={msmt_survey_id:n.survey_id,msmt_render_id:n.render_id};n.visitor_id&&(r.msmt_visitor_id=n.visitor_id),e.ktag.setDataLayer(r)}},updateWithTheme:function(t){var n=t.id,r=t.theme;n&&r&&e.Knotch.units[n].DOMHandler.setThemeBackground(r)},thirdPartyEvent:function(t){if(!t||!t.name)return e.Knotch.bugsnag.reportError(new Error("Invalid third party event data"),t);e.Knotch.bugsnag.pushBreadCrumb({name:"Third party event sent: ".concat(t.name)});var n=o({type:"knotch_thirdparty"},t);e.parent.postMessage(n,"*")},initTimeOnPage:function(t){var n=this.units[t],r=n.data,i=r.videoType,a=r.organizationId,o=8===i;if(!n.logTimeOnPage&&!o){var s=y.THROTTLED_TIME_ON_PAGE_IDS.indexOf(a)!==-1,u=this.inAdIframe||s?y.LOG_OPTIONS_TIME_ON_PAGE_THROTTLED:y.LOG_OPTIONS_TIME_ON_PAGE;e.Knotch.bugsnag.pushBreadCrumb({name:"adding time on page timer ".concat(this.inAdIframe?"ad unit":""),metaData:{maxTime:u.maxTime}}),n.logTimeOnPage=new d.default({logOptions:u,timer:this.timeOnPageTimer,event:"time_on_page",tracker:this,id:t,autoStart:!0})}},hideIframe:function(t){var n=e.Knotch.units[t];n.isVisible?n.DOMHandler.fadeOut():e.Knotch.bugsnag.pushBreadCrumb({name:"invisible unit so nothing to fade out",type:"ui"});var r=this.units[t].videoTracker;this.thirdPartyEvent({knotchId:t,name:"unit_hidden"}),void 0!==r&&"function"==typeof r.handler.dismiss&&r.handler.dismiss()},record:function(t){var n=e.Knotch.trackCurrentOnly;if(!t)return e.Knotch.bugsnag.reportError(new Error("missing data object"));var r=t.survey_id;if(!this.demo&&!this.units[r].disabled){if(n&&n.initialUrlMap[r]&&!n.shouldSendEvent(r))return e.Knotch.bugsnag.pushBreadCrumb({name:"TrackCurrentOnly: URL DOES NOT MATCH, we should NOT send event for ".concat(r)});var i=this.timeOnPageTimer.getTimeOnCurrentPage().timeSpent,a=t.type;this.reporter.sendUnitEvent({data:t,surveyId:r,timer:i}),"survey_response"===a?this.unitResponse(t):"click_through_response"===a?this.units[r].GAFrameTracker.postRBTGA(t):"followup_response"===a&&f.default.set("followup:".concat(r),t.answer_index,604800)}},unitResponse:function(t){var n=this,r=t.survey_id;void 0!==this.units[r].videoTracker&&e.setTimeout(function(){n.hideIframe(r),n.thirdPartyEvent({knotchId:r,name:"unit_hidden"})},k),this.setKnotchedCookie(t),this.units[r].GAFrameTracker.postGA(t),this.thirdPartyEvent({knotchId:r,name:"unit_response"})},setKnotchedCookie:function(t){var n="knotched:".concat(t.survey_id),r=f.default.get("optout"),i=f.default.get(n);e.Knotch.bugsnag.pushBreadCrumb({name:"Setting knotched cookie",metaData:t}),i&&!Number.isNaN(i)||r||f.default.set(n,t.sentiment,604800)},addUnit:function(t){var n=this;this.analysis&&performance.mark("starting_tracker_addunit");var r=t.public_id;this.units[r]={data:t},e.Knotch.bugsnag.pushBreadCrumb({name:"Adding unit to the Tracker",metaData:{id:r}}),this.demo||(this.initTimeOnPage(r),this.reporter.initUnit(t),this.units[r].GAFrameTracker=new b.default({knotchId:r,debug:this.debug,accountId:t.organizationId}),this.record({type:"content_view",survey_id:r}),t.surveyless||this.viewability.addUnit(r),this.inIframe||this.inKnotchPage||this.scrollDepth.addUnit(r),this.inAdIframe&&(this.scrolledPastTracker=new m.default(function(){return n.disableUnit(r)}))),null===t.videoType||this.inGenerator||(this.units[r].videoTracker=new v.default(t,this),this.units[r].isVideo=!0),this.analysis&&(performance.mark("ending_tracker_addunit"),performance.measure("tracker_addunit_method","starting_tracker_addunit","ending_tracker_addunit"))},removeUnit:function(t){var n=this.units[t];n&&(e.Knotch.bugsnag.pushBreadCrumb({name:"Removing unit from tracker",metaData:{id:t}}),n.isVideo&&(this.units[t].videoTracker.disabled=!0),this.units[t].GAFrameTracker.remove(),delete this.units[t],n.logTimeOnPage&&(n.logTimeOnPage.decayInterval.stopInterval(),n.logTimeOnPage.removeListeners()),this.scrollDepth&&this.scrollDepth.removeUnit(t),this.scrolledPastTracker&&(this.scrolledPastTracker=null),this.viewability&&this.viewability.removeUnit(t))},enableUnit:function(t){var n=this.units[t];n&&n.disabled&&(e.Knotch.bugsnag.pushBreadCrumb({name:"Enabling unit in tracker",metaData:{id:t}}),n.disabled=!1,n.logTimeOnPage&&n.logTimeOnPage.decayInterval.startInterval(),n.isVideo&&(this.units[t].videoTracker.disabled=!1))},disableUnit:function(t){var n=this.units[t];n&&(n.isVideo&&(this.units[t].videoTracker.disabled=!0),n.disabled||(e.Knotch.bugsnag.pushBreadCrumb({name:"Disabling unit in tracker",metaData:{id:t}}),n.disabled=!0,n.logTimeOnPage&&n.logTimeOnPage.decayInterval.stopInterval()))}};var T=u;r.default=T},{"../helpers/Cookies":21,"../helpers/vanillaHelper":25,"./ReporterHandler":28,"./timers/SophistiTimer":34,"./timers/TimerLogger":35,"./timers/constants.js":36,"./trackers/GAFrameTracker":38,"./trackers/ScrollDepthManager":39,"./trackers/ScrolledPastTracker":40,"./trackers/VideoTracker.js":42,"./trackers/ViewabilityTracker":43}],38:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=t("../../../../tmp/config"),c=i(t("../../helpers/vanillaHelper")),d=function(){function t(e){a(this,t),this.iframe=this.setupIFrame(e),this.analysis=c.default.isAnalysis()}return s(t,[{key:"setupIFrame",value:function(t){var n=t.knotchId,r=t.debug,i=t.accountId,a=t.optedOut;this.analysis&&performance.mark("starting_gaframe_setupIframe");var o=document.createElement("iframe");return o.name="GAFrame_".concat(n),
o.title="Knotch Analytics Frame",o.setAttribute("aria-hidden","true"),o.style.width="0",o.style.height="0",o.style.display="none",o.id="GAFrame_".concat(n),o.frameBorder="0",o.src="".concat(u.knotchConfig.gaframe,"?id=").concat(n,"&product_type=measurement&account_id=").concat(i),r&&(o.src+="&debug=true"),"undefined"!=typeof a&&(o.src+="&optout=".concat(a?1:0)),c.default.ready(function(){document.body.appendChild(o)}),e.Knotch.bugsnag.pushBreadCrumb({name:"Added GAFrame",metaData:{id:n}}),this.analysis&&(performance.mark("ending_gaframe_setupIframe"),performance.measure("gaframe_setupIframe_method","starting_gaframe_setupIframe","ending_gaframe_setupIframe")),o}},{key:"postGA",value:function(t){if(t.eventType="response",e.Knotch.bugsnag.pushBreadCrumb({name:"posting knotch response to GAFrame",metaData:t}),!t||isNaN(t.sentiment)){var n=new Error("Missing Google Analytics Sentiment data");return e.Knotch.bugsnag.reportError(n,t)}this.iframe&&this.iframe.contentWindow?this.iframe.contentWindow.postMessage(t,"*"):e.Knotch.bugsnag.pushBreadCrumb({name:"Missing iframe",metaData:{id:t.survey_id}})}},{key:"postRBTGA",value:function(t){return t.eventType="RBT",e.Knotch.bugsnag.pushBreadCrumb({name:"Posting RBT to GAFrame",metaData:t}),t.type?void(this.iframe&&this.iframe.contentWindow?this.iframe.contentWindow.postMessage(t,"*"):e.Knotch.bugsnag.pushBreadCrumb({name:"Missing iframe",metaData:{id:t.survey_id}})):e.Knotch.bugsnag.reportError(new Error("Missing Google Analytics RBT data"),t)}},{key:"remove",value:function(){c.default.removeNode(this.iframe)}},{key:"setOptout",value:function(e){this.iframe.contentWindow.postMessage({eventType:"setOptout",optedOut:e},"*")}}]),t}(),l=d;r.default=l},{"../../../../tmp/config":55,"../../helpers/vanillaHelper":25}],39:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@knotchlabs/web-tag-libs/dist/index.cjs"),u=r(e("../../helpers/vanillaHelper")),c=function(){function e(t){var n=t.tracker;i(this,e),this.surveyIds=[],this.tracker=n}return o(e,[{key:"handleEvent",value:function(e){var t=this;this.surveyIds.forEach(function(n){var r=u.default.extend(e,{survey_id:n});t.tracker.record(r)})}},{key:"addUnit",value:function(e){var t=this;this.surveyIds.push(e),this.scrollDepthTracker||(this.scrollDepthTracker=new s.ScrollDepthTracker({callback:function(e){t.handleEvent(e)}}))}},{key:"removeUnit",value:function(e){var t=this.surveyIds.indexOf(e);this.surveyIds.splice(t,1)}}]),e}(),d=c;n.default=d},{"../../helpers/vanillaHelper":25,"@knotchlabs/web-tag-libs/dist/index.cjs":19}],40:[function(t,n,r){"use strict";function i(e){this.callback=e,this.inView=!1,this.hasViewed=!1,this.intObs=null,this.checks=[],this.init()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,i.prototype={init:function(){"IntersectionObserver"in e&&"IntersectionObserverEntry"in e&&"intersectionRatio"in e.IntersectionObserverEntry.prototype&&(this.intervalCheck=e.setInterval(this.addObs.bind(this),100))},addObs:function(){var e=this;document.body&&(this.intObs&&this.intObs.unobserve(document.body),this.intObs=new IntersectionObserver(function(t){return e.checkViewability(t[0])},{threshold:.5}),this.intObs.observe(document.body))},isInView:function(){return this.inView},stop:function(){clearInterval(this.intervalCheck)},checkViewability:function(t){var n=t.intersectionRatio>=.1;try{if(n instanceof Error)this.stop();else{if(this.checks.push(n),this.checks.length>10&&this.checks.shift(),10===this.checks.length){for(var r=!0,i=0;i<10;i++)r=r&&this.checks[i];this.viewed=r}this.viewed?this.hasViewed=!0:!this.viewed&&this.hasViewed&&(e.Knotch.bugsnag.pushBreadCrumb({name:"Unit has been scrolled past"}),this.intObs.unobserve(document.body),this.callback(),this.stop())}}catch(t){e.Knotch.bugsnag.reportError(t)}}};var a=i;r.default=a},{}],41:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=i(t("../../helpers/vanillaHelper")),c=function(){function t(e){var n=e.knotch;a(this,t),this.knotch=n,this.initialUrlMap={},this.checkInfiniteScroll()}return s(t,[{key:"checkInfiniteScroll",value:function(){var t=this;this.checkURL=e.setInterval(function(){for(var e in t.initialUrlMap)t.handleUnit(e)},2e3),e.setTimeout(function(){clearInterval(t.checkURL)},18e5)}},{key:"shouldSendEvent",value:function(e){var t=u.default.getBrowserURL();return this.handleUnit(e),t===this.initialUrlMap[e]}},{key:"handleUnit",value:function(e){var t=this.initialUrlMap[e],n=u.default.getBrowserURL(),r=this.knotch.units[e].disabled;n!==t&&r!==!0?(this.knotch.bugsnag.pushBreadCrumb({name:"TrackCurrentOnly: disabling unit ".concat(e)}),this.knotch.disableUnit(e)):n===t&&r===!0&&(this.knotch.bugsnag.pushBreadCrumb({name:"TrackCurrentOnly: enabling unit ".concat(e)}),this.knotch.enableUnit(e))}},{key:"addUnit",value:function(e){var t=u.default.getBrowserURL();this.initialUrlMap[e]=t}}]),t}(),d=c;r.default=d},{"../../helpers/vanillaHelper":25}],42:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(t,n){this.unit=t,this.finished=!1,this.knotched=null!==b.default.get("knotched:".concat(t.public_id)),this.duration=null,this.tracker=n,this.vidTimer=new g.default("time_playing_video",y.LOG_OPTIONS_TIME_PLAYING_VIDEO),this.videoType=t.videoType,this.disabled=!1,this.init();var r=k[this.videoType];if(!r){var i=new Error("There is no video handler available for this video type: ".concat(t.videoType));return e.Knotch.bugsnag.reportError(i)}this.handler=new r(this,{url:t.videoUrl,surveyId:t.public_id})}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(t("../video/BrightcoveHandler.js")),s=i(t("../video/FAVEHandler.js")),u=i(t("../video/HTML5VidHandler.js")),c=i(t("../video/JWPlayerHandler.js")),d=i(t("../video/SMPlayerHandler.js")),l=i(t("../video/KalturaHandler.js")),h=i(t("../video/VimeoHandler.js")),f=i(t("../video/VPAIDHandler.js")),p=i(t("../video/WistiaHandler.js")),v=i(t("../video/YoutubeHandler.js")),m=i(t("../timers/TimerLogger.js")),g=i(t("../timers/SophistiTimer.js")),y=t("../timers/constants.js"),b=i(t("../../helpers/Cookies.js")),k={0:o.default,1:v.default,2:h.default,5:u.default,6:l.default,7:c.default,8:f.default,9:p.default,10:s.default,11:d.default};a.prototype.init=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.disabled){this.vidTimer.init();var n=y.LOG_OPTIONS_TIME_PLAYING_VIDEO;this.logVideoTimer||(e.Knotch.bugsnag.pushBreadCrumb({name:"initializing video timer",metaData:{autoplay:t}}),this.logVideoTimer=new m.default({timer:this.vidTimer,event:"time_playing_video",tracker:this.tracker,id:this.unit.public_id,logOptions:n,autoStart:t}))}},a.prototype.play=function(){this.disabled||this.logVideoTimer.started||this.finished||(e.Knotch.bugsnag.pushBreadCrumb({name:"video played"}),this.logVideoTimer.startTimer())},a.prototype.pause=function(){this.disabled||this.finished||(e.Knotch.bugsnag.pushBreadCrumb({name:"video paused"}),this.logVideoTimer.stopTimer())},a.prototype.finish=function(){var t=this.unit.public_id;if(this.knotched=null!==b.default.get("knotched:".concat(t)),e.Knotch.bugsnag.pushBreadCrumb({name:"video finished, knotched: ".concat(this.knotched,", finished: ").concat(this.finished,", disabled: ").concat(this.disabled)}),!this.disabled){if(!this.finished){this.logVideoTimer.stopTimer();var n={survey_id:t,type:"video_completed"};this.duration&&this.duration>0&&(n.video_duration=this.duration),e.Knotch.bugsnag.pushBreadCrumb({name:"recording video completed"}),this.tracker.record(n)}this.knotched||this.unit.surveyless?e.Knotch.bugsnag.pushBreadCrumb({name:"not fading in survey because already knotched or unit is surveyless",type:"ui"}):(e.Knotch.bugsnag.pushBreadCrumb({name:"fading in survey",type:"ui"}),e.Knotch.units[t].DOMHandler.fadeIn(),this.tracker.thirdPartyEvent({knotchId:t,name:"unit_shown"})),this.tracker.thirdPartyEvent({knotchId:t,name:"video_finished",unitHidden:this.knotched}),this.finished=!0}},a.prototype.setMaxTime=function(t){if(!this.disabled){if(t<1e3){var n=new Error("Improperly set maxTime: ".concat(t,"ms for videoType ").concat(this.videoType));return e.Knotch.bugsnag.reportError(n)}if(!this.logVideoTimer){var r=new Error("LogVideoTimer is undefined");return e.Knotch.bugsnag.reportError(r)}e.Knotch.bugsnag.pushBreadCrumb({name:"Setting max time to ".concat(t,"ms for videoType ").concat(this.videoType)}),this.logVideoTimer.setMaxDuration(t)}};var T=a;r.default=T},{"../../helpers/Cookies.js":21,"../timers/SophistiTimer.js":34,"../timers/TimerLogger.js":35,"../timers/constants.js":36,"../video/BrightcoveHandler.js":44,"../video/FAVEHandler.js":45,"../video/HTML5VidHandler.js":46,"../video/JWPlayerHandler.js":47,"../video/KalturaHandler.js":48,"../video/SMPlayerHandler.js":49,"../video/VPAIDHandler.js":50,"../video/VimeoHandler.js":51,"../video/WistiaHandler.js":52,"../video/YoutubeHandler.js":53}],43:[function(t,n,r){"use strict";function i(t){this.ids=[],this.tracker=t,this.checks={},this.viewed={},this.intervalCheck=e.setInterval(this.check.bind(this),100)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,i.prototype={check:function(){for(var t=e.innerHeight,n=0;n<this.ids.length;n++){var r=this.ids[n],i=document.getElementById("knotchframe_".concat(r));if(i){this.checks[r]||(this.checks[r]=[]),this.checks[r].length>10&&this.checks[r].shift();var a=document.getElementById("knotchframe_".concat(r)).getBoundingClientRect(),o=a.top+.5*a.height,s=o>0&&o<t;this.checks[r].push(s),this.isViewed(r)}else this.ids.splice(n,1)}},isViewed:function(t){for(var n=!0,r=0;r<10;r++)n=n&&this.checks[t][r];if(this.viewed[t]=n,this.viewed[t]){this.tracker.record({type:"viewability",survey_id:t,viewed:!0,viewability_type:"jstag"});var i=this.ids.indexOf(t);this.ids.splice(i,1),this.ids.length||e.clearInterval(this.intervalCheck)}},addUnit:function(t){this.ids.push(t),this.tracker.record({type:"viewability",survey_id:t,viewed:!1,viewability_type:"jstag"}),this.intervalCheck||(this.intervalCheck=e.setInterval(this.check.bind(this),100))},get:function(e){return!!this.viewed[e]},removeUnit:function(e){var t=this.ids.indexOf(e);t!==-1&&this.ids.splice(t,1)}};var a=i;r.default=a},{}],44:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(t,n){this.videoTracker=t,this.url=n.url,this.surveyId=n.surveyId,this.node=document.querySelector('video[data-knotch="'.concat(this.surveyId,'"]'))||document.querySelector('iframe[data-knotch="'.concat(this.surveyId,'"]')),!o.default.isTopFrame()&&this.url?this.videoProperties=this.getVideoProperties(this.url):e.Knotch.bugsnag.pushBreadCrumb({name:"not iframe integration or URL not provided - unable to parse necessary IDs"}),this.loadAPI(n)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(t("../../helpers/vanillaHelper"));a.prototype={interceptEvents:function(){var e=this,t=this.videoTracker;if(this.player.on("loadedmetadata",function(){e.autoplay&&(t.init(e.autoplay),t.play())}),this.player.on("timeupdate",function(){return e.progressHandler(event)}),this.player.on("ended",function(){return t.finish()}),this.player.on("play",function(){return t.play()}),this.player.on("pause",function(){return t.pause()}),this.node.duration){var n=Math.floor(1e3*this.node.duration);this.videoTracker.duration=n,this.videoTracker.setMaxTime(n)}},progressHandler:function(){if(this.videoTracker.play(),!this.videoTracker.knotched){if(this.node.duration&&!this.videoTracker.duration){var e=Math.floor(1e3*this.node.duration);this.videoTracker.duration=e,this.videoTracker.setMaxTime(e)}this.videoTracker.logVideoTimer||this.videoTracker.init(this.autoplay)}},loadAPI:function(){e.videojs?this.init():this.injectBrightcove()},injectBrightcove:function(){var t=this,n=document.createElement("script");this.videoProperties||(this.videoProperties=this.getVideoProperties(this.url)),this.videoProperties||e.Knotch.bugsnag.reportError(new Error("".concat(this.surveyId,": can't get Brightcove video propreties")));var r=this.videoProperties,i=r.accountId,a=r.playerId,o=r.videoId;n.src="//players.brightcove.net/".concat(i,"/").concat(a,"_default/index.js"),document.head.appendChild(n);var s=document.getElementById("knotchVideo"),u=document.createElement("video");u.setAttribute("data-video-id",o),u.setAttribute("data-account",i),u.setAttribute("data-player",a),u.setAttribute("data-embed","default"),u.setAttribute("class","video-js"),u.setAttribute("data-application-id",""),u.setAttribute("controls",""),u.style.width="100%",u.style.height="100%",s.appendChild(u),this.node=u,n.onload=function(){return t.init()}},init:function(){this.node?(this.player=e.videojs(this.node),this.autoplay=this.player.autoplay(),this.interceptEvents()):e.Knotch.bugsnag.pushBreadCrumb({name:"Brightcove video player node is missing"})},getVideoProperties:function(){if(this.url){var t=this.url.match(/(?:https?:\/\/)?(?:www\.)?players.brightcove.net\/(\d+)\/([A-Za-z0-9\-\_]+)\/?index.html\?videoId=(\d+)/);return t?{accountId:t[1],playerId:t[2].split("_")[0],videoId:t[3]}:void e.Knotch.bugsnag.pushBreadCrumb({name:"URL does not provide necessary IDs"})}}};var s=a;r.default=s},{"../../helpers/vanillaHelper":25}],45:[function(t,n,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=function(){function t(e,n){i(this,t),this.videoTracker=e,this.surveyId=n.surveyId,this.node=document.querySelector('[data-knotch="'.concat(n.surveyId,'"]')),this.init()}return o(t,[{key:"init",value:function(){var t=this,n=setInterval(function(){var r=e.FAVE&&Object.keys(e.FAVE.player.instances).length>0;return r?(t.playerId=document.querySelector("div[data-knotch]").id,e.Knotch.bugsnag.pushBreadCrumb({name:"FAVE player found",type:"ui"}),t.interceptEvents(),void clearInterval(n)):e.Knotch.bugsnag.pushBreadCrumb({name:"FAVE player not found",type:"ui"})},500);e.setTimeout(function(){(!e.FAVE||Object.keys(e.FAVE.player.instances).length<=0)&&e.Knotch.bugsnag.reportError(new Error("FAVE player not found within one minute")),clearInterval(n)},6e4)}},{key:"interceptEvents",value:function(){var t=this,n=this.videoTracker,r=e.FAVE.player.instances,i=r[this.playerId].getPlayer();i.addEventListener("playing",function(){n.play()}),i.addEventListener("pause",function(){n.pause()}),i.addEventListener("ended",function(){n.finished||n.finish()}),i.addEventListener("timeupdate",function(){var r=i.currentTime;!t.videoTracker.logVideoTimer.started&&r>0&&t.videoTracker.play(),r>=i.duration-2&&!n.finished&&(i.pause(),n.finish(),t.timeoutUnit||(t.timeoutUnit=e.setTimeout(function(){e.Knotch.tracker.hideIframe(t.surveyId),i.play()},1e4)))})}}]),t}(),u=s;r.default=u},{}],46:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(t,n){this.videoTracker=t,this.DOMHandler=e.Knotch.units[n.surveyId].DOMHandler,this.options=n,this.node=document.querySelector('video[data-knotch="'.concat(n.surveyId,'"]')),this.looped=this.isLooping(),this.autoplay=this.node.autoplay,this.interceptEvents()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(t("../../helpers/vanillaHelper")),s=1e4;a.prototype={interceptEvents:function(){var e=this,t=this.videoTracker;o.default.onEvent("loadedmetadata",this.node,function(){e.autoplay&&(t.init(e.autoplay),t.play())}),o.default.onEvent("timeupdate",this.node,function(t){return e.progressHandler(t)}),o.default.onEvent("play",this.node,function(){return t.play()}),o.default.onEvent("pause",this.node,function(){return t.pause()}),this.looped?(this.DOMHandler.onIframeEvent("mouseenter",function(){clearTimeout(e.backToLoopTimeOut),e.backToLoopTimeOut=null}),this.DOMHandler.onIframeEvent("mouseleave",function(){e.videoTracker.finished&&(e.backToLoopTimeOut=setTimeout(function(){return e.backToLoop()},s))})):o.default.onEvent("ended",this.node,function(){return t.finish()})},progressHandler:function(){var t=this;if(this.videoTracker.play(),!this.videoTracker.knotched){if(this.node.duration&&!this.videoTracker.duration){var n=Math.floor(1e3*this.node.duration);this.videoTracker.duration=n,this.videoTracker.setMaxTime(n)}this.videoTracker.logVideoTimer||(e.Knotch.bugsnag.pushBreadCrumb({name:"initializing HTML5 videoTracker",autoplay:this.autoplay}),this.videoTracker.init(this.autoplay));var r=this.node,i=r.currentTime,a=r.duration;if(Number.isNaN(i)||Number.isNaN(a))return void e.Knotch.bugsnag.pushBreadCrumb({name:"HTML5 video not ready yet",surveyId:this.options.surveyId,currentTime:i,duration:a});var o=i>a-.5;this.looped&&o&&!this.backToLoopTimeOut?(this.node.pause(),this.videoTracker.finish(),this.backToLoopTimeOut=setTimeout(function(){return t.backToLoop()},s)):!o&&this.backToLoopTimeOut&&(clearTimeout(this.backToLoopTimeOut),this.backToLoopTimeOut=null)}},backToLoop:function(){var e=this;setTimeout(function(){return e.DOMHandler.fadeOut()},500),this.node.play(),clearTimeout(this.backToLoopTimeOut),this.backToLoopTimeOut=null},isLooping:function(){return this.node?this.node._isLooping?this.node._isLooping:!!this.node.hasAttribute("x-celtra-media")||this.node.loop:e.Knotch.bugsnag.reportError(new Error("HTML5 video missing"))},dismiss:function(){this.looped&&this.backToLoop()}};var u=a;r.default=u},{"../../helpers/vanillaHelper":25}],47:[function(t,n,r){"use strict";function i(e,t){this.videoTracker=e,this.node=document.querySelector('video[data-knotch="'.concat(t.surveyId,'"]')),this.interceptEvents()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,i.prototype={interceptEvents:function(){var t=this.videoTracker,n=e.jwplayer&&e.jwplayer();if(n){var r=n.getDuration();if(r){var i=Math.floor(1e3*r);this.videoTracker.duration=i,this.videoTracker.setMaxTime(i)}var a=n.getState();"playing"===a&&(this.videoTracker.logVideoTimer||(e.Knotch.bugsnag.pushBreadCrumb({name:"initializing JWPlayer videoTracker"}),this.videoTracker.init(!0)),t.play()),n.on("playAttempt",function(){t.play()}),n.on("complete",function(){t.finished||t.finish()}),n.on("beforeComplete",function(){t.finished||t.finish()}),n.on("time",function(e){e.currentTime>e.duration-1&&!t.finished&&(n.pause(),t.finish())}),n.on("play",function(){t.play()}),n.on("pause",function(){t.pause()})}},dismiss:function(){var t=e.jwplayer&&e.jwplayer();t&&(t.play(),this.videoTracker.finished=!0)}};var a=i;r.default=a},{}],48:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){this.node=document.querySelector('[data-knotch="'.concat(t.surveyId,'"]')),this.videoTracker=e,this.init(),this.initialized=!1,this.timeoutUnit=null,this.duration=null}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(t("../../helpers/vanillaHelper"));a.prototype={init:function(){var t=this,n=setInterval(function(){e.kWidget&&(clearInterval(n),e.kWidget.addReadyCallback(function(e){return t.bindEvents(e)}))},500);e.setTimeout(function(){return clearInterval(n)},6e4)},bindEvents:function(t){var n=this;if(!this.initialized){this.initialized=!0;var r=document.getElementById(t);r.kBind("playerReady",function(){return n.videoTracker.init()}),r.kBind("playerPlayed",function(){return n.videoTracker.play()}),r.kBind("playerPaused",function(){return n.videoTracker.pause()}),r.kBind("playerPlayEnd",function(){return n.videoTracker.finish()}),r.kBind("playerUpdatePlayhead",function(t){if(!n.duration){n.duration=r.evaluate("{mediaProxy.entry.duration}");var i=Math.floor(1e3*n.duration);n.videoTracker.duration=i,n.videoTracker.setMaxTime(i)}!n.videoTracker.logVideoTimer.started&&t>0&&n.videoTracker.play(),n.duration&&t>n.duration-2&&!n.videoTracker.finished&&(n.videoTracker.finish(),r.sendNotification("doPause"),n.timeoutUnit||(n.timeoutUnit=e.setTimeout(function(){e.Knotch.tracker.hideIframe({data:{id:n.videoTracker.unit.public_id}}),r.sendNotification("doPlay")},1e4)))}),o.default.listen("message",e,function(t){t.data&&"hideIframe"===t.data.eventType&&(e.clearTimeout(n.timeoutUnit),r.sendNotification("doPlay"))})}}};var s=a;r.default=s},{"../../helpers/vanillaHelper":25}],49:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=i(t("../../helpers/vanillaHelper")),c="https://api.sele.co",d=function(){function t(e,n){a(this,t),this.videoTracker=e,this.node=document.querySelector('[data-knotch="'.concat(n.surveyId,'"]')),this.waitForAPI()}return s(t,[{key:"waitForAPI",value:function(){var t=this,n=setInterval(function(){var r=e.SM;r&&(clearInterval(n),t.init(),t.videoTracker.init())},500);e.setTimeout(function(){return clearInterval(n),e.Knotch.bugsnag.reportError(new Error("SM API not found"))},6e4)}},{key:"init",value:function(){var t=document.querySelector(".sm-iframe");if(!t)return e.Knotch.bugsnag.pushBreadCrumb({name:"sm iframe not found",type:"video_integration"});var n=t.getAttribute("src");u.default.stringContains(n,"autoStart=true")?(e.Knotch.bugsnag.pushBreadCrumb({name:"autoplaying sm player",type:"video_integration"}),this.videoTracker.play()):e.Knotch.bugsnag.pushBreadCrumb({name:"sm player either not autoplay, or invalid search strings",type:"video_integration"}),this.interceptEvents()}},{key:"interceptEvents",value:function(){var t=this.videoTracker;u.default.listen("message",e,function(n){if(n.origin===c){var r=JSON.parse(n.data);if(!r)return e.Knotch.bugsnag.pushBreadCrumb({name:"no sm player data",type:"video_integration"});switch(r.type){case"play":t.play();break;case"pause":t.pause();break;case"ended":t.finished||t.finish()}}})}}]),t}(),l=d;r.default=l},{"../../helpers/vanillaHelper":25}],50:[function(e,t,n){"use strict";function r(e,t){this.options=t,this.videoTracker=e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,r.prototype={dismiss:function(){console.log("placeholder function")}};var i=r;n.default=i},{}],51:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=i(t("../../helpers/vanillaHelper.js")),c=function(){function t(e,n){a(this,t),this.videoTracker=e,this.url=n.url,this.surveyId=n.surveyId,this.node=document.querySelector('[data-knotch="'.concat(n.surveyId,'"]')),this.loadAPI()}return s(t,[{key:"loadAPI",value:function(){var t=this;if("undefined"==typeof e.Vimeo){var n=document.createElement("script");n.src="https://player.vimeo.com/api/player.js";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r),n.onload=function(){t.init()}}else this.init()}},{key:"init",value:function(){var t=this;this.player=new e.Vimeo.Player(this.node,{id:this.getVimeoId(),transparent:!1}),this.player.ready().then(function(){t.bindListeners(),(e.Knotch.inIframe||u.default.inKnotchPage())&&u.default.extend(t.player.element.style,{width:"100%",height:"100%"}),t.player.getDuration().then(function(e){var n=Math.floor(1e3*e);t.videoTracker.duration=n,t.videoTracker.setMaxTime(n)})}).catch(function(t){e.Knotch.bugsnag.reportError(t)})}},{key:"bindListeners",value:function(){var e=this;this.player.on("play",function(){return e.videoTracker.play()}),this.player.on("pause",function(){return e.handlePauseAtEnd()}),this.player.on("error",function(t){return e.handleError(t)}),this.player.on("ended",function(){return e.videoTracker.finish()})}},{key:"handlePauseAtEnd",value:function(){var e=this;this.player.getCurrentTime().then(function(t){Math.floor(t)===e.videoTracker.duration/1e3?e.videoTracker.finish():e.videoTracker.pause()})}},{key:"handleError",value:function(t){if(t&&t.name)switch(t.name){case"NotAllowedError":e.Knotch.bugsnag.pushBreadCrumb({name:"error: NotAllowedError occured"});break;case"playInterrupted":e.Knotch.bugsnag.pushBreadCrumb({name:"error: playInterrupted occured"})}else e.Knotch.bugsnag.reportError(new Error("Vimeo integration error"),{data:t})}},{key:"getVimeoId",value:function(){var e=this.url&&this.url.match(/(?:https?:\/\/)?(?:www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|)(\d+)(?:$|\/|\?)/);return e?e[3]||e[1]:null}}]),t}(),d=c;r.default=d},{"../../helpers/vanillaHelper.js":25}],52:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=i(t("../../helpers/vanillaHelper")),c=function(){function t(e,n){var r=n.surveyId;a(this,t),this.videoTracker=e,this.surveyId=r,this.node=document.querySelector('[data-knotch="'.concat(r,'"]')),this.id=this.extractId(),this.id&&this.waitForAPI(this.id)}return s(t,[{key:"extractId",value:function(){var t="wistia_async_",n=null;try{if("VIDEO"===this.node.tagName){for(var r=this.node;r&&r.className.indexOf(t)===-1;)r=r.parentNode;var i=r.className.split(" "),a=i.filter(function(e){return e.indexOf(t)!==-1});a.length&&a[0].length&&(n=a[0].substring(t.length,a[0].length))}else if("IFRAME"===this.node.tagName){var o=this.node.src;n=o.split("?")[0].split("/")[5]}n||e.Knotch.bugsnag.reportError(new Error("No id found"),{data:event})}catch(t){e.Knotch.bugsnag.reportError(t)}return n}},{key:"waitForAPI",value:function(t){var n=this;e._wq=e._wq||[],e._wq.push({id:t,onReady:function(){n.init()}})}},{key:"init",value:function(){return"VIDEO"===this.node.tagName||(this.node=this.node.querySelector("video"),this.node)?void this.bindListeners():e.Knotch.bugsnag.reportError(new Error("Wistia integration: video element not found"),{data:{pageNode:u.default.getNodeDescription(this.node)}})}},{key:"bindListeners",value:function(){var e=this,t=this.videoTracker;u.default.onEvent("timeupdate",this.node,function(t){return e.progressHandler(t)}),u.default.onEvent("play",this.node,function(){return t.play()}),u.default.onEvent("pause",this.node,function(){return t.pause()}),u.default.onEvent("ended",this.node,function(){return t.finish()})}},{key:"progressHandler",value:function(){if(this.videoTracker.play(),!this.videoTracker.knotched){if(this.node.duration&&!this.videoTracker.duration){var t=Math.floor(1e3*this.node.duration);this.videoTracker.duration=t,this.videoTracker.setMaxTime(t)}this.videoTracker.logVideoTimer||this.videoTracker.init(!0);var n=this.node,r=n.currentTime,i=n.duration;(Number.isNaN(r)||Number.isNaN(i))&&e.Knotch.bugsnag.pushBreadCrumb({name:"wistia video not ready yet",surveyId:this.options.surveyId,currentTime:r,duration:i})}}},{key:"handleError",value:function(t){e.Knotch.bugsnag.reportError(new Error("Wistia integration error"),{data:t})}}]),t}(),d=c;r.default=d},{"../../helpers/vanillaHelper":25}],53:[function(t,n,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){this.surveyId=t.surveyId,this.node=document.querySelector('[data-knotch="'.concat(this.surveyId,'"]')),this.id=this.getIdFromUrl(this.getUrl(t)),this.hasAutoplay="1"===o.default.getQueryParams(this.getUrl(t)).autoplay,this.videoTracker=e,this.init()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(t("../../helpers/vanillaHelper")),s=i(t("../../thirdparty/YoutubeIframeAPI.js"));a.prototype={init:function(){var t=this;"undefined"==typeof e.youTubeReadyCollection&&(e.youTubeReadyCollection=[]);var n=!("undefined"==typeof e.YT||"undefined"==typeof e.YT.Player);n?this.loadAPI():(e.youTubeReadyCollection.push(function(){return t.loadAPI()}),e.onYouTubePlayerAPIReady=function(){if("undefined"!=typeof e.youTubeReadyCollection&&e.youTubeReadyCollection.length)for(;e.youTubeReadyCollection.length;){var t=e.youTubeReadyCollection.pop();t()}},setTimeout(function(){(0,s.default)(e)},100))},getUrl:function(e){return o.default.isTopFrame()?this.node.getAttribute("src"):e.url},getIdFromUrl:function(e){var t=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;return e.match(t)?e.match(t)[1]:null},loadAPI:function(){var t=this,n=null;"undefined"!=typeof this.node.id&&0!==this.node.id.length||(this.node.id="knotchVideo_".concat(this.id),e.Knotch.bugsnag.pushBreadCrumb({name:"node ID added"})),n=this.node.id,this.node.src&&this.enableAPI();var r=e.YT.get(n);r?(e.Knotch.bugsnag.pushBreadCrumb({name:"".concat(this.surveyId,": YouTube player exists, listening to events")}),this.player=r,this.player.addEventListener("onReady",function(e){return t.onReady(e)}),this.player.addEventListener("onStateChange",function(e,n){return t.onStateChange(e,n)})):(e.Knotch.bugsnag.pushBreadCrumb({name:"".concat(this.surveyId,": Adding a new YouTube player")}),this.player=new e.YT.Player(n,{height:"100%",width:"100%",videoId:this.id,playerVars:{modestbranding:0,fs:0,rel:0,wmode:"transparent",enablejsapi:1,autoplay:this.hasAutoplay,showinfo:0,loop:1},events:{onStateChange:function(e,n){return t.onStateChange(e,n)},onError:function(e){return t.onError(e)},onReady:function(e){return t.onReady(e)}}}))},enableAPI:function(){this.node.src.indexOf("enablejsapi")===-1&&(this.node.src.indexOf("?")===-1?this.node.src+="?enablejsapi=1":this.node.src+="&enablejsapi=1",e.Knotch.bugsnag.pushBreadCrumb({name:"".concat(this.surveyId,": youtube API enabled")}))},onReady:function(t){var n=t.target.getDuration();if(n){var r=Math.floor(1e3*n);this.videoTracker.duration=r,this.videoTracker.setMaxTime(r),e.Knotch.bugsnag.pushBreadCrumb({name:"".concat(this.surveyId,": Adding YouTube max time and duration to video tracker")})}this.hasAutoplay&&(this.videoTracker.init(this.hasAutoplay),this.videoTracker.play())},onError:function(t){e.Knotch.bugsnag.reportError(new Error("".concat(this.surveyId,": Youtube integration error")),{data:t})},onStateChange:function(t,n){switch(n&&n(),t.data){default:break;case 0:this.videoTracker.finish(),e.Knotch.bugsnag.pushBreadCrumb({name:"".concat(this.surveyId,": YouTube video finished")});break;case 1:this.videoTracker.play(),e.Knotch.bugsnag.pushBreadCrumb({name:"".concat(this.surveyId,": YouTube video played")});break;case 2:this.videoTracker.pause(),e.Knotch.bugsnag.pushBreadCrumb({name:"".concat(this.surveyId,": YouTube video paused")})}}};var u=a;r.default=u},{"../../helpers/vanillaHelper":25,"../../thirdparty/YoutubeIframeAPI.js":54}],54:[function(e,t,n){"use strict";function r(e){e.YT||(e.YT={loading:0,loaded:0}),e.YTConfig||(e.YTConfig={host:"http://www.youtube.com"}),e.YT.loading||(e.YT.loading=1,function(){var t=[];e.YT.ready=function(n){e.YT.loaded?n():t.push(n)},e.onYTReady=function(){e.YT.loaded=1;for(var n=0;n<t.length;n++)try{t[n]()}catch(e){}},e.YT.setConfig=function(e){for(var t in e)e.hasOwnProperty(t)&&(YTConfig[t]=e[t])};var n=document.createElement("script");n.type="text/javascript",n.id="www-widgetapi-script",n.src="https://s.ytimg.com/yts/jsbin/www-widgetapi-vfl9cGVgZ/www-widgetapi.js",n.async=!0;var r=document.currentScript;if(r){var i=r.nonce||r.getAttribute("nonce");i&&n.setAttribute("nonce",i)}var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a)}())}Object.defineProperty(n,"__esModule",{value:!0}),n.default=r},{}],55:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.knotchConfig=void 0;var r={env:"production",version:"v4.47.5",pixel:"https://c.knotch.it/",root:"https://www.knotch.it",metadata:"https://units.knotch.it/units",theme:"https://units.knotch.it/themes",gaframe:"https://units.knotch.it/gaframe/ver-adb8932/index.html",reporter:"https://units.knotch.it/reporter/ver-fac59b9/index.html"};n.knotchConfig=r},{}]},{},[32])}catch(e){Knotch.bugsnag&&Knotch.bugsnag.reportError(e)}}(window);
/** @cbsinteractive/avia-js 1.14.1; 2021-12-06T18:04:58.578Z **/
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).avia={})}(this,(function(t){"use strict";var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t,i){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),e=1;e<arguments.length;e++){var r=arguments[e];if(null!=r)for(var s=Object.keys(Object(r)),u=0,o=s.length;u<o;u++){var a=s[u],c=Object.getOwnPropertyDescriptor(r,a);void 0!==c&&c.enumerable&&(n[a]=r[a])}}return n}var e={assign:n,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:n})}},r={exports:{}};!function(t,n){t.exports=function(){function t(t){var i=typeof t;return null!==t&&("object"===i||"function"===i)}function n(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,s=void 0,u=void 0,o=function(t,i){y[r]=t,y[r+1]=i,2===(r+=2)&&(u?u(k):w())};function a(t){u=t}function c(t){o=t}var h="undefined"!=typeof window?window:void 0,l=h||{},f=l.MutationObserver||l.WebKitMutationObserver,d="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),v="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function b(){return function(){return process.nextTick(k)}}function A(){return void 0!==s?function(){s(k)}:p()}function m(){var t=0,i=new f(k),n=document.createTextNode("");return i.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function g(){var t=new MessageChannel;return t.port1.onmessage=k,function(){return t.port2.postMessage(0)}}function p(){var t=setTimeout;return function(){return t(k,1)}}var y=new Array(1e3);function k(){for(var t=0;t<r;t+=2)(0,y[t])(y[t+1]),y[t]=void 0,y[t+1]=void 0;r=0}function O(){try{var t=Function("return this")().require("vertx");return s=t.runOnLoop||t.runOnContext,A()}catch(t){return p()}}var w=void 0;function T(t,i){var n=this,e=new this.constructor(N);void 0===e[j]&&W(e);var r=n._state;if(r){var s=arguments[r-1];o((function(){return Q(r,e,s,n._result)}))}else F(n,e,t,i);return e}function E(t){var i=this;if(t&&"object"==typeof t&&t.constructor===i)return t;var n=new i(N);return L(n,t),n}w=d?b():f?m():v?g():void 0===h?O():p();var j=Math.random().toString(36).substring(2);function N(){}var S=void 0,R=1,I=2;function C(){return new TypeError("You cannot resolve a promise with itself")}function P(){return new TypeError("A promises callback cannot return that same promise.")}function _(t,i,n,e){try{t.call(i,n,e)}catch(t){return t}}function D(t,i,n){o((function(t){var e=!1,r=_(n,i,(function(n){e||(e=!0,i!==n?L(t,n):B(t,n))}),(function(i){e||(e=!0,U(t,i))}),"Settle: "+(t._label||" unknown promise"));!e&&r&&(e=!0,U(t,r))}),t)}function M(t,i){i._state===R?B(t,i._result):i._state===I?U(t,i._result):F(i,void 0,(function(i){return L(t,i)}),(function(i){return U(t,i)}))}function x(t,i,e){i.constructor===t.constructor&&e===T&&i.constructor.resolve===E?M(t,i):void 0===e?B(t,i):n(e)?D(t,i,e):B(t,i)}function L(i,n){if(i===n)U(i,C());else if(t(n)){var e=void 0;try{e=n.then}catch(t){return void U(i,t)}x(i,n,e)}else B(i,n)}function V(t){t._onerror&&t._onerror(t._result),K(t)}function B(t,i){t._state===S&&(t._result=i,t._state=R,0!==t._subscribers.length&&o(K,t))}function U(t,i){t._state===S&&(t._state=I,t._result=i,o(V,t))}function F(t,i,n,e){var r=t._subscribers,s=r.length;t._onerror=null,r[s]=i,r[s+R]=n,r[s+I]=e,0===s&&t._state&&o(K,t)}function K(t){var i=t._subscribers,n=t._state;if(0!==i.length){for(var e=void 0,r=void 0,s=t._result,u=0;u<i.length;u+=3)e=i[u],r=i[u+n],e?Q(n,e,r,s):r(s);t._subscribers.length=0}}function Q(t,i,e,r){var s=n(e),u=void 0,o=void 0,a=!0;if(s){try{u=e(r)}catch(t){a=!1,o=t}if(i===u)return void U(i,P())}else u=r;i._state!==S||(s&&a?L(i,u):!1===a?U(i,o):t===R?B(i,u):t===I&&U(i,u))}function H(t,i){try{i((function(i){L(t,i)}),(function(i){U(t,i)}))}catch(i){U(t,i)}}var q=0;function z(){return q++}function W(t){t[j]=q++,t._state=void 0,t._result=void 0,t._subscribers=[]}function G(){return new Error("Array Methods must be provided an Array")}var X=function(){function t(t,i){this._instanceConstructor=t,this.promise=new t(N),this.promise[j]||W(this.promise),e(i)?(this.length=i.length,this._remaining=i.length,this._result=new Array(this.length),0===this.length?B(this.promise,this._result):(this.length=this.length||0,this._enumerate(i),0===this._remaining&&B(this.promise,this._result))):U(this.promise,G())}return t.prototype._enumerate=function(t){for(var i=0;this._state===S&&i<t.length;i++)this._eachEntry(t[i],i)},t.prototype._eachEntry=function(t,i){var n=this._instanceConstructor,e=n.resolve;if(e===E){var r=void 0,s=void 0,u=!1;try{r=t.then}catch(t){u=!0,s=t}if(r===T&&t._state!==S)this._settledAt(t._state,i,t._result);else if("function"!=typeof r)this._remaining--,this._result[i]=t;else if(n===it){var o=new n(N);u?U(o,s):x(o,t,r),this._willSettleAt(o,i)}else this._willSettleAt(new n((function(i){return i(t)})),i)}else this._willSettleAt(e(t),i)},t.prototype._settledAt=function(t,i,n){var e=this.promise;e._state===S&&(this._remaining--,t===I?U(e,n):this._result[i]=n),0===this._remaining&&B(e,this._result)},t.prototype._willSettleAt=function(t,i){var n=this;F(t,void 0,(function(t){return n._settledAt(R,i,t)}),(function(t){return n._settledAt(I,i,t)}))},t}();function Y(t){return new X(this,t).promise}function $(t){var i=this;return e(t)?new i((function(n,e){for(var r=t.length,s=0;s<r;s++)i.resolve(t[s]).then(n,e)})):new i((function(t,i){return i(new TypeError("You must pass an array to race."))}))}function Z(t){var i=new this(N);return U(i,t),i}function J(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function tt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var it=function(){function t(i){this[j]=z(),this._result=this._state=void 0,this._subscribers=[],N!==i&&("function"!=typeof i&&J(),this instanceof t?H(this,i):tt())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var i=this,e=i.constructor;return n(t)?i.then((function(i){return e.resolve(t()).then((function(){return i}))}),(function(i){return e.resolve(t()).then((function(){throw i}))})):i.then(t,t)},t}();function nt(){var t=void 0;if(void 0!==i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var e=null;try{e=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===e&&!n.cast)return}t.Promise=it}return it.prototype.then=T,it.all=Y,it.race=$,it.resolve=E,it.reject=Z,it._setScheduler=a,it._setAsap=c,it._asap=o,it.polyfill=nt,it.Promise=it,it}()}(r),r.exports.polyfill();var s=function(t,i){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])},s(t,i)};function u(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var o,a=function(){return a=Object.assign||function(t){for(var i,n=1,e=arguments.length;n<e;n++)for(var r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t},a.apply(this,arguments)};function c(t,i,n,e){var r,s=arguments.length,u=s<3?i:null===e?e=Object.getOwnPropertyDescriptor(i,n):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,i,n,e);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(u=(s<3?r(u):s>3?r(i,n,u):r(i,n))||u);return s>3&&u&&Object.defineProperty(i,n,u),u}function h(t,i,n,e){return new(n||(n=Promise))((function(r,s){function u(t){try{a(e.next(t))}catch(t){s(t)}}function o(t){try{a(e.throw(t))}catch(t){s(t)}}function a(t){var i;t.done?r(t.value):(i=t.value,i instanceof n?i:new n((function(t){t(i)}))).then(u,o)}a((e=e.apply(t,i||[])).next())}))}function l(t,i){var n,e,r,s,u={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,e&&(r=2&s[0]?e.return:s[0]?e.throw||((r=e.return)&&r.call(e),0):e.next)&&!(r=r.call(e,s[1])).done)return r;switch(e=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,e=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!(r=u.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){u.label=s[1];break}if(6===s[0]&&u.label<r[1]){u.label=r[1],r=s;break}if(r&&u.label<r[2]){u.label=r[2],u.ops.push(s);break}r[2]&&u.ops.pop(),u.trys.pop();continue}s=i.call(t,u)}catch(t){s=[6,t],e=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}function f(t,i,n){if(n||2===arguments.length)for(var e,r=0,s=i.length;r<s;r++)!e&&r in i||(e||(e=Array.prototype.slice.call(i,0,r)),e[r]=i[r]);return t.concat(e||Array.prototype.slice.call(i))}t.LogLevel=void 0,(o=t.LogLevel||(t.LogLevel={})).OFF="off",o.ERROR="error",o.WARN="warn",o.INFO="info",o.DEBUG="debug";var d,v=function(){function t(){}return Object.defineProperty(t.prototype,"className",{get:function(){return this.constructor.name},enumerable:!1,configurable:!0}),t}(),b=function(t,i,n){this.timeStamp=Date.now(),this.data=n,this.target=i,this.type=t},A=function(t,i){this.value=t,this.next=i},m=function(){function t(){this.head=null,this.tail=null}return Object.defineProperty(t.prototype,"empty",{get:function(){return null==this.head},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){for(var i=this.head;i;)t(i.value),i=i.next},t.prototype.add=function(t){var i=new A(t);null==this.head?this.head=i:null==this.tail?this.head.next=this.tail=i:this.tail.next=this.tail=i},t.prototype.has=function(t){for(var i=this.head;i;){if(i.value==t)return!0;i=i.next}return!1},t.prototype.delete=function(t){for(var i=null,n=this.head;n;){if(n.value==t)return i&&(i.next=n.next),n==this.head?this.head=n.next:n==this.tail&&(this.tail=i),!0;i=n,n=n.next}return!1},t.prototype.clear=function(){for(var t,i=this.head;i;)t=i.next,i.value=i.next=null,i=t;this.head=this.tail=null},t}();t.MimeType=void 0,(d=t.MimeType||(t.MimeType={})).MP4_VIDEO="video/mp4",d.MP4_AUDIO="audio/mp4",d.HLS="application/vnd.apple.mpegurl",d.HLS_ALT="application/x-mpegURL",d.DASH="application/dash+xml",d.WEBM_VIDEO="video/webm",d.WEBM_AUDIO="audio/webm",d.TS_VIDEO="video/mp2t";var g,p={VTT:"text/vtt",XML:"application/ttml+xml",M3U8:t.MimeType.HLS,MPD:t.MimeType.DASH,TS:t.MimeType.TS_VIDEO,MP4:t.MimeType.MP4_VIDEO,MPV:t.MimeType.MP4_VIDEO,MPA:t.MimeType.MP4_AUDIO,WEBM:t.MimeType.WEBM_VIDEO};t.TextTrackKind=void 0,(g=t.TextTrackKind||(t.TextTrackKind={})).CAPTIONS="captions",g.SUBTITLES="subtitles",g.DESCRIPTIONS="descriptions",g.CHAPTERS="chapters",g.METADATA="metadata";var y,k,O,w=function(){function i(){}return i.camelToDash=function(t){return t.replace(i.cdr,"-").replace(i.dre,"$1-$2").toLowerCase()},i.uid8=function(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return t()+t()},i.isEmpty=function(t){return null==t||Array.isArray(t)&&0===t.length||i.isObject(t)&&0===Object.keys(t).length||i.isString(t)&&""===t},i.isFunction=function(t){return"function"==typeof t},i.isString=function(t){return"string"==typeof t},i.isUndefined=function(t){return void 0===t},i.isNumber=function(t){return"number"==typeof t},i.isBoolean=function(t){return"boolean"==typeof t},i.isObject=function(t){return"object"==typeof t},i.includes=function(t,i){return t.indexOf(i)>-1},i.assign=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];return Object.assign.apply(Object,f([t||{}],i,!1))},i.values=function(t){return Object.keys(t).reduce((function(i,n,e){return i[e]=t[n],i}),[])},i.entries=function(t){return Object.keys(t).reduce((function(i,n,e){return i[e]=[n,t[n]],i}),[])},i.fromEntries=function(t){return t.reduce((function(t,i){var n=i[0],e=i[1];return t[n]=e,t}),{})},i.padStart=function(t,n,e){void 0===e&&(e=" "),n|=0;var r=t.length;return r>n?t:((n-=r)>e.length&&(e+=i.repeat(e,n/e.length)),e.slice(0,n)+t)},i.repeat=function(t,i){void 0===i&&(i=0),i|=0;for(var n=0,e="";n++<i;)e+=t;return e},i.merge=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=function(t,n){return null==t?n:(null==n||Object.getOwnPropertyNames(n).forEach((function(r){var s=n[r],u=t[r],o=typeof s;"undefined"!==o&&(null==u||!i.isObject(u)||Array.isArray(s)?t[r]=s:"object"===o&&(t[r]=e(u,s)))})),t)};return t.reduce((function(t,i){return e(t,i)}),{})},i.secToHms=function(t,n){if(void 0===n&&(n=61),null==t||isNaN(t))return"00:00";t|=0;var e=i.zeroFill(t%60);return t=t/60|0,e=i.zeroFill(t%60)+":"+e,(t=t/60|0)>0&&(e=i.zeroFill(t)+":"+e),n>=3600&&5===e.length&&(e="00:"+e),e},i.msToHms=function(t){return i.formatTime(new Date(t),"HH:mm:ss:sss",{offset:0})},i.zeroFill=function(t,n){return void 0===n&&(n=2),i.padStart(String(t),n,"0")},i.hmsToSec=function(t,i){if(void 0===i&&(i=30),!t)return NaN;var n=t.split(":"),e=0;if(4===n.length)e=parseInt(n.pop())/i;else if(3===n.length&&(n[2]=n[2].replace(",","."),-1!==n[2].indexOf("."))){var r=n[2].split(".");(null!=r?r.length:void 0)>1&&(n[2]=r[0],e=parseInt(r[1])/1e3)}for(var s=parseInt(n.pop());n.length>0;)s+=Math.pow(60,n.length)*parseInt(n.shift());return s+e},i.formatTime=function(t,n,e){if(void 0===n&&(n="h:mm:ss A"),void 0===e&&(e={timezone:"",offset:-(new Date).getTimezoneOffset()/60}),null!=e.offset&&0!==e.offset&&(t=new Date(t.getTime()+Math.round(60*e.offset*60*1e3))),isNaN(t.getTime()))return"";var r=t.getUTCHours(),s=t.getUTCMinutes(),u=t.getUTCSeconds(),o=t.getUTCMilliseconds(),a=r%12||12,c=r<12?"am":"pm",h={hh:i.zeroFill(a),h:a,HH:i.zeroFill(r),H:r,mm:i.zeroFill(s),m:s,sss:i.zeroFill(o,3),ss:i.zeroFill(u),s:u,a:c,A:c.toUpperCase(),z:e.timezone};for(var l in h)n=n.replace(l,h[l]);return n},i.findIndex=function(t,n){if(!i.isFunction(n))throw new TypeError("predicate must be a function");for(var e=t.length>>>0,r=0;r<e;){if(n(t[r],r,t))return r;r++}return-1},i.find=function(t,n){if(!i.isFunction(n))throw new TypeError("predicate must be a function");var e=i.findIndex(t,n);return e>-1?t[e]:void 0},i.template=function(t,n,e,r){if(void 0===e&&(e="{{"),void 0===r&&(r="}}"),!t)return t;var s=new RegExp("".concat(e,"((?:(?!(").concat(e,"|").concat(r,")).)+)").concat(r),"g");return t.replace(s,(function(t,e){return i.isUndefined(null==n?void 0:n[e])?t:n[e]}))},i.toArray=function(t){return Array.prototype.slice.call(t)},i.forEach=function(t,n){if(t&&t.length&&i.isFunction(n))for(var e=0,r=t.length;e<r;e++)n(t[e],e,t)},i.forEachReverse=function(t,n){if(t&&t.length&&i.isFunction(n))for(var e=t.length-1;e>-1;e--)n(t[e],e,t)},i.debounce=function(t,i){var n,e=function(){clearTimeout(n),n=null},r=function(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];e(),n=setTimeout.apply(void 0,f([t,i],r,!1))};return r.cancel=e,r.flush=t,r.pending=function(){return null!=n},r},i.clampValue=function(t,i,n){return Math.max(i,Math.min(n,t))},i.inRange=function(t,n,e){return i.isNumber(t)&&t>=n&&t<=e},i.mapToRange=function(t,i,n,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),(t-i)*(r-e)/(n-i)+e},i.base64DecodeUint8Array=function(t){for(var i=atob(t),n=i.length,e=new Uint8Array(new ArrayBuffer(n)),r=0;r<n;r++)e[r]=i.charCodeAt(r);return e},i.base64EncodeUint8Array=function(t){var i=String.fromCharCode.apply(null,t);return btoa(i)},i.xmlToJson=function(t){var n={};if(1===t.nodeType&&t.attributes.length>0)for(var e=0,r=t.attributes.length;e<r;e++){var s=t.attributes.item(e);n[s.nodeName]=s.nodeValue}else 3===t.nodeType&&(n=t.nodeValue);if("p"===t.nodeName&&(n.text="",t.childNodes.forEach((function(t){if("metadata"!==t.nodeName){var i=(new XMLSerializer).serializeToString(t);1===t.nodeType&&(n.text+="br"===t.tagName?"\n":i),3===t.nodeType&&(n.text+=i)}}))),t.hasChildNodes())for(var u=0,o=t.childNodes.length;u<o;u++){var a=t.childNodes.item(u),c=a.nodeName;if(i.isUndefined(n[c]))n[c]=i.xmlToJson(a);else{if(i.isUndefined(n[c].push)){var h=n[c];n[c]=[],n[c].push(h)}n[c].push(i.xmlToJson(a))}}return n},i.getNumLines=function(t){return t&&(t.match(/\n/g)||[]).length+1},i.roundTo=function(t,i){return Math.round(t*Math.pow(10,i))/Math.pow(10,i)},i.makeUrl=function(t,i){return(t?"https:":"http:")+"//"+i},i.parseLanguageTag=function(t){void 0===t&&(t="");var i=t.match(/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/)||[];return{tag:t,language:i[1]||"",extended:i[2]||"",script:i[3]||"",region:i[4]||"",toString:function(){return this.tag}}},i.getFileExtension=function(t){return t.replace(/\?.*/,"").replace(/#.*/,"").split(".").pop()},i.getMimeType=function(t){if(!t)return"";var n=i.getFileExtension(t).toUpperCase();return p[n]},i.clearCue=function(t,i){try{var n=VTTCue||TextTrackCue;t.addCue(new n(i-.1,i+.1," "))}catch(t){}},i.eventsToPromise=function(t,i,n){return void 0===n&&(n=NaN),new Promise((function(e,r){var s,u=[],o=function(){return u.forEach((function(t){return t()}))},a=function(t){return function(i){var n=i.target,e=i.events,r=n,a=r.on?"on":"addEventListener",c=r.off?"off":"removeEventListener",h=function(i,n){clearTimeout(s),o(),t(n||i)};e.forEach((function(t){r[a](t,h),u.push((function(){return r[c](t,h)}))}))}};t.forEach(a(e)),i.forEach(a(r)),n>-1&&(s=setTimeout((function(){o(),r(new Error("timeout"))}),n))}))},i.bufferToString=function(t){return String.fromCharCode.apply(null,new Uint8Array(t))},i.arrayToString=function(t){var i=new Uint16Array(t.buffer);return String.fromCharCode.apply(null,i)},i.stringToArray=function(t){for(var i=new ArrayBuffer(2*t.length),n=new Uint16Array(i),e=0,r=t.length;e<r;e++)n[e]=t.charCodeAt(e);return n},i.getResourceMimeType=function(t){var n;return((null===(n=t.overrides)||void 0===n?void 0:n.mimeType)||"").split(";").shift()||i.getMimeType(t.location.mediaUrl)},i.normalizeQuality=function(t,i){return{index:i,bitrate:t.bitrate,height:t.height,width:t.width,codec:t.codec||t.codecs}},i.getIndexForBitrate=function(t,i,n){if(!t)return 0;var e=t.length-1;if(i>=t[e].bitrate)return e;for(;e--;){var r=t[e].bitrate;if(n){if(i>r)return e+1}else if(i>=r)return e}return 0},i.findDefaultTrack=function(t,n){var e=new RegExp(n,"i"),r=i.find(t,(function(t){return e.test(t.language)}));if(!r){var s=i.parseLanguageTag(n).language;s!=n&&(e=new RegExp(s,"i"),r=i.find(t,(function(t){return e.test(t.language)})))}return r||i.find(t,(function(t){return t.default}))||t[0]},i.dedupeCues=function(t){var n={},e=[];return i.forEach(t.activeCues,(function(i){try{if(!i)return;var r=i.text,s=i.startTime,u=i.endTime;if(!r)return;var o=n[r];if(o){if(o.startTime===s&&o.endTime===u)return void t.removeCue(i)}else n[r]=i;e.push(i)}catch(t){}})),e},i.isTextTrack=function(i){return i===t.TextTrackKind.CAPTIONS||i===t.TextTrackKind.SUBTITLES},i.dre=/([a-z\d])([A-Z])/g,i.cdr=/\W+/g,i}(),T=function(t){function i(i,n){var e=t.call(this)||this;e.target=n||e,e.opts=i||{},e.eventMap={};var r,s=e.opts;for(var u in s)w.isFunction(s[u])&&/^on[A-Z]/.test(u)&&(r=u.charAt(2).toLowerCase()+u.substring(3),e.on(r,s[u]),delete e.opts[u]);return e}return u(i,t),i.prototype.destroy=function(){var t;if(this.opts){for(t in this.opts)delete this.opts[t];this.opts=null}if(this.offAll(null),this.eventMap){for(t in this.eventMap)delete this.eventMap[t];this.eventMap=null}},i.prototype.on=function(t,i){if(this.eventMap&&t&&w.isFunction(i)){var n=this.eventMap[t]||(this.eventMap[t]=new m);n.has(i)||n.add(i)}},i.prototype.once=function(t,i){var n=this;if(this.eventMap&&t&&w.isFunction(i)){var e=function(r){n.off(t,e),i(r)};this.on(t,e)}},i.prototype.off=function(t,i){!i&&this.offAll(t),i&&this.remove(t,i)},i.prototype.offAll=function(t){if(this.eventMap){var i,n=this.eventMap;if(t)this.remove(t,null);else for(i in n)this.remove(i,null)}},i.prototype.hasListenerFor=function(t){return!(!this.eventMap||!this.eventMap[t]||this.eventMap[t].empty)},i.prototype.emit=function(t,i){void 0===i&&(i=null);var n=new b(t,this,i);this.dispatchEvt(n)},i.prototype.dispatchEvt=function(t){this.eventMap&&this.eventMap[t.type]&&this.eventMap[t.type].forEach((function(i){return i(t)}))},i.prototype.remove=function(t,i){void 0===i&&(i=null),this.eventMap&&this.eventMap[t]&&(i?this.eventMap[t].delete(i):this.eventMap[t].clear())},i}(v),E=((y={})[t.LogLevel.OFF]=0,y[t.LogLevel.ERROR]=100,y[t.LogLevel.WARN]=200,y[t.LogLevel.INFO]=300,y[t.LogLevel.DEBUG]=400,y),j=function(i){function n(n){var e=i.call(this,n)||this;return e.useConsole=!1,e.useConsole=w.isObject(console),e.id=n.id||w.uid8(),e.tzero=Date.now(),e.logLevel=w.isEmpty(e.opts.logLevel)?t.LogLevel.OFF:e.opts.logLevel,e}return u(n,i),n.error=function(t){console&&console.error(t)},n.warn=function(t){console&&console.warn(t)},n.log=function(t){console&&console.log(t)},n.deprecated=function(t){n.deprecatedCounts[t]>=n.maxDeprecatedWarnings||(n.warn(t),n.deprecatedCounts[t]=(n.deprecatedCounts[t]||0)+1)},Object.defineProperty(n.prototype,"logLevel",{get:function(){return this.pLogLevel},set:function(t){this.pLogLevel=t},enumerable:!1,configurable:!0}),n.prototype.assert=function(t,i){t||this.error('Assertion failed! - "'.concat(i||"",'"'))},n.prototype.log=function(t){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];for(var r=0,s=i.length;r<s;r++)this.emit(n.LOG_EVENT,this.assembleEvent(i[r],t));this.shouldLog(t)&&(i.unshift(this.getStamp()),console.log.apply(console,i))},n.prototype.dir=function(t,i,e){var r=e||"Unnamed Object";this.emit(n.LOG_EVENT,this.assembleEvent(i,t,r)),this.shouldLog(t)&&(console.log(this.getStamp()+" Object: ".concat(r)),console.dir(i))},n.prototype.error=function(i){this.emit(n.LOG_EVENT,this.assembleEvent(i,t.LogLevel.ERROR)),this.shouldLog(t.LogLevel.ERROR)&&console.error(this.getStamp()+i)},n.prototype.warn=function(i){this.emit(n.LOG_EVENT,this.assembleEvent(i,t.LogLevel.WARN)),this.shouldLog(t.LogLevel.WARN)&&console.warn(this.getStamp()+i)},n.prototype.assembleEvent=function(t,i,n){return void 0===n&&(n=null),{item:t,id:this.id,level:i,label:n}},n.prototype.shouldLog=function(t){return this.useConsole&&E[this.pLogLevel]>=E[t]},n.prototype.getStamp=function(){return"[".concat(this.id+"]  "+w.msToHms(Date.now()-this.tzero)," > ")},n.LOG_EVENT="logEvent",n.maxDeprecatedWarnings=1,n.deprecatedCounts={},n}(T),N=function(){function t(){}return Object.defineProperty(t,"TIMEOUT",{get:function(){return 5e3},enumerable:!1,configurable:!0}),t}(),S=function(t){function i(i){var n=t.call(this,i)||this;n.retryCount=0,n.limit=0,n.retryIntervals=null;var e=n.opts.errorRecovery;return e&&!isNaN(e.retryAttempts)&&e.retryAttempts>0&&(n.limit=e.retryAttempts),e&&e.retryIntervals&&Array.isArray(e.retryIntervals)&&(n.retryIntervals=e.retryIntervals),n}return u(i,t),i.prototype.shouldRetry=function(){return this.limit&&!this.atLimit},i.prototype.incrementAttempts=function(){this.retryCount++},Object.defineProperty(i.prototype,"retryLimit",{get:function(){return this.limit},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"atLimit",{get:function(){return this.retryCount==this.limit},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"retryInterval",{get:function(){return this.retryIntervals&&this.retryIntervals[this.retryCount-1]||300*this.retryCount},enumerable:!1,configurable:!0}),i}(T),R=function(t){function i(n){var e=this,r=w.assign({timeout:N.TIMEOUT},n||{});r.timeout||(r.timeout=N.TIMEOUT),(e=t.call(this,r)||this).timeoutHandles={},e.map={};var s=e.hasListenerFor(i.event.COMPLETE);if(e.opts.url&&s)e.loadScript(e.opts.url);else{if(!e.opts.urls||!s)throw new Error("Script load error: Missing url or listener. url: ".concat(e.opts.url||e.opts.urls,", hasListener: ").concat(s));e.loadScripts(e.opts.urls)}return e}return u(i,t),i.load=function(t){return new Promise((function(n,e){t.onComplete=function(t){var i=t.data;return i.error||i.timedOut?e(i):n(i)},new i(t)}))},i.prototype.destroy=function(){if(this.timeoutHandles){for(var i in this.timeoutHandles)clearTimeout(this.timeoutHandles[i]);this.timeoutHandles=null,t.prototype.destroy.call(this)}},i.prototype.loadScript=function(t,n){var e=this,r=document.createElement("script"),s="https:"===window.location.protocol?t.replace("http:","https:"):t;this.map[s]={hLoad:function(){return e.hLoadOrError(s)},hError:function(){return e.hLoadOrError(s,!0,!1)},scriptEl:r};var u=this.map[s];n&&this.on(i.event.COMPLETE,n),r.async=!0,r.addEventListener("load",u.hLoad),r.addEventListener("error",u.hError),this.timeoutHandles[s]=setTimeout((function(){return e.hLoadOrError(s,!0,!0)}),this.opts.timeout),document.head.appendChild(r),r.src=s},i.prototype.loadScripts=function(t,n){n&&this.on(i.event.COMPLETE,n);for(var e=0,r=t.length;e<r;e++)this.loadScript(t[e])},i.prototype.hLoadOrError=function(t,n,e){var r=this;clearTimeout(this.timeoutHandles[t]),delete this.timeoutHandles[t];var s=this.map[t];for(var u in s.scriptEl.removeEventListener("load",s.hLoad),s.scriptEl.removeEventListener("error",s.hError),s)delete s[u];delete this.map[t],n&&this.shouldRetry()?(this.incrementAttempts(),setTimeout((function(){r.loadScript(t)}),this.retryInterval)):this.emit(i.event.COMPLETE,{url:t,error:n,timedOut:!0===e})},i.event={COMPLETE:"complete"},i}(S);t.Browser=void 0,(k=t.Browser||(t.Browser={})).ANDROID="Android",k.CHROME="Chrome",k.CHROME_IOS="Chrome-iOS",k.FIREFOX="Firefox",k.FIREFOX_IOS="Firefox-iOS",k.EDGE="Edge",k.MSIE="MSIE",k.SAFARI="Safari",k.OPERA="Opera",k.OPERA_MOBILE="Opera-Mobile",k.SILK="Silk",k.PLAYSTATION_4_WEBMAF="PlayStation 4 (WebMAF)",k.PLAYSTATION_5="PlayStation 5 (Media Source API)",k.UNKNOWN="Unknown",function(t){t.ARRAY_BUFFER="arraybuffer",t.TEXT="text",t.JSON="json",t.DOCUMENT="document",t.DEFAULT=""}(O||(O={}));var I={exports:{}},C=function(t,i){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];return t.apply(i,n)}},P=C,_=Object.prototype.toString;function D(t){return"[object Array]"===_.call(t)}function M(t){return void 0===t}function x(t){return null!==t&&"object"==typeof t}function L(t){if("[object Object]"!==_.call(t))return!1;var i=Object.getPrototypeOf(t);return null===i||i===Object.prototype}function V(t){return"[object Function]"===_.call(t)}function B(t,i){if(null!=t)if("object"!=typeof t&&(t=[t]),D(t))for(var n=0,e=t.length;n<e;n++)i.call(null,t[n],n,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&i.call(null,t[r],r,t)}var U={isArray:D,isArrayBuffer:function(t){return"[object ArrayBuffer]"===_.call(t)},isBuffer:function(t){return null!==t&&!M(t)&&null!==t.constructor&&!M(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:x,isPlainObject:L,isUndefined:M,isDate:function(t){return"[object Date]"===_.call(t)},isFile:function(t){return"[object File]"===_.call(t)},isBlob:function(t){return"[object Blob]"===_.call(t)},isFunction:V,isStream:function(t){return x(t)&&V(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:B,merge:function t(){var i={};function n(n,e){L(i[e])&&L(n)?i[e]=t(i[e],n):L(n)?i[e]=t({},n):D(n)?i[e]=n.slice():i[e]=n}for(var e=0,r=arguments.length;e<r;e++)B(arguments[e],n);return i},extend:function(t,i,n){return B(i,(function(i,e){t[e]=n&&"function"==typeof i?P(i,n):i})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}},F=U;function K(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Q=function(t,i,n){if(!i)return t;var e;if(n)e=n(i);else if(F.isURLSearchParams(i))e=i.toString();else{var r=[];F.forEach(i,(function(t,i){null!=t&&(F.isArray(t)?i+="[]":t=[t],F.forEach(t,(function(t){F.isDate(t)?t=t.toISOString():F.isObject(t)&&(t=JSON.stringify(t)),r.push(K(i)+"="+K(t))})))})),e=r.join("&")}if(e){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+e}return t},H=U;function q(){this.handlers=[]}q.prototype.use=function(t,i){return this.handlers.push({fulfilled:t,rejected:i}),this.handlers.length-1},q.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},q.prototype.forEach=function(t){H.forEach(this.handlers,(function(i){null!==i&&t(i)}))};var z=q,W=U,G=function(t){return!(!t||!t.t)},X=U,Y=function(t,i,n,e,r){return t.config=i,n&&(t.code=n),t.request=e,t.response=r,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t},$=function(t,i,n,e,r){var s=new Error(t);return Y(s,i,n,e,r)},Z=$,J=U,tt=J.isStandardBrowserEnv()?{write:function(t,i,n,e,r,s){var u=[];u.push(t+"="+encodeURIComponent(i)),J.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),J.isString(e)&&u.push("path="+e),J.isString(r)&&u.push("domain="+r),!0===s&&u.push("secure"),document.cookie=u.join("; ")},read:function(t){var i=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},it=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)},nt=function(t,i){return i?t.replace(/\/+$/,"")+"/"+i.replace(/^\/+/,""):t},et=U,rt=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],st=U,ut=st.isStandardBrowserEnv()?function(){var t,i=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function e(t){var e=t;return i&&(n.setAttribute("href",e),e=n.href),n.setAttribute("href",e),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=e(window.location.href),function(i){var n=st.isString(i)?e(i):i;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0},ot=U,at=function(t,i,n){var e=n.config.validateStatus;n.status&&e&&!e(n.status)?i(Z("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)},ct=tt,ht=Q,lt=function(t,i){return t&&!it(i)?nt(t,i):i},ft=function(t){var i,n,e,r={};return t?(et.forEach(t.split("\n"),(function(t){if(e=t.indexOf(":"),i=et.trim(t.substr(0,e)).toLowerCase(),n=et.trim(t.substr(e+1)),i){if(r[i]&&rt.indexOf(i)>=0)return;r[i]="set-cookie"===i?(r[i]?r[i]:[]).concat([n]):r[i]?r[i]+", "+n:n}})),r):r},dt=ut,vt=$,bt=function(t){return new Promise((function(i,n){var e=t.data,r=t.headers;ot.isFormData(e)&&delete r["Content-Type"];var s=new XMLHttpRequest;if(t.auth){var u=t.auth.username||"",o=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";r.Authorization="Basic "+btoa(u+":"+o)}var a=lt(t.baseURL,t.url);if(s.open(t.method.toUpperCase(),ht(a,t.params,t.paramsSerializer),!0),s.timeout=t.timeout,s.onreadystatechange=function(){if(s&&4===s.readyState&&(0!==s.status||s.responseURL&&0===s.responseURL.indexOf("file:"))){var e="getAllResponseHeaders"in s?ft(s.getAllResponseHeaders()):null,r={data:t.responseType&&"text"!==t.responseType?s.response:s.responseText,status:s.status,statusText:s.statusText,headers:e,config:t,request:s};at(i,n,r),s=null}},s.onabort=function(){s&&(n(vt("Request aborted",t,"ECONNABORTED",s)),s=null)},s.onerror=function(){n(vt("Network Error",t,null,s)),s=null},s.ontimeout=function(){var i="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(i=t.timeoutErrorMessage),n(vt(i,t,"ECONNABORTED",s)),s=null},ot.isStandardBrowserEnv()){var c=(t.withCredentials||dt(a))&&t.xsrfCookieName?ct.read(t.xsrfCookieName):void 0;c&&(r[t.xsrfHeaderName]=c)}if("setRequestHeader"in s&&ot.forEach(r,(function(t,i){void 0===e&&"content-type"===i.toLowerCase()?delete r[i]:s.setRequestHeader(i,t)})),ot.isUndefined(t.withCredentials)||(s.withCredentials=!!t.withCredentials),t.responseType)try{s.responseType=t.responseType}catch(i){if("json"!==t.responseType)throw i}"function"==typeof t.onDownloadProgress&&s.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&s.upload&&s.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){s&&(s.abort(),n(t),s=null)})),e||(e=null),s.send(e)}))},At=U,mt=function(t,i){X.forEach(t,(function(n,e){e!==i&&e.toUpperCase()===i.toUpperCase()&&(t[i]=n,delete t[e])}))},gt={"Content-Type":"application/x-www-form-urlencoded"};function pt(t,i){!At.isUndefined(t)&&At.isUndefined(t["Content-Type"])&&(t["Content-Type"]=i)}var yt,kt={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(yt=bt),yt),transformRequest:[function(t,i){return mt(i,"Accept"),mt(i,"Content-Type"),At.isFormData(t)||At.isArrayBuffer(t)||At.isBuffer(t)||At.isStream(t)||At.isFile(t)||At.isBlob(t)?t:At.isArrayBufferView(t)?t.buffer:At.isURLSearchParams(t)?(pt(i,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):At.isObject(t)?(pt(i,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300}};kt.headers={common:{Accept:"application/json, text/plain, */*"}},At.forEach(["delete","get","head"],(function(t){kt.headers[t]={}})),At.forEach(["post","put","patch"],(function(t){kt.headers[t]=At.merge(gt)}));var Ot=kt,wt=U,Tt=function(t,i,n){return W.forEach(n,(function(n){t=n(t,i)})),t},Et=G,jt=Ot;function Nt(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var St=U,Rt=function(t,i){i=i||{};var n={},e=["url","method","data"],r=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],u=["validateStatus"];function o(t,i){return St.isPlainObject(t)&&St.isPlainObject(i)?St.merge(t,i):St.isPlainObject(i)?St.merge({},i):St.isArray(i)?i.slice():i}function a(e){St.isUndefined(i[e])?St.isUndefined(t[e])||(n[e]=o(void 0,t[e])):n[e]=o(t[e],i[e])}St.forEach(e,(function(t){St.isUndefined(i[t])||(n[t]=o(void 0,i[t]))})),St.forEach(r,a),St.forEach(s,(function(e){St.isUndefined(i[e])?St.isUndefined(t[e])||(n[e]=o(void 0,t[e])):n[e]=o(void 0,i[e])})),St.forEach(u,(function(e){e in i?n[e]=o(t[e],i[e]):e in t&&(n[e]=o(void 0,t[e]))}));var c=e.concat(r).concat(s).concat(u),h=Object.keys(t).concat(Object.keys(i)).filter((function(t){return-1===c.indexOf(t)}));return St.forEach(h,a),n},It=U,Ct=Q,Pt=z,_t=function(t){return Nt(t),t.headers=t.headers||{},t.data=Tt(t.data,t.headers,t.transformRequest),t.headers=wt.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),wt.forEach(["delete","get","head","post","put","patch","common"],(function(i){delete t.headers[i]})),(t.adapter||jt.adapter)(t).then((function(i){return Nt(t),i.data=Tt(i.data,i.headers,t.transformResponse),i}),(function(i){return Et(i)||(Nt(t),i&&i.response&&(i.response.data=Tt(i.response.data,i.response.headers,t.transformResponse))),Promise.reject(i)}))},Dt=Rt;function Mt(t){this.defaults=t,this.interceptors={request:new Pt,response:new Pt}}Mt.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=Dt(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var i=[_t,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){i.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){i.push(t.fulfilled,t.rejected)}));i.length;)n=n.then(i.shift(),i.shift());return n},Mt.prototype.getUri=function(t){return t=Dt(this.defaults,t),Ct(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},It.forEach(["delete","get","head","options"],(function(t){Mt.prototype[t]=function(i,n){return this.request(Dt(n||{},{method:t,url:i,data:(n||{}).data}))}})),It.forEach(["post","put","patch"],(function(t){Mt.prototype[t]=function(i,n,e){return this.request(Dt(e||{},{method:t,url:i,data:n}))}}));var xt=Mt;function Lt(t){this.message=t}Lt.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Lt.prototype.t=!0;var Vt=Lt,Bt=Vt;function Ut(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var i;this.promise=new Promise((function(t){i=t}));var n=this;t((function(t){n.reason||(n.reason=new Bt(t),i(n.reason))}))}Ut.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},Ut.source=function(){var t;return{token:new Ut((function(i){t=i})),cancel:t}};var Ft=Ut,Kt=U,Qt=C,Ht=xt,qt=Rt;function zt(t){var i=new Ht(t),n=Qt(Ht.prototype.request,i);return Kt.extend(n,Ht.prototype,i),Kt.extend(n,i),n}var Wt=zt(Ot);Wt.Axios=Ht,Wt.create=function(t){return zt(qt(Wt.defaults,t))},Wt.Cancel=Vt,Wt.CancelToken=Ft,Wt.isCancel=G,Wt.all=function(t){return Promise.all(t)},Wt.spread=function(t){return function(i){return t.apply(null,i)}},Wt.isAxiosError=function(t){return"object"==typeof t&&!0===t.isAxiosError},I.exports=Wt,I.exports.default=Wt;var Gt=I.exports,Xt=function(){function t(){}return t.create=function(t){return{url:t.url||"",method:t.method||"get",timeout:t.timeout||N.TIMEOUT,headers:t.headers||{},data:this.getBody(t.data,t.encodeList,t.sendJson),withCredentials:!0===t.withCredentials,responseType:t.responseType||O.JSON,onComplete:t.onComplete||null,errorRecovery:t.errorRecovery||null}},t.getBody=function(t,i,n){if(void 0===n&&(n=!1),!t)return null;if("string"==typeof t)return t;if(!Object.keys(t).length)return null;var e=Array.isArray(i)&&i.length;for(var r in!e&&(i=[]),t)t[r]=this.getValue(r,t[r],i);if(n)return JSON.stringify(t);var s,u="";for(var r in t)null!==(s=t[r])&&null!=s&&""!=s&&(u+="".concat(r,"=").concat(s,"&"));return u=u.substr(0,u.length-1)},t.getValue=function(t,i,n){return n.indexOf(t)>=0?encodeURIComponent(i):i},t}(),Yt=function(t){function i(i){var n=t.call(this,Xt.create(i))||this;return n.opts.url&&n.createXhr(),n}return u(i,t),i.load=function(t){return new Promise((function(n,e){var r=t;r.onComplete=function(t){var i=t.data;i.error||i.timedOut?e(i):n(i)},new i(r)}))},i.prototype.createXhr=function(){var t=this;Gt(this.opts).then((function(i){var n;(null===(n=i.headers["content-type"])||void 0===n?void 0:n.indexOf("application/smil"))>=0&&(i.data=t.processSmilResponse(i.data)),204!=i.status&&null===i.data?t.emitCompleteWithError("Unable to parse response.",i.config):setTimeout((function(){t.emitComplete(i)}),1)})).catch((function(n){if(t.shouldRetry())t.incrementAttempts(),setTimeout((function(){t.createXhr()}),t.retryInterval);else{var e=n.response||i.statusMessages[0];t.emitCompleteWithError(e,n.config)}}))},i.prototype.emitComplete=function(t){this.emit(i.event.COMPLETE,{response:t.data,contentType:t.headers["content-type"],error:!1})},i.prototype.emitCompleteWithError=function(t,n){var e=w.isString(t)?t:null,r=e?null:t;this.emit(i.event.COMPLETE,{status:r&&r.status,error:!0,url:n&&n.url||"not available",message:e||this.getMsg(r&&r.status||0,r&&r.data||null)})},i.prototype.getMsg=function(t,n){var e=i.statusMessages[""+t];return e||(e=w.isString(n)?n:"Unspecified error"),"XhrDataRequest error: "+e},i.prototype.processSmilResponse=function(t){var i=(new DOMParser).parseFromString(t,"application/xml");return i instanceof Document?i:null},i.event={COMPLETE:"complete"},i.statusMessages={0:"Request failed; blocked or timed out",500:"Server error encountered.",404:"Resource not found.",403:"Access denied."},i}(S),$t=function(){function t(){}return t.encode=function(t){if(w.isEmpty(t))return"";var i=w.entries(t).map((function(t){var i=t[0],n=t[1];return i+"="+encodeURIComponent(n)}));return i.join("&")},t.decode=function(t){var i={};return null==t||t.replace(/^[^?]*\?/,"").replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),(function(t,n,e,r){var s;try{s=w.isUndefined(r)?r:decodeURIComponent(r)}catch(t){s=r}i[decodeURIComponent(n)]=s})),i},t.parseValue=function(t){if(w.isUndefined(t))return!0;var i=t.toLowerCase();return"true"===i||"false"===i?"true"===i:"undefined"!==t?"null"===i?null:(i=parseFloat(t),isNaN(i)?t:i):void 0},t.parse=function(i){var n=t.decode(i);for(var e in n)n[e]=t.parseValue(n[e]);return n},t.append=function(i,n){return i+(w.includes(i,"?")?"&":"?")+t.encode(n)},t}();function Zt(t){return t.query&&(t.url=$t.append(t.url,t.query)),Yt.load(t).then((function(t){return t.response}))}var Jt,ti=function(){function t(){}return t.parseCaption=function(t,i,n){void 0===i&&(i=0),void 0===n&&(n={});var e=t.trim().split("\n"),r=/([0-9:.]+)\s*-->\s*([0-9:.]+)([^\n]*)/;try{r.test(e[0])||(i=parseInt(e.shift()));var s=e[0].match(r).slice(1),u=s[2],o=w.hmsToSec(s[0]),c=w.hmsToSec(s[1]),h=e.slice(1).join("\n");return null!=u&&u.replace(/\s*([A-Za-z]+)\s*:\s*([\w\-%]+)/g,(function(t,i,e){return n[i]=e})),a({id:i,startTime:o,endTime:c,text:h},n)}catch(t){return null}},t.parse=function(t){var i=this,n=(t=t.replace(/\r/g,"")).split("\n\n"),e=/^(WEBVTT|NOTE|STYLE)/;return n.reduce((function(t,n){if(!e.test(n)&&n){var r=i.parseCaption(n,t.length);r&&t.push(r)}return t}),[])},t}(),ii=function(){function t(t,i){this.url=t,this.cues=i}return t.prototype.getCueAt=function(t){return w.find(this.cues,(function(i){return i.startTime<=t&&i.endTime>=t}))},t.prototype.renderCueAt=function(i,n){t.renderThumbnail(this.getCueAt(i),n)},t.create=function(i){var n=document.createElement("a");n.href=i;var e=n.protocol+"//"+n.hostname,r=e+n.pathname.split("/").slice(0,-1).join("/")+"/";return Zt({url:i,responseType:O.TEXT}).then((function(n){var s=ti.parse(n);return s.forEach((function(t){var i=t.text.split("#"),n=i[0],s=i[1],u=n;/^(https?:)?\/\//.test(u)||(u=/^\//.test(u)?e+u:r+u);var o=s.split("="),a=o[0],c=o[1].split(","),h={backgroundImage:"url(".concat(u,")")},l={url:u};w.forEach(a,(function(t,i){var n=c[i];switch(t){case"w":l.width=parseInt(n),h.width="".concat(n,"px");break;case"h":l.height=parseInt(n),h.height="".concat(n,"px");break;case"x":l.x=parseInt(n),h.backgroundPositionX="-".concat(n,"px");break;case"y":l.y=parseInt(n),h.backgroundPositionY="-".concat(n,"px")}})),t.style=h,t.data=l})),new t(i,s)}))},t.renderThumbnail=function(t,i){(null==t?void 0:t.style)&&(null==i?void 0:i.style)&&w.assign(i.style,t.style)},t}(),ni=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.renderThumbnail=function(t,i){ii.renderThumbnail(t,i)},n.request=function(t){return Zt(t)},n.loadScript=function(t){return R.load(t)},n.smpteToVtt=function(i,e,r){return h(this,void 0,void 0,(function(){var s,u,o,a,c,h;return l(this,(function(l){switch(l.label){case 0:return[4,n.request({url:i,responseType:O.DOCUMENT})];case 1:if(s=l.sent(),!(u=s.querySelectorAll("tt body div p")).length)throw new Error("No cues found in ".concat(i));return o=r.browser===t.Browser.SAFARI?"middle":"center",a=r.browser===t.Browser.SAFARI?-1:0,c=void 0!==r.global.VTTCue,h=c?r.global.VTTCue:r.global.TextTrackCue,u.forEach((function(t,i,r){if(!n.isEmpty(t.textContent)){var s=t.textContent.replace(/(.*)<span.*tts:fontStyle="italic">(.*)<\/span>(.*)/g,"$1<i>$2</i>$3").replace(/(.*)<span.*tts:fontWeight="bold">(.*)<\/span>(.*)/g,"$1<b>$2</b>$3").replace(/(.*)<span.*tts:textDecoration="under">(.*)<\/span>(.*)/g,"$1<u>$2</u>$3"),u=n.getNumLines(s);t._lineCountPrev=t._lineCountPrev||0,t._lineCountNext=t._lineCountNext||0;for(var l=i+1,f=r[l],d=t.getAttribute("begin");(null==f?void 0:f.getAttribute("begin"))===d;)f._lineCountPrev=u+t._lineCountNext,t._lineCountNext+=n.getNumLines(f.textContent),f=r[++l];var v=new h(n.hmsToSec(d),n.hmsToSec(t.getAttribute("end")),s);if(v.align=t.getAttribute("tts:textAlign"),c){var b=t.querySelector("metadata");if(b){v.snapToLines=!0;var A=parseInt(b.getAttribute("cccol")),m=parseInt(b.getAttribute("ccrow")),g=Math.round(A/35*100);v.position=g;try{v.align=g<45?"start":g>55?"end":o}catch(t){v.align="center"}v.positionAlign=g<45?"line-left":g>55?"line-right":"center",v.line=m-17+a}}try{e.addCue(v)}catch(t){}}})),[2]}}))}))},n}(w);!function(t){t.ImaAd="ImaAd",t.DaiAd="DaiAd",t.System="System",t.MediaCapabilities="MediaCapabilities",t.Logging="Logging",t.Tracking="Tracking",t.TrackingService="TrackingService",t.AutoplayCapabilities="AutoplayCapabilities"}(Jt||(Jt={}));var ei,ri,si,ui,oi,ai=Object.freeze({env:"prod",playerVersion:"1.14.1",playerName:"Avia JS Video Player",buildTime:"12/6/2021"});t.AccessibilityAction=void 0,(ei=t.AccessibilityAction||(t.AccessibilityAction={})).ENTER_FULLSCREEN="enterFullScreen",ei.INCREASE_VOLUME="increaseVolume",ei.DECREASE_VOLUME="decreaseVolume",ei.SEEK_BACK="seekBack",ei.SEEK_FORWARD="seekForward",ei.TOGGLE_PLAY="togglePlay",ei.TOGGLE_TT="toggleTextTrack",ei.TOGGLE_MUTE="toggleMute",ei.PLAYLIST_NEXT="playListNext",ei.PLAYLIST_PREV="playListPrev",ei.STOP="stop",function(t){t.DIAGNOSTIC_PLUGIN="toggleDiagnosticPlugin",t.CONFIG_TO_CLIPBOARD="configToClipboard",t.CONFIG_TO_TEST_PAGE="configToTestPage"}(ri||(ri={})),t.NativePlugin=void 0,(si=t.NativePlugin||(t.NativePlugin={})).REPLAY="replay",si.DIAGNOSTIC="diagnostic",si.UI="ui",si.GAM="gam",function(t){t.SPACE=" ",t.ENTER="Enter",t.TAB="Tab",t.CONTROL="Control",t.SHIFT="Shift",t.ESCAPE="Escape",t.META="Meta",t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight",t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown"}(ui||(ui={})),t.PluginPriority=void 0,(oi=t.PluginPriority||(t.PluginPriority={})).LOW="low",oi.HIGH="high";var ci,hi,li,fi,di,vi,bi=37,Ai=38,mi=39,gi=40,pi=32,yi=67,ki=68,Oi=70,wi=77,Ti=84,Ei=109,ji=179,Ni=173,Si=178,Ri=175,Ii=183,Ci=174,Pi=182,_i=176,Di=177,Mi=function(){function i(){}return i.blankVideoUrl="https://vidtech.cbsinteractive.com/h5/blanks/uvp_blank.mp4",i.blankDataUrl="data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=",i.userKeyCmdDefs=[{action:ri.DIAGNOSTIC_PLUGIN,primaryKey:"d",keyCode:ki,requireCtrl:!0,requireShift:!0},{action:ri.CONFIG_TO_CLIPBOARD,primaryKey:"c",keyCode:yi,requireCtrl:!0,requireShift:!0},{action:ri.CONFIG_TO_TEST_PAGE,primaryKey:"t",keyCode:Ti,requireCtrl:!0,requireShift:!0}],i.accessibilityKeyCmdDefs=[{action:t.AccessibilityAction.ENTER_FULLSCREEN,primaryKey:"f",keyCode:Oi},{action:t.AccessibilityAction.INCREASE_VOLUME,primaryKey:ui.ARROW_UP,keyCode:Ai},{action:t.AccessibilityAction.INCREASE_VOLUME,primaryKey:null,keyCode:Ri},{action:t.AccessibilityAction.INCREASE_VOLUME,primaryKey:null,keyCode:Ii},{action:t.AccessibilityAction.DECREASE_VOLUME,primaryKey:ui.ARROW_DOWN,keyCode:gi},{action:t.AccessibilityAction.DECREASE_VOLUME,primaryKey:null,keyCode:Ci},{action:t.AccessibilityAction.DECREASE_VOLUME,primaryKey:null,keyCode:Pi},{action:t.AccessibilityAction.SEEK_BACK,primaryKey:ui.ARROW_LEFT,keyCode:bi},{action:t.AccessibilityAction.SEEK_FORWARD,primaryKey:ui.ARROW_RIGHT,keyCode:mi},{action:t.AccessibilityAction.TOGGLE_PLAY,primaryKey:ui.SPACE,keyCode:pi},{action:t.AccessibilityAction.TOGGLE_PLAY,primaryKey:null,keyCode:ji},{action:t.AccessibilityAction.TOGGLE_MUTE,primaryKey:"m",keyCode:wi},{action:t.AccessibilityAction.TOGGLE_MUTE,primaryKey:"-",keyCode:Ei},{action:t.AccessibilityAction.TOGGLE_MUTE,primaryKey:null,keyCode:Ni},{action:t.AccessibilityAction.TOGGLE_TT,primaryKey:"c",keyCode:yi},{action:t.AccessibilityAction.STOP,primaryKey:null,keyCode:Si},{action:t.AccessibilityAction.PLAYLIST_NEXT,primaryKey:null,keyCode:_i},{action:t.AccessibilityAction.PLAYLIST_PREV,primaryKey:null,keyCode:Di}],i.nativePluginConfig=w.values(t.NativePlugin).reduce((function(i,n){return i[n]={name:n,url:"https://vidtech.cbsinteractive.com/avia-js/".concat(ai.playerVersion,"/plugins/").concat(n,"/avia.").concat(n,".min.js"),factory:function(){for(var t,i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return(t=avia[n]).create.apply(t,i)},priority:t.PluginPriority.HIGH},i}),{}),i.messages={ABR_UNAVAILABLE:"Single bitrate stream detected, adaptive bitrate system is unavailable",ABR_MANUAL_SWITCHING_REACHED_LOWER_BOUNDS:"You have reached the lowest available quality for this presentation.",ABR_MANUAL_SWITCHING_REACHED_UPPER_BOUNDS:"You have reached the highest available quality for this presentation at this screen size",ABR_MIN_BITRATE_RESTRICTION_UNAVAILABLE:"Min bitrate restrictions are not offered with this streaming library",AD_STALLED:"Stalled ad detected",ADAPTER_UNAVAILABLE:"Unable to play the requested resource - mediaUrl not recognized",ADAPTER_LIB_UNAVAILABLE:"Unable to play the requested resource - External library is not loading",ADAPTER_NOT_FOUND:"Unable to find an adapater for the requested resource",CAP_LEVEL_MAXBITRATE:"Max bitrate setting will be ignored since capQualityToPlayerSize is enabled",CMS_RESOURCE_UNAVAILABLE:"Resource unavailable",CMS_UNKNOWN:"CMS not supported",CONTENT_PLAYBACK_SETTING_IGNORED:"This API is only available after the CONTENT_START event has been dispatched. This setting will be ignored.",DAI_MISSING_ASSET_URL:"Unexpected condition: valid assetUrl not found in DAI stream data",DAI_SDK_UNAVAILABLE:"A DAI SDK is required for playback, but is not found",ENVIRONMENT_NOT_SUPPORTED:'Unable to locate a global "window" object or suitable alternative',FAIRPLAY_LICENSE_ERROR:"Issue with fairplay DRM and the provided license acquisition url",FAIRPLAY_APP_CERT_ERROR:"Issue creating a fairplay keysession with the provided application certificate",FAIRPLAY_NO_CONTENT_ID:"A valid content or asset id was not detected when creating fairplay drm session",FAIRPLAY_WEBKIT_ERROR:"Issue with webkit and keysession creations while using fairplay drm.",FATAL_PLAYBACK_MEDIA_ERROR:"Fatal media error, no option for recovery",FATAL_PLAYBACK_NETWORK_ERROR:"Fatal network error, no option for recovery",IMA_SDK_MISSING:"IMA SDK not found.",INVALID_PLAYLIST_INDEX:"Index provided to Playlist is out of range",INVALID_RESOURCE:"Resource configuration appears to be invalid",MANUAL_ABR_SWITCHING_UNAVAILABLE:"Native HTML5 Video does not allow manual bitrate switching",PAUSING_LINEAR_LIVE_STREAM_NOT_ALLOWED:"StreamType.LIVE is detected. Redirecting to the stop method since a DVR window is not detected.",PLUGIN_LOAD_ERROR:"Unable to load plugin from url",RESOURCE_MISSING:"Resource missing",RESOURCE_NOT_SUPPORTED:"Resource is not recognized or is currently unsupported",RETRY_PLAYBACK_MEDIA_ERROR:"Media error detected",RETRY_PLAYBACK_NETWORK_ERROR:"Network error detected",UNEXPECTED_CONDITION:"An unexpected condition was encountered",UNSPECIFIED_ERROR:"Unspecified error",VIDEO_PLAYBACK_UNAVAILABLE:"Unable to locate a video element or suitable alternative",WEBKIT_KEY_ADDED_SUCCESS:"Webkit key added successfully",WEBKIT_MEDIA_KEYS_NOT_SUPPORTED:"WebKitMediaKeys are not supported for this type of media on this user agent"},i}();function xi(t,i){return void 0===i&&(i=100),new Promise((function(n,e){var r=setInterval((function(){t()&&(clearInterval(r),n())}),i)}))}function Li(t,i,n,e){return void 0===n&&(n="error"),void 0===e&&(e=NaN),"number"==typeof n&&(e=n),new Promise((function(r,s){var u,o=[],a=function(){return o.forEach((function(t){return t()}))},c=function(i,n){var e=t.on?"on":"addEventListener",r=t.off?"off":"removeEventListener",s=function(t,n){clearTimeout(u),a(),i(n||t)};t[e](n,s),o.push((function(){return t[r](n,s)}))};c(r,i),"string"==typeof n&&c(s,n),e>-1&&(u=setTimeout((function(){a(),s(new Error("timeout"))}),e))}))}function Vi(t,i,n){return n||(n=t instanceof HTMLVideoElement?"currentTime":"contentTime"),xi((function(){return t[n]>=i}))}t.QualityMode=void 0,(ci=t.QualityMode||(t.QualityMode={})).AUTO="auto",ci.MANUAL="manual",ci.UNAVAILABLE="unavailable",function(t){t.METADATA_CUEPOINT="metadataCuepoint",t.TEXT_CUEPOINT="textCuepoint",t.TEXT_TRACK_DISPLAY_MODE_CHANGE="textTrackModeChange",t.TEXT_TRACK_ADDED="textTrackAdded",t.TEXT_TRACK_CHANGE="textTrackChange",t.TEXT_TRACK_AVAILABLE="textTrackAvailable"}(hi||(hi={})),function(t){t.SUBTITLES="subtitles",t.CAPTIONS="captions",t.METADATA="metadata",t.DESCRIPTIONS="descriptions",t.CHAPTERS="chapters"}(li||(li={})),function(t){t.ABORT="abort",t.CAN_PLAY="canplay",t.CAN_PLAY_THROUGH="canplaythrough",t.DURATION_CHANGE="durationchange",t.ENDED="ended",t.ERROR="error",t.LOADED_METADATA="loadedmetadata",t.LOAD_START="loadstart",t.PAUSE="pause",t.PLAY="play",t.PLAYING="playing",t.PROGRESS="progress",t.RATE_CHANGE="ratechange",t.SEEKED="seeked",t.SEEKING="seeking",t.STALLED="stalled",t.TIME_UPDATE="timeupdate",t.WEBKIT_NEED_KEY="webkitneedkey",t.VOLUME_CHANGE="volumechange",t.AUTOPLAY_BLOCKED="autoplayblocked"}(fi||(fi={})),t.TextTrackEvent=void 0,(di=t.TextTrackEvent||(t.TextTrackEvent={})).CUE_CHANGE="cuechange",di.ADD_TRACK="addtrack",di.CHANGE="change",t.TextTrackMode=void 0,(vi=t.TextTrackMode||(t.TextTrackMode={})).SHOWING="showing",vi.HIDDEN="hidden",vi.DISABLED="disabled";var Bi,Ui,Fi,Ki,Qi,Hi,qi,zi,Wi,Gi,Xi,Yi,$i,Zi,Ji,tn,nn,en,rn,sn,un,on,an=function(){function i(t,i){this.url=t,this.system=i,this.isVTTCueSupported=void 0!==this.system.global.VTTCue}return i.prototype.convert=function(){var t=this;return this.loadXml(this.url).then((function(i){var n=w.xmlToJson(i).tt.body.div.p;if((null==n?void 0:n.length)>0)return t.convertToVTTCues(n);throw new Error("No cues found in ".concat(t.url))}))},i.prototype.loadXml=function(t){return Zt({url:t,responseType:O.DOCUMENT})},i.prototype.convertToVTTCues=function(t){for(var i=[],n=0,e=t.length;n<e;n++){var r=t[n],s=r.text;if(!w.isEmpty(s)){s=(s=(s=s.replace(/(.*)<span.*tts:fontStyle="italic">(.*)<\/span>(.*)/g,"$1<i>$2</i>$3")).replace(/(.*)<span.*tts:fontWeight="bold">(.*)<\/span>(.*)/g,"$1<b>$2</b>$3")).replace(/(.*)<span.*tts:textDecoration="under">(.*)<\/span>(.*)/g,"$1<u>$2</u>$3");var u=w.getNumLines(s);r._lineCountPrev=r._lineCountPrev||0,r._lineCountNext=r._lineCountNext||0;for(var o=n+1,a=t[o];(a&&a.begin)===r.begin;)a._lineCountPrev=u+r._lineCountNext,r._lineCountNext+=w.getNumLines(a.text),a=t[++o];var c=new(this.isVTTCueSupported?this.system.global.VTTCue:this.system.global.TextTrackCue)(w.hmsToSec(r.begin),w.hmsToSec(r.end),s);this.isVTTCueSupported&&(c=this.metadataToPosition(r,c)),i.push(c)}}return i},i.prototype.metadataToPosition=function(t,i){var n=t.metadata;if(n){i.snapToLines=!0;var e=Math.round(n.cccol/35*100);i.position=e;try{i.align=e<45?"start":e>55?"end":this.getAlignString()}catch(t){i.align="center"}i.positionAlign=e<45?"line-left":e>55?"line-right":"center",i.line=n.ccrow-17+this.getLineOffset()}return i},i.prototype.getAlignString=function(){return this.system.browser===t.Browser.SAFARI?"middle":"center"},i.prototype.getLineOffset=function(){return this.system.browser===t.Browser.SAFARI?-1:0},i}(),cn=function(i){function n(n){var e=i.call(this)||this;return e.pTextTracks=null,e.currentTextTrack=null,e.currentTextTrackMode=t.TextTrackMode.DISABLED,e.allowTextTrackCueDispatch=!0,e.existingTrack=[],e.onVideoTextTrackAdded=function(t){t.track.expired=!1,e.onTextTrackAdded(t)},e.onTextTrackAdded=function(i){var n=i.track,r=n.kind==t.TextTrackKind.SUBTITLES&&!n.language&&!n.label;n.kind==t.TextTrackKind.METADATA||r||e.addTracks()},e.onTextTrackChange=function(t){e.processTracks()},e.onCueChange=function(i){var n=i.target;switch(n.kind){case li.CAPTIONS:case li.SUBTITLES:var r=w.dedupeCues(n);e.allowTextTrackCueDispatch&&n.mode===t.TextTrackMode.HIDDEN&&e.emit(hi.TEXT_CUEPOINT,{activeCues:r})}},e.system=n.system,e.config=n,e.video=n.video,e.pTextTracks=e.video.textTracks,e.currentTextTrackMode=n.textTrackSettings.mode,e.allowTextTrackCueDispatch=!n.textTrackSettings.native,e.processTracks=w.debounce(e.processTracks.bind(e),100),e.addTracks=w.debounce(e.addTracks.bind(e),25),e.addEvents(),e.logger=n.logger,e.logger.log(t.LogLevel.INFO,"TextTrackSurface created"),e}return u(n,i),n.prototype.destroy=function(){var t=this;this.removeEvents(),w.forEach(this.pTextTracks,(function(i){return t.cleanupTrack(i)})),w.forEach(this.video.querySelectorAll("track"),(function(i){return t.video.removeChild(i)})),i.prototype.destroy.call(this)},n.prototype.clearCue=function(){w.clearCue(this.currentTextTrack,this.video.currentTime)},n.prototype.cleanupTrack=function(i){if(this.isTextTrack(i.kind)){w.forEachReverse(i.cues,n),w.forEachReverse(i.activeCues,n),i.expired=!0,i.textTrack1=!0,i.textTrack2=!0,i.isTTML=!0,i.isEmbedded=!1;try{i.mode=t.TextTrackMode.DISABLED}catch(t){}}function n(t){try{t&&i.removeCue(t)}catch(t){}}},Object.defineProperty(n.prototype,"timeTextSrc",{set:function(t){t.indexOf(".vtt")>=0?this.createVttTextTrack(this.video,t):this.processSmpteTimedText(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackMode",{set:function(i){this.currentTextTrack?this.setTrackMode(i):this.logger.log(t.LogLevel.WARN,"No text track detected")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrack",{get:function(){return this.currentTextTrack},set:function(i){var n=this;this.isValidTrack(i)&&i!=this.currentTextTrack&&(this.currentTextTrack&&this.currentTextTrack.mode!==t.TextTrackMode.DISABLED&&(this.currentTextTrack.mode=t.TextTrackMode.DISABLED),this.currentTextTrack=i,this.setTrackMode(this.currentTextTrackMode).then((function(){n.logger.log(t.LogLevel.INFO,"".concat(i.language," is being set as the current text track")),n.emit(hi.TEXT_TRACK_CHANGE,i)})))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTracks",{get:function(){var t=this;return w.toArray(this.pTextTracks).filter((function(i){return t.isValidTrack(i)}))},enumerable:!1,configurable:!0}),n.prototype.setTrackMode=function(i){var n=this;return new Promise((function(e,r){var s=i!=n.currentTextTrackMode,u=function(){n.currentTextTrack.mode=i,s&&setTimeout((function(){return n.emit(hi.TEXT_TRACK_DISPLAY_MODE_CHANGE,{mode:i})}),0);var r=t.TextTrackMode.DISABLED;i===t.TextTrackMode.HIDDEN&&(r="enabled for event driven external custom rendering"),i===t.TextTrackMode.SHOWING&&(r="enabled for native rendering by the user agent"),n.logger.log(t.LogLevel.INFO,"The ".concat(n.currentTextTrack.kind," track for language code ").concat(n.currentTextTrack.language," is being ").concat(r," ")),e()};n.currentTextTrackMode=i,i===t.TextTrackMode.SHOWING&&n.currentTextTrack.mode===t.TextTrackMode.DISABLED?(n.currentTextTrack.mode=t.TextTrackMode.HIDDEN,setTimeout(u,10)):u()}))},n.prototype.addTrack=function(i){i.addEventListener(t.TextTrackEvent.CUE_CHANGE,this.onCueChange),this.logger.log(t.LogLevel.INFO,"A ".concat(i.kind," text track was added")),this.emit(hi.TEXT_TRACK_ADDED,i)},n.prototype.addTracks=function(){var i=this;if(w.forEach(this.pTextTracks,(function(n){var e=i.isExpired(n)||i.isDuplicateTrack(n);n.mode=e?t.TextTrackMode.DISABLED:t.TextTrackMode.HIDDEN,e||i.addTrack(n)})),!this.currentTextTrack){if(this.textTrack=w.findDefaultTrack(this.textTracks,this.config.textTrackSettings.language),!this.textTrack)return;this.textTrack.mode=this.config.textTrackSettings.mode,this.emit(hi.TEXT_TRACK_AVAILABLE)}this.processTracks()},n.prototype.processTracks=function(){var i=this,n=this.config.textTrackSettings,e=n.enabled,r=n.native,s=n.enabledMode,u=this.textTracks;if(w.forEach(this.pTextTracks,(function(n){i.isExpired(n)&&n.mode!=t.TextTrackMode.DISABLED&&(n.mode=t.TextTrackMode.DISABLED)})),r){var o=w.find(u,(function(i){return i.mode==t.TextTrackMode.SHOWING}));if(e){if(o==this.currentTextTrack)return;o?this.textTrack=o:this.textTrackMode=t.TextTrackMode.DISABLED}else{if(!o)return;o!=this.currentTextTrack&&(this.textTrack=o),this.textTrackMode=t.TextTrackMode.SHOWING}}else if(e){var a=w.find(u,(function(i){return i.mode==t.TextTrackMode.SHOWING}));a&&(a.mode=s)}else{var c=w.find(u,(function(i){return i.mode!=t.TextTrackMode.DISABLED}));c&&(c.mode=t.TextTrackMode.DISABLED)}},n.prototype.addEvents=function(){this.pTextTracks.addEventListener(t.TextTrackEvent.ADD_TRACK,this.onTextTrackAdded),this.pTextTracks.addEventListener(t.TextTrackEvent.CHANGE,this.onTextTrackChange),this.video.addEventListener(t.TextTrackEvent.ADD_TRACK,this.onVideoTextTrackAdded)},n.prototype.removeEvents=function(){var i=this;this.pTextTracks.removeEventListener(t.TextTrackEvent.ADD_TRACK,this.onTextTrackAdded),this.pTextTracks.removeEventListener(t.TextTrackEvent.CHANGE,this.onTextTrackChange),this.video.removeEventListener(t.TextTrackEvent.ADD_TRACK,this.onVideoTextTrackAdded),w.forEach(this.pTextTracks,(function(n){return n.removeEventListener(t.TextTrackEvent.CUE_CHANGE,i.onCueChange)}))},n.prototype.isDuplicateTrack=function(t){if(w.includes(this.existingTrack,t))return!1;var i=this.existingTrack.some((function(i){return t.language==i.language&&t.label==i.label&&t.kind==i.kind}));return i||this.existingTrack.push(t),i},n.prototype.isTextTrack=function(t){return t===li.CAPTIONS||t===li.SUBTITLES},n.prototype.isExpired=function(t){return t.expired},n.prototype.isValidTrack=function(t){return!!t&&(!!this.isTextTrack(t.kind)&&!this.isExpired(t))},n.prototype.createVttTextTrack=function(i,n){var e=document.createElement("track");e.kind=li.CAPTIONS,e.label="English",e.srclang="en",e.id="sidecar-vtt",e.src=n,i.appendChild(e),e.track.mode=t.TextTrackMode.DISABLED},n.prototype.processSmpteTimedText=function(i){var n=this;new an(i,this.system).convert().then((function(i){n.createSmpteTextTrack(n.video,i),n.logger.log(t.LogLevel.INFO,"Smpte XML conversion and text track creation successful")})).catch((function(i){n.logger.log(t.LogLevel.INFO,"Smpte XML conversion and text track creation error",i.message)}))},n.prototype.createSmpteTextTrack=function(i,n){try{var e=i.addTextTrack(li.CAPTIONS,"English","en");w.forEach(n,(function(t){return e.addCue(t)}))}catch(i){this.logger.log(t.LogLevel.INFO,i)}},n}(T),hn=function(i){function n(n,e){void 0===e&&(e=!0);var r=i.call(this)||this;return r.timeAtLastBufferCheck=NaN,r.textTrackSurface=null,r.pBuffering=!1,r.pSeeking=NaN,r.pVideoEventHandler=function(t){return r.onVideoElementEvent(t)},r.pTextTrackEventHandler=function(t){return r.onTextTrackSurfaceEvent(t)},r.pVideo=n.video,r.logger=n.logger,e&&(r.textTrackSurface=new cn(n)),r.logger.log(t.LogLevel.INFO,"Html5VideoSurface created"),r}return u(n,i),n.prototype.destroy=function(){this.removeEvents(),this.textTrackSurface&&this.textTrackSurface.destroy(),this.textTrackSurface=null,this.pVideo=null,i.prototype.destroy.call(this)},n.prototype.load=function(t){return h(this,void 0,void 0,(function(){return l(this,(function(i){switch(i.label){case 0:return[4,Li(this,fi.LOADED_METADATA)];case 1:return i.sent(),t?[4,this.seek(t)]:[2];case 2:return i.sent(),[2]}}))}))},n.prototype.play=function(){return h(this,void 0,void 0,(function(){var i;return l(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.pVideo.play()];case 1:return n.sent(),[3,3];case 2:return i=n.sent(),this.logger.warn("Exception caught in play() Promise: "+i.message,t.LogLevel.WARN),this.emit(fi.AUTOPLAY_BLOCKED,i),[3,3];case 3:return[2]}}))}))},n.prototype.pause=function(){this.pVideo&&this.pVideo.pause()},n.prototype.seek=function(t){return h(this,void 0,void 0,(function(){return l(this,(function(i){switch(i.label){case 0:return this.pVideo.currentTime=t,[4,Li(this,fi.SEEKED)];case 1:return i.sent(),[2]}}))}))},n.prototype.addEvents=function(){for(var t in fi)this.pVideo.addEventListener(fi[t],this.pVideoEventHandler);if(this.textTrackSurface)for(var t in hi)this.textTrackSurface.on(hi[t],this.pTextTrackEventHandler)},n.prototype.clearCue=function(){var t;null===(t=this.textTrackSurface)||void 0===t||t.clearCue()},Object.defineProperty(n.prototype,"video",{get:function(){return this.pVideo},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"src",{set:function(t){this.pVideo&&(this.pVideo.src=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"volume",{get:function(){return this.pVideo?this.pVideo.volume:null},set:function(t){this.pVideo&&(this.pVideo.volume=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"muted",{get:function(){return this.pVideo?this.pVideo.muted:null},set:function(t){this.pVideo&&(this.pVideo.muted=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"paused",{get:function(){return this.pVideo?this.pVideo.paused:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){return this.pVideo?this.pVideo.currentTime:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return this.pVideo?this.pVideo.duration:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackMode",{set:function(t){this.textTrackSurface&&(this.textTrackSurface.textTrackMode=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrack",{get:function(){return this.textTrackSurface.textTrack},set:function(t){this.textTrackSurface&&(this.textTrackSurface.textTrack=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackSrc",{set:function(t){this.textTrackSurface&&(this.textTrackSurface.timeTextSrc=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTracks",{get:function(){return this.textTrackSurface.textTracks},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bufferLength",{get:function(){var t=0;return this.pVideo&&this.pVideo.buffered.length>0&&(t=this.pVideo.buffered.end(this.pVideo.buffered.length-1)-this.pVideo.currentTime),t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"seeking",{get:function(){return!isNaN(this.pSeeking)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"buffering",{get:function(){if(!this.paused&&this.pVideo){var t=this.timeAtLastBufferCheck+.001;this.timeAtLastBufferCheck=this.pVideo.currentTime;var i=this.pVideo.currentTime<t;this.pBuffering=this.pVideo.readyState>=1&&i&&!this.seeking}return this.pBuffering},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"framerate",{get:function(){var t=this.pVideo.webkitDecodedFrameCount||this.pVideo.mozPresentedFrames||Number.NaN;return isNaN(t)?t:t/this.pVideo.currentTime},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"metrics",{get:function(){var t={droppedVideoFrames:Number.NaN,totalVideoFrames:Number.NaN};if(!this.pVideo)return t;var i="webkitDroppedFrameCount"in this.pVideo&&"webkitDecodedFrameCount"in this.pVideo;return"getVideoPlaybackQuality"in this.pVideo?t=this.pVideo.getVideoPlaybackQuality():i&&(t={droppedVideoFrames:this.pVideo.webkitDroppedFrameCount,totalVideoFrames:this.pVideo.webkitDroppedFrameCount+this.pVideo.webkitDecodedFrameCount}),t},enumerable:!1,configurable:!0}),n.prototype.onVideoElementEvent=function(t){switch(t.type){case fi.SEEKING:if(this.seeking)return;this.pSeeking=this.pVideo.currentTime+.001;break;case fi.SEEKED:if(!this.pVideo.paused)return;this.pSeeking=NaN;break;case fi.TIME_UPDATE:this.pSeeking<=this.pVideo.currentTime&&(this.pSeeking=NaN,this.emit(fi.SEEKED,t))}this.emit(t.type,t)},n.prototype.onTextTrackSurfaceEvent=function(t){this.emit(t.type,t.data)},n.prototype.removeEvents=function(){for(var t in fi)this.pVideo.removeEventListener(fi[t],this.pVideoEventHandler);if(this.textTrackSurface)for(var t in hi)this.textTrackSurface.on(hi[t],this.pTextTrackEventHandler)},n}(T),ln=function(){function i(n,e){var r,s=this;this.metadataTracks=[],this.id3Map=[],this.daiId3=/^google_/,this.maxId3DedupeLength=i.MAX_ID3_DEDUPE_LENGTH,this.onTextTrackAdded=function(i){var n=i.track;s.isValidTrack(n)&&(n.mode=t.TextTrackMode.HIDDEN,n.addEventListener(t.TextTrackEvent.CUE_CHANGE,s.onCueChange))},this.onCueChange=function(t){var i=t.target,n=i&&i.activeCues;n&&n.length&&w.forEach(n,(function(t){return s.processId3(t)}))},this.onSeeking=function(){s.clearId3()},this.onMetadataCuepoint=e,this.video=n.video,this.id3OwnerIds=["com.cbsi.live.sg"].concat(n.resource.playback.id3OwnerIds||[]);var u=null===(r=n.playerOptions.overrides)||void 0===r?void 0:r.maxId3DedupeLength;null!=u&&(this.maxId3DedupeLength=u),this.addEvents(),this.logger=n.logger,this.logger.log(t.LogLevel.INFO,"MetadataSurface created")}return i.prototype.destroy=function(){var t=this;this.onMetadataCuepoint=null,this.id3Map=null,this.removeEvents(),w.forEach(this.metadataTracks,(function(i){return t.cleanupTrack(i)}))},i.prototype.addEvents=function(){this.video.textTracks.addEventListener(t.TextTrackEvent.ADD_TRACK,this.onTextTrackAdded),this.video.addEventListener(fi.SEEKING,this.onSeeking)},i.prototype.removeEvents=function(){var i=this;this.video.textTracks.removeEventListener(t.TextTrackEvent.ADD_TRACK,this.onTextTrackAdded),this.video.removeEventListener(fi.SEEKING,this.onSeeking),w.forEach(this.metadataTracks,(function(n){return n.removeEventListener(t.TextTrackEvent.CUE_CHANGE,i.onCueChange)}))},i.prototype.clearId3=function(){this.id3Map=[]},i.prototype.cleanupTrack=function(i){function n(t){try{t&&i.removeCue(t)}catch(t){}}w.forEachReverse(i.cues,n),w.forEachReverse(i.activeCues,n),i.expired=!0,i.mode=t.TextTrackMode.DISABLED},i.prototype.processId3=function(t){if(!w.isEmpty(t.value)){var i=t.value,n=t.startTime,e=t.endTime,r=i.key,s=i.info,u=void 0===s?"":s,o=i.data,a={key:r,info:u,data:o,startTime:n,endTime:e};if("TXXX"===r&&this.daiId3.test(o)?(w.isEmpty(u)&&(a.info=o),a.id="google_dai"):a.id=w.find(this.id3OwnerIds,(function(t){return"*"===t||w.includes(u,t)})),a.id){var c;try{c=o instanceof ArrayBuffer?w.bufferToString(o):o}catch(t){c=""}"PRIV"===r&&this.id3OwnerIds[0]===u&&(a.data=c),a.text=c,this.id3Map.some((function(t){return t.info===a.info&&t.startTime==a.startTime&&t.text==a.text}))||(this.id3Map.length>this.maxId3DedupeLength&&this.id3Map.pop(),this.id3Map.unshift(a),this.onMetadataCuepoint(a))}}},i.prototype.isMetadataTrack=function(t){return t===li.METADATA},i.prototype.isExpired=function(t){return t.expired},i.prototype.isValidTrack=function(t){return!!t&&(!!this.isMetadataTrack(t.kind)&&!this.isExpired(t))},i.MAX_ID3_DEDUPE_LENGTH=32,i}(),fn=function(){function i(i,n,e){void 0===n&&(n={}),void 0===e&&(e=!0),this.multiCdnHeaderPresent=!0,this.liveStreamInfo={isPlayingLive:!1,liveEdgeOffset:NaN,dvrWindowSize:NaN,safeSeekingDuration:NaN,safeSeekingTime:NaN,relativeTime:NaN,relativeDuration:NaN,absoluteStart:NaN,absoluteTime:NaN,absoluteDuration:NaN},this.lastKnownTimes={absolute:NaN,relative:NaN,end:NaN},this.textTrackInfo={track:null,tracks:[]},this.qualityInfo={quality:null,qualities:[],mode:t.QualityMode.AUTO},this.audioTrackInfo={track:null,tracks:[]},this.context=i,this.options=n,this.delegate=this.context.getDelegate(),this.logger=i.logger,this.videoSurface=this.createVideoSurface(e),this.onSurfaceEvent=this.onSurfaceEvent.bind(this),this.videoSurface.addEvents()}return i.prototype.createVideoSurface=function(t){return void 0===t&&(t=!0),new hn(this.context,t)},i.prototype.createMetadataSurface=function(){return new ln(this.context,this.delegate.metadataCuepoint)},i.prototype.enableSurfaceEvents=function(t){var i=this,n=t?"on":"off";ni.values(fi).forEach((function(t){return i.videoSurface[n](t,i.onSurfaceEvent)})),ni.values(hi).forEach((function(t){return i.videoSurface[n](t,i.onSurfaceEvent)}))},i.prototype.onSurfaceEvent=function(t){switch(t.type){case fi.TIME_UPDATE:this.delegate.timeUpdate();break;case fi.PLAYING:this.delegate.playing();break;case fi.PAUSE:this.delegate.paused();break;case fi.SEEKING:this.delegate.seeking();break;case fi.SEEKED:this.delegate.seeked();break;case fi.ENDED:this.delegate.ended();break;case fi.DURATION_CHANGE:this.delegate.durationChange();break;case fi.VOLUME_CHANGE:this.delegate.volumeChange(t.data.target.volume,t.data.target.muted);break;case hi.TEXT_CUEPOINT:this.delegate.textCuepoints(t.data.activeCues);break;case hi.TEXT_TRACK_DISPLAY_MODE_CHANGE:this.delegate.textTrackDisplayModeChange(t.data.mode);break;case hi.TEXT_TRACK_ADDED:this.textTrackInfo.tracks.push(t.data);break;case hi.TEXT_TRACK_AVAILABLE:this.delegate.textTrackInfoChange(this.textTrackInfo);break;case hi.TEXT_TRACK_CHANGE:var i=t.data;this.textTrackInfo.track=i,this.delegate.textTrackChange(i)}},i.prototype.getSegmentDuration=function(){return 6},i.prototype.getSeekable=function(){var t={start:0,end:0},i=this.videoSurface.video.seekable,n=i.length-1;return n>=0&&(t.start=i.start(n),t.end=i.end(n)),t},i.prototype.getErrorMessage=function(t,i,n){return void 0===n&&(n="n/a"),"".concat(t," fatal: ").concat(i," retry: ").concat(n)},i.prototype.throwError=function(i,n,e,r){void 0===r&&(r=!0),this.logger.log(t.LogLevel.ERROR,n),this.delegate.error({code:i,message:n,data:e,fatal:r})},i.prototype.getIsLiveStream=function(){return this.getDuration()==1/0},i.prototype.setAutoQualitySwitching=function(t){throw new Error("setAutoQualitySwitching Method not implemented.")},i.prototype.setQuality=function(t){throw new Error("setQuality Method not implemented.")},i.prototype.setMinBitrate=function(t){},i.prototype.setMaxBitrate=function(t){},i.prototype.setTextTrack=function(t){this.videoSurface.textTrack=t},i.prototype.setTextTrackMode=function(t){this.videoSurface.textTrackMode=t},i.prototype.setAudioTrack=function(t){throw new Error("setAudioTrack Method not implemented.")},i.prototype.getType=function(){throw new Error("getType Method not implemented.")},i.prototype.getCurrentTime=function(){return this.videoSurface.time},i.prototype.getDuration=function(){return this.videoSurface.duration},i.prototype.getBufferLength=function(){return this.videoSurface.bufferLength},i.prototype.getLiveStreamInfo=function(){var t,i=this.liveStreamInfo,n=this.videoSurface.video,e=this.getSeekable(),r=e.start,s=e.end,u=n.currentTime,o=s-r,a=this.getSegmentDuration(),c=this.context.resource.playback.liveEdgeSyncFragmentCount,h=(null===(t=this.context.resource.overrides)||void 0===t?void 0:t.safeSeekDuration)||a;i.relativeTime=Math.max(u-r,0),i.relativeDuration=o,i.absoluteDuration=Date.now(),i.dvrWindowSize=Math.floor(o),i.liveEdgeOffset=a*c+a,i.safeSeekingTime=Math.ceil(r+h),i.safeSeekingDuration=Math.floor(s-h),i.isPlayingLive=Math.ceil(u+i.liveEdgeOffset)>=i.safeSeekingDuration,s!=this.lastKnownTimes.end&&(this.lastKnownTimes.end=s,i.absoluteStart=i.absoluteDuration-1e3*o,this.lastKnownTimes.absolute=Math.round(i.absoluteStart+1e3*i.relativeTime),this.lastKnownTimes.relative=u);var l=Math.round(1e3*(u-this.lastKnownTimes.relative));return i.absoluteTime=this.lastKnownTimes.absolute+l,i},i.prototype.destroy=function(){return h(this,void 0,void 0,(function(){return l(this,(function(t){return this.videoSurface.destroy(),[2]}))}))},i.prototype.load=function(){return h(this,void 0,void 0,(function(){return l(this,(function(t){return this.enableSurfaceEvents(!0),[2]}))}))},i.prototype.play=function(){return h(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this.videoSurface.video.play()];case 1:return t.sent(),[2]}}))}))},i.prototype.pause=function(){this.videoSurface.pause()},i.prototype.suspend=function(){},i.prototype.resume=function(){},i.prototype.seek=function(t){return h(this,void 0,void 0,(function(){return l(this,(function(i){switch(i.label){case 0:return[4,this.videoSurface.seek(t)];case 1:return i.sent(),[2]}}))}))},i.prototype.resize=function(){},i.prototype.clearText=function(){this.videoSurface.clearCue()},i.prototype.getMetrics=function(){return{droppedVideoFrames:NaN,framerate:NaN,bandwidth:NaN}},i.prototype.createSidecarTextTrack=function(i){return h(this,void 0,void 0,(function(){var n,e,r,s;return l(this,(function(u){if(n=i.indexOf(".vtt")>=0,e=this.context.video,r="English","en",n)(s=document.createElement("track")).kind=li.CAPTIONS,s.label=r,s.srclang="en",s.id="sidecar-vtt",s.src=i,e.appendChild(s),s.track.mode=this.context.textTrackSettings.mode;else try{s=e.addTextTrack(li.CAPTIONS,r,"en"),ni.smpteToVtt(i,s,this.context.system),this.logger.log(t.LogLevel.INFO,"Smpte XML conversion and text track creation successful")}catch(i){this.logger.log(t.LogLevel.INFO,"Smpte XML conversion and text track creation error",i.message)}return[2]}))}))},i}(),dn=function(t,i,n){this.key=t,this.value=i,this.type=n,this.timeStamp=Date.now()},vn=Object.freeze({__proto__:null,BaseClass:v,CoreEvent:b,Emitter:T,Logger:j,Metric:dn,request:Zt});t.ActiveState=void 0,(Bi=t.ActiveState||(t.ActiveState={})).ACTIVE="active",Bi.INACTIVE="inactive",Bi.IDLE="idle",t.AdapterRole=void 0,(Ui=t.AdapterRole||(t.AdapterRole={})).AD="ad",Ui.PLAYBACK="playback",t.AdBreakType=void 0,(Fi=t.AdBreakType||(t.AdBreakType={})).PRE="PRE",Fi.MID="MID",Fi.POST="POST",t.AdContext=void 0,(Ki=t.AdContext||(t.AdContext={})).IMA="ima",Ki.IMA_AD_ONLY="ima_ad_only",Ki.DAI_SDK="dai_sdk",Ki.DAI_API="dai_api",Ki.DAI_SSB="dai_ssb",Ki.NONE="",t.AdTechnology=void 0,(Qi=t.AdTechnology||(t.AdTechnology={})).SSAI="ssai",Qi.CSAI="csai",t.ApiMetric=void 0,(Hi=t.ApiMetric||(t.ApiMetric={})).PLAY="play",Hi.PAUSE="pause",Hi.SEEK="seek",Hi.GO_LIVE="go_live",t.Autoplay=void 0,(qi=t.Autoplay||(t.Autoplay={})).NONE="none",qi.ATTEMPT_MUTED="attemptMuted",qi.ATTEMPT_UNMUTED="attemptUnmuted",qi.ATTEMPT_UNMUTED_THEN_MUTED="attemptUnmutedThenMuted",t.Device=void 0,(zi=t.Device||(t.Device={})).DESKTOP="Desktop",zi.ANDROID_PHONE="Android Phone",zi.WINDOWS_PHONE="Windows Phone",zi.IPHONE="iPhone",zi.IPOD="iPod",zi.IPAD="iPad",zi.KINDLE="Kindle",zi.TABLET="Tablet",zi.MOBILE="Mobile",zi.EMBEDDED="Embedded",zi.LG_SMART_TV="LG Smart Tv",zi.VIZIO_SMART_TV="Vizio Smart Tv",zi.SAMSUNG_SMART_TV="Samsung Smart Tv",zi.COMCAST_X1="Comcast X1",zi.XBOX_ONE="Xbox One",zi.CHROMECAST="Chromecast",zi.PLAYSTATION_4="PlayStation 4",zi.PLAYSTATION_5="PlayStation 5",zi.UNKNOWN="UNKNOWN",t.ErrorCode=void 0,(Wi=t.ErrorCode||(t.ErrorCode={})).INVALID_RESOURCE_FORMAT="1000",Wi.RESOURCE_UNAVAILABLE="1100",Wi.GEO_LOCATION_BLOCKED="1101",Wi.DOMAIN_BLOCKED="1102",Wi.IP_BLOCKED="1103",Wi.SATELLITE_PROVIDER_BLOCKED="1104",Wi.EXPIRED="1105",Wi.SELECTOR_CALL_ERROR="1106",Wi.IMA_SDK_MISSING="1200",Wi.DAI_SDK_MISSING="1201",Wi.DASH_SDK_MISSING="1202",Wi.HLS_SDK_MISSING="1203",Wi.SHAKA_SDK_MISSING="1204",Wi.TWITCH_SDK_MISSING="1205",Wi.HLSJS_PARSE_ERROR="2101",Wi.DASHJS_PARSE_ERROR="2102",Wi.SHAKA_PARSE_ERROR="2103",Wi.TWITCH_PARSE_ERROR="2104",Wi.WEBMAF_START_ERROR="2105",Wi.USER_GESTURE_REQUIRED="2300",Wi.HTML5_NETWORK_ERROR="3001",Wi.HLSJS_NETWORK_ERROR="3002",Wi.DASHJS_NETWORK_ERROR="3003",Wi.WEBMAF_NETWORK_ERROR="3004",Wi.SHAKA_NETWORK_ERROR="3005",Wi.TWITCH_NETWORK_ERROR="3006",Wi.MEDIA_ABORTED="3100",Wi.HTML5_SRC_NOT_SUPPORTED="3101",Wi.HLSJS_SRC_NOT_SUPPORTED="3102",Wi.DASHJS_SRC_NOT_SUPPORTED="3103",Wi.SHAKA_SRC_NOT_SUPPORTED="3105",Wi.TWITCH_SRC_NOT_SUPPORTED="3106",Wi.HTML5_MEDIA_ERROR="3200",Wi.HLSJS_MEDIA_ERROR="3201",Wi.HLSJS_MUX_ERROR="3202",Wi.DASHJS_MEDIA_ERROR="3203",Wi.SHAKA_MEDIA_ERROR="3205",Wi.TWITCH_MEDIA_ERROR="3206",Wi.FAIRPLAY_APP_CERT_ERROR="3300",Wi.FAIRPLAY_LIC_ERROR="3301",Wi.DASHJS_DRM_ERROR="3302",Wi.SHAKA_DRM_ERROR="3304",Wi.UNSPECIFIED_VIDEO_PLAYBACK_ERROR="3400",Wi.UNSPECIFIED_HLSJS_ERROR="3401",Wi.UNSPECIFIED_DASHJS_ERROR="3402",Wi.UNSPECIFIED_SHAKA_ERROR="3404",Wi.UNSPECIFIED_TWITCH_ERROR="3405",Wi.AD_STALLED="4000",Wi.IMA_INIT_FAILURE="4100",Wi.IMA_AD_ERROR="4101",Wi.DAI_DATA_ERROR="4200",Wi.DAI_NETWORK_ERROR="4201",Wi.AD_BLOCKING_DETECTED="4300",Wi.AD_ADAPTER_ERROR="4400",Wi.UNEXPECTED_CONDITION="9999",t.Header=void 0,(t.Header||(t.Header={})).MULTI_CDN="x-cdn",t.HookType=void 0,(Gi=t.HookType||(t.HookType={})).EVENT="event",Gi.AD_BREAK="adbreak",Gi.AD="ad",t.KeyboardScope=void 0,(Xi=t.KeyboardScope||(t.KeyboardScope={})).NONE="none",Xi.DOCUMENT="document",Xi.PLAYER="player",t.LocalizationId=void 0,(t.LocalizationId||(t.LocalizationId={})).MEDIA_PLAYER="media-player",t.LocalizedLanguage=void 0,(Yi=t.LocalizedLanguage||(t.LocalizedLanguage={})).EN="English",Yi.ES="Español",Yi.FR="Français",Yi.PT="Português",Yi.DE="Deutsche",Yi.PL="Polski",Yi.JA="日本人",Yi.KO="한국어",Yi.ZH="简体中文",Yi.IT="Italiano",Yi.RU="Русский",t.MetricType=void 0,($i=t.MetricType||(t.MetricType={})).API="api",$i.UI="ui",t.Os=void 0,(Zi=t.Os||(t.Os={})).OSX="OS X",Zi.WINDOWS="Windows",Zi.WINDOWS7="Windows 7",Zi.WINDOWS8="Windows 8",Zi.WINDOWS10="Windows 10",Zi.WINDOWS_VISTA="Windows Vista",Zi.WINDOWS_PHONE="Windows Phone",Zi.IOS="iOS",Zi.ANDROID="Android",Zi.CHROMIUM="Chromium",Zi.WEBOS="Web0S",Zi.SMARTCAST="SmartCast",Zi.TIZEN="Tizen",Zi.ORBIS="Orbis OS",Zi.PROSPERO="Prospero OS",Zi.UNKNOWN="Unknown",t.PerformanceMode=void 0,(Ji=t.PerformanceMode||(t.PerformanceMode={})).AUTO="auto",Ji.DESKTOP="desktop",Ji.MOBILE="mobile",Ji.TV="tv",t.Platform=void 0,(tn=t.Platform||(t.Platform={})).MAC="Macintosh",tn.WINDOWS="Windows",tn.LINUX="Linux",tn.UNKNOWN="Unknown",t.PlaybackState=void 0,(nn=t.PlaybackState||(t.PlaybackState={})).IDLE="idle",nn.STOPPED="stopped",nn.PLAYING="playing",nn.PAUSED="paused",nn.WAITING="waiting",t.PlayerEvent=void 0,(en=t.PlayerEvent||(t.PlayerEvent={})).HOTKEY_ACTION="hotkeyaction",en.READY="ready",en.AD_CUEPOINTS_AVAILABLE="adcuepointsavailable",en.AD_BREAK_START="adbreakstart",en.AD_BREAK_METADATA="adbreakmetadata",en.AD_BREAK_COMPLETE="adbreakcomplete",en.AD_START="adstart",en.AD_COMPLETE="adcomplete",en.AD_FIRST_QUARTILE="adfirstquartile",en.AD_MIDPOINT="admidpoint",en.AD_THIRD_QUARTILE="adthirdquartile",en.AD_ERROR="aderror",en.AD_CLICK="adclick",en.AD_SEGMENT_START="adsegmentstart",en.AD_SEGMENT_END="adsegmentend",en.AD_SKIPPED="adskipped",en.AD_PROGRESS="adprogress",en.AD_PAUSED="adpaused",en.AD_PLAYING="adplaying",en.AD_STALLED="adstalled",en.AD_BREAK_DISCARDED="adbreakdiscarded",en.AUDIO_TRACK_INFO_CHANGE="audiotrackinfochange",en.AUDIO_TRACK_CHANGE="audiotrackchange",en.QUALITY_CHANGE="qualitychange",en.QUALITY_INFO_CHANGE="qualityinfochange",en.CDN_CHANGE="cdnchange",en.CONTENT_START="contentstart",en.CONTENT_DURATION_AVAILABLE="contentdurationavailable",en.CONTENT_SEGMENT_START="contentsegmentstart",en.CONTENT_PLAYING="contentplaying",en.CONTENT_PROGRESS="contentprogress",en.CONTENT_PAUSED="contentpaused",en.CONTENT_SEGMENT_END="contentsegmentend",en.CONTENT_COMPLETE="contentcomplete",en.CONTENT_IS_PLAYING_LIVE="contentisplayinglive",en.STREAM_TYPE_CHANGE="streamtypechange",en.STREAM_METADATA="streammetadata",en.STREAM_ID_AVAILABLE="streamidavailable",en.DRM_KEYSYSTEM_CREATED="drmkeysystemcreated",en.FATAL_ERROR="fatalerror",en.ERROR="error",en.PLAYLIST_ADVANCED="playlistadvanced",en.PLAYLIST_COMPLETE="playlistcomplete",en.PLAYLIST_CHANGE="playlistchange",en.PLAYLIST_CLEARED="playlistcleared",en.PLAYLIST_OUT_OF_RANGE="playlistoutofrange",en.PLAYLIST_CURRENT_RESOURCE_CLEARED="playlistcurrentresourcecleared",en.POSTER_CLICK="posterclick",en.PLAYBACK_SUSPENDED="playbacksuspended",en.PLAYBACK_RESUMED="playbackresumed",en.RESOURCE_START="resourcestart",en.RESOURCE_END="resourceend",en.RESOURCE_INTERRUPTED="resourceinterrupted",en.RESOURCE_ERROR="resourceerror",en.RESOURCE_BUFFERING="resourcebuffering",en.SEEK_COMPLETE="seekcomplete",en.SEEK_START="seekstart",en.SEEK_REDIRECT_START="seekredirectstart",en.SEEK_REDIRECT_COMPLETE="seekredirectcomplete",en.METADATA_CUEPOINT="metadatacuepoint",en.TEXT_CUEPOINT="textcuepoint",en.TEXT_TRACK_CHANGE="texttrackchange",en.TEXT_TRACK_INFO_CHANGE="texttrackinfochange",en.TEXT_TRACK_DISPLAY_MODE_CHANGE="texttrackdisplaymodechange",en.TEXT_TRACK_AVAILABLE="texttrackavailable",en.THUMBNAIL_TRACK_AVAILABLE="thumbnailtrackavailable",en.VIDEO_START_ERROR="videostarterror",en.VIDEO_PLAYBACK_ERROR="videoplaybackerror",en.VIDEO_LOAD_COMPLETE="videoloadcomplete",en.BEFORE_CONTROLS_VISIBLE="beforecontrolsvisible",en.BEFORE_CONTROLS_HIDDEN="beforecontrolshidden",en.CONTROLS_VISIBLE="controlsvisible",en.CONTROLS_HIDDEN="controlshidden",en.LIVE_PRESENTATION_STOPPED="livepresentationstopped",en.PRESENTATION_SIZE_CHANGE="presentationsizechange",en.FULLSCREEN_ENTER="fullscreenenter",en.FULLSCREEN_EXIT="fullscreenexit",en.MOUSE_ENTER_PRESENTATION="mouseenterpresentation",en.MOUSE_LEAVE_PRESENTATION="mouseleavepresentation",en.USER_PAUSE="userpause",en.USER_SETTINGS="usersettings",en.LOG_EVENT="logevent",en.PLUGIN_EVENT="pluginevent",en.LANGUAGE_CHANGE="languagechange",en.USER_KEYBOARD_COMMAND="userkeyboardcommand",en.AUTOPLAY_BLOCKED="autoplayblocked",en.VOLUME_CHANGE="volumechange",en.MUTE_CHANGE="mutechange",en.ACTIVE_CHANGE="activechange",en.PLAYBACK_STATE_CHANGE="playbackstatechange",en.METRIC="metric",en.VIDEO_ELEMENT_ADDED="videoelementadded",en.VIDEO_ELEMENT_REMOVED="videoelementremoved",t.QualityCategory=void 0,(rn=t.QualityCategory||(t.QualityCategory={})).SD="SD",rn.HD="HD",rn.UHD="UHD",rn.UHD_4K="UHD 4K",rn.UHD_8K="UHD 8K",t.QualityLabel=void 0,(sn=t.QualityLabel||(t.QualityLabel={}))[sn.DEFINITION=0]="DEFINITION",sn[sn.HEIGHT=1]="HEIGHT",sn[sn.BITRATE=2]="BITRATE",sn[sn.CUSTOM=3]="CUSTOM",t.StreamType=void 0,(un=t.StreamType||(t.StreamType={})).VOD="VOD",un.LIVE="LIVE",un.DVR="DVR",t.UiMetric=void 0,(t.UiMetric||(t.UiMetric={})).SEEK_BY="seek_by",t.VideoFormat=void 0,(on=t.VideoFormat||(t.VideoFormat={})).HLS="hls",on.DASH="dash",on.MP4="mp4",on.UNKNOWN="unknown";var bn,An,mn=function(t){function i(i,n){var e=t.call(this,i)||this;return e.cause=n,e}return u(i,t),i}(Error),gn=function(t){function i(i,n,e){var r=t.call(this,"(".concat(i,"): ").concat(n),e)||this;return r.type=i,r.name="HookError",r}return u(i,t),i}(mn),pn=function(t){function i(i,n,e,r){void 0===r&&(r=!0);var s=t.call(this,n,e)||this;return s.code=i,s.fatal=r,s.name="PlayerError",s.data=e,s}return u(i,t),i}(mn);t.PlaybackAdapterType=void 0,(bn=t.PlaybackAdapterType||(t.PlaybackAdapterType={})).HLSJS="hlsjs",bn.DASHJS="dashjs",bn.SHAKA="shaka",bn.HTML5="html5",bn.PLAY_STATION="playStation",bn.UNKNOWN="unknown",bn.TWITCH_LOW_LATENCY="twitchLowLatency",t.DrmType=void 0,(An=t.DrmType||(t.DrmType={})).WIDEVINE="com.widevine.alpha",An.PLAYREADY="com.microsoft.playready",An.CLEAR_KEY="org.w3.clearkey",An.FAIRPLAY_1_0="com.apple.fps.1_0";var yn,kn=function(t){function i(i){void 0===i&&(i=250);var n=t.call(this,{})||this;return n.timer=NaN,n.pCount=0,n.pInterval=i,n}return u(i,t),i.prototype.destroy=function(){this.stop(),t.prototype.destroy.call(this)},i.prototype.start=function(){var t=this;this.running||(this.timer=setInterval((function(){t.pCount++,t.emit(i.TIC_EVENT,{count:t.pCount})}),this.pInterval))},i.prototype.stop=function(){clearInterval(this.timer),this.timer=NaN,this.pCount=0},Object.defineProperty(i.prototype,"running",{get:function(){return!isNaN(this.timer)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"interval",{get:function(){return this.pInterval},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"count",{get:function(){return this.pCount},enumerable:!1,configurable:!0}),i.TICK="tic",i.TIC_EVENT=i.TICK,i}(T),On=Object.freeze({__proto__:null,QueryString:$t,Util:ni,get DrmType(){return t.DrmType},Timer:kn,waitUntil:xi,waitForEvent:Li,waitForTime:Vi}),wn=Mi.messages,Tn=Object.freeze({__proto__:null,ErrorMessage:wn,PlaybackAdapterBase:fn,core:vn,buildInfo:ai,get AccessibilityAction(){return t.AccessibilityAction},get ActiveState(){return t.ActiveState},get AdapterRole(){return t.AdapterRole},get AdBreakType(){return t.AdBreakType},get AdContext(){return t.AdContext},get AdTechnology(){return t.AdTechnology},get ApiMetric(){return t.ApiMetric},get Autoplay(){return t.Autoplay},get Browser(){return t.Browser},get Device(){return t.Device},get ErrorCode(){return t.ErrorCode},FileExtensionToMimeType:p,get Header(){return t.Header},get HookType(){return t.HookType},get KeyboardScope(){return t.KeyboardScope},get LocalizationId(){return t.LocalizationId},get LocalizedLanguage(){return t.LocalizedLanguage},get LogLevel(){return t.LogLevel},get MetricType(){return t.MetricType},get NativePlugin(){return t.NativePlugin},get Os(){return t.Os},get PerformanceMode(){return t.PerformanceMode},get Platform(){return t.Platform},get PlaybackState(){return t.PlaybackState},get PlayerEvent(){return t.PlayerEvent},get PluginPriority(){return t.PluginPriority},get QualityCategory(){return t.QualityCategory},get QualityLabel(){return t.QualityLabel},get QualityMode(){return t.QualityMode},get StreamType(){return t.StreamType},get TextTrackEvent(){return t.TextTrackEvent},get TextTrackKind(){return t.TextTrackKind},get TextTrackMode(){return t.TextTrackMode},get UiMetric(){return t.UiMetric},get VideoFormat(){return t.VideoFormat},WILDCARD:"*",HookError:gn,PlayerError:pn,get PlaybackAdapterType(){return t.PlaybackAdapterType},util:On,get MimeType(){return t.MimeType},BaseClass:v,CoreEvent:b,Emitter:T,Logger:j,Metric:dn,request:Zt,QueryString:$t,Util:ni,get DrmType(){return t.DrmType},Timer:kn,waitUntil:xi,waitForEvent:Li,waitForTime:Vi}),En=function(){},jn=function(){function t(i){t.serviceContainerMap[i]?j.error(En.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","ServiceContainer")):(this.multiCoreKey=i,this.serviceMap={})}return t.getInstance=function(i){return i?(null==this.serviceContainerMap[i]&&(this.serviceContainerMap[i]=new t(i)),this.serviceContainerMap[i]):null},t.removeServiceContainer=function(t){this.serviceContainerMap[t]&&this.serviceContainerMap[t].destroy(),delete this.serviceContainerMap[t]},t.prototype.destroy=function(){for(var t in this.serviceMap)this.removeService(t);this.serviceMap=null},t.prototype.registerService=function(t){this.serviceMap[t.name]=t,t.onRegister(this.multiCoreKey)},t.prototype.retrieveService=function(t){return this.serviceMap[t]||null},t.prototype.hasService=function(t){return null!=this.serviceMap[t]},t.prototype.removeService=function(t){this.serviceMap[t]&&this.serviceMap[t].destroy(),delete this.serviceMap[t]},t.serviceContainerMap={},t}(),Nn=function(){function t(t,i){this.setNotifyMethod(t),this.setNotifyContext(i)}return t.prototype.destroy=function(){this.context=null,this.notify=null},t.prototype.setNotifyMethod=function(t){this.notify=t},t.prototype.setNotifyContext=function(t){this.context=t},t.prototype.getNotifyMethod=function(){return this.notify},t.prototype.getNotifyContext=function(){return this.context},t.prototype.notifyObserver=function(t){this.getNotifyMethod().call(this.getNotifyContext(),t)},t.prototype.compareNotifyContext=function(t){return t===this.context},t}(),Sn=function(){function t(i){null==t.viewMap[i]?(this.multiCoreKey=i,this.mediatorMap={},this.observerMap={},t.viewMap[this.multiCoreKey]=this,this.initializeView()):j.error(En.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","View"))}return t.getInstance=function(i){return i?(this.viewMap[i]||(this.viewMap[i]=new t(i)),this.viewMap[i]):null},t.removeView=function(t){this.viewMap[t]&&this.viewMap[t].destroy(),delete this.viewMap[t]},t.prototype.destroy=function(){for(var t in this.mediatorMap)this.removeMediator(this.mediatorMap[t].name);this.mediatorMap=null,this.observerMap=null},t.prototype.registerObserver=function(t,i){null!=this.observerMap[t]?this.observerMap[t].push(i):this.observerMap[t]=[i]},t.prototype.notifyObservers=function(t){var i,n;if(null!=this.observerMap[t.name]){var e=this.observerMap[t.name],r=[],s=void 0;for(i=0,n=e.length;i<n;i++)s=e[i],r.push(s);for(i=0,n=r.length;i<n;i++)(s=r[i]).notifyObserver(t)}},t.prototype.removeObserver=function(t,i){if(this.observerMap){for(var n=this.observerMap[t],e=n.length;e--;)if(!0===n[e].compareNotifyContext(i)){n.splice(e,1);break}0==n.length&&delete this.observerMap[t]}},t.prototype.registerMediator=function(t){var i,n,e,r,s=t.name;if(!this.mediatorMap[s]){if(t.initializeNotifier(this.multiCoreKey),this.mediatorMap[s]=t,(i=t.listNotificationInterests()).length>0)for(r=new Nn(t.handleNotification,t),n=0,e=i.length;n<e;n++)this.registerObserver(i[n],r);t.onRegister()}},t.prototype.retrieveMediator=function(t){return this.mediatorMap[t]},t.prototype.removeMediator=function(t){var i,n,e=this.mediatorMap[t];if(e){for(n=(i=e.listNotificationInterests()).length;n--;)this.removeObserver(i[n],e);delete this.mediatorMap[t],e.onRemove()}},t.prototype.hasMediator=function(t){return null!=this.mediatorMap[t]},t.prototype.initializeView=function(){},t.viewMap={},t}(),Rn=function(){function t(i){t.controllerMap[i]?j.error(En.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","Controller")):(this.multiCoreKey=i,t.controllerMap[this.multiCoreKey]=this,this.commandMap={},this.view=null,this.initializeController())}return t.getInstance=function(i){return i?(this.controllerMap[i]||(this.controllerMap[i]=new t(i)),this.controllerMap[i]):null},t.removeController=function(t){this.controllerMap[t]&&this.controllerMap[t].destroy(),delete this.controllerMap[t]},t.prototype.destroy=function(){for(var t in this.commandMap)this.removeCommand(t);this.commandMap=null,this.view=null},t.prototype.initializeController=function(){this.view=Sn.getInstance(this.multiCoreKey)},t.prototype.executeCommand=function(t){var i=this.commandMap[t.name];if(i){var n=new i;n.initializeNotifier(this.multiCoreKey),n.execute(t)}},t.prototype.registerCommand=function(t,i){this.commandMap[t]||this.view.registerObserver(t,new Nn(this.executeCommand,this)),this.commandMap[t]=i},t.prototype.hasCommand=function(t){return!!this.commandMap[t]},t.prototype.removeCommand=function(t){this.hasCommand(t)&&(this.view.removeObserver(t,this),this.commandMap[t]=null)},t.controllerMap={},t}(),In=function(){function t(i){this.proxyMap=null,t.modelMap[i]?j.error(En.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","Model")):(this.multiCoreKey=i,t.modelMap[i]=this,this.proxyMap={},this.initializeModel())}return t.getInstance=function(i){return i?(null==this.modelMap[i]&&(this.modelMap[i]=new t(i)),this.modelMap[i]):null},t.removeModel=function(t){this.modelMap[t]&&this.modelMap[t].destroy(),delete this.modelMap[t]},t.prototype.destroy=function(){for(var t in this.proxyMap)this.removeProxy(t);this.proxyMap=null},t.prototype.initializeModel=function(){},t.prototype.registerProxy=function(t){this.proxyMap[t.name]=t,t.initializeNotifier(this.multiCoreKey),t.onRegister()},t.prototype.retrieveProxy=function(t){return this.proxyMap[t]||null},t.prototype.hasProxy=function(t){return null!=this.proxyMap[t]},t.prototype.removeProxy=function(t){var i=this.proxyMap[t];i&&(i.onRemove(),this.proxyMap[t]=null)},t.modelMap={},t}(),Cn=function(){function t(t,i,n){this.pName=t,this.pBody=i,this.pType=n}return Object.defineProperty(t.prototype,"name",{get:function(){return this.pName||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this.pBody||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.pType||null},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t="\nBody: ".concat(null==this.pBody?"null":JSON.stringify(this.body)),i="\nType: ".concat(null==this.pType?"null":this.type);return"Notification Name: ".concat(this.name+t+i)},t}(),Pn=function(){function t(t,i){this.model=null,this.view=null,this.controller=null,this.serviceContainer=null,this.initialized=!1,this.multiCoreKey=t,this.initializeFacade(),this.registerCommands(i)}return t.removeCore=function(t){this.facadeMap[t]&&(In.removeModel(t),Sn.removeView(t),Rn.removeController(t),jn.removeServiceContainer(t),this.facadeMap[t].destroy(),delete this.facadeMap[t])},t.hasCore=function(i){return null!=t.facadeMap[i]},t.getInstance=function(t){if(!t)throw new Error(En.ERROR_NO_KEY);return this.facadeMap[t]},t.createFacade=function(i,n){if(!i)throw new Error(En.ERROR_NO_KEY);if(this.facadeMap[i]){var e=new Error('Not creating facade - key "'.concat(i,'" already exists!'));throw e.key=i,e}return this.facadeMap[i]=new t(i,n),this.facadeMap[i]},t.prototype.destroy=function(){this.model=null,this.view=null,this.controller=null,this.serviceContainer=null},Object.defineProperty(t.prototype,"key",{get:function(){return this.multiCoreKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appId",{get:function(){return this.multiCoreKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logger",{get:function(){return this.retrieveService(Jt.Logging).logger},enumerable:!1,configurable:!0}),t.prototype.log=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.logger.log.apply(this.logger,t)},t.prototype.registerCommand=function(t,i){this.controller.registerCommand(t,i)},t.prototype.removeCommand=function(t){this.controller.removeCommand(t)},t.prototype.hasCommand=function(t){return this.controller.hasCommand(t)},t.prototype.registerProxy=function(t){this.model.registerProxy(t)},t.prototype.retrieveProxy=function(t){return this.model?this.model.retrieveProxy(t):null},t.prototype.removeProxy=function(t){this.model&&this.model.removeProxy(t)},t.prototype.hasProxy=function(t){return this.model.hasProxy(t)},t.prototype.registerMediator=function(t){this.view.registerMediator(t)},t.prototype.retrieveMediator=function(t){return this.view?this.view.retrieveMediator(t):null},t.prototype.removeMediator=function(t){this.view&&this.view.removeMediator(t)},t.prototype.hasMediator=function(t){return this.view.hasMediator(t)},t.prototype.registerService=function(t){this.serviceContainer.registerService(t)},t.prototype.retrieveService=function(t){return this.serviceContainer?this.serviceContainer.retrieveService(t):null},t.prototype.removeService=function(t){this.model&&this.serviceContainer.removeService(t)},t.prototype.hasService=function(t){return this.serviceContainer.hasService(t)},t.prototype.registerGlobalServices=function(t){for(var i in t)this.registerService(t[i])},t.prototype.sendNotification=function(t,i,n){var e;e="string"==typeof i?new Cn(t,{},i):new Cn(t,i,n),this.notifyObservers(e)},t.prototype.notifyObservers=function(t){null!=this.view&&this.view.notifyObservers(t)},t.prototype.registerCommands=function(t){if(t)for(var i in t)t[i]&&this.registerCommand(i,t[i])},t.prototype.initializeServiceContainer=function(){this.serviceContainer=jn.getInstance(this.multiCoreKey)},t.prototype.initializeController=function(){this.controller=Rn.getInstance(this.multiCoreKey)},t.prototype.initializeModel=function(){this.model=In.getInstance(this.multiCoreKey)},t.prototype.initializeView=function(){this.view=Sn.getInstance(this.multiCoreKey)},t.prototype.initializeFacade=function(){if(this.initialized)throw new Error("Unexpected Condition: Facade already initialized");this.initializeModel(),this.initializeController(),this.initializeView(),this.initializeServiceContainer(),this.initialized=!0},t.facadeMap={},t}();!function(t){t.AdDataProxy="AdDataProxy",t.ContentPlaybackStateProxy="ContentPlaybackStateProxy",t.PlayerDomProxy="PlayerDomProxy",t.Playlist="PlaylistProxy",t.ModelCollectionProxy="ModelCollectionProxy",t.ResourceProxy="ResourceProxy",t.TrackingConfigProxy="TrackingConfigProxy",t.PerformanceProxy="PerformanceProxy",t.TextTrackProxy="TextTrackProxy",t.LocalizationProxy="LocalizationProxy",t.ActivityProxy="ActivityProxy",t.AdapterProxy="AdapterProxy",t.HookProxy="HookProxy"}(yn||(yn={}));var _n=function(){function t(t){this.pName=t}return Object.defineProperty(t.prototype,"name",{get:function(){return this.pName},enumerable:!1,configurable:!0}),t.prototype.destroy=function(){},t.prototype.onRegister=function(t){this.facadeKey=t},t.prototype.getLogger=function(){return this.getService(Jt.Logging).logger},t.prototype.getService=function(t){return Pn.getInstance(this.facadeKey).retrieveService(t)},t.prototype.getModel=function(t){return this.getModelCollection().getModel(t)},t.prototype.getModelCollection=function(){var t;return null===(t=Pn.getInstance(this.facadeKey))||void 0===t?void 0:t.retrieveProxy(yn.ModelCollectionProxy)},t}(),Dn=function(){function i(){}return Object.defineProperty(i,"info",{get:function(){return this.sysInfo},enumerable:!1,configurable:!0}),Object.defineProperty(i,"global",{get:function(){return this.pGlobal},enumerable:!1,configurable:!0}),i.initialize=function(){if("object"==typeof window){i.pGlobal=window;var t=navigator.userAgent,n=this.getPlatform(t),e=this.getBrowser(t,n);this.sysInfo=w.assign({},e,n);var r=this.sysInfo.osVersion,s=r&&w.isString(r)?parseInt(r.split(".")[0]):NaN;this.sysInfo.osMajorVersion=s}else i.pGlobal=null},i.getBrowser=function(i,n){var e,r=((e={})[t.Browser.CHROME]=/Chrome\/(\S+)/,e[t.Browser.CHROME_IOS]=/CriOS\/(\S+)/,e[t.Browser.FIREFOX_IOS]=/FxiOS\/(\S+)/,e[t.Browser.EDGE]=/ Edge?\/([^\s]+)/,e[t.Browser.FIREFOX]=/Firefox\/(\S+)/,e[t.Browser.OPERA]=/Opera|OPR\/(\S+)/,e[t.Browser.SAFARI]=/Version\/(\S+).*Safari/,e[t.Browser.MSIE]=/MSIE ([^\s]+)[\)\;]\ Windows/,e[t.Browser.ANDROID]=/Android/,e[t.Browser.SILK]=/Silk\/(\S+)/,e[t.Browser.PLAYSTATION_4_WEBMAF]=/Playstation 4 (WebMAF) (\S+)/,e[t.Browser.PLAYSTATION_5]=/PlayStation 5/,e[t.Browser.UNKNOWN]=null,e),s=r[t.Browser.CHROME_IOS].test(i),u=function(t,i,n){var e=i&&i.exec(n),r={browser:t,browserVersion:"0",browserMajorVersion:0};if(e&&e.length&&e.length>1)if(r.browserVersion=e[1]||"",r.browserVersion.indexOf(".")){var s=r.browserVersion.split(".");if(Array.isArray(s)&&s.length){var u=parseInt(s[0]);!isNaN(u)&&(r.browserMajorVersion=u)}}else{u=parseInt(r.browserVersion);!isNaN(u)&&(r.browserMajorVersion=u)}return r};if((r[t.Browser.CHROME].test(i)||s)&&!r[t.Browser.OPERA].test(i)&&!r[t.Browser.EDGE].test(i)){var o=s?t.Browser.CHROME_IOS:t.Browser.CHROME;return u(o,r[o],i)}var a=this.getMsBrowser(r[t.Browser.EDGE],r[t.Browser.MSIE],i);if(a.browser!==t.Browser.UNKNOWN)return u(a.browser,a.re,i);for(var c in r)switch(c){case t.Browser.FIREFOX:case t.Browser.FIREFOX_IOS:case t.Browser.SILK:case t.Browser.ANDROID:if(r[c].test(i))return c===t.Browser.SILK&&(n.device=t.Device.KINDLE),u(c,r[c],i);break;case t.Browser.PLAYSTATION_4_WEBMAF:case t.Browser.PLAYSTATION_5:if(r[t.Browser.PLAYSTATION_5].test(i)||r[t.Browser.PLAYSTATION_4_WEBMAF].test(i)){var h=r[t.Browser.PLAYSTATION_5].test(i),l=h?t.Browser.PLAYSTATION_5:t.Browser.PLAYSTATION_4_WEBMAF;return n.device=h?t.Device.PLAYSTATION_5:t.Device.PLAYSTATION_4,n.platform=h?t.Device.PLAYSTATION_5:t.Device.PLAYSTATION_4,n.os=h?t.Os.PROSPERO:t.Os.ORBIS,u(l,r[l],i)}case t.Browser.SAFARI:if(this.getSafariBrowser(r[c],i,n))return u(c,r[c],i);break;case t.Browser.OPERA:var f=r[c].exec(i);if(f)return u(l=f.indexOf("Opera Mini/")>=0||f.indexOf("Opera Mobi")>=0?t.Browser.OPERA_MOBILE:t.Browser.OPERA,r[c],i);case t.Browser.UNKNOWN:}return u(t.Browser.UNKNOWN,r[t.Browser.UNKNOWN],i)},i.getMsBrowser=function(i,n,e){var r=/Trident.[^\s]+;.*rv:([^\s]+)[\)\;]/;return n.test(e)?{browser:t.Browser.MSIE,re:n}:i.test(e)?{browser:t.Browser.EDGE,re:i}:r.test(e)?{browser:t.Browser.MSIE,re:r}:{browser:t.Browser.UNKNOWN,re:null}},i.getSafariBrowser=function(i,n,e){var r=i.test(n),s=e.os===t.Os.ANDROID?t.Browser.ANDROID:t.Browser.SAFARI;return r&&"Unknown"!==e.os?s:null},i.getPlatform=function(i){var n=this,e=i.toLowerCase(),r={os:t.Os.UNKNOWN,platform:t.Platform.UNKNOWN,osVersion:"",device:t.Device.UNKNOWN};if(e.indexOf("fxios")>=0)return r.os=t.Os.IOS,r.platform=t.Platform.MAC,e.indexOf("iphone")>=0?r.device=t.Device.IPHONE:r.device=t.Device.IPAD,r;if(e.indexOf("crkey")>=0)return r.platform=t.Platform.LINUX,r.device=t.Device.CHROMECAST,r;var s=/\s(\([^)]+\))/.exec(i);if(s&&s.length&&s.length>1)for(var u=s[1].replace(/_/gi,"."),o=[function(t,i){return n.isLinux(t,i)},function(t,i){return n.isMac(t,i)},function(t,i){return n.isWin(t,i)}],a=o.length;a--&&!(0,o[a])(0===a?i:u,r););return r},i.isLinux=function(i,n){var e=new RegExp(t.Platform.LINUX,"i"),r=/Linux armv/.test(navigator.platform);if(e.test(i)||i.indexOf(t.Os.ANDROID)>=0){if(n.platform=t.Platform.LINUX,n.device=t.Device.UNKNOWN,i.indexOf(t.Os.CHROMIUM)>=0){var s=/Chromium\/([\d+\.]*)\s/.exec(i);n.os=t.Os.CHROMIUM,n.osVersion=s&&s[1]||""}else if(i.indexOf(t.Os.ANDROID)>=0){var u=/ Android ([^\s]+);/.exec(i);n.os=t.Os.ANDROID,n.osVersion=u&&u[1]||"",n.device=t.Device.ANDROID_PHONE}else if(i.indexOf(t.Os.WEBOS)>=0)n.os=t.Os.WEBOS,n.osVersion="n/a",n.device=t.Device.LG_SMART_TV;else if(i.indexOf(t.Os.SMARTCAST)>=0)n.os=t.Os.SMARTCAST,n.osVersion="n/a",n.device=t.Device.VIZIO_SMART_TV;else if(i.indexOf(t.Os.TIZEN)>=0){var o=/Tizen ([^\s]+)(;|\))/.exec(i);n.os=t.Os.TIZEN,n.osVersion=o&&o[1]||"",n.device=t.Device.SAMSUNG_SMART_TV}else"undefined"!=typeof $badger||/ Xfinity/.test(i)||/ WPE/.test(i)?(n.os=t.Platform.LINUX,n.osVersion="n/a",n.device=t.Device.COMCAST_X1):r&&(n.os=t.Platform.LINUX,n.osVersion="n/a",n.device=t.Device.EMBEDDED);return!0}return!1},i.isMac=function(i,n){if(i.indexOf(t.Platform.MAC)>=0){if(n.platform=t.Platform.MAC,n.device=t.Device.DESKTOP,i.indexOf(t.Os.OSX)>=0){var e=/Mac OS X ([\d\.]+)/.exec(i);n.os=t.Os.OSX,n.osVersion=e&&e[1]?e[1]:null}return!0}if(-1!==i.indexOf("like Mac OS X")){n.platform=t.Platform.MAC,n.os=t.Os.IOS,n.device=t.Device.UNKNOWN;var r=[/\(iPhone;/,/\(iPad;/,/\(iPod;/],s=[t.Device.IPHONE,t.Device.IPAD,t.Device.IPOD],u=r.length,o=/\sOS\s([^\s]*)\s/.exec(i);for(o&&o[1]&&(n.osVersion=o[1]);u--;)if(r[u].test(i))return n.device=s[u],!0;return!0}return!1},i.isWin=function(i,n){var e=/(Windows Phone |Windows Phone OS )([^\s]+);/.exec(i);if(e&&e[2])return n.platform=t.Platform.WINDOWS,n.os=t.Os.WINDOWS_PHONE,n.osVersion=e[2],n.device=t.Device.WINDOWS_PHONE,!0;var r=/Windows NT ([^\s]+)[;\)]/.exec(i);if(n.device=t.Device.DESKTOP,r&&r[1]){n.platform=t.Platform.WINDOWS,n.os=t.Os.WINDOWS;var s=r[1];if(/Xbox; Xbox One/.test(i)&&(n.device=t.Device.XBOX_ONE),10==parseInt(s))n.os=t.Os.WINDOWS10,n.osVersion=s;else switch(s){case"6.0":n.os=t.Os.WINDOWS_VISTA;break;case"6.1":n.os=t.Os.WINDOWS7,n.osVersion="7";break;case"6.2":n.os=t.Os.WINDOWS8,n.osVersion="8"}return!0}return!1},i.sysInfo=null,i}();Dn.initialize();var Mn,xn=function(){this.muted=!1,this.volume=NaN,this.currentTime=NaN,this.duration=NaN},Ln=function(i){function n(){return i.call(this,Jt.System)||this}return u(n,i),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},Object.defineProperty(n.prototype,"appNamespace",{get:function(){return this.appNs},set:function(t){this.appNs=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"info",{get:function(){return Dn.info},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"webMafPlayer",{get:function(){return this.isWebMaf?this.global.WM_videoPlayer:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isWebMaf",{get:function(){return!(!this.global||!this.global.WM_videoPlayer)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isWebOs",{get:function(){return this.os===t.Os.WEBOS},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isChromecast",{get:function(){return this.device===t.Device.CHROMECAST},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"global",{get:function(){return Dn.global},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"document",{get:function(){return this.global&&(this.global.document||null)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isDesktop",{get:function(){return this.info.device===t.Device.DESKTOP},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isMobile",{get:function(){return!this.isDesktop},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isTv",{get:function(){switch(this.device){case t.Device.LG_SMART_TV:case t.Device.VIZIO_SMART_TV:case t.Device.SAMSUNG_SMART_TV:case t.Device.COMCAST_X1:return!0;default:return!1}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isTizenSmartTv",{get:function(){return this.device===t.Device.SAMSUNG_SMART_TV},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isXboxOne",{get:function(){return this.device===t.Device.XBOX_ONE},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isEmbedded",{get:function(){return this.device==t.Device.EMBEDDED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"browser",{get:function(){return this.info.browser},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"os",{get:function(){return this.info.os},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"device",{get:function(){return this.info.device},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"platform",{get:function(){return this.info.platform},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isIos",{get:function(){return this.info.os===t.Os.IOS},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isAndroid",{get:function(){var i=this.info;return i.device===t.Device.ANDROID_PHONE||i.device===t.Os.ANDROID},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"browserVersionInfo",{get:function(){return this.parseVerStr(this.info.browserVersion)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"osVersionInfo",{get:function(){return this.parseVerStr(this.info.osVersion)},enumerable:!1,configurable:!0}),n.prototype.createSimpleVideoInterface=function(){return new xn},n.prototype.parseVerStr=function(t){var i={majorVersion:null,minorVersion:null,versionString:t||null};if(t){var n=t.split("."),e=parseInt(n[0],10),r=parseInt(n[1],10);!isNaN(e)&&(i.majorVersion=e),!isNaN(r)&&(i.minorVersion=r)}return i},n}(_n),Vn=function(i){function n(){var t=i.call(this,Jt.AutoplayCapabilities)||this;return t.testDom=null,t.checkCompleted=!1,t.testVideoSrc=Mi.blankVideoUrl,t.isMobile=null,t.sysInfo=Ln.getInstance(),t.info={supportsUnmutedAutoplay:null,supportsMutedAutoplay:null},t}return u(n,i),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},Object.defineProperty(n.prototype,"autoplayInfo",{get:function(){return this.info},enumerable:!1,configurable:!0}),n.prototype.destory=function(){clearTimeout(this.timeout)},n.prototype.detectCapabilities=function(t){var i=this;return this.detecting?this.detecting:(t&&(this.testVideoSrc=t),this.detecting=new Promise((function(t){i.checkCompleted?t(i.info):(i.createTestDom(),i.internalCallback=function(){return t(i.info)},i.checkUnmutedAutoplay())})))},n.prototype.finishCheck=function(t,i){var n=this;this.setInfo(t,i),this.checkCompleted=!0,this.internalCallback(),this.timeout=setTimeout((function(){return n.cleanUp()}),100)},n.prototype.setInfo=function(t,i){this.info.supportsUnmutedAutoplay=t,this.info.supportsMutedAutoplay=i},n.prototype.cleanUp=function(){this.testDom&&this.testDom.parentNode.removeChild(this.testDom),this.testDom=null},n.prototype.checkUnmutedAutoplay=function(){var t=this,i=this.createVideoElement(!1);if(i){i.load();var n=i.play();void 0===n?this.isMobile?this.detectMobileCapabilities():this.finishCheck(!0,!0):n.then((function(){t.finishCheck(!0,!0)})).catch((function(i){t.checkMutedAutoplay()}))}else this.finishCheck(!0,!0)},n.prototype.checkMutedAutoplay=function(){var t=this;if(this.isEarlySafari11())this.finishCheck(!1,!1);else{var i=this.createVideoElement(!0);i.load(),i.play().then((function(){t.finishCheck(!1,!0)})).catch((function(n){if(i.error&&t.testVideoSrc!=Mi.blankDataUrl)return t.testVideoSrc=Mi.blankDataUrl,void t.checkUnmutedAutoplay();t.finishCheck(!1,!1)}))}},n.prototype.isEarlySafari11=function(){var i=this.sysInfo,n=i.browser===t.Browser.SAFARI&&"desktop"===i.device,e=n?i.browserVersionInfo.majorVersion:null,r=n?i.browserVersionInfo.minorVersion:null,s=11===e&&0===r,u=i.browserVersionInfo.versionString,o=u?u.split("."):null;return s&&(!o[2]||parseInt(o[2])<3)},n.prototype.detectMobileCapabilities=function(){var t=this.isAutoplayEligibleAndroid()||this.isAutoplayEligibleIos();this.finishCheck(!1,t)},n.prototype.isAutoplayEligibleAndroid=function(){var i=this.sysInfo;return i.os===t.Os.ANDROID&&i.browser===t.Browser.CHROME&&this.isChromeAutoplayEligible()},n.prototype.isAutoplayEligibleIos=function(){var i=this.sysInfo,n=i.os===t.Os.IOS&&i.browserVersionInfo.majorVersion>=10,e=n&&i.browser===t.Browser.SAFARI,r=n&&!e&&(i.browser===t.Browser.CHROME_IOS||i.browser===t.Browser.CHROME)&&this.isChromeAutoplayEligible();return e||r},n.prototype.isChromeAutoplayEligible=function(){return this.sysInfo.browserVersionInfo.majorVersion>=54},n.prototype.createVideoElement=function(t){var i=this.document;if(!i)return null;var n=i.createElement("video");return t&&(n.muted=!0,n.setAttribute("muted","muted"),n.setAttribute("playsinline","playsinline")),n.volume=.005,n.style.width="100%",n.style.height="100%",n.src=this.testVideoSrc,this.testDom.appendChild(n),n},n.prototype.createTestDom=function(){var t=this.document;if(!this.document)return null;var i=t.createElement("div"),n=i.style,e="-1000px";return n.position="absolute",n.top=e,n.left=e,n.width="400px",n.height="225px",t.body.appendChild(i),this.testDom=i,i},Object.defineProperty(n.prototype,"document",{get:function(){return this.sysInfo.document||null},enumerable:!1,configurable:!0}),n}(_n),Bn=[{type:"avc",config:{type:"media-source",audio:{contentType:"audio/mp4; codecs=mp4a.40.2",channels:"2",bitrate:132266,samplerate:48e3},video:{contentType:'video/mp4; codecs="avc1.4D401E"',width:1920,height:1080,bitrate:2646242,framerate:"25"}}},{type:"hevc",config:{type:"media-source",audio:{contentType:"audio/mp4; codecs=mp4a.40.2",channels:"2",bitrate:132266,samplerate:48e3},video:{contentType:'video/mp4; codecs="hev1.1.2.L93.B0"',width:1920,height:1080,bitrate:2646242,framerate:"25"}}},{type:"webm",config:{type:"media-source",audio:{contentType:"audio/webm; codecs=opus",channels:"2",bitrate:132266,samplerate:48e3},video:{contentType:'video/webm; codecs="vp09.00.10.08"',width:1920,height:1080,bitrate:2646242,framerate:"25"}}}];!function(t){t.AVC="avc1.4D401E,mp4a.40.2",t.HEVC="hev1.1.2.L93.B0",t.VP8="vp8, opus, vorbis",t.VP9="vp9, opus, vorbis",t.AV1="av1.experimental.e87fb2378f01103d5d6e477a4ef6892dc714e614"}(Mn||(Mn={}));var Un,Fn,Kn,Qn,Hn,qn,zn=function(i){function n(){var n=i.call(this,Jt.MediaCapabilities)||this;return n.types={video:{HLS:t.MimeType.HLS,AVC:t.MimeType.MP4_VIDEO+"; codecs="+Mn.AVC,HEVC:t.MimeType.MP4_VIDEO+"; codecs="+Mn.HEVC,WEBM_VP8:t.MimeType.WEBM_VIDEO+"; codecs="+Mn.VP8,WEBM_VP9:t.MimeType.WEBM_VIDEO+"; codecs="+Mn.VP9},audio:{AVC:t.MimeType.MP4_AUDIO+"; codecs="+Mn.AVC,HEVC:t.MimeType.MP4_AUDIO+"; codecs="+Mn.HEVC,WEBM_VP8:t.MimeType.WEBM_AUDIO+"; codecs="+Mn.VP8,WEBM_VP9:t.MimeType.WEBM_AUDIO+"; codecs="+Mn.VP9}},n}return u(n,i),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},Object.defineProperty(n.prototype,"capabilities",{get:function(){return this.pCapabilities},enumerable:!1,configurable:!0}),n.prototype.detectCapabilities=function(){var t=this;return new Promise((function(i,n){var e={mediaDecodeCapabilitiesResults:[],drmCapabilitiesResults:[],hasMediaSource:t.hasMediaSource,hasEncryptedMediaSource:t.hasEncryptedMediaSource,isWebKit:t.isWebKit,supportsVp8:t.supportsVp8,supportsMediaDecodeConfigurations:t.supportsMediaDecodeConfigurations,supportsNativeHls:t.isTypeSupported(t.types.video.HLS),supportsRequestMediaKeySystemAccess:t.supportsRequestMediaKeySystemAccess,supportsAvc:!1,supportsHevc:!1,supportsWebM:!1,supportsVp9:!1};t.pCapabilities=e,t.supportsMediaDecodeConfigurations?t.testMediaDecodeCapabilities(e,(function(t){var n=t.mediaDecodeCapabilitiesResults;e.supportsAvc=n[0].supported,e.supportsHevc=n[1].supported,e.supportsWebM=n[2].supported,e.supportsVp9=n[2].supported,i(e)})):(e.supportsAvc=t.isTypeSupported(t.types.video.AVC),e.supportsHevc=t.isTypeSupported(t.types.video.HEVC),e.supportsWebM=t.supportsWebM,e.supportsVp9=t.supportsVp9,i(e))}))},Object.defineProperty(n.prototype,"hasMediaSource",{get:function(){return!(!Dn.global||!Dn.global.MediaSource&&!this.isWebKit)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasEncryptedMediaSource",{get:function(){var t=Dn.global;return!!(t&&(t.MediaKeys||t.WebKitMediaKeys||t.MSMediaKeys))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isWebKit",{get:function(){return!(!Dn.global||!Dn.global.WebKitMediaSource)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"supportsWebM",{get:function(){return this.supportsVp8||this.supportsVp9},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"supportsVp8",{get:function(){return this.isTypeSupported(this.types.video.WEBM_VP8)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"supportsVp9",{get:function(){return this.isTypeSupported(this.types.video.WEBM_VP9)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"supportsRequestMediaKeySystemAccess",{get:function(){return!(!Dn.global||!Dn.global.MediaKeySystemAccess)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"supportsMediaDecodeConfigurations",{get:function(){return!!navigator.mediaCapabilities},enumerable:!1,configurable:!0}),n.prototype.isTypeSupported=function(t){var i=!1;if(!Dn.global)return!1;if(this.isWebKit?i=Dn.global.WebKitMediaSource.isTypeSupported(t):this.hasMediaSource&&(i=Dn.global.MediaSource.isTypeSupported(t)),!i){var n=document.createElement("video");w.isObject(n)&&w.isFunction(n.canPlayType)&&("probably"!==n.canPlayType(t)&&"maybe"!==n.canPlayType(t)||(i=!0))}return i},n.prototype.testMediaDecodeCapabilities=function(t,i){navigator||i(t);var n=0,e=function(e){t.mediaDecodeCapabilitiesResults.push(e),t.mediaDecodeCapabilitiesResults.length===Bn.length?i(t):(r(Bn[n]),n++)},r=function(t){var i={type:t.type},n=navigator.mediaCapabilities.decodingInfo;n?n(t.config).then((function(t){i.supported=t.supported,i.smooth=t.smooth,i.powerEfficient=t.powerEfficient,e(i)})).catch((function(){e(i)})):e(i)};r(Bn[n]),n++},n}(_n),Wn=function(i){void 0===i&&(i={}),this.ad={enabled:!1,adapter:null,context:null,showPrerollOnNonZeroStart:!1,suppressAdUi:!1,viewabilityTracking:{partner:null,viewGuid:null,pageType:null},adTagParameters:{description_url:null,sz:"640x480",url:null,iu:null,ad_rule:null,ciu_szs:null,pp:null,cmsid:"2289",vid:null,hl:null,msid:null,an:null,nofb:null,ppid:null,tfcd:null,npa:null,cust_params:null},csai:{adCallUrl:null,loadVideoTimeoutMs:4e3,enableAdPreloading:!1,enableStalledAdCheck:!0,stalledAdThreshold:5,preloadContentAtEndOfPreRoll:!1,ignoreAnomalousConditionOnSeek:!1,fw:null},ssai:{apiKey:null,authToken:null,adParameters:null,contentSourceId:null,videoId:null,assetKey:null,useApi:!1,format:t.VideoFormat.HLS,isLive:!1,filterOutPremiumAudioCodecs:!1},ima:{adCallUrl:null,loadVideoTimeoutMs:4e3,enableAdPreloading:!1,enableStalledAdCheck:!0,stalledAdThreshold:5,preloadContentAtEndOfPreRoll:!1,ignoreAnomalousConditionOnSeek:!1},dai:{contentSourceId:null,daiVideoId:null,assetKey:null,apiKey:null,ssbStreamUrl:null,isLive:!1,format:null,streamActivityMonitorId:null}},this.location={cms:null,tokenMap:null,cmsUri:null,mediaUrl:null,textTrackUrl:null,thumbnailTrackUrl:null,posterImageUrl:null,drm:{enabled:!1,sessionId:null,ticket:null,playready:{url:null,header:null},widevine:{url:null,header:null},fairplay:{appCertUrl:null,licenseUrl:null,header:null},aes:{header:null,provider:null}}},this.playback={id3OwnerIds:null,startTime:NaN,preloadContent:!1,enableAdvancedCodecs:!1,liveEdgeSyncFragmentCount:3,abr:{maxBitrate:NaN,minBitrate:NaN,startBitrate:NaN,capQualityToScreenSize:!0}},this.metadata={},this.tracking={},this.overrides={},w.merge(this,i)};!function(t){t.APPLICATION="AppMediator",t.UI="UiMediator",t.FULLSCREEN="FullscreenMediator",t.TRACKING_MEDIATOR="TrackingMediator",t.TIMER_MEDIATOR="TimerMediator",t.PRESENTATION_MEDIATOR="PresentationMediator",t.PLUGIN_MEDIATOR="pluginMediator",t.KEY_COMMAND="keyCommandMediator",t.ACC_KEY_CMD_MEDIATOR="accessibilityKeyCommandMediator"}(Un||(Un={})),function(t){t.MAIN_CONTAINER="main",t.VIDEO_EL="video",t.VIDEO_CONTAINER="videoContainer",t.CC_CONTAINER="ccContainer",t.AD_CONTAINER="adContainer",t.PANEL_CONTAINER="panelContainer",t.AD_CLICK_EL="adClickEl"}(Fn||(Fn={})),function(t){t.AdBreakInfo="AdBreakInfo",t.AdItem="AdItem",t.ContentPlaybackState="ContentPlaybackState",t.PlayerDom="PlayerDom",t.PlayerOptions="PlayerOptions",t.PresentationState="PresentationState"}(Kn||(Kn={})),function(t){t.DEFAULT="default",t.BOOT_APP="bootApp",t.PREP_TRACKING="prepTracking",t.PREP_SERVICE="prepService",t.TIMER_TIC="timerTic",t.APP_EVENT="appEvent",t.APP_ERROR_EVENT="appErrorEvent",t.READY="ready",t.METRIC="metric",t.RESOURCE_ERROR="resourceError",t.VIDEO_START_ERROR="videoStartError",t.VIDEO_PLAYBACK_ERROR="videoPlaybackError",t.PREP_RESOURCE_COLLECTION="prepResourceCollection",t.RETRIEVE_RESOURCE="retrieveResource",t.TRANSFORM_RESOURCE="transformResourceData",t.REGISTER_RESOURCE="registerResource",t.PLAY_RESOURCE="playResource",t.PREP_PLUGINS="prepPlugins",t.LOAD_PLUGINS="loadPlugins",t.REMOVE_PLUGIN="removePlugin",t.START_PRESENTATION="startPresentation",t.RESOURCE_START="resourceStart",t.RESOURCE_END="resourceEnd",t.RESOURCE_PLAYING="resourcePlaying",t.RESOURCE_PAUSED="resourcePaused",t.RESOURCE_COMPLETE="resourceComplete",t.ADVANCE_PLAYLIST="advancePlaylist",t.PLAYLIST_CHANGE="playlistChanged",t.PLAYLIST_ADVANCED="playlistAdvanced",t.PLAYLIST_COMPLETE="playlistComplete",t.PLAYLIST_CLEARED="playlistCleared",t.PLAYLIST_CURRENT_RESOURCE_CLEARED="playlistCurrentResourceCleared",t.PLAYLIST_OUT_OF_RANGE="playlistOutOfRange",t.RESOURCE_INTERRUPTED="resourceInterrupted",t.CONTENT_COMPLETE="contentComplete",t.LIVE_PRESENTATION_STOPPED="livePresentationStopped",t.KILL_RESOURCE_PRESENTATION="killResourcePresentation",t.POSTER_CLICK="posterClick",t.SUSPEND_PLAYBACK="suspendPlayback",t.RESUME_PLAYBACK="resumePlayback",t.PLAYBACK_SUSPENDED="playbackSuspended",t.PLAYBACK_RESUMED="playbackResumed",t.FULLSCREEN_ENTER="fullscreenEnter",t.FULLSCREEN_EXIT="fullscreenExit",t.PRESENTATION_SIZE_CHANGE="presentationSizeChange",t.MOUSE_ENTER_PRESENTATION="mouseEnterPresentation",t.MOUSE_LEAVE_PRESENTATION="mouseLeavePresentation",t.USER_PAUSE="userPause",t.METADATA_CUEPOINT="metadataCuepoint",t.TEXT_CUEPOINT="textCuepoint",t.TEXT_TRACK_CHANGE="textTrackChange",t.TEXT_TRACK_DISPLAY_MODE_CHANGE="textTrackDisplayModeChange",t.TEXT_TRACK_AVAILABLE="textTrackAvailable",t.TEXT_TRACK_INFO_CHANGE="textTrackInfoChange",t.AUDIO_TRACK_CHANGE="audioTrackSwitched",t.AUDIO_TRACK_INFO_CHANGE="audioTrackInfoChange",t.QUALITY_INFO_CHANGE="qualityInfoChange",t.THUMBNAIL_TRACK_AVAILABLE="thumbnailTrackAvailable",t.PLAYBACK_STATE_CHANGE="playbackStateChange",t.AUTO_QUALITY_SWITCHING="autoQualitySwitching",t.MIN_BITRATE="minBitrate",t.MAX_BITRATE="maxBitrate",t.PLAY_ON_USER_GESTURE="playOnUSerGesture",t.PLAY="play",t.PAUSE="pause",t.STOP="stop",t.SEEK="seek",t.SEEK_FORWARD="seekForward",t.SEEK_BACK="seekBack",t.SEEK_TO_LIVE="seekToLive",t.SWITCH_BITRATE="switchBitrate",t.SWITCH_QUALITY_CATEGORY="switchQualityCategory",t.SWITCH_AUDIO_TRACK="switchAudioTrack",t.SWITCH_TEXT_TRACK="switchTextTrack",t.SWITCH_TEXT_MODE="switchTextMode",t.CONTENT_START="contentStart",t.CONTENT_DURATION_AVAILABLE="contentDurationAvailable",t.CONTENT_SEGMENT_START="contentSegmentStart",t.CONTENT_SEEKING="contentSeeking",t.CONTENT_SEEKED="contentSeeked",t.SEEK_REDIRECT_START="seekRedirectStart",t.SEEK_REDIRECT_COMPLETE="seekRedirectComplete",t.CONTENT_BUFFERING="contentBuffering",t.CONTENT_PLAYING="contentPlaying",t.CONTENT_PAUSED="contentPaused",t.QUALITY_CHANGE="contentQualityChange",t.CDN_CHANGE="contentCdnChange",t.DRM_KEYSYSTEM_CREATED="drmKeySystemCreated",t.CONTENT_SEGMENT_END="contentSegmentEnd",t.CONTENT_TIME_UPDATE="contentTimeupdate",t.CONTENT_IS_LIVE_CHANGED="contentIsLiveChanged",t.STREAM_TYPE_CHANGE="streamTypeChange",t.STREAM_METADATA="streamMetadata",t.STREAM_ID_AVAILABLE="streamIdAvailable",t.VIDEO_PROGRESS="contentVideoProgress",t.VIDEO_LOAD_START="videoLoadStart",t.VIDEO_LOAD_COMPLETE="videoLoadComplete",t.VIDEO_LOADED_METADATA="videoLoadedMetadata",t.AUTOPLAY_BLOCKED="autoplayBlocked",t.AD_SEGMENT_START="adsegmentstart",t.AD_SEGMENT_END="adsegmentend",t.AD_BUFFERING="adBuffering",t.AD_CUEPOINTS_AVAILABLE="adCuepointsAvailable",t.AD_BREAK_START="adBreakStart",t.AD_BREAK_METADATA="adBreakMetadata",t.AD_START="adStart",t.AD_TIME_UPDATE="adProgress",t.AD_FIRST_QUARTILE="adFirstQuartile",t.AD_MIDPOINT="adMidpoint",t.AD_THIRD_QUARTILE="adThirdQuartile",t.AD_COMPLETE="adComplete",t.AD_BREAK_COMPLETE="adBreakEnd",t.AD_PAUSED="adPaused",t.AD_PLAYING="adPlaying",t.AD_ERROR="adError",t.AD_STALLED="adStalled",t.AD_BREAK_DISCARDED="adBreakDiscarded",t.AD_CLICK="adClick",t.AD_SKIPPED="adSkipped",t.ENABLE_UI="enableUi",t.DISABLE_UI="disableUi",t.FULLSCREEN_AVAILABLE="fullscreenAvailable",t.FULLSCREEN_CHANGE="fullscreenChange",t.ENTER_FULLSCREEN_REQUEST="enterFullscreenRequest",t.EXIT_FULLSCREEN_REQUEST="exitFullscreenRequest",t.BEFORE_CONTROLS_VISIBLE="beforeControlsVisible",t.CONTROLS_VISIBLE="controlsVisible",t.BEFORE_CONTROLS_HIDDEN="beforeControlsHidden",t.CONTROLS_HIDDEN="controlsHidden",t.MUTE="mute",t.UNMUTE="unmute",t.VOLUME_CHANGE="volumeChange",t.USER_KEY_COMMAND="userKeyCommand",t.USER_KEYBOARD_COMMAND="userKeyboardCommand",t.HOTKEY_ACTION="hotkeyAction",t.TT_OFFSET_REQUEST="ttOffsetRequest",t.USER_SETTINGS_REQUEST="userSettingsRequest",t.CHANGE_LANGUAGE="changeLanguage",t.LANGUAGE_CHANGE="languageChange"}(Qn||(Qn={})),function(t){t.EXTERNAL="external",t.INTERNAL="internal",t.UI="ui"}(Hn||(Hn={})),function(t){t[t.AD=0]="AD",t[t.CONTENT=1]="CONTENT",t[t.IDLE=2]="IDLE"}(qn||(qn={}));var Gn,Xn=function(){function t(){this.multiCoreKey=null}return t.prototype.destroy=function(){},t.prototype.onRemove=function(){this.multiCoreKey=null},Object.defineProperty(t.prototype,"facade",{get:function(){return Pn.getInstance(this.multiCoreKey)},enumerable:!1,configurable:!0}),t.prototype.sendNotification=function(t,i,n){var e=this.facade;e&&e.sendNotification(t,i,n)},t.prototype.initializeNotifier=function(t){this.multiCoreKey=t},t}(),Yn=function(t){function i(i,n){return t.call(this,i,n)||this}return u(i,t),Object.defineProperty(i.prototype,"logger",{get:function(){return this.facade.logger},enumerable:!1,configurable:!0}),i.prototype.log=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.logger.log.apply(this.logger,t)},i}(function(t){function i(i,n){var e=t.call(this)||this;return e.pViewControl=null,e.mediatorName=i,n&&(e.viewControl=n),e}return u(i,t),Object.defineProperty(i.prototype,"name",{get:function(){return this.mediatorName},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"viewControl",{get:function(){return this.pViewControl},set:function(t){this.pViewControl=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"systemService",{get:function(){return this.facade.retrieveService(Jt.System)},enumerable:!1,configurable:!0}),i.prototype.getService=function(t){return this.facade?this.facade.retrieveService(t):null},i.prototype.getModel=function(t){return this.getModelCollection().getModel(t)},i.prototype.getProxy=function(t){return this.facade?this.facade.retrieveProxy(t):null},i.prototype.getModelCollection=function(){return this.facade?this.facade.retrieveProxy(yn.ModelCollectionProxy):null},i.prototype.listNotificationInterests=function(){return[]},i.prototype.onRegister=function(){},i.prototype.onRemove=function(){this.pViewControl=null,t.prototype.onRemove.call(this)},i}(Xn)),$n=function(i){function n(t,n){var e=i.call(this,t,n)||this;return e.seekRedirectPending=!1,e.ccEnabled=!1,e.ccAvail=!1,e.fullScreenAccessRestricted=!1,e.increment=10,e.isPlayingLive=!1,e.controlsVisible=!1,e.adErrorOccurred=!1,e}return u(n,i),n.prototype.onRegister=function(){var t=this,i=this.facade.retrieveProxy(yn.LocalizationProxy);this.ui.setLocalizationService(i);this.ui.setThumbnailService({getThumbnail:function(i){return t.facade.retrieveProxy(yn.ContentPlaybackStateProxy).getThumbnail(i)}})},n.prototype.onRemove=function(){clearTimeout(this.timeout),this.viewControl&&this.viewControl.destroy(),this.viewControl=null,this.enums=null,this.fsm=null,i.prototype.onRemove.call(this)},Object.defineProperty(n.prototype,"viewController",{get:function(){return this.ui},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"controlNames",{get:function(){return this.enums.ControlName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"adViewSuppressed",{get:function(){return this.suppressAdView},set:function(t){this.suppressAdView=t},enumerable:!1,configurable:!0}),n.prototype.uiIsStandardView=function(){return this.ui.isStandardView()},n.prototype.setSeekNotice=function(t,i){this.ui.setSeekNotice(t,i)},n.prototype.setFullScreenAccessRestricted=function(t){this.fullScreenAccessRestricted=t},n.prototype.killUi=function(){this.viewControl&&this.viewControl.destroy(),this.viewControl=null},n.prototype.initialize=function(t){this.enums=t,this.init()},n.prototype.enableControl=function(t){this.ui.enableControl(t)},n.prototype.disableControl=function(t){this.ui.disableControl(t)},n.prototype.enableFullscreen=function(){!this.fullScreenAccessRestricted&&this.isFullScreenAvailable()&&this.enableControl(this.controlNames.FULLSCREEN_TOGGLE)},n.prototype.disableFullscreen=function(){this.disableControl(this.controlNames.FULLSCREEN_TOGGLE)},n.prototype.setMuteState=function(t){this.ui.setMuteState(t)},n.prototype.forceControlsVisible=function(t){this.ui.forceControlsVisible(t)},n.prototype.setSeekable=function(t){this.ui.setSeekable(t)},n.prototype.engageSeek=function(){this.ui.forceControlsVisible(!0),this.ui.beginSeekMove()},n.prototype.disengageSeek=function(){var t=this;this.ui.endSeekMove(),this.timeout=setTimeout((function(){return t.ui.forceControlsVisible(!1)}),500)},n.prototype.moveSeekBy=function(t){this.ui.moveSeekBy(t)},n.prototype.setVolume=function(t){!isNaN(t)&&t>=0&&t<=1&&this.ui.setVolume(t)},n.prototype.setTransportType=function(i){var n=i==t.StreamType.LIVE?1:i==t.StreamType.DVR?2:0;this.ui.setTransportType(n)},n.prototype.setIsPlayingLive=function(t){this.isPlayingLive=t,this.ui.setIsPlayingLive(t)},n.prototype.setClosedCaptionState=function(t){this.ui.setClosedCaptionState(t)},n.prototype.updateProgress=function(t){var i=t.playheadTime,n=t.duration;this.ui.updateProgress({currentTime:i,duration:n});var e=this.controlNames;this.isPlayingLive||i+this.increment>=n?this.ui.disableControl(e.SEEK_FORWARD_BUTTON):this.ui.enableControl(e.SEEK_FORWARD_BUTTON),i<=this.increment?this.ui.disableControl(e.SEEK_BACK_BUTTON):this.ui.enableControl(e.SEEK_BACK_BUTTON)},n.prototype.setClickCatcherState=function(i){var n=i===t.PlaybackState.PLAYING?this.enums.PlayState.PLAYING:this.enums.PlayState.PAUSED;this.ui.setClickCatcherState(n)},n.prototype.hideClickCatcher=function(t){this.ui.hideClickCatcher(t)},n.prototype.displayPoster=function(t){this.ui.showDecorator(this.enums.DecoratorName.POSTER,t)},n.prototype.activatePoster=function(){this.ui.activatePoster()},n.prototype.showUnmutePrompt=function(){this.ui.showDecorator(this.enums.DecoratorName.UNMUTE_PROMPT,!0)},n.prototype.displaySpinner=function(t){this.ui.showDecorator(this.enums.DecoratorName.SPINNER,t)},n.prototype.setAccVolumeLevelIndicator=function(t){this.ui.setAccVolumeLevelIndicator(t)},n.prototype.setVideoMode=function(t){t==qn.AD&&this.adViewSuppressed?this.ui.setVideoMode(qn.CONTENT):this.ui.setVideoMode(t)},n.prototype.resetUi=function(){this.hideClickCatcher(!0),this.displayPoster(!1),this.ui.setChapterMarkers([]),this.ui.setVideoMode(qn.IDLE)},n.prototype.handleNotification=function(i){var n=i.name,e=i.body;if(this.ui)switch(n){case Qn.ENABLE_UI:this.enableFullscreen(),this.ui.activateControls();break;case Qn.DISABLE_UI:this.ui.setVideoMode(qn.IDLE),this.ui.inactivateControls();break;case Qn.VIDEO_LOAD_START:this.displaySpinner(!0);break;case Qn.VIDEO_LOAD_COMPLETE:this.displaySpinner(!1);break;case Qn.CONTENT_TIME_UPDATE:if(this.seekRedirectPending)return;this.ui.updateProgress({currentTime:e.contentTime,duration:e.contentDuration});break;case Qn.AD_CUEPOINTS_AVAILABLE:this.ui.setChapterMarkers(e.cuepoints);break;case Qn.AD_TIME_UPDATE:this.adViewSuppressed||this.ui.updateProgress({currentTime:e.currentTime,duration:e.duration});break;case Qn.TEXT_TRACK_AVAILABLE:this.ccAvail=!0,this.ui.enableControl(this.controlNames.CC_TOGGLE),this.ccEnabled&&(this.ui.setClosedCaptionState(!0),this.activateCaptions(!0));break;case Qn.TEXT_TRACK_DISPLAY_MODE_CHANGE:this.doCaptionCheckOnControlVisChange();break;case Qn.SEEK:case Qn.SEEK_FORWARD:case Qn.SEEK_BACK:case Qn.CONTENT_SEEKING:if(this.displaySpinner(!0),this.seekRedirectPending)return;this.ui.setSeekComplete();break;case Qn.SEEK_REDIRECT_START:this.seekRedirectPending=!0;break;case Qn.SEEK_REDIRECT_COMPLETE:this.seekRedirectPending=!1;break;case Qn.CONTENT_SEEKED:if(this.displaySpinner(!1),this.seekRedirectPending)return;this.ui.setSeekComplete(),this.adErrorOccurred&&(this.adErrorOccurred=!1,this.ui.setVideoMode(qn.CONTENT),this.ccAvail&&this.ui.enableControl(this.controlNames.CC_TOGGLE));break;case Qn.CONTENT_BUFFERING:this.displaySpinner(e.value);break;case Qn.FULLSCREEN_AVAILABLE:this.enableFullscreen();break;case Qn.FULLSCREEN_CHANGE:this.ui.setFullscreenState(i.body.isFullscreen);break;case Qn.PRESENTATION_SIZE_CHANGE:this.ui.updateSize();break;case Qn.CONTENT_PLAYING:this.ui.hideClickCatcher(!1),this.displaySpinner(!1),this.setPlayState(t.PlaybackState.PLAYING);break;case Qn.CONTENT_PAUSED:this.displaySpinner(!1),this.setPlayState(t.PlaybackState.PAUSED);break;case Qn.AD_BREAK_START:this.displaySpinner(!1),this.ui.hideClickCatcher(!0),this.ui.hidePanelsForAdPlay(!0),this.setPlayState(t.PlaybackState.PLAYING),this.ui.setVideoMode(qn.AD);break;case Qn.AD_PAUSED:this.setPlayState(t.PlaybackState.PAUSED),this.ui.forceControlsVisible(!0);break;case Qn.AD_PLAYING:this.displaySpinner(!1),this.setPlayState(t.PlaybackState.PLAYING),this.ui.forceControlsVisible(!1);break;case Qn.CONTENT_START:case Qn.CONTENT_SEGMENT_START:this.ui.setVideoMode(qn.CONTENT),this.ccAvail&&this.ui.enableControl(this.controlNames.CC_TOGGLE);break;case Qn.AD_ERROR:case Qn.AD_STALLED:this.adErrorOccurred=!0;break;case Qn.AD_BREAK_COMPLETE:case Qn.CONTENT_SEGMENT_END:case Qn.RESOURCE_INTERRUPTED:case Qn.CONTENT_COMPLETE:this.ui.resetProgress(),this.ui.setVideoMode(qn.IDLE),n===Qn.AD_BREAK_COMPLETE?this.ui.hidePanelsForAdPlay(!1):this.ui.disableControl(this.controlNames.CC_TOGGLE),n!=Qn.RESOURCE_INTERRUPTED&&n!==Qn.CONTENT_COMPLETE||(this.ccAvail=!1);break;case Qn.READY:case Qn.LANGUAGE_CHANGE:this.ui.updateText();break;case Qn.STREAM_TYPE_CHANGE:this.setTransportType(e.value);break;case Qn.CONTENT_IS_LIVE_CHANGED:this.setIsPlayingLive(e.value)}},n.prototype.listNotificationInterests=function(){return[Qn.AD_CUEPOINTS_AVAILABLE,Qn.ENABLE_UI,Qn.DISABLE_UI,Qn.SEEK_REDIRECT_START,Qn.SEEK_REDIRECT_COMPLETE,Qn.SEEK,Qn.SEEK_FORWARD,Qn.SEEK_BACK,Qn.CONTENT_SEEKED,Qn.CONTENT_BUFFERING,Qn.CONTENT_PLAYING,Qn.CONTENT_PAUSED,Qn.AD_PLAYING,Qn.AD_PAUSED,Qn.AD_ERROR,Qn.AD_STALLED,Qn.FULLSCREEN_AVAILABLE,Qn.FULLSCREEN_CHANGE,Qn.PRESENTATION_SIZE_CHANGE,Qn.RESOURCE_INTERRUPTED,Qn.AD_BREAK_START,Qn.CONTENT_START,Qn.CONTENT_COMPLETE,Qn.CONTENT_SEGMENT_START,Qn.AD_BREAK_COMPLETE,Qn.CONTENT_SEGMENT_END,Qn.AD_TIME_UPDATE,Qn.CONTENT_TIME_UPDATE,Qn.TEXT_TRACK_AVAILABLE,Qn.TEXT_TRACK_DISPLAY_MODE_CHANGE,Qn.VIDEO_LOAD_START,Qn.VIDEO_LOAD_COMPLETE,Qn.LANGUAGE_CHANGE,Qn.READY,Qn.STREAM_TYPE_CHANGE,Qn.CONTENT_IS_LIVE_CHANGED]},n.prototype.setPlayState=function(t){switch(t){case"waiting":t="buffering";break;case"stopped":t="idle"}this.ui.setPlayState(t)},Object.defineProperty(n.prototype,"ui",{get:function(){return this.viewControl},enumerable:!1,configurable:!0}),n.prototype.hVisibilityEvent=function(t){if(!this.getModel(Kn.PresentationState).isCurrentVideoAd){var i=this.enums.ControlEvent,n=null;switch(t.type){case i.BEFORE_CONTROLS_VISIBLE:this.updateControlsVisible(!0),n=Qn.BEFORE_CONTROLS_VISIBLE;break;case i.CONTROLS_VISIBLE:n=Qn.CONTROLS_VISIBLE;break;case i.BEFORE_CONTROLS_HIDDEN:n=Qn.BEFORE_CONTROLS_HIDDEN;break;case i.CONTROLS_HIDDEN:this.updateControlsVisible(!1),n=Qn.CONTROLS_HIDDEN}n&&this.sendNotification(n)}},n.prototype.hActionEvent=function(t){var i=t.data.action,n=null,e=null;switch(i){case"mute":n=Qn.MUTE;break;case"unmute":n=Qn.UNMUTE;break;case"volume":n=Qn.VOLUME_CHANGE,e={value:t.data.value};break;case"pause":n=Qn.PAUSE;break;case"stop":n=Qn.STOP;break;case"play":n=Qn.PLAY;break;case"posterClick":n=Qn.PLAY_ON_USER_GESTURE;break;case"ccEnabled":case"ccDisabled":var r="ccEnabled"===i;this.activateCaptions(r);break;case"seek":n=Qn.SEEK,e={value:t.data.value};break;case"seekForward":n=Qn.SEEK_FORWARD,e={value:t.data.value||this.increment};break;case"seekBack":n=Qn.SEEK_BACK,e={value:t.data.value||this.increment};break;case"enterFullscreen":n=Qn.ENTER_FULLSCREEN_REQUEST;break;case"exitFullscreen":n=Qn.EXIT_FULLSCREEN_REQUEST;break;case"goLive":n=Qn.SEEK_TO_LIVE;break;case"settings":n=Qn.USER_SETTINGS_REQUEST}n&&this.sendNotification(n,e,Hn.UI)},n.prototype.doCaptionCheckOnControlVisChange=function(){this.ui.isStandardView()&&this.ccAvail&&this.sendNotification(Qn.TT_OFFSET_REQUEST,{controlsVisible:this.controlsVisible},Hn.UI)},n.prototype.updateControlsVisible=function(t){this.controlsVisible=t,this.doCaptionCheckOnControlVisChange()},n.prototype.hGestureEvent=function(t){if(!this.getModel(Kn.PresentationState).isCurrentVideoAd){var i=t.type===this.enums.ControlEvent.MOUSE_ENTER_PRESENTATION?Qn.MOUSE_ENTER_PRESENTATION:Qn.MOUSE_LEAVE_PRESENTATION;this.sendNotification(i,null,Hn.UI)}},n.prototype.activateCaptions=function(t){this.ccEnabled=t,this.sendNotification(Qn.SWITCH_TEXT_MODE,{value:t},Hn.UI)},n.prototype.isFullScreenAvailable=function(){return this.fsMediator&&this.fsMediator.isFullScreenPermitted()},Object.defineProperty(n.prototype,"fsMediator",{get:function(){return this.fsm||(this.fsm=this.facade.retrieveMediator(Un.FULLSCREEN)),this.fsm},enumerable:!1,configurable:!0}),n.prototype.init=function(){for(var i=this,n=this.enums.ControlEvent,e=this.controlNames,r=function(t){return i.hVisibilityEvent(t)},s=function(t){return i.hGestureEvent(t)},u=[n.BEFORE_CONTROLS_VISIBLE,n.CONTROLS_VISIBLE,n.BEFORE_CONTROLS_HIDDEN,n.CONTROLS_HIDDEN],o=u.length;o--;)this.ui.on(u[o],r);this.ui.on(n.ACTION,(function(t){return i.hActionEvent(t)})),this.ui.on(n.MOUSE_ENTER_PRESENTATION,s),this.ui.on(n.MOUSE_LEAVE_PRESENTATION,s),this.ui.disableControl(e.CC_TOGGLE),this.disableFullscreen(),this.ui.setVolume(.35),this.ui.setVideoMode(qn.IDLE),this.log(t.LogLevel.INFO,"UI created.")},n}(Yn);!function(t){t.ABR_QUALITY_LOADED="abrQualityLoaded",t.ABR_QUALITY_SWITCHED="abrQualitySwitched",t.ABR_QUALITY_SWITCHING="abrQualitySwitching",t.ABR_CONSTRAINTS_CHANGE="maxLevelChanged",t.FRAGMENT_LOADED="fragmentLoaded",t.FRAGMENT_PARSED="fragmentParsed",t.MANIFEST_LOADED="manifestLoaded",t.MANIFEST_PARSED="manifestParsed",t.LOADED_METADATA="loadedMetdata",t.DRM_KEYSYSTEM_CREATED="drmKeySystemCreated",t.AUDIO_TRACK_UPDATED="audioTrackUpdated",t.AUDIO_TRACK_CHANGE="audioTrackChange",t.MULTI_CDN="multiCdn",t.ERROR="adapterError"}(Gn||(Gn={}));var Zn,Jn,te,ie=function(i){function n(t){var n=i.call(this)||this;n.enableLogger=!1,n.networkErrorRetryCount=0,n.mediaErrorRetryCount=0,n.minAutoLevel=NaN,n.maxAutoLevel=NaN,n.multiCdnHeaderPresent=!0,n.pIsLiveStream=!1,n.lowLevelDvrDetails=null,n.liveStreamInfoVO={isPlayingLive:!1,liveEdgeOffset:NaN,dvrWindowSize:NaN,safeSeekingDuration:NaN,safeSeekingTime:NaN,relativeTime:NaN,relativeDuration:NaN,absoluteStart:NaN,absoluteTime:NaN,absoluteDuration:NaN},n.blockTimeUpdateEvent=!1,n.loaded=!1,n.pauseTime=NaN,n.videoSurfaceEventHandler=function(t){return n.onVideoSurfaceEvent(t)},n.videoEventMap=n.enumToEventMap(fi,n.videoSurfaceEventHandler),n.textEventMap=n.enumToEventMap(hi,n.videoSurfaceEventHandler),n.config=t,n.playback=n.config.resource.playback,n.logger=t.logger,n.mediaUrl=t.resource.location.mediaUrl;var e=n.config.playerOptions.overrides;return w.isEmpty(e.enableLowLevelStreamingLogs)||(n.enableLogger=e.enableLowLevelStreamingLogs),n.videoSurface=n.createVideoSurface(),n.metadataSurface=n.createMetadataSurface(),n}return u(n,i),n.prototype.createVideoSurface=function(){return new hn(this.config)},n.prototype.createMetadataSurface=function(){var t=this;return new ln(this.config,(function(i){t.emit(hi.METADATA_CUEPOINT,i)}))},n.prototype.initialize=function(){this.addEvents(this.videoSurface,this.videoEventMap),this.addEvents(this.videoSurface,this.textEventMap)},n.prototype.destroy=function(){var t;return this.removeEvents(this.videoSurface,this.videoEventMap),this.removeEvents(this.videoSurface,this.textEventMap),this.videoSurface.destroy(),this.videoSurface=null,null===(t=this.metadataSurface)||void 0===t||t.destroy(),this.metadataSurface=null,this.logger=null,this.config=null,this.playback=null,this.liveStreamInfoVO=null,this.lowLevelDvrDetails=null,this.normalizedAudioTracks=null,i.prototype.destroy.call(this),Promise.resolve()},n.prototype.play=function(){var t=this;this.load().then((function(){t.videoSurface.play()}))},n.prototype.pause=function(){this.videoSurface.pause()},n.prototype.suspend=function(){},n.prototype.resume=function(){},n.prototype.seek=function(t){this.videoSurface.seek(t)},n.prototype.load=function(){var t=this;if(!0===this.loaded)return Promise.resolve();if(this.pendingLoad)return this.pendingLoad;this.videoSurface.addEvents();var i=this.config.resource.location.textTrackUrl;return w.isEmpty(i)||(this.videoSurface.textTrackSrc=i),this.pendingLoad=this.loadMediaUrl().then((function(){t.loadComplete()})),this.pendingLoad},n.prototype.resize=function(){},n.prototype.clearCue=function(){this.videoSurface.clearCue()},Object.defineProperty(n.prototype,"audioTrack",{set:function(t){this.videoSurface.video.audioTracks[t.index].enabled=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackMode",{set:function(t){this.videoSurface.textTrackMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrack",{set:function(t){var i=this.videoSurface.video.textTracks,n=w.find(i,(function(i){return t.language==i.language&&t.kind===i.kind&&t.label===i.label}));this.videoSurface.textTrack=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bufferLength",{get:function(){return this.videoSurface.bufferLength},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){return this.videoSurface.time},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return this.videoSurface.duration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isLiveStream",{get:function(){return this.pIsLiveStream},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"droppedVideoFrames",{get:function(){return this.videoSurface.metrics.droppedVideoFrames},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"framerate",{get:function(){return this.videoSurface.framerate},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"buffering",{get:function(){return this.videoSurface.buffering},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this.pType},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fragmentType",{get:function(){return""},enumerable:!1,configurable:!0}),n.prototype.eventsToPromise=function(t){return w.eventsToPromise([{target:this.videoSurface,events:[t]}],[{target:this.videoSurface,events:[fi.ERROR]},{target:this,events:[Gn.ERROR]}])},n.prototype.loadMediaUrl=function(){var t=this;return this.eventsToPromise(fi.LOADED_METADATA).then((function(){return t.loadedMetadata()}))},n.prototype.getStreamMetadata=function(){return{manifest:{mimeType:w.getMimeType(this.mediaUrl)},fragment:{mimeType:this.fragmentType}}},n.prototype.loadedMetadata=function(){var t=this.getStreamMetadata();this.emit(Gn.LOADED_METADATA,t)},n.prototype.loadComplete=function(){this.pendingLoad=null,this.loaded=!0},n.prototype.checkAbrConstraints=function(t){if(this.manifestQualities.length>0){var i=this.getCurrentAbrConstraints(t);this.updateAbrConstraints(i.min,i.max,this.manifestQualities)}},n.prototype.updateAbrConstraints=function(t,i,n){t===this.minAutoLevel&&i===this.maxAutoLevel||(this.minAutoLevel=t,this.maxAutoLevel=i,this.emit(Gn.ABR_CONSTRAINTS_CHANGE,{minIndex:this.minAutoLevel,maxIndex:this.maxAutoLevel,manifestQualities:n}))},n.prototype.getCurrentAbrConstraints=function(t){return{min:t?w.getIndexForBitrate(this.manifestQualities,this.minBitrate,!0):0,max:t}},n.prototype.onVideoSurfaceEvent=function(t){if(t.type===fi.ERROR||t.type===fi.STALLED||t.type===fi.ABORT)this.handleVideoSurfaceError(t);else if(t.type===fi.TIME_UPDATE&&this.blockTimeUpdateEvent)return;this.emit(t.type,t.data)},n.prototype.handleVideoSurfaceError=function(i){var n=this.videoSurface.video.error;if(n&&n.code===MediaError.MEDIA_ERR_ABORTED)this.throwError(t.ErrorCode.MEDIA_ABORTED,n,n)},n.prototype.enumToEventMap=function(t,i){var n=this;return w.values(t).map((function(t){return n.mapEvent(t,i)}))},n.prototype.mapEvent=function(t,i){return{type:t,callback:i.bind(this)}},n.prototype.addEvents=function(t,i){var n=w.isFunction(t.on)?"on":"addEventListener";i.forEach((function(i){return t[n](i.type,i.callback)}))},n.prototype.removeEvents=function(t,i){var n=w.isFunction(t.off)?"off":"removeEventListener";i.forEach((function(i){return t[n](i.type,i.callback)}))},n.prototype.throwError=function(i,n,e,r){void 0===r&&(r=!0),this.log(t.LogLevel.ERROR,n),this.emit(Gn.ERROR,{code:i,message:n,data:e,fatal:r})},n.prototype.log=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.logger.log.apply(this.logger,t)},n.prototype.getErrorMessage=function(t,i,n){return void 0===n&&(n="n/a"),"".concat(t," fatal: ").concat(i," retry: ").concat(n)},n.prototype.normalizeAudioTracks=function(t,i){return t.map((function(t,n){return{index:n,id:isNaN(t[i.id])?isNaN(t.id)?"":t.id.toString():t[i.id].toString(),type:t[i.type]||t.type||"",lang:t[i.lang]||t.lang||"",codec:t[i.codec]||t.codec||"",label:t[i.label]||t.label||""}})).filter((function(t){var i=t.codec;return""===i||-1!==i.indexOf("mp4a")}))},n.prototype.normalizeQuality=function(t,i){return{index:i,bitrate:t.bitrate,height:t.height,width:t.width,codec:t.codec||t.codecs}},n.prototype.mergeStreamingConfigs=function(t,i){var n;return w.isEmpty(null===(n=null==i?void 0:i[this.pType])||void 0===n?void 0:n.config)?t:w.merge(t,i[this.pType].config)},n}(T),ne=function(i){function n(n){var e=i.call(this,n)||this;return e.MAX_BITRATE_CLEAR_VALUE=1e8,e.pType=t.PlaybackAdapterType.TWITCH_LOW_LATENCY,e.twitch=window.IVSPlayer,e.autoMaxBitrate=Number.POSITIVE_INFINITY,e.twitchEventMap=[{type:e.twitch.PlayerState.READY,callback:function(t){return e.onReady(t)}},{type:e.twitch.PlayerEventType.QUALITY_CHANGED,callback:function(t){return e.onQualityChange(t)}},{type:e.twitch.PlayerEventType.ERROR,callback:function(t){return e.onError(t)}},{type:e.twitch.PlayerEventType.AUDIO_BLOCKED,callback:function(t){return e.onError(t)}},{type:e.twitch.PlayerEventType.PLAYBACK_BLOCKED,callback:function(t){return e.onError(t)}}],e.logger.log(t.LogLevel.INFO,"TwitchLowLatencyAdapter created"),e}return u(n,i),n.prototype.initialize=function(){var n;i.prototype.initialize.call(this),this.player=this.twitch.create(),this.player.attachHTMLVideoElement(this.videoSurface.video),this.player.setAutoplay(!1);var e=this.enableLogger?"debug":"error";this.player.setLogLevel(e);var r=(null===(n=this.config.resource.overrides)||void 0===n?void 0:n.twitch)||{},s=!w.isBoolean(r.rebufferToLive)||r.rebufferToLive;this.player.setRebufferToLive(s),this.addEvents(this.player,this.twitchEventMap),!isNaN(this.playback.abr.maxBitrate)&&(this.maxBitrate=this.playback.abr.maxBitrate),!isNaN(this.playback.abr.minBitrate)&&(this.minBitrate=this.playback.abr.minBitrate),this.logger.log(t.LogLevel.INFO,"Twitch Version",this.player.getVersion())},n.prototype.seek=function(t){},n.prototype.destroy=function(){return this.removeEvents(this.player,this.twitchEventMap),this.player.delete(),this.player=null,this.twitch=null,i.prototype.destroy.call(this)},n.prototype.play=function(){this.player.play()},Object.defineProperty(n.prototype,"duration",{get:function(){return this.player.getDuration()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){return this.player.getPosition()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoQualitySwitching",{get:function(){return this.player.getAutoSwitchQuality()},set:function(t){this.player.setAutoSwitchQuality(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentIndex",{get:function(){var t=this.player.getQuality();return w.getIndexForBitrate(this.manifestQualities,t.bitrate,!1)},set:function(t){var i=this.player.getQualities();this.player.setQuality(i[t])},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minBitrate",{get:function(){return this.manifestQualities[0].bitrate},set:function(i){this.logger.log(t.LogLevel.INFO,Mi.messages.ABR_MIN_BITRATE_RESTRICTION_UNAVAILABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBitrate",{get:function(){var t=isNaN(this.autoMaxBitrate)?this.manifestQualities.length-1:w.getIndexForBitrate(this.manifestQualities,this.autoMaxBitrate,!1);return this.manifestQualities[t].bitrate},set:function(t){this.autoMaxBitrate=isNaN(t)?this.MAX_BITRATE_CLEAR_VALUE:t,this.player.setAutoMaxBitrate(this.autoMaxBitrate)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"manifestQualities",{get:function(){return this.player.getQualities().sort((function(t,i){return t.bitrate-i.bitrate})).map(this.normalizeQuality)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"liveStreamInfo",{get:function(){var t=this.liveStreamInfoVO;return this.pIsLiveStream&&(t.isPlayingLive=!0,t.relativeDuration=this.duration,t.relativeTime=this.time,t.liveEdgeOffset=this.player.getLiveLatency()),t},enumerable:!1,configurable:!0}),n.prototype.onVideoSurfaceEvent=function(t){if(t.type===fi.DURATION_CHANGE)this.pIsLiveStream=this.duration===1/0;i.prototype.onVideoSurfaceEvent.call(this,t)},n.prototype.loadMediaUrl=function(){var t=this;return Promise.resolve().then((function(){t.player.load(t.mediaUrl)}))},n.prototype.onReady=function(t){this.emit(Gn.MANIFEST_PARSED,{profile:this.manifestQualities})},n.prototype.onQualityChange=function(t){var i=w.getIndexForBitrate(this.manifestQualities,t.bitrate,!1);this.checkAbrConstraints(w.getIndexForBitrate(this.manifestQualities,this.maxBitrate,!1)),this.emit(Gn.ABR_QUALITY_LOADED,{index:i})},n.prototype.onError=function(i){switch(void 0===i&&(i={}),i.type){case this.twitch.ErrorType.NETWORK_IO:case this.twitch.ErrorType.NETWORK:case this.twitch.ErrorType.NOT_AVAILABLE:this.throwError(t.ErrorCode.TWITCH_NETWORK_ERROR,"".concat(Mi.messages.FATAL_PLAYBACK_NETWORK_ERROR," : ").concat(i.message),i);break;case this.twitch.ErrorType.INVALID_DATA:this.throwError(t.ErrorCode.TWITCH_PARSE_ERROR,"".concat(Mi.messages.FATAL_PLAYBACK_MEDIA_ERROR," : ").concat(i.message),i);break;case this.twitch.ErrorType.NOT_SUPPORTED:this.throwError(t.ErrorCode.TWITCH_SRC_NOT_SUPPORTED,"".concat(Mi.messages.FATAL_PLAYBACK_MEDIA_ERROR," : ").concat(i.message),i);break;default:switch(i.source){case this.twitch.ErrorSource.DECODER:case this.twitch.ErrorSource.RENDERER:case this.twitch.ErrorSource.SEGMENT:this.throwError(t.ErrorCode.TWITCH_MEDIA_ERROR,"".concat(Mi.messages.FATAL_PLAYBACK_MEDIA_ERROR," : ").concat(i.message),i);break;default:this.throwError(t.ErrorCode.UNSPECIFIED_TWITCH_ERROR,i.message,i,!1)}}},n}(ie),ee=function(){function t(){}return t.warn=function(t){j.deprecated(t)},t.checkEventName=function(i){return/[A-Z]+/.test(i)&&(t.warn("Event name is being forced to lowercase. Please use the avia.PlayerEvent enum instead of a string literal. This check will be removed April 1st, 2022"),i=i.toLowerCase()),i},t.createUi=function(i,n,e,r){t.warn("CVUI is deprecated. Please use the avia-js-ui instead. Access to this feature will be completely removed April 1st, 2022");var s=i.retrieveProxy(yn.PlayerDomProxy),u=r.uiConfig;(e.isIos||e.isAndroid)&&(u||(u={}),u.exclude&&Array.isArray(u.exclude)||(u.exclude=[]),-1==u.exclude.indexOf(n.ControlName.CC_TOGGLE)&&u.exclude.push(n.ControlName.CC_TOGGLE));var o=n.createUi({controlContainer:s.getMain(),panelContainer:s.getElement(Fn.PANEL_CONTAINER),zOrigin:s.getSafeZIndex(),systemInfo:e.info,configuration:u||{},omitVolume:!e.isDesktop}),a={ControlName:n.ControlName,ControlEvent:n.ControlEvent,PlayState:n.PlayState,DecoratorName:n.DecoratorName,VideoType:n.VideoType},c=new $n(Un.UI,o);i.registerMediator(c),c.initialize(a)},t.getModelSnapShot=function(i){t.warn("getModelSnapShot method is deprecated. Access to this property will be completely removed April 1st, 2022");var n=i.getSnapshot();return n.BuildInfo=ai,n},Object.defineProperty(t,"xhr",{get:function(){return{performXhr:function(i){t.warn("performXhr method is deprecated. Please use Util.request, or fetch directly. Access to this property will be completely removed April 28th, 2022");var n=i.onComplete;i.onComplete=function(t){n(t),t.target.destroy()},new Yt(i)}}},enumerable:!1,configurable:!0}),t.setResource=function(i,n){t.warn("The setter for the resource property is deprecated. Please use player.attachResource. Access to this property will be completely removed July 1st, 2022"),i.attachResource(n)},t.createTwitch=function(i){return t.warn("The twitch low latency adapter is deprecated. Please use the Twitch Adapter Plugin. This feature will be completely removed January 1st, 2022"),new ne(i)},t.getAutoplayCapabilities=function(i){return t.warn("The getAutoplayCapabilities function is deprecated. Please use avia.getAutoplayCapabilities. This feature will be completely removed January 1st, 2022"),i.getService(Jt.AutoplayCapabilities).detectCapabilities()},t}(),re=function(t){function i(i,n){var e=t.call(this)||this;return e.proxyName=null,e.pData=null,e.proxyName=i,e.pData=n||{},e}return u(i,t),Object.defineProperty(i.prototype,"name",{get:function(){return this.proxyName},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"data",{get:function(){return this.pData},enumerable:!1,configurable:!0}),i.prototype.onRegister=function(){},i.prototype.onRemove=function(){this.pData=null,t.prototype.onRemove.call(this)},i}(Xn),se=((Zn={})[t.HookType.EVENT]={multiple:!0},Zn[t.HookType.AD_BREAK]={multiple:!1},Zn[t.HookType.AD]={multiple:!1},Zn),ue=function(t){function i(i){var n=t.call(this,yn.HookProxy,i)||this;return n.hookMap={},n}return u(i,t),i.prototype.onRemove=function(){this.hookMap=null,t.prototype.onRemove.call(this)},i.prototype.registerHook=function(t,i){this.hookMap[t]||(this.hookMap[t]=[]),!1===se[t].multiple&&this.hookMap[t].length||this.hookMap[t].push(i)},i.prototype.removeHook=function(t,i){this.hookMap[t]&&(this.hookMap[t]=this.hookMap[t].filter((function(t){return t!==i})))},i.prototype.applyHook=function(t,i){return h(this,void 0,void 0,(function(){var n,e,r,s,u=this;return l(this,(function(o){return(n=this.hookMap[t])&&0!==n.length?(e=!1,r=function(){return e=!0},s=function(i,o){return void 0===o&&(o=0),h(u,void 0,void 0,(function(){var u,a,c;return l(this,(function(h){switch(h.label){case 0:if(o>=n.length)return[2,i];if("function"!=typeof(u=n[o]))throw new gn(t,"Hook must be a valid function");a={type:t,value:i,cancel:r},h.label=1;case 1:return h.trys.push([1,3,,4]),[4,u(a)];case 2:return h.sent(),[3,4];case 3:throw c=h.sent(),new gn(t,c.toString(),c);case 4:return[2,e?null:s(a.value,++o)]}}))}))},[2,s(i)]):[2,i]}))}))},i}(re),oe=((Jn={})[t.QualityCategory.UHD_8K]=4320,Jn[t.QualityCategory.UHD_4K]=2160,Jn[t.QualityCategory.UHD]=1440,Jn[t.QualityCategory.HD]=720,Jn[t.QualityCategory.SD]=0,Jn),ae=function(){function i(){}return i.getMinAndMaxValuesForCategory=function(t,i){var n=1/0,e=0,r=1/0,s=0;return t.forEach((function(t){t.category.indexOf(i)>=0&&(e=Math.max(e,t.index),n=Math.min(n,t.index),s=Math.max(s,t.bitrate),r=Math.min(r,t.bitrate))})),{maxIndex:e,minIndex:n,minBitrate:r,maxBitrate:s}},i.getQualityCategoryForVideoHeight=function(i){var n=oe;return i>=n[t.QualityCategory.UHD_8K]?t.QualityCategory.UHD_8K:i>=n[t.QualityCategory.UHD_4K]?t.QualityCategory.UHD_4K:i>=n[t.QualityCategory.UHD]?t.QualityCategory.UHD:i>=n[t.QualityCategory.HD]?t.QualityCategory.HD:t.QualityCategory.SD},i.classFromQualifiedName=function(t){if(!w.isString(t))return t;var i,n,e=Ln.getInstance().global,r=t.split("."),s=e,u=r.length;for("window"===r[0]&&(u=(r=r.slice(1)).length),i=0;i<u;i++){if(void 0===s[n=r[i]])return j.error("Util.classFromQualifiedName: '".concat(t,"' is undefined.")),null;s=s[n]}return s},i.serializeConfigSnapshot=function(t,i,n,e){void 0===e&&(e=0);var r=i.currentResource?JSON.parse(JSON.stringify(i.currentResource)):{},s=function(t){var i=typeof t;if(t&&"object"==i){for(var n in t){var e=s(t[n]);"\0"===e?delete t[n]:t[n]=e}return t}return null===t||"number"===i&&isNaN(t)?"\0":t};s(r);var u=JSON.stringify(t,(function(t,i){return i instanceof HTMLElement?void 0:i})),o=JSON.parse(u);delete o.dataTransformers,o.container=null;var a={buildInfo:ai,playerOptions:o,resource:r,system:n.info};return JSON.stringify(a,null,e)},i.getNativePluginConfig=function(t,i){var n,e,r=Mi.nativePluginConfig[t];if(!r)return null;var s=Object.assign({},r),u=(null===(e=null===(n=i.overrides)||void 0===n?void 0:n.dependencies)||void 0===e?void 0:e[t])||s.url;return s.url=u,s},i}(),ce=function(t){function i(i,n){var e=t.call(this,i)||this;return e.pLogger=n,e}return u(i,t),i.prototype.destroy=function(){this.pLogger.destroy(),this.pLogger=null},Object.defineProperty(i.prototype,"logger",{get:function(){return this.pLogger},enumerable:!1,configurable:!0}),i}(_n),he=((te={})[Qn.READY]=t.PlayerEvent.READY,te[Qn.POSTER_CLICK]=t.PlayerEvent.POSTER_CLICK,te[Qn.VIDEO_START_ERROR]=t.PlayerEvent.VIDEO_START_ERROR,te[Qn.VIDEO_PLAYBACK_ERROR]=t.PlayerEvent.VIDEO_PLAYBACK_ERROR,te[Qn.RESOURCE_ERROR]=t.PlayerEvent.RESOURCE_ERROR,te[Qn.PLAYLIST_ADVANCED]=t.PlayerEvent.PLAYLIST_ADVANCED,te[Qn.PLAYLIST_COMPLETE]=t.PlayerEvent.PLAYLIST_COMPLETE,te[Qn.PLAYLIST_CHANGE]=t.PlayerEvent.PLAYLIST_CHANGE,te[Qn.PLAYLIST_CLEARED]=t.PlayerEvent.PLAYLIST_CLEARED,te[Qn.PLAYLIST_CURRENT_RESOURCE_CLEARED]=t.PlayerEvent.PLAYLIST_CURRENT_RESOURCE_CLEARED,te[Qn.RESOURCE_START]=t.PlayerEvent.RESOURCE_START,te[Qn.RESOURCE_END]=t.PlayerEvent.RESOURCE_END,te[Qn.RESOURCE_INTERRUPTED]=t.PlayerEvent.RESOURCE_INTERRUPTED,te[Qn.PLAYLIST_OUT_OF_RANGE]=t.PlayerEvent.PLAYLIST_OUT_OF_RANGE,te[Qn.PLAYBACK_SUSPENDED]=t.PlayerEvent.PLAYBACK_SUSPENDED,te[Qn.PLAYBACK_RESUMED]=t.PlayerEvent.PLAYBACK_RESUMED,te[Qn.PLAYBACK_STATE_CHANGE]=t.PlayerEvent.PLAYBACK_STATE_CHANGE,te[Qn.AUDIO_TRACK_INFO_CHANGE]=t.PlayerEvent.AUDIO_TRACK_INFO_CHANGE,te[Qn.AUDIO_TRACK_CHANGE]=t.PlayerEvent.AUDIO_TRACK_CHANGE,te[Qn.QUALITY_CHANGE]=t.PlayerEvent.QUALITY_CHANGE,te[Qn.QUALITY_INFO_CHANGE]=t.PlayerEvent.QUALITY_INFO_CHANGE,te[Qn.CDN_CHANGE]=t.PlayerEvent.CDN_CHANGE,te[Qn.CONTENT_START]=t.PlayerEvent.CONTENT_START,te[Qn.CONTENT_DURATION_AVAILABLE]=t.PlayerEvent.CONTENT_DURATION_AVAILABLE,te[Qn.CONTENT_SEGMENT_START]=t.PlayerEvent.CONTENT_SEGMENT_START,te[Qn.CONTENT_TIME_UPDATE]=t.PlayerEvent.CONTENT_PROGRESS,te[Qn.CONTENT_BUFFERING]=t.PlayerEvent.RESOURCE_BUFFERING,te[Qn.CONTENT_PLAYING]=t.PlayerEvent.CONTENT_PLAYING,te[Qn.CONTENT_PAUSED]=t.PlayerEvent.CONTENT_PAUSED,te[Qn.CONTENT_SEEKING]=t.PlayerEvent.SEEK_START,te[Qn.CONTENT_SEEKED]=t.PlayerEvent.SEEK_COMPLETE,te[Qn.CONTENT_IS_LIVE_CHANGED]=t.PlayerEvent.CONTENT_IS_PLAYING_LIVE,te[Qn.STREAM_TYPE_CHANGE]=t.PlayerEvent.STREAM_TYPE_CHANGE,te[Qn.STREAM_METADATA]=t.PlayerEvent.STREAM_METADATA,te[Qn.STREAM_ID_AVAILABLE]=t.PlayerEvent.STREAM_ID_AVAILABLE,te[Qn.SEEK_REDIRECT_START]=t.PlayerEvent.SEEK_REDIRECT_START,te[Qn.SEEK_REDIRECT_COMPLETE]=t.PlayerEvent.SEEK_REDIRECT_COMPLETE,te[Qn.CONTENT_SEGMENT_END]=t.PlayerEvent.CONTENT_SEGMENT_END,te[Qn.CONTENT_COMPLETE]=t.PlayerEvent.CONTENT_COMPLETE,te[Qn.DRM_KEYSYSTEM_CREATED]=t.PlayerEvent.DRM_KEYSYSTEM_CREATED,te[Qn.METADATA_CUEPOINT]=t.PlayerEvent.METADATA_CUEPOINT,te[Qn.TEXT_CUEPOINT]=t.PlayerEvent.TEXT_CUEPOINT,te[Qn.TEXT_TRACK_DISPLAY_MODE_CHANGE]=t.PlayerEvent.TEXT_TRACK_DISPLAY_MODE_CHANGE,te[Qn.TEXT_TRACK_CHANGE]=t.PlayerEvent.TEXT_TRACK_CHANGE,te[Qn.TEXT_TRACK_INFO_CHANGE]=t.PlayerEvent.TEXT_TRACK_INFO_CHANGE,te[Qn.TEXT_TRACK_AVAILABLE]=t.PlayerEvent.TEXT_TRACK_AVAILABLE,te[Qn.VIDEO_LOAD_COMPLETE]=t.PlayerEvent.VIDEO_LOAD_COMPLETE,te[Qn.THUMBNAIL_TRACK_AVAILABLE]=t.PlayerEvent.THUMBNAIL_TRACK_AVAILABLE,te[Qn.AD_SEGMENT_START]=t.PlayerEvent.AD_SEGMENT_START,te[Qn.AD_SEGMENT_END]=t.PlayerEvent.AD_SEGMENT_END,te[Qn.AD_CUEPOINTS_AVAILABLE]=t.PlayerEvent.AD_CUEPOINTS_AVAILABLE,te[Qn.AD_BREAK_START]=t.PlayerEvent.AD_BREAK_START,te[Qn.AD_BREAK_METADATA]=t.PlayerEvent.AD_BREAK_METADATA,te[Qn.AD_START]=t.PlayerEvent.AD_START,te[Qn.AD_PAUSED]=t.PlayerEvent.AD_PAUSED,te[Qn.AD_PLAYING]=t.PlayerEvent.AD_PLAYING,te[Qn.AD_TIME_UPDATE]=t.PlayerEvent.AD_PROGRESS,te[Qn.AD_FIRST_QUARTILE]=t.PlayerEvent.AD_FIRST_QUARTILE,te[Qn.AD_MIDPOINT]=t.PlayerEvent.AD_MIDPOINT,te[Qn.AD_THIRD_QUARTILE]=t.PlayerEvent.AD_THIRD_QUARTILE,te[Qn.AD_COMPLETE]=t.PlayerEvent.AD_COMPLETE,te[Qn.AD_BREAK_COMPLETE]=t.PlayerEvent.AD_BREAK_COMPLETE,te[Qn.AD_ERROR]=t.PlayerEvent.AD_ERROR,te[Qn.AD_STALLED]=t.PlayerEvent.AD_STALLED,te[Qn.AD_BREAK_DISCARDED]=t.PlayerEvent.AD_BREAK_DISCARDED,te[Qn.AD_BUFFERING]=t.PlayerEvent.RESOURCE_BUFFERING,te[Qn.AD_CLICK]=t.PlayerEvent.AD_CLICK,te[Qn.AD_SKIPPED]=t.PlayerEvent.AD_SKIPPED,te[Qn.USER_PAUSE]=t.PlayerEvent.USER_PAUSE,te[Qn.BEFORE_CONTROLS_VISIBLE]=t.PlayerEvent.BEFORE_CONTROLS_VISIBLE,te[Qn.BEFORE_CONTROLS_HIDDEN]=t.PlayerEvent.BEFORE_CONTROLS_HIDDEN,te[Qn.CONTROLS_VISIBLE]=t.PlayerEvent.CONTROLS_VISIBLE,te[Qn.CONTROLS_HIDDEN]=t.PlayerEvent.CONTROLS_HIDDEN,te[Qn.USER_SETTINGS_REQUEST]=t.PlayerEvent.USER_SETTINGS,te[Qn.LIVE_PRESENTATION_STOPPED]=t.PlayerEvent.LIVE_PRESENTATION_STOPPED,te[Qn.PRESENTATION_SIZE_CHANGE]=t.PlayerEvent.PRESENTATION_SIZE_CHANGE,te[Qn.FULLSCREEN_ENTER]=t.PlayerEvent.FULLSCREEN_ENTER,te[Qn.FULLSCREEN_EXIT]=t.PlayerEvent.FULLSCREEN_EXIT,te[Qn.MOUSE_ENTER_PRESENTATION]=t.PlayerEvent.MOUSE_ENTER_PRESENTATION,te[Qn.MOUSE_LEAVE_PRESENTATION]=t.PlayerEvent.MOUSE_LEAVE_PRESENTATION,te[Qn.LANGUAGE_CHANGE]=t.PlayerEvent.LANGUAGE_CHANGE,te[Qn.USER_KEYBOARD_COMMAND]=t.PlayerEvent.USER_KEYBOARD_COMMAND,te[Qn.HOTKEY_ACTION]=t.PlayerEvent.HOTKEY_ACTION,te[Qn.AUTOPLAY_BLOCKED]=t.PlayerEvent.AUTOPLAY_BLOCKED,te[Qn.VOLUME_CHANGE]=t.PlayerEvent.VOLUME_CHANGE,te[Qn.MUTE]=t.PlayerEvent.MUTE_CHANGE,te[Qn.UNMUTE]=t.PlayerEvent.MUTE_CHANGE,te),le=function(i){function n(t,n){var e=i.call(this,t)||this;return e.app=n,e}return u(n,i),n.prototype.setFullscreenElement=function(t){this.facade.retrieveMediator(Un.FULLSCREEN).fullscreenElement=t},n.prototype.getFullscreenElement=function(){return this.facade.retrieveMediator(Un.FULLSCREEN).fullscreenElement},n.prototype.onRemove=function(){this.app=null,i.prototype.onRemove.call(this)},n.prototype.getAppApi=function(){return this.app.getApi()},n.prototype.loadNativePlugin=function(t,i){var n=Mi.nativePluginConfig[t];if(!n)return null;i&&(n.url=i);var e=this.facade.retrieveMediator(Un.PLUGIN_MEDIATOR);return null==e?void 0:e.loadPlugin(n)},n.prototype.getSnapshot=function(){return this.getProxy(yn.ModelCollectionProxy).collection.getSnapshot()},n.prototype.getConfigAsJson=function(t){var i=this.getProxy(yn.ModelCollectionProxy).getModel(Kn.PlayerOptions).data,n=this.getProxy(yn.Playlist),e=this.facade.retrieveService(Jt.System);return ae.serializeConfigSnapshot(i,n,e,t)},n.prototype.validateSeek=function(i,n){if(isNaN(i))return this.log(t.LogLevel.WARN,"Invalid seek() time [".concat(i,"] supplied")),null;var e=this.getModel(Kn.PresentationState),r=this.getProxy(yn.ContentPlaybackStateProxy),s=r&&r.model.streamType===t.StreamType.LIVE;return!e||!r||e.isCurrentVideoAd||s?(this.log(t.LogLevel.WARN,"seek() may not be called in the current context"),null):w.clampValue(i,0,n)},n.prototype.isPlaybackSuspended=function(){return this.getModel(Kn.PresentationState).suspended},n.prototype.getAutoplayCapabilities=function(){return ee.getAutoplayCapabilities(this)},n.prototype.getContainerRect=function(){var t=this.getProxy(yn.PlayerDomProxy);return t?t.getPresentationRect():null},n.prototype.attachResource=function(i,n){var e,r=this;n||(null===(e=this.getProxy(yn.Playlist))||void 0===e||e.softClear());return this.stopPresentation().then((function(){return null==n||n(),r.app.sendAsyncNotification({name:Qn.PREP_RESOURCE_COLLECTION,body:{resource:i,start:!0}},[t.PlayerEvent.RESOURCE_START],[t.PlayerEvent.RESOURCE_ERROR])})).then((function(){return r.getCurrentResource()}))},n.prototype.getCurrentResource=function(){var t;return(null===(t=this.getProxy(yn.ResourceProxy))||void 0===t?void 0:t.resource)||null},n.prototype.killCurrentResource=function(){var i=this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR);return this.log(t.LogLevel.INFO,"Killing current resource"),Promise.resolve().then((function(){return null==i?void 0:i.close()})).catch((function(t){j.error(t)}))},n.prototype.stopPresentation=function(){var i=this.getProxy(yn.ContentPlaybackStateProxy);if(!(null==i?void 0:i.model))return Promise.resolve();var n={name:Qn.STOP,type:Hn.EXTERNAL};return this.app.sendAsyncNotification(n,[t.PlayerEvent.RESOURCE_INTERRUPTED,t.PlayerEvent.RESOURCE_END])},n.prototype.skipAd=function(){this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR).skipAd()},n.prototype.getPlugin=function(t){var i=this.facade.retrieveMediator(Un.PLUGIN_MEDIATOR);return i?i.getPlugin(t):null},n.prototype.dispatchPluginEvent=function(i){this.app.sendEvent(t.PlayerEvent.PLUGIN_EVENT,i)},n.prototype.prepForPlayerRemoval=function(){var i=this.facade.retrieveMediator(Un.UI);i&&(i.killUi(),this.log(t.LogLevel.INFO,"UI layer destroyed"))},n.prototype.getMuteState=function(){var t=this.getModel(Kn.PresentationState);return t?t.isMuted:null},n.prototype.getVolume=function(){var t=this.getModel(Kn.PresentationState);return t?t.volume:NaN},n.prototype.getDimensions=function(){var t=this.getProxy(yn.PlayerDomProxy);return t?t.getDimensions():null},n.prototype.getAdBreakTimes=function(){var t=this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR);return t?t.getAdBreakTimes():null},n.prototype.grabFrame=function(){var t=this.getProxy(yn.PlayerDomProxy),i=t&&t.getVideo();if(!t||!i)return null;var n,e,r,s=document.createElement("canvas");n=s.getContext("2d");var u=s.width=i.videoWidth,o=s.height=i.videoHeight;return n.drawImage(i,0,0,u,o),e=s.toDataURL(),(r=document.createElement("img")).setAttribute("src",e),r},n.prototype.listNotificationInterests=function(){return[Qn.APP_EVENT]},n.prototype.sendErrorEvent=function(t){this.app.sendErrorEvent(t)},n.prototype.handleNotification=function(t){var i=t.body,n=he[i.notificationName]||i.type;if(t.name===Qn.APP_EVENT)n&&this.app.sendEvent(n,i.data)},n.prototype.onRegister=function(){i.prototype.onRegister.call(this)},n}(Yn),fe=function(t){function i(i){var n=t.call(this,i||{})||this;return n.pAppId=i.id||w.uid8(),n.pFacade=Pn.createFacade(n.pAppId,i.commandMap||null),n}return u(i,t),i.prototype.destroy=function(){this.mdlCollProxy=null,this.pFacade=null,t.prototype.destroy.call(this),Pn.removeCore(this.pAppId)},Object.defineProperty(i.prototype,"appId",{get:function(){return this.pAppId},enumerable:!1,configurable:!0}),i.prototype.sendNotification=function(t,i,n){this.pFacade.sendNotification(t,i,n)},i.prototype.createLoggingService=function(t){var i=this,n=new j({logLevel:t,id:this.appId,onLogEvent:function(t){return i.sendEvent(t.type,t.data)}});this.pFacade.registerService(new ce(Jt.Logging,n))},i.prototype.registerGlobalServices=function(t){var i=this.pFacade;for(var n in t)i.registerService(t[n])},Object.defineProperty(i.prototype,"facade",{get:function(){return this.pFacade},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"modelCollectionProxy",{get:function(){return this.mdlCollProxy||(this.mdlCollProxy=this.facade.retrieveProxy(yn.ModelCollectionProxy)),this.mdlCollProxy},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"appMediator",{get:function(){return this.pFacade.retrieveMediator(Un.APPLICATION)},enumerable:!1,configurable:!0}),i.prototype.createApplicationMediator=function(t){var i=new le(t,this);this.pFacade.registerMediator(i)},i}(T);function de(){return function(t,i,n){w.isObject(t.apiMethods)||(t.apiMethods={}),t.apiMethods[i]=n.value}}function ve(t){return void 0===t&&(t=!1),function(i,n,e){w.isObject(i.apiAccessors)||(i.apiAccessors={});var r={get:e.get,set:t?void 0:e.set||void 0};i.apiAccessors[n]=r}}function be(t,i){var n=function(n){t[n]=function(){var t=Array.prototype.slice.call(arguments);return!!i&&!!i.apiMethods&&!!i.apiMethods[n]&&i.apiMethods[n].apply(i,t)||null}};for(var e in i.apiMethods)n(e);var r=function(n){var e=i.apiAccessors[n],r={};e.get&&(r.get=function(){return i[n]}),e.set&&(r.set=function(t){i[n]=t}),Object.defineProperty(t,n,r)};for(var s in i.apiAccessors)r(s);return t}var Ae,me,ge=function(t){function i(){return t.call(this)||this}return u(i,t),Object.defineProperty(i.prototype,"logger",{get:function(){return this.facade.logger},enumerable:!1,configurable:!0}),i.prototype.log=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.logger.log.apply(this.logger,t)},i}(function(t){function i(){return t.call(this)||this}return u(i,t),i.prototype.getModel=function(t){return this.getModelCollection().getModel(t)},i.prototype.getProxy=function(t){return this.facade?this.facade.retrieveProxy(t):null},i.prototype.getService=function(t){return this.facade?this.facade.retrieveService(t):null},i.prototype.getModelCollection=function(){return this.facade?this.facade.retrieveProxy(yn.ModelCollectionProxy):null},i}(Xn)),pe=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){var n=this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR),e=this.facade.retrieveProxy(yn.ContentPlaybackStateProxy),r=n.adapter,s=i.body.value;if(e.isAbrSwitchingAvailable)switch(i.name){case Qn.SWITCH_BITRATE:var u=w.getIndexForBitrate(e.qualityInfo.qualities,s,!1);this.switchToIndex(u,e,r);break;case Qn.SWITCH_QUALITY_CATEGORY:e.userQualityCategory=s,this.switchQualityCategory(e,s,r);break;case Qn.AUTO_QUALITY_SWITCHING:r.autoQualitySwitching=s,e.qualitySwitchingMode=this.getAbrMode(s);break;case Qn.MIN_BITRATE:r.minBitrate=s;break;case Qn.MAX_BITRATE:r.maxBitrate=s}else e.qualitySwitchingMode=t.QualityMode.UNAVAILABLE},n.prototype.switchToIndex=function(i,n,e){var r=n.minIndex,s=n.maxIndex;w.inRange(i,r,s)?(e.autoQualitySwitching=!1,n.qualitySwitchingMode=this.getAbrMode(!1),e.currentIndex=i):this.logger.log(t.LogLevel.WARN,i>=s?Mi.messages.ABR_MANUAL_SWITCHING_REACHED_UPPER_BOUNDS:Mi.messages.ABR_MANUAL_SWITCHING_REACHED_LOWER_BOUNDS)},n.prototype.switchQualityCategory=function(t,i,n){var e=t.qualityInfo.qualities,r=ae.getMinAndMaxValuesForCategory(e,i),s=r.minBitrate,u=r.maxBitrate,o=r.minIndex;o===r.maxIndex?this.switchToIndex(o,t,n):(n.minBitrate=s,n.maxBitrate=u)},n.prototype.getAbrMode=function(i){return i?t.QualityMode.AUTO:t.QualityMode.MANUAL},n}(ge),ye=function(t){function i(){var i=t.call(this)||this;return i.subCommands=null,i.subCommands=[],i.initializeMacroCommand(),i}return u(i,t),i.prototype.addSubCommand=function(t){this.subCommands.push(t)},i.prototype.execute=function(t){for(var i;this.subCommands.length>0;)(i=new(this.subCommands.shift())).initializeNotifier(this.multiCoreKey),i.execute(t)},i}(Xn),ke=function(i){function n(n,e){var r=i.call(this,n,{activeState:t.ActiveState.INACTIVE})||this;return r.mouseDown=!1,r.mouseOver=!1,r.idleDelay=3e3,r.idleEvents=["mousemove","mousedown","keypress","DOMMouseScroll","mousewheel","touchmove","touchstart","MSPointerMove","MSPointerDown","pointermove","pointerdown"],r.container=e.container,r.document=e.document,r.idleDelay=e.idleDelay,r}return u(n,i),n.prototype.onRegister=function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.reset=this.reset.bind(this),this.idle=this.idle.bind(this),this.container.addEventListener("mouseenter",this.onMouseEnter),this.container.addEventListener("mouseleave",this.onMouseLeave),this.container.addEventListener("mousedown",this.onMouseDown),this.document.addEventListener("mouseup",this.onMouseUp),this.document.addEventListener("keydown",this.onKeyDown)},n.prototype.onRemove=function(){this.container.removeEventListener("mouseenter",this.onMouseEnter),this.container.removeEventListener("mouseleave",this.onMouseLeave),this.container.removeEventListener("mousedown",this.onMouseDown),this.document.removeEventListener("mouseup",this.onMouseUp),this.document.removeEventListener("keydown",this.onKeyDown),this.stop(),this.container=null,this.document=null,i.prototype.onRemove.call(this)},n.prototype.applyListeners=function(t){var i=this;void 0===t&&(t=!0);var n=t?"add":"remove";this.idleEvents.forEach((function(t){return i.container["".concat(n,"EventListener")](t,i.reset,{passive:!0})}))},n.prototype.start=function(){this.stop(),this.applyListeners(),this.timeout=setTimeout(this.idle,this.idleDelay)},n.prototype.stop=function(){clearTimeout(this.timeout),this.applyListeners(!1)},n.prototype.idle=function(){this.activeState=this.mouseOver?t.ActiveState.IDLE:t.ActiveState.INACTIVE},n.prototype.reset=function(){this.activeState=t.ActiveState.ACTIVE,this.start()},n.prototype.onMouseEnter=function(){this.reset(),this.mouseOver=!0,this.activeState=t.ActiveState.ACTIVE,this.start()},n.prototype.onMouseLeave=function(){this.reset(),this.mouseOver=!1,this.activeState=t.ActiveState.INACTIVE},n.prototype.onMouseDown=function(){this.mouseDown=!0},n.prototype.onMouseUp=function(){this.mouseDown&&(this.mouseDown=!1,this.start())},n.prototype.onKeyDown=function(i){var n=this,e=i.key,r=i.keyCode;"Tab"!=e&&9!=r||setTimeout((function(){var i=n.document.activeElement,e=n.container==i||n.container.contains(i);e&&n.stop(),n.activeState=e?t.ActiveState.ACTIVE:t.ActiveState.INACTIVE}),0)},Object.defineProperty(n.prototype,"activeState",{get:function(){return this.data.activeState},set:function(i){this.mouseDown&&(i=t.ActiveState.ACTIVE),i!=this.data.activeState&&(this.data.activeState=i,this.sendNotification(Qn.APP_EVENT,{type:t.PlayerEvent.ACTIVE_CHANGE,data:{value:i}}))},enumerable:!1,configurable:!0}),n}(re),Oe=function(){function t(t,i){this.document=i,this.main=t}return t.createVideoElement=function(){var t=document.createElement("video");return t.style.height="100%",t.style.width="100%",t.style.backgroundColor="#000",t.dataset.elementId=w.uid8(),t},t.prototype.destroy=function(){this.main=null,this.document=null},t.prototype.create=function(i,n){var e,r,s,u=this,o=((e={})[Fn.MAIN_CONTAINER]=this.main,e),a=this.main,c={position:"absolute",width:"100%",height:"100%",padding:0,margin:0,overflow:"hidden"},h=[Fn.AD_CONTAINER,Fn.PANEL_CONTAINER,Fn.CC_CONTAINER,Fn.VIDEO_CONTAINER],l=a.style;l.position=l.position||"relative",l.padding=l.padding||"0",l.margin=l.margin||"0",l.width=l.width||"100%",l.height=l.height||"100%",l.backgroundColor=l.backgroundColor||"#000",l.overflow=l.overflow||"hidden",a.classList.add("cvp-container"),a.classList.add("avia-container");var f=a.hasChildNodes()?a.firstChild:null;if(h.forEach((function(t){if(!w.includes(i,t)){var n=u.div(t,c);o[t]=n,f?a.insertBefore(n,f):a.appendChild(n),f=n}})),!1!==(null===(s=n.overrides)||void 0===s?void 0:s.reuseVideoElement)){var d=t.createVideoElement();o[Fn.VIDEO_CONTAINER].appendChild(d),o[Fn.VIDEO_EL]=d}return o[Fn.AD_CLICK_EL]=this.createAdClickEl(),a.appendChild(o[Fn.AD_CLICK_EL]),(r={})[Fn.MAIN_CONTAINER]=o[Fn.MAIN_CONTAINER],r[Fn.VIDEO_EL]=o[Fn.VIDEO_EL],r[Fn.VIDEO_CONTAINER]=o[Fn.VIDEO_CONTAINER],r[Fn.CC_CONTAINER]=o[Fn.CC_CONTAINER],r[Fn.AD_CONTAINER]=o[Fn.AD_CONTAINER],r[Fn.AD_CLICK_EL]=o[Fn.AD_CLICK_EL],r[Fn.PANEL_CONTAINER]=o[Fn.PANEL_CONTAINER],r},t.prototype.createAdClickEl=function(){var t=this.div("adClickEl",{display:"none",padding:"4px 8px",fontSize:"12px",background:"#dedede",lineHeight:"14px",color:"#000",position:"absolute",right:"2px",top:"2px",textAlign:"center"});return t.innerHTML="Learn More",t},t.prototype.div=function(t,i){var n=this.document.createElement("div");return n.setAttribute("data-role",t),w.assign(n.style,i),n},t}(),we=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){var n=i.body.playerOptions.container,e=this.facade.retrieveService(Jt.System),r=this.getModel(Kn.PlayerOptions);if(!e.isWebMaf&&e.global&&e.document&&n){var s="string"==typeof n?e.document.querySelector(n):n,u=[];r.useNativeControls&&(u=[Fn.CC_CONTAINER,Fn.PANEL_CONTAINER]);var o=new Oe(s,e.document),a=o.create(u,r),c=this.facade.retrieveProxy(yn.PlayerDomProxy);c.setModel(a),o.destroy(),c.showAdContainer(!1),r.useNativeControls&&c.setVideoAttribute("controls",""),!1!==r.playsInline&&c.setVideoAttribute("playsinline",""),c.setVideoAttribute("data-player-id",this.facade.appId),this.facade.registerProxy(new ke(yn.ActivityProxy,{container:s,document:e.document,idleDelay:r.idleDelay})),this.log(t.LogLevel.INFO,"Player DOM created.")}},n}(ge),Te=function(t){function i(i){var n=t.call(this,yn.AdapterProxy,i)||this;return n.adapterMap={},n}return u(i,t),i.prototype.onRemove=function(){this.adapterMap=null,t.prototype.onRemove.call(this)},i.prototype.registerAdapter=function(t){var i=t.id;this.adapterMap[i]=t},i.prototype.retrieveAdapter=function(t){return this.adapterMap[t]},i.prototype.removeAdapter=function(t){delete this.adapterMap[t]},i.prototype.getAdaptersByRole=function(t){return w.values(this.adapterMap).filter((function(i){return w.includes(i.role,t)}))},i.prototype.createContext=function(t,i){var n=this.facade.retrieveMediator(Un.PLUGIN_MEDIATOR).createPluginServices(),e=n.dom,r=n.system,s=this.facade.retrieveProxy(yn.ModelCollectionProxy).getModel(Kn.PresentationState),u=this.facade.retrieveProxy(yn.TextTrackProxy),o=this.facade.retrieveProxy(yn.PerformanceProxy);return Object.assign(n,{resource:t,video:r.isWebMaf?r.webMafPlayer:e.video,container:e.main,autoplay:s.isAutoplay,muted:s.isMuteAtPlayStart,performanceSettings:o,textTrackSettings:u,getDelegate:i})},i.prototype.createAdapter=function(t,i,n){var e;return h(this,void 0,void 0,(function(){var r,s,u,o,a,c,h,f,d,v,b;return l(this,(function(l){switch(l.label){case 0:r=this.createContext(i,n),s=this.getAdaptersByRole(t),u=(null===(e=r.resource[t])||void 0===e?void 0:e.adapter)||{},o=u.id,a=u.options,c=void 0===a?{}:a,h=o?s.filter((function(t){return t.id===o})):s,f=0,d=h,l.label=1;case 1:return f<d.length?[4,(v=d[f]).factory(r,w.merge({},v.options,c))]:[3,4];case 2:if(b=l.sent())return[2,b];l.label=3;case 3:return f++,[3,1];case 4:throw new Error("Could not find adapter for role: ".concat(t))}}))}))},i}(re),Ee=function(i){function n(t,e){var r=i.call(this,t,{})||this;return r.pLocalizationData=[],r.pLocale={},r.pLanguage=e,r.registerLocalizationData(n.LocalizationData),r}return u(n,i),n.load=function(t){return null==this.pExternalData[t]&&(this.pExternalData[t]=Zt({url:t})),this.pExternalData[t]},n.prototype.onRemove=function(){this.pLocale=null,this.pLocalizationData=null,this.pLanguageTag=null,this.pLanguage=null},n.prototype.getApi=function(){return be({},this)},Object.defineProperty(n.prototype,"defaultLanguage",{get:function(){return navigator&&navigator.language?navigator.language:"en"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"language",{get:function(){return this.pLanguage||this.defaultLanguage},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"languageTag",{get:function(){return this.pLanguageTag},enumerable:!1,configurable:!0}),n.prototype.changeLanguage=function(i){var e=this;void 0===i&&(i=this.defaultLanguage),this.pLanguage=i,this.pLanguageTag=w.parseLanguageTag(this.language);var r=new RegExp("^".concat(this.pLanguageTag.language),"i"),s=this.pLocalizationData.map((function(i){var s=w.entries(i).filter((function(t){return r.test(t[0])})).map((function(i){return"string"==typeof i[1]?function(i){var r=i[0],s=i[1];return n.load(s).then((function(t){return[r,t]})).catch((function(i){return e.facade.log(t.LogLevel.ERROR,"Could not load locale file ".concat(s),i),[r,{}]}))}(i):i}));return Promise.all(s)}));return Promise.all(s).then((function(t){var i=t.map((function(t){return w.fromEntries(t)})),n=w.merge.apply(w,i);return e.pLocale=n}))},n.prototype.registerLocalizationData=function(t){w.isEmpty(t)||this.pLocalizationData.push(t)},n.prototype.localize=function(t,i){var n=this.lookup(t);return w.template(n,i)},n.prototype.lookup=function(t,i){var n=this;void 0===i&&(i=this.language);var e=function(i){return(n.pLocale[i]||{})[t]};return e(i)||e(this.pLanguageTag.language)||t},n.pExternalData={},n.LocalizationData={en:(Ae={},Ae[t.LocalizationId.MEDIA_PLAYER]="Media Player",Ae),es:(me={},me[t.LocalizationId.MEDIA_PLAYER]="Reproductor multimedia",me)},c([ve(!0)],n.prototype,"defaultLanguage",null),c([ve(!0)],n.prototype,"language",null),c([de()],n.prototype,"languageTag",null),c([de()],n.prototype,"changeLanguage",null),c([de()],n.prototype,"registerLocalizationData",null),c([de()],n.prototype,"localize",null),n}(re),je=function(t){function i(i,n){var e=t.call(this,i,n)||this;return e.resettables=[Kn.AdBreakInfo,Kn.AdItem,Kn.ContentPlaybackState],e}return u(i,t),i.prototype.onRemove=function(){this.resettables=null;var i=this.facade.retrieveProxy(yn.PlayerDomProxy);i&&i.removeDom(),t.prototype.onRemove.call(this)},Object.defineProperty(i.prototype,"collection",{get:function(){return this.data},enumerable:!1,configurable:!0}),i.prototype.getSnapshot=function(){return this.collection.getSnapshot()},i.prototype.getModel=function(t){return this.data.getModel(t)},i.prototype.reset=function(){for(var t=this.resettables,i=t.length;i--;)this.getModel(t[i]).reset();var n=this.getModel(Kn.PresentationState);n.skipAutoplayCheck=!n.isAutoplay||null!==n.autoplaySupport,n.isAutoplay=!0,n.isCurrentVideoAd=!1,n.started=!1,n.streamDuration=NaN,n.streamTime=NaN},i}(re),Ne=function(t){function i(n){var e=t.call(this,n)||this;return e.timer=new kn(i.INTERVAL),e.timer.on(kn.TIC_EVENT,(function(t){return e.onTic(t)})),e}return u(i,t),i.prototype.killTimer=function(){var t;null===(t=this.timer)||void 0===t||t.stop()},i.prototype.listNotificationInterests=function(){return[Qn.RESOURCE_START]},i.prototype.handleNotification=function(t){var i;if(t.name===Qn.RESOURCE_START)null===(i=this.timer)||void 0===i||i.start()},i.prototype.onRegister=function(){t.prototype.onRegister.call(this)},i.prototype.onRemove=function(){this.timer.destroy(),this.timer=null,t.prototype.onRemove.call(this)},i.prototype.onTic=function(t){this.facade.sendNotification(Qn.TIMER_TIC,{count:t.data.count},Hn.INTERNAL)},i.INTERVAL=100,i}(Yn),Se=function(i){function n(t,n){return i.call(this,t,n)||this}return u(n,i),n.prototype.onRegister=function(){var i=this.facade.retrieveProxy(yn.ModelCollectionProxy).getModel(Kn.PlayerOptions);this.pOverrides=i.overrides,this.pMode=i.performanceMode==t.PerformanceMode.AUTO?this.calculatePerformanceMode():i.performanceMode},n.prototype.calculatePerformanceMode=function(){var i=this.facade.retrieveService(Jt.System);switch(!0){case i.isTv:case i.isEmbedded:return t.PerformanceMode.TV;case i.isMobile:return t.PerformanceMode.MOBILE;default:return t.PerformanceMode.DESKTOP}},Object.defineProperty(n.prototype,"mode",{get:function(){return this.pMode},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"forwardBufferLength",{get:function(){switch(this.pMode){case t.PerformanceMode.MOBILE:case t.PerformanceMode.TV:return 20;default:return}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"backBufferLength",{get:function(){switch(this.pMode){case t.PerformanceMode.MOBILE:case t.PerformanceMode.TV:return 30;default:return 60}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"topQualityForwardBufferLength",{get:function(){switch(this.pMode){case t.PerformanceMode.MOBILE:case t.PerformanceMode.TV:return 60;default:return}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bufferingSampleRate",{get:function(){var i,n=null===(i=this.pOverrides)||void 0===i?void 0:i.bufferingSampleRate;return n||(this.pMode===t.PerformanceMode.TV?300:Ne.INTERVAL)},enumerable:!1,configurable:!0}),n}(re),Re=function(i){function n(t,n){var e=i.call(this,t,n)||this;return e.controlVisCssClass="cvui-ctrlbar-vis",e}return u(n,i),n.prototype.setModel=function(t){for(var i in t)this.model[i]=t[i]},n.prototype.removeDom=function(){for(var t=this.getMain(),i=t.childNodes,n=i.length;n--;)t.removeChild(i[n])},n.prototype.removePanelContainer=function(){var t=this.getElement(Fn.PANEL_CONTAINER),i=this.getMain();i&&t&&i.removeChild(t)},n.prototype.setControlVisibility=function(t){var i=this.getMain();if(i){var n=t?"add":"remove";i.classList[n](this.controlVisCssClass)}},n.prototype.getElement=function(t){return this.model[t]||null},n.prototype.getSafeZIndex=function(){var t=this.getElement(Fn.AD_CONTAINER);return t?Number(t.style.zIndex)+10:10},n.prototype.getVideo=function(){return this.getElement(Fn.VIDEO_EL)},n.prototype.getTextTrackContainer=function(){return this.getElement(Fn.CC_CONTAINER)||null},n.prototype.setVideoVolume=function(t){var i=this.getVideo();i&&this.getVideoVolume()!=t&&(i.volume=t)},n.prototype.getVideoVolume=function(){var t=this.getVideo();return t?t.volume:null},n.prototype.getMain=function(){return this.getElement(Fn.MAIN_CONTAINER)},n.prototype.showAdClickElement=function(t){var i=this.getElement(Fn.AD_CLICK_EL);i&&(i.style.display=!1!==t?"block":"none")},n.prototype.getDimensions=function(){var t=this.getPresentationRect();return t?{width:t.width,height:t.height}:null},n.prototype.showContainer=function(t,i){var n=this.getElement(t);n&&(n.style.display=i?"inline-block":"none")},n.prototype.showAdContainer=function(t){this.showContainer(Fn.AD_CONTAINER,t)},n.prototype.getPresentationRect=function(){var t=this.getMain();return t&&t.getBoundingClientRect()||null},n.prototype.muteVideo=function(t){var i=this.getVideo(),n="muted";i&&(i.muted=t,t&&i.setAttribute(n,n),!t&&i.removeAttribute(n))},n.prototype.primeVideo=function(t){var i=this;return void 0===t&&(t=Mi.blankVideoUrl),Promise.resolve().then((function(){var n=i.getVideo();if(n)return n.src=t,n.load(),n.play().catch((function(t){if(n.error&&n.src!=Mi.blankDataUrl)return i.primeVideo(Mi.blankDataUrl)}))}))},n.prototype.setVideoAttribute=function(t,i){var n=this.getVideo();null==n||n.setAttribute(t,i)},n.prototype.removeVideoAttribute=function(t){var i=this.getVideo();null==i||i.removeAttribute(t)},n.prototype.recreateVideo=function(){var i,n=Oe.createVideoElement(),e=this.getElement(Fn.VIDEO_CONTAINER),r=this.getElement(Fn.VIDEO_EL);if(r){var s=["src","data-element-id"];r.getAttributeNames().filter((function(t){return!w.includes(s,t)})).forEach((function(t){return n.setAttribute(t,r.getAttribute(t))})),e.replaceChild(n,r),this.sendNotification(Qn.APP_EVENT,{type:t.PlayerEvent.VIDEO_ELEMENT_REMOVED,data:r})}else e.appendChild(n);this.setModel(((i={})[Fn.VIDEO_EL]=n,i)),this.sendNotification(Qn.APP_EVENT,{type:t.PlayerEvent.VIDEO_ELEMENT_ADDED,data:n})},Object.defineProperty(n.prototype,"model",{get:function(){return this.data},enumerable:!1,configurable:!0}),n}(re),Ie=function(i){function n(t,n){var e=i.call(this,t,n)||this;return e.pCurrentIndex=-1,e.cachedApi=null,e.pList=[],e}return u(n,i),n.prototype.onRegister=function(){var t=this.facade.retrieveMediator(Un.APPLICATION);this.appMediator=t},n.prototype.onRemove=function(){this.clear(),this.pList=null,this.cachedApi=null,i.prototype.onRemove.call(this)},n.prototype.getApi=function(){return this.cachedApi||(this.cachedApi=be({},this)),this.cachedApi},Object.defineProperty(n.prototype,"list",{get:function(){for(var t=[],i=this.pList.length;i--;)t.unshift(w.merge({},this.pList[i]));return t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return this.pList.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentIndex",{get:function(){return this.pCurrentIndex},set:function(t){if(t<0||t>=this.pList.length)this.notify(Qn.PLAYLIST_OUT_OF_RANGE);else{var i=Math.max(this.pCurrentIndex,0);this.advance(t-i)}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentResource",{get:function(){return this.appMediator.getCurrentResource()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"nextResource",{get:function(){var t=this.find(this.pCurrentIndex+1);return t?w.merge({},t):null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"prevResource",{get:function(){var t=this.find(this.pCurrentIndex-1);return t?w.merge({},t):null},enumerable:!1,configurable:!0}),n.prototype.next=function(){return this.advance(1)},n.prototype.prev=function(){return this.advance(-1)},n.prototype.start=function(t){return void 0===t&&(t=0),this.pCurrentIndex=isNaN(t)?-1:t-1,this.advance()},n.prototype.addResources=function(t,i){var n=this;void 0===i&&(i=null),(Array.isArray(t)?t:[t]).forEach((function(t,e){var r=new Wn(t);null!==i?n.pList.splice(i+e,0,r):n.pList.push(r)})),this.notifyChanged()},n.prototype.removeResourceAtIndex=function(t){var i=this.length;if(t===this.currentIndex&&1===i)return this.clear(),null;if(t>=0&&t<i){var n=this.pList.splice(t,1);return t===this.currentIndex&&this.notify(Qn.PLAYLIST_CURRENT_RESOURCE_CLEARED,{interruptedResource:n}),this.notifyChanged(),n&&n[0]||null}return null},n.prototype.clear=function(){var t=this.find(this.pCurrentIndex);this.pList=[],this.pCurrentIndex=-1,this.notify(Qn.PLAYLIST_CLEARED,{interruptedResource:t})},n.prototype.softClear=function(){this.pList=[],this.pCurrentIndex=-1,this.sendNotification(Qn.APP_EVENT,{type:t.PlayerEvent.PLAYLIST_CLEARED})},n.prototype.advance=function(t){var i=this;void 0===t&&(t=1);var n=this.pCurrentIndex+t,e=this.find(n),r=null;if(e){return this.appMediator.attachResource(e,(function(){return i.pCurrentIndex=n})).then((function(t){return i.notify(Qn.PLAYLIST_ADVANCED,{resource:e,currentIndex:n}),t}))}return(r=n<0?Qn.PLAYLIST_OUT_OF_RANGE:Qn.PLAYLIST_COMPLETE)&&this.notify(r),Promise.resolve(null)},n.prototype.find=function(t){return t>=0&&t<this.pList.length&&this.pList[t]||null},n.prototype.notify=function(t,i){void 0===i&&(i=null),this.facade&&this.facade.sendNotification(t,i||null,Hn.INTERNAL)},n.prototype.notifyChanged=function(){this.notify(Qn.PLAYLIST_CHANGE,null)},c([ve(!0)],n.prototype,"list",null),c([ve()],n.prototype,"length",null),c([ve()],n.prototype,"currentIndex",null),c([ve()],n.prototype,"currentResource",null),c([ve()],n.prototype,"nextResource",null),c([ve()],n.prototype,"prevResource",null),c([de()],n.prototype,"next",null),c([de()],n.prototype,"prev",null),c([de()],n.prototype,"start",null),c([de()],n.prototype,"addResources",null),c([de()],n.prototype,"removeResourceAtIndex",null),c([de()],n.prototype,"clear",null),n}(re),Ce=function(i){function n(n,e){return void 0===e&&(e={}),i.call(this,n,{native:!1!==e.native,mode:t.TextTrackMode.DISABLED,language:null!=e.language?e.language:navigator.language})||this}return u(n,i),Object.defineProperty(n.prototype,"mode",{get:function(){return this.data.mode},set:function(t){this.data.mode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"enabled",{get:function(){return this.data.mode!=t.TextTrackMode.DISABLED},set:function(i){this.mode=i?this.enabledMode:t.TextTrackMode.DISABLED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"enabledMode",{get:function(){return this.data.native?t.TextTrackMode.SHOWING:t.TextTrackMode.HIDDEN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"native",{get:function(){return this.data.native},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"language",{get:function(){return this.data.language},set:function(t){this.data.language=t},enumerable:!1,configurable:!0}),n}(re),Pe=function(){function t(){}return t.checkType=function(t,i,n){return"string"==typeof i&&(i=[i]),!(!n||null!==t)||i.some((function(i){return typeof t===i}))},t.notEmpty=function(t){return!(null==t||Array.isArray(t)&&0===t.length||"object"==typeof t&&t.constructor===Object&&0===Object.keys(t).length||"string"==typeof t&&""===t)},t.isArray=function(t){return Array.isArray(t)},t.validNumber=function(t,i){return"number"!=typeof t?i:t},t.isTypedArray=function(t,i){if(this.isArray(t)&&this.notEmpty(t)){for(var n=t.length;n--;)if(typeof t[n]!==i)return!1;return!0}return!1},t.isType=function(t,i){return t instanceof i},t.isPositiveNumber=function(t){return"number"==typeof t&&t>=0},t}(),_e={adBreakDuration:{type:"number",defaultValue:-1,setterTransformer:function(t){return"number"!=typeof t?-1:t}},adTotal:{type:"number",defaultValue:-1,setterTransformer:function(t){return"number"!=typeof t?-1:t}},adBreakPosition:{type:"number",defaultValue:-1,setterTransformer:function(t){return"number"!=typeof t?-1:t}},adBreakType:{type:"string",defaultValue:null,setterTransformer:function(i){return i===t.AdBreakType.MID||i===t.AdBreakType.POST||i===t.AdBreakType.PRE?i:null}},adServerName:{type:"string",defaultValue:null,validator:Pe.notEmpty}},De={adDuration:{type:"number",defaultValue:-1,setterTransformer:function(t){return Pe.validNumber(t,-1)}},adTitle:{type:"string",defaultValue:null},adId:{type:"string",defaultValue:null},adPosition:{type:"number",defaultValue:-1,setterTransformer:function(t){return Pe.validNumber(t,-1)}},adAssetUrl:{type:"string",defaultValue:null},isVpaid:{type:"boolean",defaultValue:!1,setterTransformer:function(t){return"boolean"==typeof t&&t}},wrapperAdId:{type:"string",defaultValue:null},creativeId:{type:"string",defaultValue:null},wrapperCreativeId:{type:"string",defaultValue:null},vastMediaWidth:{type:"number",defaultValue:null},vastMediaHeight:{type:"number",defaultValue:null},vastMediaBitrate:{type:"number",defaultValue:null}},Me={manifestQualities:{type:"object",defaultValue:null},qualityInfo:{type:"object",defaultValue:null},audioTracks:{type:"object",defaultValue:null},textTracks:{type:"object",defaultValue:null},streamType:{type:"string",defaultValue:t.StreamType.VOD},liveStreamInfo:{type:"object",defaultValue:null},bufferLength:{type:"number",defaultValue:0},cdn:{type:"string",defaultValue:null,validator:Pe.notEmpty},drmType:{type:"string",defaultValue:null,validator:Pe.notEmpty},contentSegment:{type:"number",defaultValue:NaN},maxBandwidth:{type:"number",defaultValue:NaN},time:{type:"number",defaultValue:0},state:{type:"string",defaultValue:t.PlaybackState.IDLE},duration:{type:"number",defaultValue:NaN},bitrate:{type:"number",defaultValue:NaN},started:{type:"boolean",defaultValue:!1},averageDroppedFps:{type:"number",defaultValue:NaN},framerate:{type:"number",defaultValue:NaN}},xe={container:{type:["object","string"],defaultValue:null},dataTransformers:{type:"object",defaultValue:null},plugins:{type:"object",defaultValue:null},nativePlugins:{type:"object",defaultValue:null},autoplay:{type:"string",defaultValue:t.Autoplay.NONE},offsetTextOnControlsVisible:{type:"boolean",defaultValue:!1},id:{type:"string",defaultValue:null},networkErrorRecovery:{type:"object",defaultValue:null},networkTimeout:{type:"number",defaultValue:N.TIMEOUT},performanceMode:{type:"string",defaultValue:t.PerformanceMode.AUTO},renderTextTrackNatively:{type:"boolean",defaultValue:!0},useNativeFullscreen:{type:"boolean",defaultValue:!0},playsInline:{type:"boolean",defaultValue:!0},uiConfig:{type:"object",defaultValue:null},useNativeControls:{type:"boolean",defaultValue:!1},overrides:{type:"object",defaultValue:{}},logLevel:{type:"string",defaultValue:t.LogLevel.OFF},language:{type:"string",defaultValue:null},localization:{type:"object",defaultValue:null},idleDelay:{type:"number",defaultValue:3e3},enableOm:{type:"boolean",defaultValue:!1}},Le=function(){function t(){}return t.clampValue=function(t,i,n){return"number"!=typeof t?null:Math.max(i,Math.min(t,n))},t.lowerCase=function(t){return"string"==typeof t?t.toLowerCase():t},t.strToNum=function(t){if("number"==typeof t)return t;if("string"==typeof t){var i=parseFloat(t);return isNaN(i)?t:i}return t},t}(),Ve={ad_break_info_config:_e,ad_item_config:De,content_playback_state_config:Me,player_dom_config:{main:{type:"object",defaultValue:null},video:{type:"object",defaultValue:null},videoContainer:{type:"object",defaultValue:null},ccContainer:{type:"object",defaultValue:null},adContainer:{type:"object",defaultValue:null},panelContainer:{type:"object",defaultValue:null},adClickEl:{type:"object",defaultValue:null}},player_options_config:xe,presentation_state_config:{skipAutoplayCheck:{type:"boolean",defaultValue:!1},streamTime:{type:"number",defaultValue:0,setterTransformer:function(t){return Pe.isPositiveNumber(t)?t:0}},streamDuration:{type:"number",defaultValue:NaN,setterTransformer:function(t){return Pe.isPositiveNumber(t)?t:NaN}},autoplaySupport:{type:"object",defaultValue:null},isAutoplay:{type:"boolean",defaultValue:!1},isCurrentVideoAd:{type:"boolean",defaultValue:!1},isFullscreen:{type:"boolean",defaultValue:!1},isMuted:{type:"boolean",defaultValue:!1},isMuteAtPlayStart:{type:"boolean",defaultValue:!1},started:{type:"boolean",defaultValue:!1},userHasUnmuted:{type:"boolean",defaultValue:!1},volume:{type:"number",defaultValue:1,setterTransformer:function(t){return Le.clampValue(t,0,1)}},usesSsai:{type:"boolean",defaultValue:!1},streamId:{type:"string",defaultValue:null},suspended:{type:"boolean",defaultValue:!1}}},Be=function(){function t(){}return t.generateModel=function(t,i,n,e){for(var r in i)this.createProperty(r,i[r],t,n,e)},t.createProperty=function(t,i,n,e,r){var s=i.validator,u=i.type,o=i.defaultValue,a=!1!==i.enumerable,c=this.getTransformer(i,"setter",n),h=this.getTransformer(i,"getter",n);!1===i.writable?(Object.defineProperty(n,t,{enumerable:a,value:o,writable:!1}),e[t]=o):(Object.defineProperty(n,t,{enumerable:a,set:function(i){var n=c(i);!s||s(n)?Pe.checkType(n,u,null===o)?e[t]=n:j.warn("Invalid type supplied for property ".concat(t)):j.warn("Invalid value '".concat(n,"' for property ").concat(t))},get:function(){return h(e[t])}}),e[t]=o),r[t]=o},t.getTransformer=function(t,i,n){var e=t[i+"Transformer"];return e&&"function"==typeof e?e.bind(n):this.blankTransformer},t.blankTransformer=function(t){return t},t}(),Ue=function(){function t(t){this.pData={},this.defaultValues={},Be.generateModel(this,t,this.pData,this.defaultValues)}return Object.defineProperty(t.prototype,"data",{get:function(){return w.assign({},this.pData)},enumerable:!1,configurable:!0}),t.prototype.reset=function(){for(var t in this.defaultValues)this.pData[t]=this.defaultValues[t]},t}(),Fe=function(){function t(t){this.model=new Ue(t)}return Object.defineProperty(t,"modelName",{get:function(){return"AdBreakInfo"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.model.data},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.model.reset()},Object.defineProperty(t.prototype,"adBreakDuration",{get:function(){return this.model.adBreakDuration},set:function(t){this.model.adBreakDuration=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adBreakPosition",{get:function(){return this.model.adBreakPosition},set:function(t){this.model.adBreakPosition=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adBreakType",{get:function(){return this.model.adBreakType},set:function(t){this.model.adBreakType=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adServerName",{get:function(){return this.model.adServerName},set:function(t){this.model.adServerName=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adTotal",{get:function(){return this.model.adTotal},set:function(t){this.model.adTotal=t},enumerable:!1,configurable:!0}),t}(),Ke=function(){function t(t){this.model=new Ue(t)}return Object.defineProperty(t,"modelName",{get:function(){return"AdItem"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.model.data},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.model.reset()},Object.defineProperty(t.prototype,"adDuration",{get:function(){return this.model.adDuration},set:function(t){this.model.adDuration=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adTitle",{get:function(){return this.model.adTitle},set:function(t){this.model.adTitle=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adId",{get:function(){return this.model.adId},set:function(t){this.model.adId=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adPosition",{get:function(){return this.model.adPosition},set:function(t){this.model.adPosition=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adAssetUrl",{get:function(){return this.model.adAssetUrl},set:function(t){this.model.adAssetUrl=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVpaid",{get:function(){return this.model.isVpaid},set:function(t){this.model.isVpaid=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapperAdId",{get:function(){return this.model.wrapperAdId},set:function(t){this.model.wrapperAdId=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"creativeId",{get:function(){return this.model.creativeId},set:function(t){this.model.creativeId=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapperCreativeId",{get:function(){return this.model.wrapperCreativeId},set:function(t){this.model.wrapperCreativeId=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vastMediaWidth",{get:function(){return this.model.vastMediaWidth},set:function(t){this.model.vastMediaWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vastMediaHeight",{get:function(){return this.model.vastMediaHeight},set:function(t){this.model.vastMediaHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vastMediaBitrate",{get:function(){return this.model.vastMediaBitrate},set:function(t){this.model.vastMediaBitrate=t},enumerable:!1,configurable:!0}),t}(),Qe=function(){function t(t){this.model=new Ue(t)}return Object.defineProperty(t,"modelName",{get:function(){return"ContentPlaybackState"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.model.data},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.model.reset()},Object.defineProperty(t.prototype,"manifestQualities",{get:function(){return this.model.manifestQualities},set:function(t){this.model.manifestQualities=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qualityInfo",{get:function(){return this.model.qualityInfo},set:function(t){this.model.qualityInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"audioTracks",{get:function(){return this.model.audioTracks},set:function(t){this.model.audioTracks=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textTracks",{get:function(){return this.model.textTracks},set:function(t){this.model.textTracks=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"streamType",{get:function(){return this.model.streamType},set:function(t){this.model.streamType=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"liveStreamInfo",{get:function(){return this.model.liveStreamInfo},set:function(t){this.model.liveStreamInfo=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bufferLength",{get:function(){return this.model.bufferLength},set:function(t){this.model.bufferLength=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cdn",{get:function(){return this.model.cdn},set:function(t){this.model.cdn=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"drmType",{get:function(){return this.model.drmType},set:function(t){this.model.drmType=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentSegment",{get:function(){return this.model.contentSegment},set:function(t){this.model.contentSegment=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxBandwidth",{get:function(){return this.model.maxBandwidth},set:function(t){this.model.maxBandwidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return this.model.time},set:function(t){this.model.time=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.model.state},set:function(t){this.model.state=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.model.duration},set:function(t){this.model.duration=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bitrate",{get:function(){return this.model.bitrate},set:function(t){this.model.bitrate=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"started",{get:function(){return this.model.started},set:function(t){this.model.started=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"averageDroppedFps",{get:function(){return this.model.averageDroppedFps},set:function(t){this.model.averageDroppedFps=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"framerate",{get:function(){return this.model.framerate},set:function(t){this.model.framerate=t},enumerable:!1,configurable:!0}),t}(),He=function(){function t(t){this.model=new Ue(t)}return Object.defineProperty(t,"modelName",{get:function(){return"PlayerDom"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.model.data},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.model.reset()},Object.defineProperty(t.prototype,"main",{get:function(){return this.model.main},set:function(t){this.model.main=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"video",{get:function(){return this.model.video},set:function(t){this.model.video=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoContainer",{get:function(){return this.model.videoContainer},set:function(t){this.model.videoContainer=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ccContainer",{get:function(){return this.model.ccContainer},set:function(t){this.model.ccContainer=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adContainer",{get:function(){return this.model.adContainer},set:function(t){this.model.adContainer=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"panelContainer",{get:function(){return this.model.panelContainer},set:function(t){this.model.panelContainer=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adClickEl",{get:function(){return this.model.adClickEl},set:function(t){this.model.adClickEl=t},enumerable:!1,configurable:!0}),t}(),qe=function(){function t(t){this.model=new Ue(t)}return Object.defineProperty(t,"modelName",{get:function(){return"PlayerOptions"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.model.data},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.model.reset()},Object.defineProperty(t.prototype,"container",{get:function(){return this.model.container},set:function(t){this.model.container=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataTransformers",{get:function(){return this.model.dataTransformers},set:function(t){this.model.dataTransformers=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plugins",{get:function(){return this.model.plugins},set:function(t){this.model.plugins=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nativePlugins",{get:function(){return this.model.nativePlugins},set:function(t){this.model.nativePlugins=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoplay",{get:function(){return this.model.autoplay},set:function(t){this.model.autoplay=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetTextOnControlsVisible",{get:function(){return this.model.offsetTextOnControlsVisible},set:function(t){this.model.offsetTextOnControlsVisible=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.model.id},set:function(t){this.model.id=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmbedded",{get:function(){return this.model.isEmbedded},set:function(t){this.model.isEmbedded=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"networkErrorRecovery",{get:function(){return this.model.networkErrorRecovery},set:function(t){this.model.networkErrorRecovery=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"networkTimeout",{get:function(){return this.model.networkTimeout},set:function(t){this.model.networkTimeout=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"performanceMode",{get:function(){return this.model.performanceMode},set:function(t){this.model.performanceMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderTextTrackNatively",{get:function(){return this.model.renderTextTrackNatively},set:function(t){this.model.renderTextTrackNatively=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useNativeFullscreen",{get:function(){return this.model.useNativeFullscreen},set:function(t){this.model.useNativeFullscreen=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playsInline",{get:function(){return this.model.playsInline},set:function(t){this.model.playsInline=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uiConfig",{get:function(){return this.model.uiConfig},set:function(t){this.model.uiConfig=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useNativeControls",{get:function(){return this.model.useNativeControls},set:function(t){this.model.useNativeControls=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"overrides",{get:function(){return this.model.overrides},set:function(t){this.model.overrides=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logLevel",{get:function(){return this.model.logLevel},set:function(t){this.model.logLevel=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){return this.model.language},set:function(t){this.model.language=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localization",{get:function(){return this.model.localization},set:function(t){this.model.localization=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idleDelay",{get:function(){return this.model.idleDelay},set:function(t){this.model.idleDelay=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enableOm",{get:function(){return this.model.enableOm},set:function(t){this.model.enableOm=t},enumerable:!1,configurable:!0}),t}(),ze=function(){function t(t){this.model=new Ue(t)}return Object.defineProperty(t,"modelName",{get:function(){return"PresentationState"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.model.data},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.model.reset()},Object.defineProperty(t.prototype,"skipAutoplayCheck",{get:function(){return this.model.skipAutoplayCheck},set:function(t){this.model.skipAutoplayCheck=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"streamTime",{get:function(){return this.model.streamTime},set:function(t){this.model.streamTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"streamDuration",{get:function(){return this.model.streamDuration},set:function(t){this.model.streamDuration=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoplaySupport",{get:function(){return this.model.autoplaySupport},set:function(t){this.model.autoplaySupport=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAutoplay",{get:function(){return this.model.isAutoplay},set:function(t){this.model.isAutoplay=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCurrentVideoAd",{get:function(){return this.model.isCurrentVideoAd},set:function(t){this.model.isCurrentVideoAd=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFullscreen",{get:function(){return this.model.isFullscreen},set:function(t){this.model.isFullscreen=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMuted",{get:function(){return this.model.isMuted},set:function(t){this.model.isMuted=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMuteAtPlayStart",{get:function(){return this.model.isMuteAtPlayStart},set:function(t){this.model.isMuteAtPlayStart=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"started",{get:function(){return this.model.started},set:function(t){this.model.started=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userHasUnmuted",{get:function(){return this.model.userHasUnmuted},set:function(t){this.model.userHasUnmuted=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this.model.volume},set:function(t){this.model.volume=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"usesSsai",{get:function(){return this.model.usesSsai},set:function(t){this.model.usesSsai=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"streamId",{get:function(){return this.model.streamId},set:function(t){this.model.streamId=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suspended",{get:function(){return this.model.suspended},set:function(t){this.model.suspended=t},enumerable:!1,configurable:!0}),t}(),We=function(){function t(){this.mdlCollection={},this.createModels()}return t.prototype.destroy=function(){for(var t in this.mdlCollection)delete this.mdlCollection[t];this.mdlCollection=null},t.prototype.getModel=function(t){return this.mdlCollection[t]},t.prototype.getSnapshot=function(){var t={};for(var i in this.mdlCollection)"PlayerDom"!=i&&"PlayerOptions"!=i&&"BuildInfo"!=i&&(t[i]=this.mdlCollection[i].data);return t},Object.defineProperty(t.prototype,"AdBreakInfo",{get:function(){return this.mdlCollection.AdBreakInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"AdItem",{get:function(){return this.mdlCollection.AdItem},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ContentPlaybackState",{get:function(){return this.mdlCollection.ContentPlaybackState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"PlayerDom",{get:function(){return this.mdlCollection.PlayerDom},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"PlayerOptions",{get:function(){return this.mdlCollection.PlayerOptions},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"PresentationState",{get:function(){return this.mdlCollection.PresentationState},enumerable:!1,configurable:!0}),t.prototype.createModels=function(){for(var t=[Fe,Ke,Qe,He,qe,ze],i=t.length;i--;){var n=t[i],e=n.modelName,r=Ve[this.classToCfgName(e)];this.mdlCollection[e]=new n(r)}},t.prototype.classToCfgName=function(t){return t.replace(/(?:^|\.?)([A-Z])/g,(function(t,i){return"_"+i.toLowerCase()})).replace(/^_/,"")+"_config"},t}(),Ge=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){var n=this.facade.retrieveService(Jt.System),e=new We,r=new je(yn.ModelCollectionProxy,e),s=i.body.playerOptions;this.facade.registerProxy(r),this.setPlayerOptions(r,s),this.facade.registerProxy(new Se(yn.PerformanceProxy));var u=new Ee(yn.LocalizationProxy,s.language);this.facade.registerProxy(u),this.facade.registerProxy(new Ce(yn.TextTrackProxy,{native:s.renderTextTrackNatively,language:u.language})),!n.isWebMaf&&this.createDomProxy(r),this.facade.registerProxy(new Te),this.facade.registerProxy(new Ie(yn.Playlist)),this.log(t.LogLevel.DEBUG,"Model prepared")},n.prototype.setPlayerOptions=function(t,i){var n=t.getModel(Kn.PlayerOptions);for(var e in i)!w.isUndefined(n[e])&&(n[e]=i[e])},n.prototype.createDomProxy=function(t){var i=t.getModel(Kn.PlayerDom),n=new Re(yn.PlayerDomProxy,i);this.facade.registerProxy(n)},n}(ge),Xe=function(){function t(t){var i=this;this.xhr=ee.xhr,this.event={dispatchPluginEvent:function(t){i.dispatch(t)}},this.util={queryStrFromObj:function(t,i){return $t.encode(t)}},this.vc=null,this.playerApi=null,this.sys=null,this.bi=null,this.domProxy=null,this.playerOpts=null,this.loc=null,this.log=null,this.playerApi=t.player,this.vc=t.viewController,this.sys=t.system,this.bi=t.buildInfo,this.domProxy=t.domProxy,this.playerOpts=t.playerOptions,this.loc=t.localization,this.dispatch=t.dispatch,this.log=t.logger}return Object.defineProperty(t.prototype,"player",{get:function(){return this.playerApi},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logger",{get:function(){return this.log},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewController",{get:function(){return this.vc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"system",{get:function(){return this.sys},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appNamespace",{get:function(){return this.sys.appNamespace},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"avia",{get:function(){return this.sys.appNamespace},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playerOptions",{get:function(){return this.playerOpts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"buildInfo",{get:function(){return this.bi},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playerDomProxy",{get:function(){return ee.warn("The PluginService.playerDomProxy method is deprecated. Use PluginService.dom instead. Access to this property will be completely removed April 28th, 2022"),this.domProxy},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localization",{get:function(){return this.loc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dom",{get:function(){var t,i,n,e,r,s=this;return{main:null===(t=this.domProxy)||void 0===t?void 0:t.getMain(),get video(){return function(){var t;return null===(t=s.domProxy)||void 0===t?void 0:t.getVideo()}()},videoContainer:null===(i=this.domProxy)||void 0===i?void 0:i.getElement(Fn.VIDEO_CONTAINER),ccContainer:null===(n=this.domProxy)||void 0===n?void 0:n.getElement(Fn.CC_CONTAINER),adContainer:null===(e=this.domProxy)||void 0===e?void 0:e.getElement(Fn.AD_CONTAINER),adClickEl:null===(r=this.domProxy)||void 0===r?void 0:r.getElement(Fn.AD_CLICK_EL)}},enumerable:!1,configurable:!0}),t}(),Ye=function(i){function n(t){var n=i.call(this,t)||this;return n.plugins={},n.pendingLoads=null,n.services=null,n.diagnosticPlugin=null,n.diagnosticPluginVisible=!1,n}return u(n,i),n.prototype.onRemove=function(){var t=this;Object.keys(this.plugins).forEach((function(i){try{t.killPlugin(i)}catch(n){t.logger.warn("Error destroying plugin: ".concat(i),n)}})),this.plugins=null,this.pendingLoads=null,this.services=null,this.diagnosticPlugin=null,i.prototype.onRemove.call(this)},n.prototype.removePlugin=function(t){this.killPlugin(t)},n.prototype.getPlugin=function(t){return this.plugins[t]||null},n.prototype.loadPlugin=function(i){return h(this,void 0,void 0,(function(){var n;return l(this,(function(e){switch(e.label){case 0:return[4,this.createPlugin(i)];case 1:return n=e.sent(),i.name==t.NativePlugin.DIAGNOSTIC&&this.registerDiagnosticPlugin(i.name),[2,n]}}))}))},n.prototype.toggleDiagnosticPlugin=function(){if(!this.diagnosticPlugin&&this.createDiagnosticPlugin())return;this.diagnosticPluginVisible=!this.diagnosticPluginVisible,this.diagnosticPluginVisible?this.diagnosticPlugin.show():this.diagnosticPlugin.hide()},n.prototype.listNotificationInterests=function(){return[Qn.LOAD_PLUGINS,Qn.AD_BREAK_START,Qn.CONTENT_START,Qn.REMOVE_PLUGIN]},n.prototype.handleNotification=function(t){switch(t.name){case Qn.LOAD_PLUGINS:this.loadPlugins(t.body);break;case Qn.REMOVE_PLUGIN:this.removePlugin(t.body.name);break;case Qn.AD_BREAK_START:case Qn.CONTENT_START:this.loadPendingPlugins()}},n.prototype.createPluginServices=function(){var t=this.facade.retrieveMediator(Un.APPLICATION),i=this.facade.retrieveMediator(Un.UI);return new Xe({player:t.getAppApi(),viewController:i?i.viewController:null,buildInfo:ai,system:this.facade.retrieveService(Jt.System),domProxy:this.facade.retrieveProxy(yn.PlayerDomProxy),localization:this.facade.retrieveProxy(yn.LocalizationProxy).getApi(),playerOptions:this.playerOptions,dispatch:function(i){t.dispatchPluginEvent(i)},logger:this.logger})},n.prototype.registerDiagnosticPlugin=function(t){this.diagnosticPlugin=this.plugins[t],this.diagnosticPluginVisible=!0},Object.defineProperty(n.prototype,"playerOptions",{get:function(){return this.getModel(Kn.PlayerOptions).data},enumerable:!1,configurable:!0}),n.prototype.initPluginServices=function(){this.services||(this.services=this.createPluginServices())},n.prototype.createDiagnosticPlugin=function(){var i=this,n=ae.getNativePluginConfig(t.NativePlugin.DIAGNOSTIC,this.playerOptions);return!n||(this.plugins[n.name]?(this.registerDiagnosticPlugin(n.name),!1):(this.initPluginServices(),this.createPlugin(n).then((function(){return i.registerDiagnosticPlugin(n.name)})),!0))},n.prototype.createPlugins=function(t,i){var n=this;return Promise.all(t.map((function(t){return n.createPlugin(t)}))).then((function(){return null==i?void 0:i()}))},n.prototype.createPlugin=function(i){var n;return h(this,void 0,void 0,(function(){var e,r,s,u,o;return l(this,(function(a){switch(a.label){case 0:if(!i.url)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,R.load({url:i.url,errorRecovery:this.playerOptions.networkErrorRecovery,timeout:null!=i.loadTimeout?i.loadTimeout:this.playerOptions.networkTimeout})];case 2:return a.sent(),[3,4];case 3:return e=a.sent(),this.log(t.LogLevel.ERROR,Mi.messages.PLUGIN_LOAD_ERROR,e),[2];case 4:return r=i.name,s=w.assign({name:r},i.options),i.factory?[4,i.factory(this.services,s)]:[3,6];case 5:return u=a.sent(),w.isFunction(u)&&(u={destroy:u}),[3,8];case 6:return(o=i.classRef?i.classRef:ae.classFromQualifiedName(i.qualifiedClassName))?(u=w.isFunction(o.onRegister)?o:new o,[4,null===(n=u.onRegister)||void 0===n?void 0:n.call(u,this.services.player,s,this.services)]):[3,8];case 7:a.sent(),a.label=8;case 8:return u?(this.plugins[r]=u,this.log(t.LogLevel.INFO,"Created plugin '".concat(r,"'")),[2,u]):[2]}}))}))},n.prototype.killPlugin=function(t){var i=this.plugins[t];i&&(w.isFunction(i.destroy)&&i.destroy(),delete this.plugins[t])},n.prototype.loadPendingPlugins=function(){this.pendingLoads&&(this.createPlugins(this.pendingLoads),this.pendingLoads=null)},n.prototype.loadPlugins=function(i){var n=i.plugins||this.playerOptions.plugins,e=!this.getModel(Kn.PresentationState).started,r=i.callback;if(null==n?void 0:n.length){this.initPluginServices();var s=n.filter((function(i){return i.priority===t.PluginPriority.LOW})),u=n.filter((function(i){return i.priority!==t.PluginPriority.LOW}));e&&(this.pendingLoads=s);var o=e?u:s.concat(u);this.createPlugins(o,r)}else null==r||r()},n}(Yn),$e=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){this.facade.registerMediator(new Ye(Un.PLUGIN_MEDIATOR)),this.log(t.LogLevel.DEBUG,"Plugins Prepared")},n}(ge),Ze=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){this.facade.registerMediator(new Ne(Un.TIMER_MEDIATOR)),this.log(t.LogLevel.DEBUG,"Timer mediator registered")},n}(ge),Je=function(t){function i(i){var n=t.call(this,i)||this;return n.defs=[],n.pScope=null,n.keyUpHandler=null,n.keyDownHandler=null,n.pDisabled=!1,n.suppressed=!1,n.scopeActive=null,n}return u(i,t),i.prototype.onRemove=function(){this.activateScope(!1),this.pScope=null;var t=function(t){};this.keyUpHandler=t,this.keyDownHandler=t},Object.defineProperty(i.prototype,"disabled",{get:function(){return this.suppressed||this.pDisabled},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"scope",{set:function(t){this.suppressed||(this.pScope&&this.scopeActive&&this.activateScope(!1),this.pScope=t,(!!this.scopeActive||null===this.scopeActive)&&this.activateScope(!0))},enumerable:!1,configurable:!0}),i.prototype.registerCommandDef=function(t){this.suppressed||this.defs.push(t)},i.prototype.disable=function(){this.suppressed||(this.scopeActive&&this.activateScope(!1),this.pDisabled=!0)},i.prototype.enable=function(){this.suppressed||(!this.scopeActive&&this.activateScope(!0),this.pDisabled=!1)},i.prototype.validatePrimaryKey=function(t,i){var n=i.key,e=w.isString(n)&&n.toLowerCase(),r=i.keyCode;return!(!n&&!r)&&(t.primaryKey===n||t.primaryKey===e||t.keyCode===r)},i.prototype.getCommand=function(t,i){void 0===i&&(i=!0);for(var n,e=this.defs.length,r=null;e--;)if(n=this.defs[e],this.validatePrimaryKey(n,t)&&(!i||this.hasRequiredModifiers(n,t))){r=n;break}return r},i.prototype.hasRequiredModifiers=function(t,i){var n=!!((t.requireCtrl?1:0)^(i.ctrlKey?1:0)),e=!!((t.requireShift?1:0)^(i.shiftKey?1:0)),r=!!((t.requireMeta?1:0)^(i.metaKey?1:0));return!n&&!e&&!r},i.prototype.activateScope=function(t){if(this.pScope&&!this.suppressed){var i=t?"addEventListener":"removeEventListener";this.pScope[i]("keyup",this.keyUpHandler),this.pScope[i]("keydown",this.keyDownHandler),this.scopeActive=t}},i.prototype.handleNotification=function(t){},i.prototype.onRegister=function(){var i=this;t.prototype.onRegister.call(this);var n=this.facade.retrieveService(Jt.System);!n.document||n.isTv||n.isWebMaf?this.suppressed=!0:(this.keyDownHandler=function(t){return i.hKeyDown(t)},this.keyUpHandler=function(t){return i.hKeyUp(t)})},i}(Yn),tr=function(i){function n(t){var n=i.call(this,t)||this;return n.uim=null,n.vpi=null,n.seekMoving=!1,n.seekEnabled=!1,n.VOLUME_INCREMENT=.05,n.SEEK_FACTOR_DISCRETE=.05,n.SEEK_INCREMENT_CONTINUOUS=.001,n.tZero=0,n}return u(n,i),n.prototype.onRemove=function(){clearTimeout(this.timeout),this.vpi=null,this.uim=null,i.prototype.onRemove.call(this)},n.prototype.isControl=function(t){return"BUTTON"==t.nodeName||"INPUT"==t.nodeName},n.prototype.hKeyUp=function(t){this.disabled||this.isControl(document.activeElement)||(this.seekMoving?this.disengageSeek():this.processKeyEvent(t))},n.prototype.hKeyDown=function(t){var i=t.key,n=t.keyCode,e=i===ui.ARROW_UP||n===Ai,r=i===ui.ARROW_DOWN||n===gi,s=i===ui.SPACE||n===pi,u=i===ui.ARROW_LEFT||n===bi,o=i===ui.ARROW_RIGHT||n===mi,a=t.repeat;if(!(o||u||e||r||s)||this.isControl(document.activeElement)){if(this.shouldSeekContinuous()&&(u||o)){if(!this.seekMoving&&a)this.tZero=Date.now(),this.engageSeek();else if(this.seekMoving&&a){var c=.001*(Date.now()-this.tZero),h=c>=5?3:c>=3?2:1,l=u?-1:1;this.moveSeekBy(l*this.SEEK_INCREMENT_CONTINUOUS*h)}this.stopEvent(t)}}else t.preventDefault()},n.prototype.engageSeek=function(){this.uim&&this.uim.engageSeek(),this.seekMoving=!0},n.prototype.disengageSeek=function(){var t=this;this.uim&&this.uim.disengageSeek(),this.seekMoving=!1,this.tZero=null,this.timeout=setTimeout((function(){t.uim&&t.uim.forceControlsVisible(!1)}),500)},n.prototype.moveSeekBy=function(t){this.uim&&this.uim.moveSeekBy(t)},n.prototype.shouldSeekContinuous=function(){return this.uim&&this.uim.uiIsStandardView()&&!this.disabled&&this.seekEnabled},Object.defineProperty(n.prototype,"player",{get:function(){if(!this.vpi){var t=this.facade.retrieveMediator(Un.APPLICATION);this.vpi=t.getAppApi()}return this.vpi},enumerable:!1,configurable:!0}),n.prototype.stopEvent=function(t){t.stopImmediatePropagation(),t.preventDefault()},n.prototype.processKeyEvent=function(t){if(t.ctrlKey||t.shiftKey||t.metaKey||t.key===ui.META||t.key===ui.SHIFT||t.key===ui.CONTROL)return null;var i=this.getCommand(t,!1);i&&(this.doAction(i),this.stopEvent(t))},n.prototype.doAction=function(i){var n,e,r,s=i.action;switch(s){case t.AccessibilityAction.INCREASE_VOLUME:case t.AccessibilityAction.DECREASE_VOLUME:r=s===t.AccessibilityAction.DECREASE_VOLUME?-1:1,n=this.player.volume,e=w.clampValue(n+this.VOLUME_INCREMENT*r,0,1),this.player.muted&&e>0&&(this.player.muted=!1),this.player.volume=e,this.uim&&this.uim.setAccVolumeLevelIndicator(e),this.notify({action:s,value:this.player.volume});break;case t.AccessibilityAction.SEEK_BACK:case t.AccessibilityAction.SEEK_FORWARD:if(!this.seekEnabled)return;var u=this.player.contentDuration;if(r=s===t.AccessibilityAction.SEEK_BACK?-1:1,n=this.player.contentTime,!u||isNaN(u)||1===r&&this.player.streamType===t.StreamType.DVR&&this.player.isPlayingLive)return;e=w.clampValue(n+this.SEEK_FACTOR_DISCRETE*r*u,0,u),this.setSeekNotice(e,r),this.notify({action:s,position:e,duration:u}),this.player.seek(e);break;case t.AccessibilityAction.ENTER_FULLSCREEN:this.player.enterFullscreen();break;case t.AccessibilityAction.TOGGLE_PLAY:this.player.streamType!==t.StreamType.LIVE&&this.player.togglePlayPause();break;case t.AccessibilityAction.TOGGLE_MUTE:this.player.muted=!this.player.muted,this.notify({action:s,muted:this.player.muted});break;case t.AccessibilityAction.TOGGLE_TT:this.player.textTrackEnabled=!this.player.textTrackEnabled;break;case t.AccessibilityAction.PLAYLIST_NEXT:case t.AccessibilityAction.PLAYLIST_PREV:r=s==t.AccessibilityAction.PLAYLIST_PREV?-1:1,this.player.playlist.length>1&&(r<0?this.player.playlist.prev():this.player.playlist.next());break;case t.AccessibilityAction.STOP:this.player.streamType===t.StreamType.LIVE?this.player.stop():this.player.pause()}},n.prototype.setSeekNotice=function(t,i){if(this.uim){var n=w.secToHms(t),e=w.secToHms(this.player.contentDuration),r=i>0?"&gt;&nbsp;&nbsp;".concat(n,"&nbsp;/&nbsp;").concat(e):"".concat(n,"&nbsp;/&nbsp;").concat(e,"&nbsp;&nbsp;&lt;");this.uim.setSeekNotice(r,i)}},n.prototype.notify=function(t){this.sendNotification(Qn.HOTKEY_ACTION,t,Hn.INTERNAL)},n.prototype.handleNotification=function(i){var n=i.name,e=Qn;switch(n){case e.AD_BREAK_START:this.seekEnabled=!1,this.enable();break;case e.CONTENT_COMPLETE:this.seekEnabled=!1,this.disable();break;case e.CONTENT_START:case e.CONTENT_SEGMENT_START:this.enable(),this.seekEnabled=this.player.streamType!==t.StreamType.LIVE}},n.prototype.listNotificationInterests=function(){var t=Qn;return[t.AD_BREAK_START,t.CONTENT_START,t.CONTENT_SEGMENT_START,t.CONTENT_COMPLETE]},n.prototype.onRegister=function(){var t=this;i.prototype.onRegister.call(this),Mi.accessibilityKeyCmdDefs.forEach((function(i){return t.registerCommandDef(i)})),this.uim=this.facade.retrieveMediator(Un.UI)||null},n}(Je),ir={exports:{}};!function(t){!function(){var i="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=t.exports,e=function(){for(var t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],e=0,r=n.length,s={};e<r;e++)if((t=n[e])&&t[1]in i){for(e=0;e<t.length;e++)s[n[0][e]]=t[e];return s}return!1}(),r={change:e.fullscreenchange,error:e.fullscreenerror},s={request:function(t,n){return new Promise(function(r,s){var u=function(){this.off("change",u),r()}.bind(this);this.on("change",u);var o=(t=t||i.documentElement)[e.requestFullscreen](n);o instanceof Promise&&o.then(u).catch(s)}.bind(this))},exit:function(){return new Promise(function(t,n){if(this.isFullscreen){var r=function(){this.off("change",r),t()}.bind(this);this.on("change",r);var s=i[e.exitFullscreen]();s instanceof Promise&&s.then(r).catch(n)}else t()}.bind(this))},toggle:function(t,i){return this.isFullscreen?this.exit():this.request(t,i)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,n){var e=r[t];e&&i.addEventListener(e,n,!1)},off:function(t,n){var e=r[t];e&&i.removeEventListener(e,n,!1)},raw:e};e?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(i[e.fullscreenElement])}},element:{enumerable:!0,get:function(){return i[e.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(i[e.fullscreenEnabled])}}}),n?t.exports=s:window.screenfull=s):n?t.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()}(ir);var nr,er=ir.exports,rr=function(i){function n(t,n){var e=i.call(this,t,n)||this;return e.isFullscreen=!1,e.fsElement=null,e.enabled=!1,e.pIsAndroidFirefox=null,e.isIos=!1,e.fsMgr=null,e.useCustomFullscreen=!0,e.iosPropNames={ENTER_EVENT:"webkitbeginfullscreen",EXIT_EVENT:"webkitendfullscreen",ENTER_METHOD:"webkitEnterFullscreen",EXIT_METHOD:"webkitExitFullscreen",SUPPORTED:"webkitSupportsFullscreen"},e.fsMgr=er,e.changeHandler=function(t){return e.hChange(t)},e}return u(n,i),Object.defineProperty(n.prototype,"fullscreenElement",{get:function(){return this.fsElement},set:function(t){t instanceof HTMLElement&&(this.systemService.isIos||this.systemService.isAndroid||(this.fsElement=t))},enumerable:!1,configurable:!0}),n.prototype.onRemove=function(){this.isIos&&this.fsElement&&(this.fsElement.removeEventListener(this.iosPropNames.ENTER_EVENT,this.changeHandler),this.fsElement.removeEventListener(this.iosPropNames.EXIT_EVENT,this.changeHandler)),this.fsMgr&&w.isFunction(this.fsMgr.off)&&this.fsMgr.off("change",this.changeHandler),this.fsElement=null,this.fsMgr=null,i.prototype.onRemove.call(this)},n.prototype.enter=function(){if(this.enabled)return this.useCustomFullscreen?(this.isFullscreen=!0,void this.sendFullscreenNotification()):void(this.isIos?this.enterFsIos():this.fsMgr.request(this.fsElement))},n.prototype.exit=function(){if(this.enabled)return this.useCustomFullscreen?(this.isFullscreen=!1,void this.sendFullscreenNotification()):void(this.isIos?this.exitFsIos():this.fsMgr.exit())},n.prototype.isFullScreenPermitted=function(){return this.enabled},n.prototype.isFullScreen=function(){return this.isFullscreen},Object.defineProperty(n.prototype,"isAndroidFirefox",{get:function(){if(null===this.pIsAndroidFirefox){var i=this.systemService;this.pIsAndroidFirefox=i.os===t.Os.ANDROID&&i.browser===t.Browser.FIREFOX}return this.pIsAndroidFirefox},enumerable:!1,configurable:!0}),n.prototype.handleNotification=function(t){var i=t.name;i!==Qn.VIDEO_LOADED_METADATA?this.enabled&&(i===Qn.ENTER_FULLSCREEN_REQUEST?this.enter():this.exit()):this.handleMetadataLoaded()},n.prototype.listNotificationInterests=function(){return[Qn.VIDEO_LOADED_METADATA,Qn.ENTER_FULLSCREEN_REQUEST,Qn.EXIT_FULLSCREEN_REQUEST]},n.prototype.handleMetadataLoaded=function(){this.enabled=this.enabled||this.webkitIosEnabled(),this.enabled&&this.sendNotification(Qn.FULLSCREEN_AVAILABLE,null)},n.prototype.hChange=function(t){this.isFullscreen=this.isIos?this.checkWebkitIsoState(t):er.isFullscreen,this.isAndroidFirefox&&(this.isFullscreen&&this.fsElement.setAttribute("controls",""),!this.isFullscreen&&this.fsElement.removeAttribute("controls")),this.sendFullscreenNotification()},n.prototype.sendFullscreenNotification=function(){this.sendNotification(Qn.FULLSCREEN_CHANGE,{isFullscreen:this.isFullscreen},Hn.INTERNAL)},n.prototype.enterFsIos=function(){this.fsElement[this.iosPropNames.ENTER_METHOD]()},n.prototype.exitFsIos=function(){this.fsElement[this.iosPropNames.EXIT_METHOD]()},n.prototype.webkitIosEnabled=function(){return this.systemService.isIos&&this.fsElement[this.iosPropNames.SUPPORTED]},n.prototype.checkWebkitIsoState=function(t){return t.type===this.iosPropNames.ENTER_EVENT},n.prototype.onRegister=function(){if(this.useCustomFullscreen=!this.getModel(Kn.PlayerOptions).useNativeFullscreen,this.useCustomFullscreen)this.enabled=!0;else{var t=this.systemService,i=this.facade.retrieveProxy(yn.PlayerDomProxy);t.isIos||t.isAndroid?(this.isIos=t.isIos,this.fsElement=i.getVideo()):this.fsElement=i.getMain(),!this.isIos&&this.fsElement&&this.fsMgr.isEnabled?(this.enabled=!0,this.fsMgr.on("change",this.changeHandler)):this.fsElement&&this.isIos&&(this.fsElement.addEventListener(this.iosPropNames.ENTER_EVENT,this.changeHandler),this.fsElement.addEventListener(this.iosPropNames.EXIT_EVENT,this.changeHandler))}},n}(Yn),sr=function(t){function i(i){return t.call(this,i)||this}return u(i,t),i.prototype.hKeyUp=function(t){var i=this.getCommand(t);i&&this.sendNotification(Qn.USER_KEY_COMMAND,{action:i.action})},i.prototype.hKeyDown=function(t){},i.prototype.onRegister=function(){t.prototype.onRegister.call(this);for(var i=Mi.userKeyCmdDefs,n=i.length;n--;)this.registerCommandDef(i[n])},i}(Je),ur=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){var n,e=this.facade,r=e.retrieveService(Jt.System),s=i.body.playerOptions;if(r.global&&!r.isWebMaf){var u=(null===(n=null==s?void 0:s.uiConfig)||void 0===n?void 0:n.cvui)||r.global.cvui;if(!s.useNativeControls&&u)ee.createUi(this.facade,u,r,s);else if(!s.useNativeControls){this.log(t.LogLevel.INFO,"PrepView: No UI specified."),e.retrieveProxy(yn.PlayerDomProxy).removePanelContainer()}if(r.isTv||e.registerMediator(new rr(Un.FULLSCREEN)),this.getScopeForKeys(s.overrides&&s.overrides.keyboardScope)!==t.KeyboardScope.NONE){var o=new tr(Un.ACC_KEY_CMD_MEDIATOR);e.registerMediator(o);var a=new sr(Un.KEY_COMMAND);e.registerMediator(a);var c=this.getPlayerContainer();o.scope=c,a.scope=c}this.log(t.LogLevel.DEBUG,"View prepared")}else this.log(t.LogLevel.INFO,"Skipping view creation")},n.prototype.getScopeForKeys=function(i){switch(i){case t.KeyboardScope.PLAYER:case t.KeyboardScope.DOCUMENT:case t.KeyboardScope.NONE:return i}return t.KeyboardScope.PLAYER},n.prototype.getPlayerContainer=function(){return this.facade.retrieveProxy(yn.PlayerDomProxy).getMain()},n}(ge),or=function(t){function i(){return t.call(this)||this}return u(i,t),i.prototype.initializeMacroCommand=function(){this.addSubCommand(Ge),this.addSubCommand(we),this.addSubCommand(Ze),this.addSubCommand(ur),this.addSubCommand($e)},i}(ye),ar=function(t){function i(i,n,e,r,s){void 0===s&&(s=!1);var u=t.call(this,i,null,w.assign({},r))||this;return u.pCode=n,u.pMessage=e,u.pFatal=s,u}return u(i,t),Object.defineProperty(i.prototype,"code",{get:function(){return this.pCode},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"message",{get:function(){return this.pMessage},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fatal",{get:function(){return this.pFatal},enumerable:!1,configurable:!0}),i}(b),cr=function(i){function n(n,e,r,s){var u=i.call(this,t.PlayerEvent.AD_ERROR,n,e,r,s)||this;return u.eInfo=u.data||{},u}return u(n,i),Object.defineProperty(n.prototype,"errorCode",{get:function(){return this.eInfo.errorCode||null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"innerErrorMessage",{get:function(){return this.eInfo.innerErrorMessage||null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sdkVersion",{get:function(){return this.eInfo.sdkVersion||null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"vastErrorCode",{get:function(){return this.eInfo.vastErrorCode||null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"requestContext",{get:function(){return this.eInfo.requestContext||null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"adInfo",{get:function(){return this.eInfo.adInfo||null},enumerable:!1,configurable:!0}),n}(ar),hr=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){var n=this.facade.retrieveMediator(Un.APPLICATION);if(n){var e=i.name,r=he[e],s=i.body,u=this.isAdRelatedError(e)?new cr(s.code,s.message,s.data,s.fatal):new ar(r,s.code,s.message,s.data,s.fatal);if(this.logger.error(s.message,t.LogLevel.ERROR),s.fatal){var o=new ar(t.PlayerEvent.FATAL_ERROR,s.code,s.message,s.data,s.fatal);n.sendErrorEvent(o)}n.sendErrorEvent(u);var a=new ar(t.PlayerEvent.ERROR,s.code,s.message,s.data,s.fatal);n.sendErrorEvent(a)}},n.prototype.isAdRelatedError=function(t){return t===Qn.AD_ERROR||t===Qn.AD_STALLED},n}(ge),lr=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return u(i,t),i.prototype.execute=function(t){this.facade.removeMediator(Un.PRESENTATION_MEDIATOR),this.facade.removeProxy(yn.ResourceProxy),this.facade.removeProxy(yn.ContentPlaybackStateProxy),this.facade.retrieveProxy(yn.ModelCollectionProxy).reset()},i}(ge),fr=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){var n=this,e=i.name,r=i.body;switch(e){case Qn.CHANGE_LANGUAGE:var s=this.facade.retrieveProxy(yn.LocalizationProxy),u=r.value;s.changeLanguage(u).then((function(){var i=n.facade.retrieveProxy(yn.PlayerDomProxy);if(i){var e=i.getMain();e.setAttribute("aria-label",s.localize(t.LocalizationId.MEDIA_PLAYER)),e.setAttribute("lang",s.language)}n.sendNotification(Qn.LANGUAGE_CHANGE,r)}));break;case Qn.LANGUAGE_CHANGE:this.sendNotification(Qn.APP_EVENT,{notificationName:e,data:r})}},n}(ge),dr=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){var n=i.body;this.sendNotification(Qn.APP_EVENT,{type:t.PlayerEvent.METRIC,data:n})},n}(ge),vr=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(t){var i,n,e,r=this,s=this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR),u=null===(i=this.contentPlaybackStateProxy)||void 0===i?void 0:i.model;if(u)switch(t.name){case Qn.PLAY_ON_USER_GESTURE:if(s){this.invokePlayOnUserGesture(s);var o=this.facade.retrieveProxy(yn.Playlist);this.facade.sendNotification(Qn.POSTER_CLICK,{resource:o.currentResource},Hn.INTERNAL)}else this.facade.sendNotification(Qn.POSTER_CLICK,null,Hn.INTERNAL);break;case Qn.PLAY:var a=!!s,c=a&&this.getModel(Kn.PresentationState).started;a&&t.type===Hn.EXTERNAL&&!c?this.invokePlayOnUserGesture(s):c&&s&&s.play();break;case Qn.PAUSE:s&&s.pause(),(e=this.getModel(Kn.PresentationState)).isCurrentVideoAd||t.type!==Hn.UI||this.facade.sendNotification(Qn.USER_PAUSE,null,Hn.INTERNAL);break;case Qn.STOP:var h=this.facade.retrieveMediator(Un.APPLICATION),l=this.facade.retrieveProxy(yn.Playlist).currentResource,f=this.isVod();h.killCurrentResource().then((function(){f||r.sendNotification(Qn.APP_EVENT,{notificationName:Qn.LIVE_PRESENTATION_STOPPED,data:l})}));break;case Qn.SEEK:s.seek(t.body.value);break;case Qn.SEEK_FORWARD:n=u.time+t.body.value,s.seek(Math.min(n,u.duration));break;case Qn.SEEK_BACK:n=u.time-t.body.value,s.seek(Math.max(n,0));break;case Qn.SEEK_TO_LIVE:!this.isVod()&&u.liveStreamInfo&&(n=u.liveStreamInfo.relativeDuration,s.seek(Math.min(n,u.duration)));break;case Qn.SWITCH_AUDIO_TRACK:s.adapter.audioTrack=t.body.value;break;case Qn.SWITCH_TEXT_TRACK:var d=t.body.value;if(d){this.facade.retrieveProxy(yn.TextTrackProxy).language=d.language;var v=this.contentPlaybackStateProxy.getTextTrackById(d.id);s.adapter.textTrack=v}break;case Qn.SWITCH_TEXT_MODE:var b=t.body.value,A=this.facade.retrieveProxy(yn.TextTrackProxy);A.enabled=b,(null==s?void 0:s.adapter)&&(s.adapter.textTrackMode=A.mode);break;case Qn.MUTE:s.mute(!0),this.sendNotification(Qn.APP_EVENT,{notificationName:Qn.MUTE,data:!0});break;case Qn.UNMUTE:s.mute(!1),this.sendNotification(Qn.APP_EVENT,{notificationName:Qn.UNMUTE,data:!1});break;case Qn.VOLUME_CHANGE:var m=t.body,g=m.value,p=m.muted;if(!isNaN(g)&&s.setVolume(g),e=this.getModel(Kn.PresentationState),w.isUndefined(p)||e.isMuted==p||this.sendNotification(p?Qn.MUTE:Qn.UNMUTE),t.type===Hn.EXTERNAL){var y=this.facade.retrieveMediator(Un.UI);y&&y.setVolume(g)}this.sendNotification(Qn.APP_EVENT,{notificationName:Qn.VOLUME_CHANGE,data:g})}else this.log("play() can not be invoked in this context.")},Object.defineProperty(n.prototype,"contentPlaybackStateProxy",{get:function(){return this.facade.retrieveProxy(yn.ContentPlaybackStateProxy)},enumerable:!1,configurable:!0}),n.prototype.isVod=function(){var i=this.contentPlaybackStateProxy.model.streamType;return i!=t.StreamType.LIVE&&i!=t.StreamType.DVR},n.prototype.shouldSkipPriming=function(){var i=this.facade.retrieveProxy(yn.PlayerDomProxy),n=this.facade.retrieveService(Jt.System),e=this.getModel(Kn.PlayerOptions).overrides;return!i||n.device==t.Device.LG_SMART_TV||n.device==t.Device.PLAYSTATION_5||!0===(null==e?void 0:e.skipPriming)},n.prototype.invokePlayOnUserGesture=function(i){var n=this,e=this.facade.retrieveProxy(yn.PlayerDomProxy),r=this.facade.retrieveService(Jt.System),s=this.getModel(Kn.PlayerOptions).overrides;(i.beforePlayOnUserGesture(),this.shouldSkipPriming())?i&&i.playOnUserGesture():e.primeVideo(null==s?void 0:s.blankVideoUrl).then((function(){if(r.device==t.Device.IPHONE){var n="timeupdate",s=e.getVideo(),u=function(t){s.removeEventListener(n,u),setTimeout((function(){return i.playOnUserGesture()}),200)};s.addEventListener(n,u)}else i.playOnUserGesture()})).catch((function(i){n.log(t.LogLevel.ERROR,"ERROR - PlaybackCommand: Priming FAILED.  ".concat(i.message)),n.facade.sendNotification(Qn.AUTOPLAY_BLOCKED,i,Hn.INTERNAL)}))},n}(ge),br=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return u(i,t),i.prototype.execute=function(t){var i=this;switch(t.name){case Qn.PLAYLIST_ADVANCED:this.sendAppEventNotification(t.name,t.body);break;case Qn.PLAYLIST_COMPLETE:case Qn.PLAYLIST_CLEARED:case Qn.PLAYLIST_CURRENT_RESOURCE_CLEARED:this.close().then((function(){i.sendAppEventNotification(t.name,t.body)}))}},i.prototype.sendAppEventNotification=function(t,i){void 0===i&&(i=null),this.sendNotification(Qn.APP_EVENT,{notificationName:t,data:i})},i.prototype.close=function(){var t=this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR);return t?t.close():Promise.resolve()},i}(ge),Ar=function(t){function i(i,n,e,r){var s=t.call(this,i,null,e)||this;return s.ad=null,s.data=e,s.target=n,r&&(s.ad=r),s}return u(i,t),Object.defineProperty(i.prototype,"Type",{get:function(){return i.Type},enumerable:!1,configurable:!0}),i.prototype.getAd=function(){return this.ad},i.prototype.getStreamData=function(){return this.data},i.Type={LOADED:"loaded",AD_BREAK_STARTED:"adBreakStarted",AD_BREAK_ENDED:"adBreakEnded",STARTED:"started",COMPLETE:"complete",FIRST_QUARTILE:"firstQuartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdQuartile",AD_PERIOD_STARTED:"adPeriodStarted",AD_PERIOD_ENDED:"adPeriodEnded",CUEPOINTS_CHANGED:"cuePointsChanged",STREAM_INITIALIZED:"streamInitialized",ERROR:"error",AD_PROGRESS:"adProgress",CLICK:"click"},i}(b),mr=function(){function t(t,i){this.data=t,this.podInfo=i}return t.prototype.getAdId=function(){return this.data.ad_id},t.prototype.getAdPodInfo=function(){return this.podInfo},t.prototype.getAdSystem=function(){return this.data.advertiser||null},t.prototype.getAdvertiserName=function(){return this.data.advertiser||null},t.prototype.getApiFramework=function(){return null},t.prototype.getCreativeAdId=function(){return this.data.creative_ad_id},t.prototype.getCreativeId=function(){return this.data.creative_id},t.prototype.getDealId=function(){return this.data.deal_id||null},t.prototype.getDescription=function(){return this.data.description},t.prototype.getDuration=function(){return this.data.duration},t.prototype.getTitle=function(){return this.data.title},t.prototype.getDaiWrapperData=function(){var t=null,i=null,n=null;if(this.data.wrappers&&this.data.wrappers[0]){var e=this.data.wrappers[0];t=e.ad_id,i=e.creative_id,n=e.creative_ad_id}return{adId:t,creativeId:i,creativeAdId:n}},t.prototype.getWrapperAdIds=function(){return this.getWrapperPropArray("ad_id")},t.prototype.getWrapperCreativeIds=function(){return this.getWrapperPropArray("creative_id")},t.prototype.getWrapperCreativeAdIds=function(){return this.getWrapperPropArray("creative_ad_id")},t.prototype.getWrapperAdSystems=function(){return this.getWrapperPropArray("system")},t.prototype.getCompanionAds=function(){return null},t.prototype.getWrapperPropArray=function(t){var i,n=[],e=this.data.wrappers||null;if(!e)return null;for(var r=0,s=e.length;r<s;r++)(i=e[r][t])&&""!=i&&n.push(i);return n},t}(),gr=function(){function t(t,i,n){this.data=t,this.podIdx=n,this.pos=i}return t.prototype.getAdPosition=function(){return this.pos},t.prototype.setAdPosition=function(t){this.pos=t},t.prototype.getMaxDuration=function(){return this.data.duration},t.prototype.getPodIndex=function(){return this.podIdx},t.prototype.setPodIndex=function(t){this.podIdx=t},t.prototype.getTimeOffset=function(){return this.data.start},t.prototype.getTotalAds=function(){return this.data.ads&&this.data.ads.length},t}(),pr=function(i){function n(t,n,e){var r=i.call(this,null)||this;return r.adBreaks=[],r.currBreak=null,r.currBreakIndex=null,r.currAd=null,r.breakStatus={},r.breakPoints=[],r.pollId=null,r.lastRecordedTime=-1,r.currEventStatus=r.createEventStatus(),r.currBreakIndex=null,r.vidIface=t,r.logger=e,r.setClickElement(n),r}return u(n,i),n.prototype.addEventListener=function(t,i){this.on(t,i)},n.prototype.removeEventListener=function(t,i){this.off(t,i)},n.prototype.requestStream=function(i,n){var e=this;void 0===n&&(n=null),i.adTagParameters.correlator=this.getCorrelator(),i.apiKey&&(i.adTagParameters["api-key"]=i.apiKey),i.authToken&&(i.adTagParameters["auth-token"]=i.authToken),Zt({method:"POST",errorRecovery:n,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:this.getUrl(i.contentSourceId,i.videoId,i.format||"hls"),data:i.adTagParameters,encodeList:["cust_params"]}).then((function(t){e.gatherStreamInfo(t),e.emitCues(),e.beginPoll(),e.emitLoaded(t)})).catch((function(i){var n="Error. Status: ".concat(i.status||"Unknown","; Message: ").concat(i.message);e.logger.log(t.LogLevel.ERROR,n),e.emitError(n,t.ErrorCode.DAI_NETWORK_ERROR)}))},n.prototype.setClickElement=function(t){var i=this;t&&(this.clickEl=t||null,this.clickThruHandler=function(t){i.hClickThru(t)},this.clickEl.addEventListener("click",this.clickThruHandler))},n.prototype.contentTimeForStreamTime=function(t){var i,n=this.adBreaks,e=0;null==t&&(t=this.streamDur);for(var r=0,s=n.length;r<s;r++){if(!(t>(i=n[r]).start))return t-e;if(!(t>=i.end))return i.start-e;if(e+=i.duration,r==s-1)return t-e}return t},n.prototype.streamTimeForContentTime=function(t){for(var i,n=this.adBreaks,e=0,r=0,s=n.length;r<s&&(i=n[r],t>=this.contentTimeForStreamTime(n[r].start));r++)e+=i.duration;return t+e},n.prototype.previousCuePointForStreamTime=function(t){for(var i,n=this.adBreaks,e=n.length;e--;)if(t>=(i=n[e]).start)return i.played?null:this.cuePointFromBreak(i);return null},n.prototype.onTimedMetadata=function(t){Zt({url:this.mvu+t.TXXX})},n.prototype.processMetadata=function(t,i,n){},n.prototype.reset=function(){clearInterval(this.pollId),this.clickEl&&this.clickEl.removeEventListener("click",this.clickThruHandler),this.clickEl=null,this.streamId=null,this.adBreaks=[],this.breakPoints=[],this.streamDur=NaN,this.currBreak=null,this.currBreakIndex=null,this.currAd=null,this.mvu=null,this.resetUponAdComplete(),this.lastRecordedTime=-1,this.pollId=null},n.prototype.beginPoll=function(){var t=this;clearInterval(this.pollId),this.pollId=setInterval((function(){t.checkState()}),100)},n.prototype.checkState=function(){var t=this.vidIface.currentTime;if(!isNaN(t)&&t>0&&t>this.lastRecordedTime){if(!this.currBreak){var i=this.getBreakForStreamTime(t),n=i.break;n&&n.played?this.emitAdPeriodStarted(n):n&&this.beginBreak(n,i.index)}if(this.currBreak){var e=this.currBreak;t>=e.end?(this.monitorAdStatus(t,e),this.endBreak()):this.monitorAdStatus(t,e)}}!isNaN(t)&&t>=0&&(this.lastRecordedTime=t)},n.prototype.monitorAdStatus=function(t,i){var n=i.ads,e=i.start;if(this.currAd)this.monitorCurrentAd(t);else for(var r,s=n.length;s--;)if((t>=(r=n[s].start||0)||null==r)&&!this.breakStatus["t_".concat(e)]["t_".concat(r)]){var u=i.type.toLowerCase();this.currBreakIndex="pre"===u?0:"mid"===u?i.index:-1,this.beginAd(n[s],r);break}},n.prototype.monitorCurrentAd=function(t){for(var i,e=this.currAd.events,r=this.currEventStatus,s=!0,u=e.length;u--;)if(t>=(i=e[u]).time&&!r[i.type]){if(r[i.type]=!0,"complete"===i.type||t>=this.currAd.start+this.currAd.duration){s=!1,this.emitAdComplete(),this.resetUponAdComplete();break}if("start"!==i.type){s=!1,this.emit(n.eventStatusMap[i.type],this.createStreamData());break}}s&&this.emitProgress(t)},n.prototype.resetUponAdComplete=function(){this.currEventStatus=this.createEventStatus(),this.currAd=null},n.prototype.beginBreak=function(t,i){this.currBreak=t,this.currBreak.played=!0,this.emitCues();var e=this.createStreamData();e.streamId=this.streamId,this.emit(n.event.AD_BREAK_STARTED,e)},n.prototype.endBreak=function(){this.emit(n.event.AD_BREAK_ENDED,this.createStreamData()),this.currBreak=null},n.prototype.beginAd=function(t,i){this.currAd=t,this.breakStatus["t_".concat(this.currBreak.start)]["t_".concat(i)]=!0,this.currEventStatus.start=!0;var e=this.createStreamData();e.streamId=this.streamId;var r=new gr(this.currBreak,this.currAd.seq,this.currBreakIndex),s=new mr(this.currAd,r),u=new Ar(n.event.STARTED,this,e,s);this.dispatchEvt(u)},n.prototype.hClickThru=function(t){if(this.currAd){var i=this.currAd.clickthrough_url;i&&""!==i&&window.open(i),this.emit(n.event.CLICK)}},n.prototype.emit=function(t,i){void 0===i&&(i=null);var n=new Ar(t,this,i);this.dispatchEvt(n)},n.prototype.emitCues=function(){var t=this.createStreamData();t.cuepoints=this.assembleCuePoints(),this.emit(n.event.CUEPOINTS_CHANGED,t)},n.prototype.emitProgress=function(t){var i=this.createAdProgressData(null===t?(this.currAd.start||0)+this.currAd.duration:t),e=this.createStreamData();e.adProgressData=i,this.emit(n.event.AD_PROGRESS,e)},n.prototype.emitLoaded=function(t){var i=this.createStreamData();i.stream_id=this.streamId,i.subtitles=t.subtitles,i.manifestFormat=this.getFormat(t.stream_manifest),i.url=t.stream_manifest,this.emit(n.event.LOADED,i)},n.prototype.emitAdComplete=function(){var t=this.createStreamData();t.streamId=this.streamId,this.emitProgress(null),this.emit(n.event.COMPLETE,t)},n.prototype.emitError=function(t,i){var e=this.createStreamData();e.streamId=this.streamId,e.errorMessage=t,e.code=i,this.emit(n.event.ERROR,e)},n.prototype.emitAdPeriodStarted=function(t){var i=this.createStreamData();i.streamResumeTime=t.start+t.duration+.1,this.emit(n.event.AD_PERIOD_STARTED,i)},n.prototype.createAdProgressData=function(t){return{adBreakDuration:this.currBreak.duration,adPeriodDuration:null,adPosition:this.currAd.seq,currentTime:w.clampValue(t-(this.currAd.start||0),0,this.currAd.duration),duration:this.currAd.duration,totalAds:this.currBreak.ads.length}},n.prototype.createEventStatus=function(){return{start:!1,first:!1,mid:!1,third:!1,complete:!1}},n.prototype.assembleCuePoints=function(){for(var t=[],i=0,n=this.adBreaks.length;i<n;i++)t.push(this.cuePointFromBreak(this.adBreaks[i]));return t},n.prototype.getBreakForStreamTime=function(t){for(var i,n=0,e=this.adBreaks.length;n<e;n++)if(t>=(i=this.adBreaks[n]).start&&t-i.start<=1.5&&!this.currBreak)return{break:i,index:n};return{break:null,index:null}},n.prototype.getUrl=function(t,i,e){return n.DAI_BASE_URL+n.STREAM_PATH.replace("{format}",e).replace("{contentSourceId}",t).replace("{daiVideoId}",i)},n.prototype.getCorrelator=function(){var t=String(Math.round(1e15+9e15*Math.random()));if(t.length<16)for(;t.length<16;)t+="0";return t.length>16&&(t=t.substr(0,17)),t},n.prototype.cuePointFromBreak=function(i){return{adTechnology:t.AdTechnology.SSAI,start:i.start,end:i.end,played:i.played}},n.prototype.createStreamData=function(){return{adProgressData:null,cuepoints:null,errorMessage:null,streamId:this.streamId||null,manifestFormat:null,subtitles:null,url:null}},n.prototype.getFormat=function(i){var n=i.indexOf(".m3u8")>=0,e=!n&&i.indexOf(".mpd")>=0;return n?t.VideoFormat.HLS:e?t.VideoFormat.DASH:t.VideoFormat.UNKNOWN},n.prototype.gatherBreakInfo=function(t){for(var i,n,e,r,s=t&&t.length||0,u=1,o=0;o<s;o++){e=(n=(i=t[o]).start)+(r=i.duration),this.breakPoints.push(n),this.adBreaks.push({duration:r,start:n,end:e,played:!1,type:i.type,ads:i.ads,index:o,seq:"mid"==i.type?u++:0});for(var a=this.breakStatus["t_"+n]={},c=0,h=i.ads.length;c<h;c++)a["t_"+(i.ads[c].start||0)]=!1}},n.prototype.gatherStreamInfo=function(t){this.streamDur=t.total_duration,this.mvu=t.media_verification_url,this.streamId=t.stream_id,this.gatherBreakInfo(t.ad_breaks)},n.event={LOADED:"loaded",STREAM_INITIALIZED:"streamInitialized",CUEPOINTS_CHANGED:"cuePointsChanged",AD_BREAK_STARTED:"adBreakStarted",AD_BREAK_ENDED:"adBreakEnded",STARTED:"started",COMPLETE:"complete",AD_PROGRESS:"adProgress",FIRST_QUARTILE:"firstQuartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdQuartile",CLICK:"click",ERROR:"error",AD_PERIOD_STARTED:"adPeriodStarted",AD_PERIOD_ENDED:"adPeriodEnded"},n.eventStatusMap={start:"started",firstquartile:"firstQuartile",midpoint:"midpoint",thirdquartile:"thirdQuartile",complete:"complete"},n.DAI_BASE_URL="https://dai.google.com",n.STREAM_PATH="/ondemand/v1/{format}/content/{contentSourceId}/vid/{daiVideoId}/stream",n}(T),yr=function(){function t(t){this.req={apiKey:null,streamActivityMonitorId:null,adTagParameters:null,assetKey:null,format:"hls",contentSourceId:null,videoId:null},t&&w.assign(this.req,t)}return Object.defineProperty(t.prototype,"adTagParameters",{get:function(){return this.req.adTagParameters},set:function(t){this.req.adTagParameters=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoId",{get:function(){return this.req.videoId},set:function(t){this.req.videoId=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentSourceId",{get:function(){return this.req.contentSourceId},set:function(t){this.req.contentSourceId=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiKey",{get:function(){return this.req.apiKey},set:function(t){this.req.apiKey=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authToken",{get:function(){return this.req.authToken},set:function(t){this.req.authToken=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this.req.format},set:function(t){this.req.format=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"assetKey",{get:function(){return this.req.assetKey},set:function(t){this.req.assetKey=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"streamActivityMonitorId",{get:function(){return this.req.streamActivityMonitorId},set:function(t){this.req.streamActivityMonitorId=t},enumerable:!1,configurable:!0}),t}(),kr={StreamManager:pr,StreamEvent:Ar,VODStreamRequest:yr},Or=function(){function t(){this.MOAT_PARTNER_CODE="cbsiimajsint708425247896",this.adContextToVpaidEventMap={ima:{start:"AdVideoStart",firstquartile:"AdVideoFirstQuartile",midpoint:"AdVideoMidpoint",thirdquartile:"AdVideoThirdQuartile",complete:"AdVideoComplete",pause:"AdPaused",resume:"AdPlaying",skip:"AdSkipped",volumechange:"AdVolumeChange",mute:"AdVolumeChange"},dai_sdk:{started:"AdVideoStart",firstquartile:"AdVideoFirstQuartile",midpoint:"AdVideoMidpoint",thirdquartile:"AdVideoThirdQuartile",complete:"AdVideoComplete",controlpause:"AdPaused",controlplay:"AdPlaying",controlvolumeset:"AdVolumeChange",controlmute:"AdVolumeChange",controlunmute:"AdVolumeChange"}}}return t.prototype.destroy=function(){this.adContextToVpaidEventMap=null,this.trackingObj=null},t.prototype.track=function(t){var i=t.context,n=t.adInfo,e={level1:"",level2:"",level3:n.wrapperAdId,level4:n.wrapperCreativeId,slicer1:"vaw-can",slicer2:t.partner,slicer3:t.pageType,moatVASTSystem:i,moatVASTAdID:n.wrapperAdId},r=t.viewGuid||t.vguid,s=t.pageType||t.ptype;r&&(e.zMoatVGUID=r),s&&(e.zMoatPT=s),this.initMoat(t.adVideoContainer,e,n.adDuration,this.MOAT_PARTNER_CODE,null)},t.prototype.untrack=function(){this.trackingObj=null},t.prototype.trackEvent=function(t){var i=this.adContextToVpaidEventMap[t.context][t.eventName.toLowerCase()];i&&this.trackingObj&&this.trackingObj.dispatchEvent({type:i,adVolume:t.volume})},t.prototype.initMoat=function(t,i,n,e,r){void 0===r&&(r=null);var s,u,o,a=document.createElement("script"),c=[],h={adData:{ids:i,duration:n,url:r},dispatchEvent:function(t){this.sendEvent?(c&&(c.push(t),t=c,c=!1),this.sendEvent(t)):c.push(t)}};o="_moatApi"+Math.floor(1e8*Math.random());try{u=(s=t.ownerDocument).defaultView||s.parentWindow}catch(t){u=window}u[o]=h,a.type="text/javascript",t&&t.insertBefore(a,t.childNodes[0]||null),a.src="https://z.moatads.com/"+e+"/moatvideo.js#"+o,this.trackingObj=h},t}(),wr=function(i){function n(t,n){var e=i.call(this,t)||this;return e.adContext=n,e}return u(n,i),n.prototype.destroy=function(){this.moatTracker&&this.moatTracker.destroy(),this.moatTracker=null,this.adContainer=null,this.trackingData=null,i.prototype.destroy.call(this)},n.prototype.getGamPlatformString=function(){return this.getService(Jt.System).isDesktop?"desktop":"mobile_web"},n.prototype.setTrackingData=function(t){this.trackingData=t},n.prototype.getAdContext=function(){return this.adContext},n.prototype.setContainer=function(t){this.adContainer=t},n.prototype.getAdBreakTypeFromPodIndex=function(i){return 0===i?t.AdBreakType.PRE:-1===i?t.AdBreakType.POST:t.AdBreakType.MID},n.prototype.assembleAdBreakInfo=function(t,i){var n=t.getAdPodInfo(),e=n.getPodIndex();return{adBreakDuration:n.getMaxDuration(),adBreakPosition:e,adTotal:n.getTotalAds(),adBreakType:this.getAdBreakTypeFromPodIndex(e),adServerName:this.adContext,adTechnology:i}},n.prototype.assembleAdInfo=function(i,n,e){void 0===e&&(e=!1);var r=i.getAdPodInfo(),s=r&&r.getAdPosition()||-1,u=this.getIdInfo(i),o=this.adContext===t.AdContext.IMA;return{adObject:e?i:null,adServerName:this.adContext,adDuration:i.getDuration(),adTitle:i.getTitle(),adId:u.adId,adPosition:s,adAssetUrl:o?i.getMediaUrl():n.mediaUrl||null,isVpaid:o?this.getIsVpaid(i):null,wrapperAdId:u.wrapperAdId,creativeId:u.creativeId,wrapperCreativeId:u.wrapperCreativeId,vastMediaHeight:o?i.getVastMediaHeight():null,vastMediaWidth:o?i.getVastMediaWidth():null,vastMediaBitrate:o?i.getVastMediaBitrate():null}},n.prototype.trackAd=function(t){var i=this.trackingData;this.moatTracker.track({viewGuid:i.viewGuid,pageType:i.pageType,adInfo:t,adVideoContainer:this.adContainer,context:this.adContext,partner:i.partner})},n.prototype.trackAdEvent=function(t){this.moatTracker.trackEvent(t)},n.prototype.untrackAd=function(){this.moatTracker.untrack()},n.prototype.createViewabilityTracker=function(){this.moatTracker=new Or},n.prototype.getIdInfo=function(i){var n=this.getWrapperId(i),e=this.getCreativeId(i);return{adId:n.adId,wrapperAdId:n.wrapperAdId,creativeId:e.creativeId,wrapperCreativeId:e.wrapperCreativeId,adServerName:t.AdContext.IMA,adDuration:i.getDuration()}},n.prototype.getWrapperId=function(t){var i=t.getWrapperAdIds(),n=Array.isArray(i)&&i.length,e=t.getAdId()||"",r=n?i[0]:e,s=n?i[i.length-1]:e;return s||(s=null),{adId:r,wrapperAdId:s}},n.prototype.getCreativeId=function(t){var i=t.getWrapperCreativeIds(),n=Array.isArray(i)&&i.length,e=t.getCreativeId()||null,r=n?i[0]:e,s=n?i[i.length-1]:e;return s||(s=null),{creativeId:r,wrapperCreativeId:s}},n.prototype.getIsVpaid=function(t){return"application/javascript"===t.getContentType()},n}(_n),Tr=function(i){function n(n,e){var r=i.call(this,n,e?t.AdContext.DAI_API:t.AdContext.DAI_SDK)||this;return r.pSdk=null,r.usesApi=!1,r.videoIface=null,e&&(r.pSdk=e,r.usesApi=!0),r}return u(n,i),n.prototype.destroy=function(){this.streamMgr&&this.streamMgr.reset(),this.streamMgr=null,this.pSdk=null,this.videoIface=null,i.prototype.destroy.call(this)},n.prototype.initViewabilityTracking=function(){this.createViewabilityTracker()},Object.defineProperty(n.prototype,"videoInterface",{get:function(){return this.videoIface},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"usesDaiApi",{get:function(){return this.usesApi},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sdk",{get:function(){var t,i;if(!this.pSdk){var n=this.getService(Jt.System).global;(null===(i=null===(t=null==n?void 0:n.google)||void 0===t?void 0:t.ima)||void 0===i?void 0:i.dai)&&(this.pSdk=n.google.ima.dai.api)}return this.pSdk},enumerable:!1,configurable:!0}),n.prototype.getSdkVersion=function(){return""},n.prototype.setVideoInterface=function(t){this.videoIface=t},n.prototype.setVolume=function(t){this.usesApi&&(this.videoIface.volume=t)},n.prototype.setMuted=function(t){this.usesApi&&(this.videoIface.muted=t)},n.prototype.setDuration=function(t){this.usesApi&&(this.videoIface.duration=t)},n.prototype.setCurrentTime=function(t){this.usesApi&&(this.videoIface.currentTime=t)},n.prototype.reset=function(){this.streamMgr.reset(),this.usesApi&&(this.videoIface.duration=NaN,this.videoIface.currentTime=NaN)},n.prototype.assembleAdInfo=function(n,e){if(this.adContext===t.AdContext.DAI_SDK)return i.prototype.assembleAdInfo.call(this,n,e);var r=n.getAdPodInfo(),s=r&&r.getAdPosition()||-1,u=n.getDaiWrapperData(),o=u.adId,a=u.creativeId;return{adObject:n,adServerName:this.adContext,adDuration:n.getDuration(),adTitle:n.getTitle(),adId:o,adPosition:s,adAssetUrl:e.mediaUrl||null,isVpaid:!1,wrapperAdId:o,creativeId:a,wrapperCreativeId:a,vastMediaHeight:null,vastMediaWidth:null,vastMediaBitrate:null}},n.prototype.getStreamManager=function(){return!this.streamMgr&&this.sdk&&(this.usesApi?this.streamMgr=new this.sdk.StreamManager(this.videoIface,this.adContainer,this.getLogger()):this.streamMgr=new this.sdk.StreamManager(this.videoIface,this.adContainer)),this.streamMgr},n}(wr);!function(t){t.GOOGLE_DAI="urn:google:dai:2018"}(nr||(nr={}));var Er,jr,Nr,Sr,Rr=function(t){function i(){var i=t.call(this)||this;return i.pManifestParsed=!1,i.qualityChange=function(t){i.emit(Gn.ABR_QUALITY_LOADED,t)},i.qualityInfoChange=function(t){i.qualities=t.qualities,i.emit(Gn.MANIFEST_PARSED,{profile:t.qualities}),i.emit(Gn.ABR_CONSTRAINTS_CHANGE,{minIndex:0,maxIndex:t.qualities.length-1,manifestQualities:t.qualities})},i.error=function(t){i.emit(Gn.ERROR,t)},i.audioTrackChange=function(t){i.emit(Gn.AUDIO_TRACK_CHANGE,{track:t})},i.audioTrackInfoChange=function(t){i.emit(Gn.AUDIO_TRACK_UPDATED,t)},i.cdnChange=function(t){i.emit(Gn.MULTI_CDN,{cdn:t})},i.drmKeySystemCreated=function(t){i.emit(Gn.DRM_KEYSYSTEM_CREATED,{keysystem:t})},i.timeUpdate=function(){i.emit(fi.TIME_UPDATE)},i.playing=function(){i.emit(fi.PLAYING)},i.paused=function(){i.emit(fi.PAUSE)},i.seeking=function(){i.emit(fi.SEEKING)},i.seeked=function(){i.emit(fi.SEEKED)},i.ended=function(){i.emit(fi.ENDED)},i.durationChange=function(){i.emit(fi.DURATION_CHANGE)},i.volumeChange=function(t,n){i.emit(fi.VOLUME_CHANGE,{volume:t,muted:n})},i.metadataCuepoint=function(t){i.emit(hi.METADATA_CUEPOINT,t)},i.textCuepoints=function(t){i.emit(hi.TEXT_CUEPOINT,t)},i.textTrackDisplayModeChange=function(t){i.emit(hi.TEXT_TRACK_DISPLAY_MODE_CHANGE,{mode:t})},i.textTrackInfoChange=function(t){var n;null===(n=t.tracks)||void 0===n||n.forEach((function(t){return i.emit(hi.TEXT_TRACK_ADDED,t)})),i.emit(hi.TEXT_TRACK_AVAILABLE)},i.textTrackChange=function(t){i.emit(hi.TEXT_TRACK_CHANGE,t)},i}return u(i,t),i}(T),Ir=function(i){function n(t,n,e){var r=i.call(this)||this;return r.config=t,r.adapter=n,r.delegate=e,r.lastKnownTimes={buffer:NaN},r.pBuffering=!1,r.pPaused=!1,r.pSeeking=!1,r.pConstraints={},r.logger=t.logger,r.dispatchEvt=r.dispatchEvt.bind(r),ni.values(fi).forEach((function(t){return r.delegate.on(t,r.dispatchEvt)})),ni.values(Gn).forEach((function(t){return r.delegate.on(t,r.dispatchEvt)})),ni.values(hi).forEach((function(t){return r.delegate.on(t,r.dispatchEvt)})),r}return u(n,i),n.prototype.destroy=function(){return i.prototype.destroy.call(this),Promise.resolve(this.adapter.destroy())},Object.defineProperty(n.prototype,"type",{get:function(){return this.adapter.getType()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){return this.adapter.getCurrentTime()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return this.adapter.getDuration()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"liveStreamInfo",{get:function(){return this.adapter.getLiveStreamInfo()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isLiveStream",{get:function(){return this.adapter.getIsLiveStream()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"droppedVideoFrames",{get:function(){var t,i;return null===(i=(t=this.adapter).getMetrics)||void 0===i?void 0:i.call(t).droppedVideoFrames},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"framerate",{get:function(){var t,i;return null===(i=(t=this.adapter).getMetrics)||void 0===i?void 0:i.call(t).framerate},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"buffering",{get:function(){if(!this.pPaused){var t=this.lastKnownTimes.buffer+.001,i=this.adapter.getCurrentTime();this.lastKnownTimes.buffer=i;var n=i<t;this.pBuffering=n&&!this.pSeeking}return this.pBuffering},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bufferLength",{get:function(){return this.adapter.getBufferLength()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentIndex",{set:function(t){this.adapter.setQuality(this.delegate.qualities[t])},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoQualitySwitching",{set:function(t){this.adapter.setAutoQualitySwitching(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBitrate",{set:function(t){this.pConstraints.maxBitrate=t,this.adapter.setMaxBitrate(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minBitrate",{set:function(t){this.pConstraints.minBitrate=t,this.adapter.setMinBitrate(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackMode",{set:function(t){this.adapter.setTextTrackMode(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrack",{set:function(t){this.adapter.setTextTrack(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"audioTrack",{set:function(t){this.adapter.setAudioTrack(t)},enumerable:!1,configurable:!0}),n.prototype.initialize=function(){},n.prototype.load=function(){var t=this;return this.adapter.load().then((function(i){void 0===i&&(i={});var n=ni.merge({manifest:{mimeType:ni.getResourceMimeType(t.config.resource)},fragment:{mimeType:""}},i);t.delegate.emit(Gn.LOADED_METADATA,n)}))},n.prototype.play=function(){var i=this;this.adapter.play().then((function(){i.pPaused=!1})).catch((function(n){i.logger.warn("Exception caught in play() Promise: "+n.message,t.LogLevel.WARN),i.emit(fi.AUTOPLAY_BLOCKED,n)}))},n.prototype.pause=function(){this.pPaused=!0,this.adapter.pause()},n.prototype.suspend=function(){throw new Error("Method not implemented.")},n.prototype.resume=function(){throw new Error("Method not implemented.")},n.prototype.seek=function(t){var i=this;this.pSeeking=!0,this.adapter.seek(t).then((function(){return i.pSeeking=!1}))},n.prototype.resize=function(){this.adapter.resize()},n.prototype.clearCue=function(){var t,i;null===(i=(t=this.adapter).clearText)||void 0===i||i.call(t)},n}(T);!function(t){t.HLSJS_GZIP_CDN="//cdnjs.cloudflare.com/ajax/libs/hls.js/{{VERSION}}/hls.min.js",t.SHAKA_GZIP_CDN="//cdnjs.cloudflare.com/ajax/libs/shaka-player/{{VERSION}}/shaka-player.compiled{{DEBUG}}.js",t.TWITCH_GZIP_CDN="//player.live-video.net/{{VERSION}}/amazon-ivs-player.min.js"}(Er||(Er={})),function(t){t.HLSJS="1.0.7",t.SHAKA="3.2.0",t.TWITCH="1.1.2"}(jr||(jr={})),function(t){t[t.BUFFER_LEVEL_PRELOAD=12]="BUFFER_LEVEL_PRELOAD",t[t.BUFFER_LEVEL_PLAYBACK=60]="BUFFER_LEVEL_PLAYBACK",t[t.MANIFEST_RETRY_ATTEMPTS=2]="MANIFEST_RETRY_ATTEMPTS",t[t.MANIFEST_RETRY_DELAY=1e3]="MANIFEST_RETRY_DELAY",t[t.LEVEL_RETRY_TIMEOUT=2e3]="LEVEL_RETRY_TIMEOUT",t[t.LEVEL_RETRY_DELAY=500]="LEVEL_RETRY_DELAY",t[t.FRAGMENT_RETRY_TIMEOUT=2e3]="FRAGMENT_RETRY_TIMEOUT",t[t.FRAGMENT_RETRY_DELAY=500]="FRAGMENT_RETRY_DELAY",t[t.FATAL_ERROR_RECOVERY_ATTEMPTS=3]="FATAL_ERROR_RECOVERY_ATTEMPTS"}(Nr||(Nr={})),function(t){t.MULTI_CDN="x-cdn",t.VIDEO="video",t.AUDIO="audio",t.TEXT="text"}(Sr||(Sr={}));var Cr,Pr,_r=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.lastKnownTimes={absolute:NaN,relative:NaN,end:NaN},t}return u(n,i),n.prototype.play=function(){if(!isNaN(this.pauseTime)){if(this.pauseTime<this.liveStreamInfo.absoluteStart){var n=this.seekable.start+1;this.logger.log(t.LogLevel.INFO,"Playhead outside of DVR window bounds. Moving to ".concat(n)),this.videoSurface.seek(n)}this.pauseTime=NaN}i.prototype.play.call(this)},n.prototype.pause=function(){var t;this.pIsLiveStream&&!0===(null===(t=this.config.resource.overrides)||void 0===t?void 0:t.clearOutOfBoundsDvrBuffer)&&(this.pauseTime=this.liveStreamInfo.absoluteTime),i.prototype.pause.call(this)},n.prototype.seek=function(t){if(this.pIsLiveStream){var n=this.liveStreamInfoVO;t=w.mapToRange(t,0,n.relativeDuration,n.safeSeekingTime,n.safeSeekingDuration)}i.prototype.seek.call(this,t)},Object.defineProperty(n.prototype,"seekable",{get:function(){var t={start:0,end:0},i=this.videoSurface.video.seekable,n=i.length-1;return n>=0&&(t.start=i.start(n),t.end=i.end(n)),t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"segmentDuration",{get:function(){return 6},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"liveStreamInfo",{get:function(){var t,i=this.liveStreamInfoVO,n=this.videoSurface.video,e=this.seekable,r=e.start,s=e.end,u=n.currentTime,o=s-r,a=this.segmentDuration,c=this.playback.liveEdgeSyncFragmentCount,h=(null===(t=this.config.resource.overrides)||void 0===t?void 0:t.safeSeekDuration)||a;i.relativeTime=Math.max(u-r,0),i.relativeDuration=o,i.absoluteDuration=Date.now(),i.dvrWindowSize=Math.floor(o),i.liveEdgeOffset=a*c+a,i.safeSeekingTime=Math.ceil(r+h),i.safeSeekingDuration=Math.floor(s-h),i.isPlayingLive=Math.ceil(u+i.liveEdgeOffset)>=i.safeSeekingDuration,s!=this.lastKnownTimes.end&&(this.lastKnownTimes.end=s,i.absoluteStart=i.absoluteDuration-1e3*o,this.lastKnownTimes.absolute=Math.round(i.absoluteStart+1e3*i.relativeTime),this.lastKnownTimes.relative=u);var l=Math.round(1e3*(u-this.lastKnownTimes.relative));return i.absoluteTime=this.lastKnownTimes.absolute+l,i},enumerable:!1,configurable:!0}),n}(ie),Dr=function(i){function n(n){var e=i.call(this,n)||this;return e.pType=t.PlaybackAdapterType.HLSJS,e.Hls=window.Hls,e.pFramerate=Number.NaN,e.pFragmentType="",e.textTrackInfo={track:null,tracks:[]},e.hlsjsEventMap=[{type:e.Hls.Events.MANIFEST_PARSED,callback:function(t,i){return e.onManifestParsed(t,i)}},{type:e.Hls.Events.LEVEL_LOADED,callback:function(t,i){return e.onLevelLoaded(t,i)}},{type:e.Hls.Events.LEVEL_UPDATED,callback:function(t,i){return e.onLevelUpdated(t,i)}},{type:e.Hls.Events.LEVEL_SWITCHING,callback:function(t,i){return e.onLevelSwitching(t,i)}},{type:e.Hls.Events.LEVEL_SWITCHED,callback:function(t,i){return e.onLevelSwitched(t,i)}},{type:e.Hls.Events.FRAG_LOADED,callback:function(t,i){return e.onFragmentLoaded(t,i)}},{type:e.Hls.Events.FRAG_PARSING_DATA,callback:function(t,i){return e.onFragmentParsingData(t,i)}},{type:e.Hls.Events.AUDIO_TRACKS_UPDATED,callback:function(t,i){return e.onAudioTrackUpdated(t,i)}},{type:e.Hls.Events.AUDIO_TRACK_SWITCHED,callback:function(t,i){return e.onAudioTrackSwitched(t,i)}},{type:e.Hls.Events.ERROR,callback:function(t,i){return e.onError(t,i)}},{type:e.Hls.Events.SUBTITLE_TRACKS_UPDATED,callback:function(t,i){return e.onSubtitleTracksUpdated(t,i)}},{type:e.Hls.Events.SUBTITLE_TRACK_SWITCH,callback:function(t,i){return e.onSubtitleTrackSwitch(t,i)}}],e.onCueChange=function(t){var i=t.target,n=w.dedupeCues(i);e.config.textTrackSettings.native||e.emit(hi.TEXT_CUEPOINT,{activeCues:n})},e.logger.log(t.LogLevel.INFO,"HlsjsAdapter created"),e}return u(n,i),n.prototype.createVideoSurface=function(){return new hn(this.config,!1)},Object.defineProperty(n.prototype,"textTrackMode",{set:function(t){this.enabledSubtitles(t),this.emit(hi.TEXT_TRACK_DISPLAY_MODE_CHANGE,{mode:t})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrack",{set:function(t){t&&(this.player.subtitleTrack=parseInt(t.id))},enumerable:!1,configurable:!0}),n.prototype.initialize=function(){var n=this;i.prototype.initialize.call(this);var e={};e.debug=this.enableLogger,e.capLevelToPlayerSize=this.playback.abr.capQualityToScreenSize,e.autoStartLoad=!1,e.liveSyncDurationCount=this.playback.liveEdgeSyncFragmentCount,e.manifestLoadingMaxRetry=Nr.MANIFEST_RETRY_ATTEMPTS,e.manifestLoadingRetryDelay=Nr.MANIFEST_RETRY_DELAY,e.levelLoadingRetryDelay=Nr.LEVEL_RETRY_DELAY,e.fragLoadingRetryDelay=Nr.FRAGMENT_RETRY_DELAY,e.enableCEA708Captions=!0;var r=this.config.performanceSettings;null!=r.forwardBufferLength&&(e.maxBufferLength=r.forwardBufferLength),null!=r.backBufferLength&&(e.liveBackBufferLength=r.backBufferLength),null!=r.topQualityForwardBufferLength&&(e.maxMaxBufferLength=r.topQualityForwardBufferLength);var s=(e=this.mergeStreamingConfigs(e,this.config.resource.overrides)).xhrSetup;e.xhrSetup=s?function(t,i){s(t,i),n.onRequest(t,i)}:this.onRequest.bind(this),this.logger.log(t.LogLevel.INFO,"Hlsjs version: ".concat(this.Hls.version)),this.player=new this.Hls(e),this.player.subtitleDisplay=this.config.textTrackSettings.native,this.addEvents(this.player,this.hlsjsEventMap)},n.prototype.loadMediaUrl=function(){var t=this,n=w.eventsToPromise([{target:this.player,events:[this.Hls.Events.MANIFEST_LOADED]}],[{target:this,events:[Gn.ERROR]}]);return this.player.loadSource(this.mediaUrl),n.then((function(i){t.initNativeTextTracks(i);var n=w.eventsToPromise([{target:t.player,events:[t.Hls.Events.MEDIA_ATTACHED]}],[{target:t,events:[Gn.ERROR]}]);return t.player.attachMedia(t.videoSurface.video),n})).then((function(){var i=t.playback.startTime;t.player.startLoad(isNaN(i)?-1:i),t.setBitrateRestrictionAtStartup(),t.emit(Gn.MANIFEST_LOADED)})).then((function(){return i.prototype.loadMediaUrl.call(t)}))},n.prototype.destroy=function(){var n=this;this.removeEvents(this.player,this.hlsjsEventMap),this.destroyNativeTextTracks();var e=w.eventsToPromise([{target:this.player,events:[this.Hls.Events.MEDIA_DETACHING]}],[{target:this,events:[Gn.ERROR]}]);return this.player.destroy(),this.player=null,this.Hls=null,w.forEach(this.config.video.textTracks,(function(i){i.removeEventListener(t.TextTrackEvent.CUE_CHANGE,n.onCueChange)})),e.then((function(){return i.prototype.destroy.call(n)}))},n.prototype.suspend=function(){this.player.stopLoad()},n.prototype.resume=function(){this.player.startLoad()},Object.defineProperty(n.prototype,"audioTrack",{set:function(t){this.player.audioTrack=t.index},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentIndex",{get:function(){return this.player.loadLevel},set:function(t){this.player.loadLevel=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoQualitySwitching",{get:function(){return-1===this.player.loadLevel},set:function(t){this.player.loadLevel=t?-1:this.player.nextLoadLevel},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minBitrate",{get:function(){return this.player.config.minAutoBitrate},set:function(t){this.player.config.minAutoBitrate=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBitrate",{get:function(){return this.player.levels[this.player.autoLevelCapping].bitrate},set:function(t){var i=isNaN(t);this.player.capLevelToPlayerSize=!!i&&this.playback.abr.capQualityToScreenSize,this.player.autoLevelCapping=i?-1:w.getIndexForBitrate(this.player.levels,t,!1)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"manifestQualities",{get:function(){return this.player.levels.map((function(t,i){return{index:i,bitrate:t.bitrate,width:t.width,height:t.height,codec:t.attrs?t.attrs.CODECS:void 0}}))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"seekable",{get:function(){var t=this.videoSurface.video.duration;return{start:t-(this.lowLevelDvrDetails?this.lowLevelDvrDetails.totalduration:0),end:t}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"segmentDuration",{get:function(){return this.lowLevelDvrDetails?this.lowLevelDvrDetails.averagetargetduration:i.prototype.segmentDuration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"framerate",{get:function(){return this.pFramerate},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fragmentType",{get:function(){return this.pFragmentType},enumerable:!1,configurable:!0}),n.prototype.onManifestParsed=function(t,i){this.emit(Gn.MANIFEST_PARSED,{profile:this.manifestQualities})},n.prototype.onLevelLoaded=function(t,i){this.lowLevelDvrDetails=i.details,this.pIsLiveStream=this.lowLevelDvrDetails.live,this.emit(Gn.ABR_QUALITY_LOADED,{index:i.level})},n.prototype.onLevelUpdated=function(t,i){this.checkAbrConstraints(this.player.maxAutoLevel)},n.prototype.onLevelSwitching=function(t,i){this.emit(Gn.ABR_QUALITY_SWITCHING,{index:i.level})},n.prototype.onLevelSwitched=function(t,i){this.emit(Gn.ABR_QUALITY_LOADED,{index:i.level})},n.prototype.onFragmentLoaded=function(t,i){this.networkErrorRetryCount=0,this.mediaErrorRetryCount=0,this.pFragmentType||(this.pFragmentType=w.getMimeType(i.frag.url)),this.checkAbrConstraints(this.player.maxAutoLevel);var n=i.stats?i.stats:i.frag.stats,e=8e3*n.loaded/Number(window.performance.now()-n.trequest);this.emit(Gn.FRAGMENT_LOADED,{bandwidth:e})},n.prototype.onFragmentParsingData=function(t,i){this.pFramerate=i.nb/(i.endPTS-i.startPTS),this.emit(Gn.FRAGMENT_PARSED,{rate:this.pFramerate})},n.prototype.onAudioTrackUpdated=function(t,i){this.normalizedAudioTracks=this.normalizeAudioTracks(this.player.audioTracks,{codec:"audioCodec",label:"name"}),this.emit(Gn.AUDIO_TRACK_UPDATED,{tracks:this.normalizedAudioTracks,track:this.normalizedAudioTracks[this.player.audioTrack]})},n.prototype.onAudioTrackSwitched=function(t,i){this.emit(Gn.AUDIO_TRACK_CHANGE,{track:this.normalizedAudioTracks[parseInt(i.id)]})},n.prototype.onSubtitleTrackSwitch=function(t,i){var n=this.textTrackInfo.tracks.find((function(t){return t.id==i.id}));-1!==i.id&&n&&this.textTrackInfo.track!==n&&this.selectSubtitles(n)},n.prototype.onSubtitleTracksUpdated=function(t,i){this.setTextTracks(i.subtitleTracks.map((function(t,i){return{id:t.id,language:t.lang,kind:t.type.toLowerCase(),label:t.name,default:t.default}})))},n.prototype.onRequest=function(t,i){var n=this;t.withCredentials||(t.withCredentials=i.indexOf("akamaihd")>-1&&i.indexOf("csmil")>-1);var e=this.config.resource.location.drm.aes;if(!w.isEmpty(e)&&i.includes(e.provider)){var r=e.header;for(var s in r){var u=r[s];t.setRequestHeader(s,u)}}this.multiCdnHeaderPresent&&t.addEventListener("readystatechange",(function(e){if(-1!==i.indexOf(".ts")&&t.readyState===XMLHttpRequest.HEADERS_RECEIVED&&n.multiCdnHeaderPresent){var r=t.getAllResponseHeaders();n.multiCdnHeaderPresent=-1!==r.indexOf(Sr.MULTI_CDN),n.multiCdnHeaderPresent&&n.emit(Gn.MULTI_CDN,{cdn:t.getResponseHeader(Sr.MULTI_CDN.toUpperCase())})}}))},n.prototype.onError=function(i,n){var e=t.ErrorCode.UNSPECIFIED_HLSJS_ERROR;switch(n.type){case this.Hls.ErrorTypes.NETWORK_ERROR:n.fatal&&this.handleNetworkErrors(n);break;case this.Hls.ErrorTypes.MEDIA_ERROR:n.fatal&&this.handleMediaErrors(n);break;case this.Hls.ErrorTypes.MUX_ERROR:e=t.ErrorCode.HLSJS_MUX_ERROR;default:var r=this.getErrorMessage("".concat(n.details),n.fatal);this.log(t.LogLevel.ERROR,r,n),this.throwError(e,r,n,n.fatal)}},n.prototype.handleNetworkErrors=function(i){var n=Nr.FATAL_ERROR_RECOVERY_ATTEMPTS,e=this.Hls.ErrorDetails;switch(i.details){case e.LEVEL_LOAD_ERROR:case e.FRAG_LOAD_ERROR:if(this.networkErrorRetryCount<n){this.player.startLoad(),this.networkErrorRetryCount++,this.log(t.LogLevel.ERROR,this.getErrorMessage(Mi.messages.RETRY_PLAYBACK_NETWORK_ERROR,!1,"".concat(this.networkErrorRetryCount," / ").concat(n)));break}this.throwError(t.ErrorCode.HLSJS_NETWORK_ERROR,Mi.messages.FATAL_PLAYBACK_NETWORK_ERROR,i);break;case e.MANIFEST_PARSING_ERROR:this.throwError(t.ErrorCode.HLSJS_PARSE_ERROR,"".concat(Mi.messages.FATAL_PLAYBACK_NETWORK_ERROR," : ").concat(i.details),i);break;default:this.throwError(t.ErrorCode.HLSJS_NETWORK_ERROR,"".concat(Mi.messages.FATAL_PLAYBACK_NETWORK_ERROR," : ").concat(i.details),i,i.fatal)}},n.prototype.handleMediaErrors=function(i){var n=this.Hls.ErrorDetails;if(i.details===n.MANIFEST_INCOMPATIBLE_CODECS_ERROR)this.throwError(t.ErrorCode.HLSJS_SRC_NOT_SUPPORTED,"".concat(Mi.messages.FATAL_PLAYBACK_MEDIA_ERROR," : ").concat(i.details),i);else this.throwError(t.ErrorCode.HLSJS_MEDIA_ERROR,"".concat(Mi.messages.FATAL_PLAYBACK_MEDIA_ERROR," : ").concat(i.details),i)},n.prototype.setBitrateRestrictionAtStartup=function(){var t=this.playback.abr;if(isNaN(t.minBitrate)||(this.minBitrate=t.minBitrate-1),isNaN(t.maxBitrate)||(this.maxBitrate=t.maxBitrate),!isNaN(t.startBitrate)){var i=this.player.levels,n=w.getIndexForBitrate(i,t.startBitrate,!1);w.inRange(n,0,i.length-1)&&(this.player.config.startLevel=n)}},n.prototype.setTextTracks=function(i){var n=this;this.textTrackInfo.tracks=i,w.forEach(i,(function(t){return n.emit(hi.TEXT_TRACK_ADDED,t)})),w.forEach(this.config.video.textTracks,(function(i){w.isTextTrack(i.kind)&&i.addEventListener(t.TextTrackEvent.CUE_CHANGE,n.onCueChange)})),this.emit(hi.TEXT_TRACK_AVAILABLE),w.find(i,(function(t){return t.default}))||this.selectSubtitles(w.findDefaultTrack(i,this.config.textTrackSettings.language))},n.prototype.selectSubtitles=function(t){this.textTrackInfo.track=t,this.emit(hi.TEXT_TRACK_CHANGE,t),this.enabledSubtitles(this.config.textTrackSettings.mode)},n.prototype.enabledSubtitles=function(i){i!==t.TextTrackMode.DISABLED?this.textTrack=this.textTrackInfo.track:this.player.subtitleTrack=-1},n.prototype.initNativeTextTracks=function(i){var n,e=this,r=null===(n=i.subtitles)||void 0===n?void 0:n.length,s=this.config.resource.location.textTrackUrl;if(r)s&&this.logger.warn("Detected subtitles in the manifest. Ignoring resource's textTrackUrl");else{var u=this.config.video.textTracks,o=[],a=new Map,c=function(){return w.find(u,(function(i){return w.isTextTrack(i.kind)&&i.mode!==t.TextTrackMode.DISABLED}))},h=c(),l=function(t){var i=c();i!==h&&i&&(h=i,e.textTrackInfo.track=a.get(h))},f=w.debounce((function(){e.setTextTracks(o),u.addEventListener(t.TextTrackEvent.CHANGE,l)}),100),d=function(t){var i=t.track;if(w.isTextTrack(i.kind)){var n={id:o.length.toString(),language:i.language,kind:i.kind,label:i.label,default:!1};a.set(n,i),a.set(i,n),o.push(n),f()}};u.addEventListener(t.TextTrackEvent.ADD_TRACK,d),this.enabledSubtitles=function(t){var i=a.get(e.textTrackInfo.track);i&&(i.mode=t)},this.destroyNativeTextTracks=function(){e.config.video.textTracks.removeEventListener(t.TextTrackEvent.ADD_TRACK,d),e.config.video.textTracks.removeEventListener(t.TextTrackEvent.CHANGE,l)},s&&this.createSidecarTextTrack(s)}},n.prototype.destroyNativeTextTracks=function(){},n.prototype.createSidecarTextTrack=function(i){return h(this,void 0,void 0,(function(){var n,e,r,s,u,o,a,c,h=this;return l(this,(function(l){switch(l.label){case 0:return n=i.indexOf(".vtt")>=0,e=this.config.video,r="English",s="en",n?((u=document.createElement("track")).kind=li.CAPTIONS,u.label=r,u.srclang=s,u.id="sidecar-vtt",u.src=i,e.appendChild(u),u.track.mode=this.config.textTrackSettings.mode,[3,4]):[3,1];case 1:return l.trys.push([1,3,,4]),[4,new an(i,this.config.system).convert()];case 2:return o=l.sent(),a=e.addTextTrack(li.CAPTIONS,r,s),this.logger.log(t.LogLevel.INFO,"Smpte XML conversion and text track creation successful"),w.forEach(o,(function(i){try{a.addCue(i)}catch(i){h.logger.log(t.LogLevel.INFO,i)}})),[3,4];case 3:return c=l.sent(),this.logger.log(t.LogLevel.INFO,"Smpte XML conversion and text track creation error",c.message),[3,4];case 4:return[2]}}))}))},n}(_r);!function(t){t[t.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",t[t.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",t[t.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",t[t.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"}(Cr||(Cr={})),function(t){t.IRDETO="irdeto",t.DRM_TODAY="drmtoday",t.UNKNOWN="unknown"}(Pr||(Pr={}));var Mr,xr=function(i){function n(t,n,e){var r=i.call(this)||this;return r.WEBKIT_KEY_MESSAGE="webkitkeymessage",r.WEBKIT_KEY_ADDED="webkitkeyadded",r.WEBKIT_KEY_ERROR="webkitkeyerror",r.appCertLoaded=!1,r.webKitNeedKeyCalled=!1,r.webkitNeedKeyHandler=function(t){return r.onWebkitNeedKey(t)},r.drmInfo=n.resource.location.drm,r.videoSurface=t,r.videoSurface.on(fi.WEBKIT_NEED_KEY,r.webkitNeedKeyHandler),r.logger=e,r}return u(n,i),n.prototype.initialize=function(){var t=this;Zt({url:this.drmInfo.fairplay.appCertUrl,responseType:O.ARRAY_BUFFER}).then((function(i){return t.onAppCertLoaded(i)}))},n.prototype.destroy=function(){this.videoSurface.off(fi.WEBKIT_NEED_KEY,this.webkitNeedKeyHandler)},n.prototype.onAppCertLoaded=function(t){this.appCertData=new Uint8Array(t),this.appCertLoaded=!0,this.webKitNeedKeyCalled&&this.initializeFairplayCDM()},n.prototype.onWebkitNeedKey=function(t){this.initData=t.data.initData,this.webKitNeedKeyCalled=!0,this.appCertLoaded&&this.initializeFairplayCDM()},n.prototype.onLicenseRequestReady=function(t,i){this.drmVendor=this.getDrmVendor(t);var n=new XMLHttpRequest;n.session=i.target,n.addEventListener("load",this.onLicenseLoaded.bind(this),!1),n.open("POST",t,!0),n.responseType=this.drmVendor===Pr.IRDETO||this.drmVendor===Pr.UNKNOWN?O.ARRAY_BUFFER:O.TEXT;var e="spc="+encodeURIComponent(w.base64EncodeUint8Array(i.message))+"&"+n.session.contentId;(n=this.setRequestHeaders(n)).send(e)},n.prototype.setRequestHeaders=function(t){if(t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),!w.isEmpty(this.drmInfo.fairplay.header)){var i=this.drmInfo.fairplay.header;for(var n in i){var e=i[n];t.setRequestHeader(n,e)}}return t},n.prototype.onLicenseLoaded=function(i){var n=i.target,e=n.session;w.inRange(n.status,200,400)||this.throwFatalError(t.ErrorCode.FAIRPLAY_LIC_ERROR,Mi.messages.FAIRPLAY_LICENSE_ERROR);var r="arraybuffer"!==n.responseType?w.base64DecodeUint8Array(n.responseText):new Uint8Array(n.response);e.update(r)},n.prototype.onWebkitKeyAdded=function(i){this.logger.log(t.LogLevel.INFO,Mi.messages.WEBKIT_KEY_ADDED_SUCCESS)},n.prototype.onWebkitError=function(i){this.throwFatalError(t.ErrorCode.FAIRPLAY_LIC_ERROR,"".concat(Mi.messages.FAIRPLAY_LICENSE_ERROR))},n.prototype.initializeFairplayCDM=function(){var i=this.getLicenseServerUrl(this.initData),n=this.getId(i,this.initData),e=this.videoSurface.video,r=Ln.getInstance().global,s=Mi.messages;if(n){if(!e.webkitKeys){var u=t.DrmType.FAIRPLAY_1_0;if(!r.WebKitMediaKeys.isTypeSupported(u,"video/mp4"))return void this.throwFatalError(t.ErrorCode.FAIRPLAY_APP_CERT_ERROR,s.FAIRPLAY_WEBKIT_ERROR);try{e.webkitSetMediaKeys(new r.WebKitMediaKeys(u))}catch(i){return void this.throwFatalError(t.ErrorCode.FAIRPLAY_APP_CERT_ERROR,i.message)}}var o=this.concatInitDataIdAndCertificate(this.initData,n,this.appCertData),a=e.webkitKeys.createSession("video/mp4",o);a?(a.contentId=n,a.addEventListener(this.WEBKIT_KEY_MESSAGE,this.onLicenseRequestReady.bind(this,i),!1),a.addEventListener(this.WEBKIT_KEY_ADDED,this.onWebkitKeyAdded.bind(this),!1),a.addEventListener(this.WEBKIT_KEY_ERROR,this.onWebkitError.bind(this),!1)):this.throwFatalError(t.ErrorCode.FAIRPLAY_APP_CERT_ERROR,s.FAIRPLAY_WEBKIT_ERROR)}else this.throwFatalError(t.ErrorCode.FAIRPLAY_APP_CERT_ERROR,s.FAIRPLAY_NO_CONTENT_ID)},n.prototype.concatInitDataIdAndCertificate=function(t,i,n){"string"==typeof i&&(i=w.stringToArray(i));var e=0,r=new ArrayBuffer(t.byteLength+4+i.byteLength+4+n.byteLength),s=new DataView(r);new Uint8Array(r,e,t.byteLength).set(t),e+=t.byteLength,s.setUint32(e,i.byteLength,!0),e+=4;var u=new Uint16Array(r,e,i.length);return u.set(i),e+=u.byteLength,s.setUint32(e,n.byteLength,!0),e+=4,new Uint8Array(r,e,n.byteLength).set(n),new Uint8Array(r,0,r.byteLength)},n.prototype.getLicenseServerUrl=function(t){var i=null;w.isEmpty(this.drmInfo.fairplay.licenseUrl)?i="https://"+String.fromCharCode.apply(null,new Uint16Array(t.buffer)).split("://")[1]:i=this.drmInfo.fairplay.licenseUrl;return this.drmInfo.sessionId&&(i=$t.append(i,{SessionId:this.drmInfo.sessionId})),this.drmInfo.ticket&&(i=$t.append(i,{Ticket:this.drmInfo.ticket})),i},n.prototype.extractContentId=function(t){return w.arrayToString(t).split("skd://")[1]},n.prototype.getId=function(t,i){var n=$t.decode(t);return console.log(n),n.ContentId||n.contentId||n.assetId||this.extractContentId(i)},n.prototype.getDrmVendor=function(t){var i=Pr.UNKNOWN;return-1!==t.indexOf(Pr.IRDETO)?i=Pr.IRDETO:-1!==t.indexOf(Pr.DRM_TODAY)&&(i=Pr.DRM_TODAY),i},n.prototype.throwFatalError=function(i,n){this.logger.log(t.LogLevel.ERROR,i,n),this.emit(Gn.ERROR,{code:i,message:n,fatal:!0})},n}(T),Lr=function(i){function n(n){var e=i.call(this,n)||this;return e.pType=t.PlaybackAdapterType.HTML5,e.audioTrackIdx=-1,e.fairPlayEventHandler=function(t){return e.onFairplayEvent(t)},e.textTrackMap=new Map,e.logger.log(t.LogLevel.INFO,"Html5Adapter created"),e}return u(n,i),n.prototype.initialize=function(){i.prototype.initialize.call(this),this.hasFairplayDrm(this.config.resource.location.drm)&&(this.fairplay=new xr(this.videoSurface,this.config,this.logger),this.fairplay.on(Gn.ERROR,this.fairPlayEventHandler),this.fairplay.initialize(),this.emit(Gn.DRM_KEYSYSTEM_CREATED,{keysystem:t.DrmType.FAIRPLAY_1_0}))},n.prototype.destroy=function(){return this.videoSurface.video.removeAttribute("src"),this.videoSurface.video.load(),this.fairplay&&(this.fairplay.off(Gn.ERROR,this.fairPlayEventHandler),this.fairplay.destroy()),i.prototype.destroy.call(this)},Object.defineProperty(n.prototype,"currentIndex",{set:function(i){this.logger.log(t.LogLevel.INFO,Mi.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoQualitySwitching",{set:function(i){this.logger.log(t.LogLevel.INFO,Mi.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minBitrate",{set:function(i){this.logger.log(t.LogLevel.INFO,Mi.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBitrate",{set:function(i){this.logger.log(t.LogLevel.INFO,Mi.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"manifestQualities",{get:function(){return[]},enumerable:!1,configurable:!0}),n.prototype.onVideoSurfaceEvent=function(t){var n,e=t.data;switch(t.type){case fi.DURATION_CHANGE:this.pIsLiveStream=this.videoSurface.duration==1/0;break;case hi.TEXT_TRACK_ADDED:return n={id:w.uid8(),language:e.language,kind:e.kind,label:e.label},this.textTrackMap.set(e,n),void this.emit(t.type,n);case hi.TEXT_TRACK_CHANGE:return n=this.textTrackMap.get(e),void this.emit(t.type,n)}i.prototype.onVideoSurfaceEvent.call(this,t),this.updateAudioTracks(t)},n.prototype.loadMediaUrl=function(){var t=this;return this.videoSurface.src=this.mediaUrl,i.prototype.loadMediaUrl.call(this).then((function(){var i=t.playback.startTime;if(i>0)return t.eventsToPromise(fi.CAN_PLAY_THROUGH).then((function(){return t.seek(i)}))}))},n.prototype.updateAudioTracks=function(t){var i=-1!==this.audioTrackIdx,n=this.videoSurface&&this.videoSurface.video&&this.videoSurface.video.audioTracks;if(n){var e=this.getEnabledAudioTrackId(n);switch(t.type){case fi.CAN_PLAY:i||(this.audioTrackIdx=e,this.normalizedAudioTracks=this.normalizeAudioTracks(w.toArray(n),{type:"kind",lang:"language"}),this.emit(Gn.AUDIO_TRACK_UPDATED,{tracks:this.normalizedAudioTracks,track:this.normalizedAudioTracks[this.audioTrackIdx]}));break;case fi.PROGRESS:i&&this.audioTrackIdx!==e&&(this.audioTrackIdx=e,this.emit(Gn.AUDIO_TRACK_CHANGE,{track:this.normalizedAudioTracks[this.audioTrackIdx]}))}}},n.prototype.onFairplayEvent=function(t){this.emit(t.type,t.data)},n.prototype.getEnabledAudioTrackId=function(t){for(var i=t.length;i--;)if(t[i].enabled)return i;return i},n.prototype.hasFairplayDrm=function(t){return null!==t&&!w.isEmpty(t.fairplay)},n.prototype.handleVideoSurfaceError=function(n){i.prototype.handleVideoSurfaceError.call(this,n);var e=this.videoSurface.video.error,r=Object.keys(Cr)[(null==e?void 0:e.code)-1]||Mi.messages.UNSPECIFIED_ERROR;if(e)switch(e.code){case Cr.MEDIA_ERR_NETWORK:this.throwError(t.ErrorCode.HTML5_NETWORK_ERROR,r,e);break;case Cr.MEDIA_ERR_DECODE:this.throwError(t.ErrorCode.HTML5_MEDIA_ERROR,r,e);break;case Cr.MEDIA_ERR_SRC_NOT_SUPPORTED:this.throwError(t.ErrorCode.HTML5_SRC_NOT_SUPPORTED,r,e);break;default:this.throwError(t.ErrorCode.UNSPECIFIED_VIDEO_PLAYBACK_ERROR,r,e)}},n}(_r);!function(t){t.BUFFERING="buffering",t.END_OF_STREAM="endOfStream",t.NOT_READY="notReady",t.OPENING="opening",t.PAUSED="paused",t.PLAYING="playing",t.STOPPED="stopped",t.DISPLAYING_VIDEO="DisplayingVideo",t.UNKNOWN="unknown",t.READY="ready",t.PLAYER_TIMED_EVENT="playerTimedEvent",t.NETWORK_STATUS_CHANGE="networkStatusChange",t.CONTENT_AVAILABLE="contentAvailable",t.PLAYER_STATUS_CHANGE="playerStatusChange",t.PLAYER_STREAMING_ERROR="playerStreamingError",t.PLAYER_ERROR="playerError",t.PLAYER_SUBTITLE="playerSubtitle",t.GET_AUDIO_TRACKS="getAudioTracks",t.GET_VIDEO_REP_COUNT="getRepresentationsCount",t.GET_VIDEO_REP_INFO="getRepresentationInfo",t.GET_SUBTITLE_TRACKS="getSubtitleTracks",t.GET_PLAYBACK_TIME="getPlaybackTime",t.GET_SEEK_WINDOW="getSeekWindow"}(Mr||(Mr={}));var Vr,Br=function(i){function n(n){var e,r=i.call(this)||this;return r.onTicHandler=function(t){return r.onTic(t)},r.pTime=NaN,r.pDuration=NaN,r.abrProfileCount=0,r.pMasterBitrateProfile=[],r.audioTrackUpdated=!1,r.pStartTime=NaN,r.debugMode=!1,r.fatalErrorInProgress=!1,r.cea608708Detected=!1,r.cea608708Enabled=!1,r.seeking=!1,r.logger=n.logger,r.timer=new kn(500),r.timer.on(kn.TIC_EVENT,r.onTicHandler),r.config=n,r.logger.log(t.LogLevel.WARN,"".concat(r.config)),r.global=n.system.global,r.pVideo=r.global.WM_videoPlayer,r.global.accessfunction=function(t){return r.accessfunction(t)},r.pMetrics=r.global.videometrics,r.pMetrics.onBitrateChange=function(t){return r.onBitrateChange(t)},r.debugMode=!!(null===(e=n.playerOptions.overrides)||void 0===e?void 0:e.enableLowLevelStreamingLogs),r.logger&&(r.pVideo.TTY=function(i){r.logger.log(t.LogLevel.DEBUG,i)},r.pVideo.TTYLevel=r.debugMode?3:1),r}return u(n,i),n.prototype.destroy=function(){this.callExternalWebMafApi('{"command":"stop"}'),this.timer.off(kn.TIC_EVENT,this.onTicHandler),i.prototype.destroy.call(this)},n.prototype.load=function(t){return Promise.resolve()},n.prototype.play=function(){return this.callExternalWebMafApi('{"command":"play"}'),Promise.resolve()},n.prototype.pause=function(){this.callExternalWebMafApi('{"command":"pause"}')},n.prototype.seek=function(i){if(!this.seeking){this.seeking=!0,this.pStatePreSeek=this.pState;var n=Math.floor(i);this.callExternalWebMafApi('{"command":"setPlayTime","playTime":'+n+"}"),this.logger.log(t.LogLevel.INFO,"seeking to ".concat(n)),this.emit(fi.SEEKING,{position:n}),this.pState=Mr.BUFFERING}return w.eventsToPromise([{events:[fi.SEEKED],target:this}],[{events:[fi.ERROR],target:this}])},n.prototype.addEvents=function(){},n.prototype.clearCue=function(){},Object.defineProperty(n.prototype,"startTime",{set:function(i){this.logger.log(t.LogLevel.INFO,"startTime set on webmaf ".concat(i)),this.pStartTime=i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"volume",{get:function(){return 1},set:function(t){this.callExternalWebMafApi('{"command":"setVolume", "volume":'+t+"}")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"muted",{get:function(){return!1},set:function(t){this.callExternalWebMafApi('{"command": "setVolume", "volume": 0.0}')},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"src",{set:function(t){this.callExternalWebMafApi(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"video",{get:function(){return this.pVideo},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"framerate",{get:function(){return this.metrics.renderedFramerate},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"metrics",{get:function(){return this.pMetrics},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){return this.pTime},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return this.pDuration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bufferLength",{get:function(){return this.pVideo.bufferedRange},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"buffering",{get:function(){return this.pState===Mr.BUFFERING},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"paused",{get:function(){return this.pState===Mr.PAUSED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this.pState},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"masterBitrateProfile",{get:function(){return this.pMasterBitrateProfile},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bitrate",{get:function(){return this.pMetrics.currentBitrate},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"startingBitrate",{set:function(i){this.logger.log(t.LogLevel.INFO,"startingBitrate set on webmaf ".concat(i)),this.callExternalWebMafApi('{"command":"setVideoStartingBandwidth","bandwidth":'+i+"}")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minBitrate",{set:function(i){this.logger.log(t.LogLevel.INFO,"minBitrate set on webmaf ".concat(i)),this.callExternalWebMafApi('{"command":"setFixVideoRepresentations", "minBitrate":'+i+"}")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBitrate",{set:function(i){this.logger.log(t.LogLevel.INFO,"maxBitrate set on webmaf ".concat(i)),this.callExternalWebMafApi('{"command":"setFixVideoRepresentations", "maxBitrate":'+i+"}")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"audioTrack",{set:function(t){var i=this.audioTrackInfo.tracks[t.index].id;this.audioTrackUpdated=!0,this.callExternalWebMafApi('{"command":"setAudioTrack", "audioTrack":'+JSON.stringify(i)+"}")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackMode",{set:function(i){var n=i!==t.TextTrackMode.DISABLED;if(this.cea608708Detected)this.cea608708Enabled=n,this.callExternalWebMafApi('{"command":"setClosedCaptions","enable": '+n+"}");else{var e=n?"en":"";this.callExternalWebMafApi('{"command":"setSubtitleTrack","subtitleTrack":'+JSON.stringify(e)+', "disablePreviousTrack":false }')}this.logger.log(t.LogLevel.INFO,"Text Track is enabled: ".concat(n))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrack",{set:function(i){this.logger.log(t.LogLevel.WARN,"Changing the text track language is not supported on PlayStation 4 at this time")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackSrc",{set:function(i){this.logger.log(t.LogLevel.INFO,"Sidecar text is not supported on playstation ".concat(i))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTracks",{get:function(){return[]},enumerable:!1,configurable:!0}),n.prototype.callExternalWebMafApi=function(t){this.global.external.user(t)},n.prototype.onTic=function(t){this.callExternalWebMafApi('{"command":"getPlaybackTime"}'),this.audioTrackUpdated&&(this.audioTrackUpdated=!1),this.pMetrics.poll()},n.prototype.respondToPlaybackTime=function(t){this.pTime!==t.elapsedTime&&t.elapsedTime<=this.pDuration&&(this.pTime=t.elapsedTime,this.seeking||this.emit(fi.TIME_UPDATE,{value:this.pTime}),this.seeking&&(this.seeking=!1,this.pState=this.pStatePreSeek,this.emit(fi.SEEKED)))},n.prototype.onBitrateChange=function(i){var n=i,e=w.getIndexForBitrate(this.pMasterBitrateProfile,n,!1);this.logger.log(t.LogLevel.INFO,"bitrate change ".concat(n)),this.emit(Gn.ABR_QUALITY_LOADED,{index:e})},n.prototype.parseAudioInfo=function(t){for(var i=t.audioTracks.split(","),n=t.audioNumChannels.split(","),e={track:null,tracks:[]},r=0,s=i.length;r<s;r++){var u={index:r,id:i[r],type:n[r],lang:i[r],label:i[r],codec:""};e.tracks.push(u),i[r]===t.currentAudioTrack&&(e.track=u)}return e},n.prototype.accessfunction=function(i){this.debugMode&&-1===i.indexOf("getPlaybackTime")&&-1===i.indexOf("playerSubtitle")&&-1===i.indexOf("playerMessage")&&this.logger.log(t.LogLevel.INFO,"Access Function Avia:",i);var n=JSON.parse(i);switch(n.command){case Mr.GET_AUDIO_TRACKS:this.respondToAudioTrackInfo(n);break;case Mr.GET_VIDEO_REP_COUNT:this.respondToVideoRepCount(n);break;case Mr.GET_VIDEO_REP_INFO:this.respondToVideoRepInfo(n);break;case Mr.GET_SUBTITLE_TRACKS:this.respondToGetSubtitleTracks(n);break;case Mr.GET_PLAYBACK_TIME:this.respondToPlaybackTime(n);break;case Mr.NETWORK_STATUS_CHANGE:break;case Mr.CONTENT_AVAILABLE:this.respondToContentAvailable(n);break;case Mr.PLAYER_SUBTITLE:this.respondToPlayerSubtitle(n);break;case Mr.GET_SEEK_WINDOW:break;case Mr.PLAYER_TIMED_EVENT:this.respondToTimedMetadataEvent(n);break;case Mr.PLAYER_ERROR:case Mr.PLAYER_STREAMING_ERROR:this.fatalErrorInProgress||(this.fatalErrorInProgress=!0,this.respondToError(n));break;case Mr.PLAYER_STATUS_CHANGE:this.respondToPlayerStatusChange(n)}},n.prototype.respondToPlayerStatusChange=function(t){switch(t.playerState){case Mr.BUFFERING:break;case Mr.READY:this.respondToPlayerStatusReady(t);break;case Mr.PAUSED:this.emit(fi.PAUSE);break;case Mr.PLAYING:this.emit(fi.PLAYING);break;case Mr.DISPLAYING_VIDEO:this.timer.start();break;case Mr.END_OF_STREAM:this.respondToPlayerStatusEOS()}this.pState=t.playerState},n.prototype.respondToError=function(i){var n=0===this.pDuration?t.ErrorCode.WEBMAF_START_ERROR:t.ErrorCode.WEBMAF_NETWORK_ERROR,e="fail"===i.status,r=null;i.error_info?r=i.error_info:i.error&&i.status_code&&(r=i.error+" : "+i.status_code),this.emit(fi.ERROR,{code:n,message:r,data:i,fatal:e})},n.prototype.respondToGetSubtitleTracks=function(i){var n=this;i.subtitleTracks.split(",").forEach((function(e){if("und"===e)n.logger.log(t.LogLevel.INFO,"timed metadata detected.",i),n.callExternalWebMafApi('{"command":"setTimedMetadata","enable":true}'),n.callExternalWebMafApi('{"command":"setSubtitleTrack","subtitleTrack":"und", "disablePreviousTrack":false}'),n.callExternalWebMafApi('{"command":"setClosedCaptions","enable":true}');else if("en"===e){var r={language:e,kind:"subtitle",label:e};n.emit(hi.TEXT_TRACK_AVAILABLE),n.emit(hi.TEXT_TRACK_ADDED,r),n.emit(hi.TEXT_TRACK_CHANGE,r)}}))},n.prototype.respondToTimedMetadataEvent=function(t){var i=this;if("cea-708"===t.datatype)this.cea608708Detected?this.cea608708Enabled&&this.respondToPlayerSubtitle(t):(this.cea608708Detected=!0,this.callExternalWebMafApi('{"command":"setClosedCaptions","enable":false}'),this.emit(hi.TEXT_TRACK_AVAILABLE));else if("data"===t.datatype){var n=this.config.resource.playback.id3OwnerIds,e=atob(t.data).split("PRIV")[1].slice(6,-1);w.forEach(n,(function(n){-1!==e.indexOf(n)&&i.emit(hi.METADATA_CUEPOINT,{id:"PRIV",info:e,data:t.data})}))}else"text"===t.datatype&&this.detectDaiImpression(t.data)&&this.emit(hi.METADATA_CUEPOINT,{id:"google_dai",info:"",data:t.data,startTime:t.timestamp/1e3})},n.prototype.detectDaiImpression=function(t){return/google_\d+/.test(t)},n.prototype.respondToPlayerSubtitle=function(t){if(!this.detectDaiImpression(t.text)){var i=[];"cea-708"===t.datatype?i=t.details.captions:i.push({text:t.text}),i.length>0&&this.emit(hi.TEXT_CUEPOINT,{activeCues:i})}},n.prototype.respondToContentAvailable=function(t){this.pDuration!==t.totalLength&&(this.pDuration=0===t.totalLength?Number.POSITIVE_INFINITY:t.totalLength,this.emit(fi.DURATION_CHANGE,{value:this.pDuration}))},n.prototype.respondToVideoRepInfo=function(t){this.pMasterBitrateProfile.push(t),this.pMasterBitrateProfile.length===this.abrProfileCount&&this.emit(Gn.MANIFEST_PARSED,this.pMasterBitrateProfile)},n.prototype.respondToVideoRepCount=function(t){this.abrProfileCount=t.count;for(var i=0;i<this.abrProfileCount;i++)this.callExternalWebMafApi('{"command":"getRepresentationInfo", "representation":'+i+"}")},n.prototype.respondToAudioTrackInfo=function(t){this.audioTrackInfo=this.parseAudioInfo(t),this.emit(Gn.AUDIO_TRACK_UPDATED,this.audioTrackInfo)},n.prototype.respondToPlayerStatusEOS=function(){this.timer.stop(),this.emit(fi.ENDED)},n.prototype.respondToPlayerStatusReady=function(t){this.emit(fi.LOADED_METADATA),this.callExternalWebMafApi('{"command":"getRepresentationsCount"}'),this.callExternalWebMafApi('{"command":"getSubtitleTracks"}'),this.callExternalWebMafApi('{"command":"getSeekWindow"}'),!isNaN(this.pStartTime)&&this.seek(this.pStartTime)},n}(T),Ur=function(i){function n(n){var e=i.call(this,n)||this;return e.pType=t.PlaybackAdapterType.PLAY_STATION,e.psEventMap=[{type:Gn.MANIFEST_PARSED,callback:function(t){return e.onManifestParsed(t)}},{type:Gn.ABR_QUALITY_LOADED,callback:function(t){return e.onBubble(t)}},{type:Gn.AUDIO_TRACK_UPDATED,callback:function(t){return e.onBubble(t)}}],e.log(e.pType,e.videoSurface.video.version,e.videoSurface.video.TTYLevel,e.videoSurface.metrics),e}return u(n,i),n.prototype.createVideoSurface=function(){return new Br(this.config)},n.prototype.createMetadataSurface=function(){return null},n.prototype.initialize=function(){i.prototype.initialize.call(this);var t=this.playback,n=this.videoSurface;!isNaN(t.abr.startBitrate)&&(n.startingBitrate=t.abr.startBitrate),!isNaN(t.abr.minBitrate)&&(n.minBitrate=t.abr.minBitrate),!isNaN(t.abr.maxBitrate)&&(n.maxBitrate=t.abr.maxBitrate),!isNaN(t.startTime)&&(n.startTime=t.startTime),this.addEvents(this.videoSurface,this.psEventMap)},n.prototype.loadMediaUrl=function(){var t,n,e=this.config.resource.location.drm,r=null===(n=null===(t=e.aes.header)||void 0===t?void 0:t.authorization)||void 0===n?void 0:n.trim().replace(/^Bearer /i,""),s='{"command":"load", "contentUri":"'+this.mediaUrl+'","licenseUri":"", "customData":"&ls_session='+r+'","sourceType":0}',u='{"command":"load", "contentUri":"'+this.mediaUrl+'", "licenseUri":"'+e.playready.url+'","customData": "","sourceType":0}';return this.videoSurface.src=w.isEmpty(e.aes.header)?u:s,i.prototype.loadMediaUrl.call(this)},n.prototype.destroy=function(){return this.removeEvents(this.videoSurface,this.psEventMap),this.videoSurface.destroy(),i.prototype.destroy.call(this)},n.prototype.play=function(){this.videoSurface.play()},n.prototype.pause=function(){this.videoSurface.pause()},n.prototype.seek=function(t){this.videoSurface.seek(t)},Object.defineProperty(n.prototype,"audioTrack",{set:function(t){this.videoSurface.audioTrack=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this.pType},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){return this.videoSurface.time},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return this.videoSurface.duration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"droppedVideoFrames",{get:function(){return this.videoSurface.metrics.droppedFrame},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"buffering",{get:function(){return this.videoSurface.buffering},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentIndex",{set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentBitrate",{get:function(){return this.videoSurface.metrics.bitrate},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoQualitySwitching",{set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minBitrate",{set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBitrate",{set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"manifestQualities",{get:function(){return this.videoSurface.masterBitrateProfile.map(this.normalizeQuality)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"liveStreamInfo",{get:function(){return this.liveStreamInfoVO},enumerable:!1,configurable:!0}),n.prototype.handleVideoSurfaceError=function(t){var i=t.data,n=i.data,e=i.message,r=i.code,s=i.fatal;this.throwError(r,e,n,s)},n.prototype.onManifestParsed=function(t){this.emit(Gn.MANIFEST_PARSED,{profile:this.manifestQualities})},n.prototype.onBubble=function(t){this.emit(t.type,t.data)},n}(ie);!function(t){t[t.MANIFEST_RETRY_ATTEMPTS=2]="MANIFEST_RETRY_ATTEMPTS",t[t.MANIFEST_RETRY_INTERVAL=1e3]="MANIFEST_RETRY_INTERVAL",t[t.FATAL_ERROR_RECOVERY_ATTEMPTS=4]="FATAL_ERROR_RECOVERY_ATTEMPTS",t[t.FATAL_ERROR_RECOVERY_DELAY=1e3]="FATAL_ERROR_RECOVERY_DELAY",t[t.FATAL_ERROR_RECOVERY_BACKOFF=2]="FATAL_ERROR_RECOVERY_BACKOFF",t[t.FATAL_ERROR_RECOVERY_FUZZ=0]="FATAL_ERROR_RECOVERY_FUZZ"}(Vr||(Vr={}));var Fr=function(i){function n(n){var e=i.call(this,n)||this;return e.pType=t.PlaybackAdapterType.SHAKA,e.shaka=window.shaka,e.textTracks=[],e.pSegmentDuration=NaN,e.playerEventMap=[e.mapEvent("error",e.onError),e.mapEvent("streaming",e.onManifestParsed),e.mapEvent("variantchanged",e.onBitrateChanged),e.mapEvent("adaptation",e.onBitrateChanged),e.mapEvent("emsg",e.onEmsg),e.mapEvent("trackschanged",e.onTracksChanged),e.mapEvent("variantchanged",e.onVariantChanged),e.mapEvent("adaptation",e.onAdaptation),e.mapEvent("drmsessionupdate",e.onDrmSessionUpdate),e.mapEvent("texttrackvisibility",e.onTextTrackVisibility),e.mapEvent("timelineregionenter",e.onTimelineRegionEnter)],e.onCueChangeHandler=function(t){return e.onCueChange(t)},e.audioSwitching=!1,e.renderTextTrackNatively=!0,e.cleanUpVtt=!1,e.logger.log(t.LogLevel.INFO,"ShakaAdapter created"),e.updateAudioTracks=w.debounce(e.updateAudioTracks.bind(e),25),e.updateTextTracks=w.debounce(e.updateTextTracks.bind(e),25),e.resize=w.debounce(e.resize.bind(e),250),e}return u(n,i),n.prototype.createVideoSurface=function(){return new hn(this.config,!1)},n.prototype.initialize=function(){i.prototype.initialize.call(this),"undefined"==typeof VTTCue&&(this.cleanUpVtt=!0),this.shaka.polyfill.installAll(),this.player=new this.shaka.Player(this.videoSurface.video),this.logger.log(t.LogLevel.INFO,"Shaka version: ".concat(this.shaka.Player.version)),this.playerConfig=this.player.getConfiguration(),this.addEvents(this.player,this.playerEventMap);var n=this.playerConfig.streaming.retryParameters;n.maxAttempts=Vr.FATAL_ERROR_RECOVERY_ATTEMPTS,n.baseDelay=Vr.FATAL_ERROR_RECOVERY_DELAY,n.backoffFactor=Vr.FATAL_ERROR_RECOVERY_BACKOFF,n.fuzzFactor=Vr.FATAL_ERROR_RECOVERY_FUZZ,(n=this.playerConfig.manifest.retryParameters).maxAttempts=Vr.MANIFEST_RETRY_ATTEMPTS,n.baseDelay=Vr.MANIFEST_RETRY_INTERVAL,this.networkEngine=this.player.getNetworkingEngine(),this.networkEngine.registerRequestFilter(this.onRequest.bind(this)),this.networkEngine.registerResponseFilter(this.onResponse.bind(this));var e=this.config.resource.location.drm;e.widevine&&e.widevine.url&&(this.playerConfig.drm.servers["com.widevine.alpha"]=e.widevine.url),e.playready&&e.playready.url&&(this.playerConfig.drm.servers["com.microsoft.playready"]=e.playready.url);var r=this.playback.abr,s=this.playerConfig.abr;isNaN(r.minBitrate)||(s.restrictions.minBandwidth=r.minBitrate),isNaN(r.maxBitrate)||(s.restrictions.maxBandwidth=r.maxBitrate),isNaN(r.startBitrate)||(s.defaultBandwidthEstimate=1.15*r.startBitrate);var u=this.config.performanceSettings;null!=u.forwardBufferLength&&(this.playerConfig.streaming.bufferingGoal=u.forwardBufferLength),null!=u.backBufferLength&&(this.playerConfig.streaming.bufferBehind=u.backBufferLength),this.renderTextTrackNatively=this.config.playerOptions.renderTextTrackNatively,0==this.renderTextTrackNatively&&(this.playerConfig.streaming.alwaysStreamText=!0);var o=this.playback,a=o.enableAdvancedCodecs,c=w.isEmpty(o.preferredVideoCodecs)?null:o.preferredVideoCodecs,h=w.isEmpty(o.preferredAudioCodecs)?null:o.preferredAudioCodecs;a&&(this.playerConfig.preferredVideoCodecs=c||["hev","hvc","dvhe"],this.playerConfig.preferredAudioCodecs=h||["ec-3","ac-3"]),this.playerConfig=this.mergeStreamingConfigs(this.playerConfig,this.config.resource.overrides),this.configure()},n.prototype.resize=function(){if(this.playback.abr.capQualityToScreenSize){var t=this.getVariantTracks()[0];if(t){var i=this.videoSurface.video,n=i.clientWidth,e=i.clientHeight;(n<t.width||e<t.height)&&(n=t.width,e=t.height);var r=this.playerConfig.restrictions;r.maxWidth===n&&r.maxHeight===e||(r.maxWidth=n,r.maxHeight=e,this.configure())}}},n.prototype.destroy=function(){var n=this;return this.removeEvents(this.player,this.playerEventMap),this.pTextTrack&&this.pTextTrack.removeEventListener(t.TextTrackEvent.CUE_CHANGE,this.onCueChangeHandler),this.player.destroy().then((function(){return n.player=null,n.networkEngine=null,n.playerConfig=null,n.shaka=null,n.textTracks=null,n.audioTracks=null,n.variant=null,n.pTextTrack=null,n.currentTextTrack=null,n.cleanUpVtt&&delete window.VTTCue,i.prototype.destroy.call(n)}))},n.prototype.suspend=function(){this.playerConfig.streaming.bufferingGoal=1,this.playerConfig.streaming.rebufferingGoal=1},n.prototype.resume=function(){this.playerConfig.streaming.bufferingGoal=10,this.playerConfig.streaming.rebufferingGoal=10},n.prototype.clearCue=function(){w.clearCue(this.pTextTrack,this.videoSurface.video.currentTime)},Object.defineProperty(n.prototype,"seekable",{get:function(){return this.player.seekRange()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoQualitySwitching",{get:function(){return this.playerConfig.abr.enabled},set:function(t){this.playerConfig.abr.enabled=t,this.configure()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentIndex",{get:function(){return w.findIndex(this.getVariantTracks(),this.isActive)},set:function(t){var i=this.getVariantTracks()[t];this.player.selectVariantTrack(i,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"segmentDuration",{get:function(){return this.pSegmentDuration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"manifestQualities",{get:function(){return this.getVariantTracks().map((function(t,i){return{index:i,bitrate:t.bandwidth,width:t.width,height:t.height,codec:t.codecs}}))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBitrate",{get:function(){return this.playerConfig.abr.restrictions.maxBandwidth},set:function(t){isNaN(t)&&(t=1/0),this.playerConfig.abr.restrictions.maxBandwidth=t,this.configure(),this.constrainAbr()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minBitrate",{get:function(){return this.playerConfig.abr.restrictions.minBandwidth},set:function(t){isNaN(t)&&(t=-1/0),this.playerConfig.abr.restrictions.minBandwidth=t,this.configure(),this.constrainAbr()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"audioTrack",{set:function(i){i?(this.audioSwitching=!0,this.player.selectAudioLanguage(i.lang,i.type)):this.logger.log(t.LogLevel.INFO,"ShakaAdapter: Audio track is null, will not set.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"droppedVideoFrames",{get:function(){return this.player.getStats().droppedFrames},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"framerate",{get:function(){var t=this.variant;return t?t.frameRate:Number.NaN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackMode",{set:function(i){this.currentTextTrackMode=i,this.renderTextTrackNatively?(this.player.setTextTrackVisibility(i!=t.TextTrackMode.DISABLED),this.pTextTrack.mode=i):this.onTextTrackVisibility()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrack",{set:function(t){if(!this.currentTextTrack||t.id!=this.currentTextTrack.id){this.currentTextTrack=t,this.emit(hi.TEXT_TRACK_CHANGE,this.currentTextTrack);var i=w.find(this.player.getTextTracks(),(function(i){return i.id.toString()==t.id}));this.player.selectTextTrack(i)}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fragmentType",{get:function(){var t=this.getVariantTrack();return t?t.mimeType:""},enumerable:!1,configurable:!0}),n.prototype.loadMediaUrl=function(){var i=this,n=this.playback.startTime;return this.player.load(this.mediaUrl,isNaN(n)||n<0?0:n).then((function(){i.pIsLiveStream=i.player.isLive(),i.loadedMetadata();var n=i.config.resource.location.textTrackUrl;if(!w.isEmpty(n)){var e=w.getMimeType(n);i.player.addTextTrack(n,"en",t.TextTrackKind.CAPTIONS,e)}})).catch((function(t){throw i.createPlayerError(t)}))},n.prototype.onError=function(t){var i=this.createPlayerError(t.detail),n=i.code,e=i.message,r=i.data,s=i.fatal;this.throwError(n,e,r,s)},n.prototype.onManifestParsed=function(t){this.pSegmentDuration=this.player.getManifest().presentationTimeline.getMaxSegmentDuration(),this.emit(Gn.MANIFEST_PARSED,{profile:this.manifestQualities})},n.prototype.onBitrateChanged=function(t){this.constrainAbr(),this.emit(Gn.ABR_QUALITY_LOADED,{index:this.currentIndex})},n.prototype.onRequest=function(t,i){var n=this.config.resource.location.drm;t===this.shaka.net.NetworkingEngine.RequestType.LICENSE&&n.enabled&&(n.widevine&&n.widevine.header&&w.assign(i.headers,n.widevine.header),n.playready&&n.playready.header&&w.assign(i.headers,n.playready.header))},n.prototype.onResponse=function(t,i){if(this.multiCdnHeaderPresent){var n=i.headers[Sr.MULTI_CDN];this.multiCdnHeaderPresent=null!=n,this.multiCdnHeaderPresent&&this.emit(Gn.MULTI_CDN,{cdn:n})}if(t===this.shaka.net.NetworkingEngine.RequestType.SEGMENT){var e=this.player.getStats().estimatedBandwidth;this.emit(Gn.FRAGMENT_LOADED,{bandwidth:e})}},n.prototype.onEmsg=function(t){var i=t.detail,n={id:i.schemeIdUri,info:i.value,data:i.messageData};this.emit(hi.METADATA_CUEPOINT,n)},n.prototype.onTracksChanged=function(t){this.resize(),this.updateAudioTracks(),this.updateTextTracks()},n.prototype.onAdaptation=function(t){this.variant=this.getVariantTrack()},n.prototype.onVariantChanged=function(t){this.audioSwitching&&(this.audioSwitching=!1,this.emit(Gn.AUDIO_TRACK_CHANGE,{track:this.normalizedAudioTracks[this.getAudioTrackIndex()]})),this.variant=this.getVariantTrack()},n.prototype.onDrmSessionUpdate=function(t){this.emit(Gn.DRM_KEYSYSTEM_CREATED,{keysystem:this.player.keySystem()})},n.prototype.onTextTrackVisibility=function(){this.currentTextTrackMode&&this.emit(hi.TEXT_TRACK_DISPLAY_MODE_CHANGE,{mode:this.currentTextTrackMode})},n.prototype.onCueChange=function(t){if(!this.renderTextTrackNatively&&this.config.textTrackSettings.enabled){var i=t.target;this.emit(hi.TEXT_CUEPOINT,{activeCues:i.activeCues})}},n.prototype.onTimelineRegionEnter=function(t){if(!this.videoSurface.video.seeking){var i=t.detail,n={id:i.schemeIdUri,info:i.value||i.eventElement.getAttribute("messageData"),data:i};this.emit(hi.METADATA_CUEPOINT,n)}},n.prototype.isActive=function(t){return t.active},n.prototype.getAudioTrackIndex=function(){var t=this.getVariantTracks()[this.currentIndex],i=t.language,n=t.audioRoles.join(",");return w.findIndex(this.audioTracks,(function(t){return t.language==i&&t.role==n}))},n.prototype.configure=function(){this.player.configure(this.playerConfig)},n.prototype.constrainAbr=function(){var t=w.getIndexForBitrate(this.manifestQualities,this.maxBitrate,!1);this.checkAbrConstraints(t)},n.prototype.getVariantTracks=function(){return this.player.getVariantTracks().sort((function(t,i){return t.bandwidth-i.bandwidth}))},n.prototype.getVariantTrack=function(){return w.find(this.player.getVariantTracks(),this.isActive)},n.prototype.updateAudioTracks=function(){this.audioTracks=this.player.getAudioLanguagesAndRoles(),this.normalizedAudioTracks=this.normalizeAudioTracks(this.audioTracks,{type:"role",lang:"language",label:"language"});var t=function(t){return"und"===t.lang},i=this.normalizedAudioTracks.filter((function(i){return!t(i)})),n=this.normalizedAudioTracks[this.getAudioTrackIndex()];if(t(n)){var e=this.normalizedAudioTracks.length>n.index+1?n.index+1:n.index;n=this.normalizedAudioTracks[e],this.audioTrack=n}this.emit(Gn.AUDIO_TRACK_UPDATED,{tracks:i,track:n})},n.prototype.updateTextTracks=function(){var i=this;if(this.player.getTextTracks().forEach((function(n){if(!i.textTracks.some((function(t){return t.id==n.id.toString()}))){var e=null!=n.id?n.id.toString():w.uid8(),r="caption"===n.kind?t.TextTrackKind.CAPTIONS:"subtitle"===n.kind?t.TextTrackKind.SUBTITLES:n.kind,s=Object.freeze({id:e,language:n.language,kind:r,label:n.label});i.textTracks.push(s),i.emit(hi.TEXT_TRACK_ADDED,s)}})),!this.currentTextTrack){this.pTextTrack=w.find(this.videoSurface.video.textTracks,(function(t){return"Shaka Player TextTrack"==t.label})),this.pTextTrack.addEventListener(t.TextTrackEvent.CUE_CHANGE,this.onCueChangeHandler);var n=w.findDefaultTrack(this.textTracks,this.config.textTrackSettings.language);n&&(this.currentTextTrack=n,this.emit(hi.TEXT_TRACK_AVAILABLE),this.emit(hi.TEXT_TRACK_CHANGE,this.currentTextTrack))}this.renderTextTrackNatively&&this.player.setTextTrackVisibility(this.config.textTrackSettings.enabled)},n.prototype.createPlayerError=function(i){var n=this.shaka.util.Error,e=n.Category,r=n.Code,s=function(t,n,e,s){for(var u in void 0===s&&(s=!0),r){var o=r[u];if(o==i.code){n+=" : ".concat(u," / ").concat(o);break}}return{code:t,message:n,data:e,fatal:s}};switch(i.category){case e.NETWORK:return s(t.ErrorCode.SHAKA_NETWORK_ERROR,Mi.messages.FATAL_PLAYBACK_NETWORK_ERROR,i);case e.MANIFEST:return s(t.ErrorCode.SHAKA_PARSE_ERROR,Mi.messages.FATAL_PLAYBACK_MEDIA_ERROR,i);case e.MEDIA:return s(i.code==r.VIDEO_ERROR&&i.data[0]==MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED?t.ErrorCode.SHAKA_SRC_NOT_SUPPORTED:t.ErrorCode.SHAKA_MEDIA_ERROR,Mi.messages.FATAL_PLAYBACK_MEDIA_ERROR,i);case e.DRM:return s(t.ErrorCode.SHAKA_DRM_ERROR,Mi.messages.FATAL_PLAYBACK_MEDIA_ERROR,i);default:return s(t.ErrorCode.UNSPECIFIED_SHAKA_ERROR,Mi.messages.UNSPECIFIED_ERROR,i,!1)}},n}(_r),Kr=function(){function i(){}return i.getAdapterOverride=function(t){var i;return null===(i=t.resource.overrides)||void 0===i?void 0:i.adapter},i.getAdapterType=function(n){var e;if(null===(e=n.resource.playback.adapter)||void 0===e?void 0:e.id)return null;var r=[{adapter:t.PlaybackAdapterType.TWITCH_LOW_LATENCY,condition:i.isTwitchLowLatencyAdapter},{adapter:t.PlaybackAdapterType.PLAY_STATION,condition:i.isPlayStationAdapter},{adapter:t.PlaybackAdapterType.HTML5,condition:i.isHTML5Adapter},{adapter:t.PlaybackAdapterType.SHAKA,condition:i.isDashAdapter},{adapter:t.PlaybackAdapterType.HLSJS,condition:i.isHlsAdapter}],s=i.getAdapterOverride(n);if(!w.isEmpty(s)){var u=w.find(r,(function(t){return t.adapter===s}));if(!u||u.condition(n))return s}var o=w.find(r,(function(t){return t.condition(n)}));return(null==o?void 0:o.adapter)||t.PlaybackAdapterType.UNKNOWN},i.getUrl=function(i,n){var e,r=n.playerOptions.overrides,s=function(t,i,n){return void 0===n&&(n={}),w.template(t,a({VERSION:i},n))};if(null===(e=null==r?void 0:r.dependencies)||void 0===e?void 0:e[i])return r.dependencies[i];switch(i){case t.PlaybackAdapterType.HLSJS:return s(Er.HLSJS_GZIP_CDN,jr.HLSJS);case t.PlaybackAdapterType.SHAKA:var u=!0===(null==r?void 0:r.enableLowLevelStreamingLogs)?".debug":"";return s(Er.SHAKA_GZIP_CDN,jr.SHAKA,{DEBUG:u});case t.PlaybackAdapterType.TWITCH_LOW_LATENCY:return s(Er.TWITCH_GZIP_CDN,jr.TWITCH);default:return null}},i.loadLib=function(t,n,e){try{if(null!=e())return Promise.resolve()}catch(t){}return ni.loadScript({url:i.checkSslForUrl(n.system,t),timeout:i.getScriptLoaderTimeout(n),errorRecovery:i.getErrorRecoveryFromConfig(n)})},i.getAdapter=function(n){var e=n.logger,r=i.getAdapterType(n),s=function(t,i){return void 0===i&&(i=Mi.messages.ADAPTER_LIB_UNAVAILABLE),{target:r,code:t,message:i,fatal:!0}},u=i.getUrl(r,n);switch(r){case t.PlaybackAdapterType.HLSJS:return i.loadLib(u,n,(function(){return window.Hls})).then((function(){return e.log(t.LogLevel.INFO,"Loading ".concat(t.PlaybackAdapterType.HLSJS," external library version: ").concat(jr.HLSJS)),new Dr(n)})).catch((function(i){throw s(t.ErrorCode.HLS_SDK_MISSING)}));case t.PlaybackAdapterType.SHAKA:return i.loadLib(u,n,(function(){return window.shaka.Player})).then((function(){return e.log(t.LogLevel.INFO,"Loading ".concat(t.PlaybackAdapterType.SHAKA," external library version: ").concat(jr.SHAKA)),new Fr(n)})).catch((function(i){throw s(t.ErrorCode.SHAKA_SDK_MISSING)}));case t.PlaybackAdapterType.TWITCH_LOW_LATENCY:return i.loadLib(u,n,(function(){return window.IVSPlayer})).then((function(){return e.log(t.LogLevel.INFO,"Loading ".concat(t.PlaybackAdapterType.TWITCH_LOW_LATENCY," external library version: ").concat(jr.TWITCH)),ee.createTwitch(n)})).catch((function(i){throw s(t.ErrorCode.TWITCH_SDK_MISSING)}));case t.PlaybackAdapterType.HTML5:return Promise.resolve(new Lr(n));case t.PlaybackAdapterType.PLAY_STATION:return Promise.resolve(new Ur(n))}return null},i.getMimeType=function(t){var i;return((null===(i=t.overrides)||void 0===i?void 0:i.mimeType)||"").split(";").shift()||w.getMimeType(t.location.mediaUrl)},i.isPlayStationAdapter=function(t){return t.system.isWebMaf},i.isHTML5Adapter=function(n){var e,r,s=!w.isEmpty(null===(r=null===(e=n.resource.location.drm)||void 0===e?void 0:e.fairplay)||void 0===r?void 0:r.appCertUrl),u=n.system.info.browser===t.Browser.SAFARI,o=n.system.os===t.Os.IOS,a=n.system.os==t.Os.ANDROID,c=n.system.osVersionInfo,h=i.getMimeType(n.resource),l=h==t.MimeType.HLS||h==t.MimeType.HLS_ALT,f=i.getAdapterOverride(n);if(!n.capabilities.hasMediaSource||f==t.PlaybackAdapterType.HTML5)return n.video&&""!=n.video.canPlayType(h);if(!l&&h==t.MimeType.MP4_VIDEO)return!0;if(l&&s&&u)return!0;if(l&&o){if(s&&u)return!0;if(!s)return!0}return!!(l&&!s&&a&&c.majorVersion<5)},i.isDashAdapter=function(n){return n.capabilities.hasMediaSource&&i.getMimeType(n.resource)==t.MimeType.DASH},i.isTwitchLowLatencyAdapter=function(n){return i.getAdapterOverride(n)===t.PlaybackAdapterType.TWITCH_LOW_LATENCY},i.isHlsAdapter=function(n){var e=n.system.info.browser===t.Browser.SAFARI,r=n.system.os===t.Os.IOS,s=i.getMimeType(n.resource),u=s==t.MimeType.HLS||s==t.MimeType.HLS_ALT;return!!n.capabilities.hasMediaSource&&(!(u&&r&&!e)&&u)},i.checkSslForUrl=function(t,i){return t.isWebOs?w.makeUrl(!0,i):i},i.getScriptLoaderTimeout=function(t){var i=t.playerOptions,n=i.overrides,e=i.networkTimeout;return n.streamingLibLoaderTimeout||e||N.TIMEOUT},i.getErrorRecoveryFromConfig=function(t){var i=null,n=t.playerOptions.networkErrorRecovery;return w.isEmpty(n)||(i={retryAttempts:n.retryAttempts,retryIntervals:n.retryIntervals}),i},i}(),Qr=function(i){function n(t,n){var e=i.call(this,t,n)||this;return e.started=!1,e.preloadContent=!0,e.minDvrDuration=1800,e.adapterTask=Promise.resolve(),e.seeking=!1,e.onLoadError=function(t){var i=t.name,n=t.error;return e.sendErrorNotification(i,n)},e.previousPlaybackState={state:null,overrides:{}},e.contentIsBuffering=!1,e.adapterEventHandler=function(t){return e.hPlaybackAdaptorEvents(t)},e.videoEventHandler=function(t){return e.hVideoAdapterEvents(t)},e.textTrackEventHandler=function(t){return e.hTextTrackEvents(t)},e.endFreezeTimeoutHandle=null,e.loadComplete=!1,e.offsetTtOnControlVis=!1,e.isMonitoringCueEvents=!1,e.respondToTextTrackInfoChange=w.debounce(e.respondToTextTrackInfoChange.bind(e),10),e}return u(n,i),Object.defineProperty(n.prototype,"adapter",{get:function(){return this.pAdapter},enumerable:!1,configurable:!0}),n.prototype.onRemove=function(){clearTimeout(this.endFreezeTimeoutHandle),this.removeEvents(Gn,this.adapterEventHandler),this.removeEvents(fi,this.videoEventHandler),this.removeEvents(hi,this.textTrackEventHandler),this.pAdapter=null,this.contentPlaybackStateProxy=null,this.resourceProxy=null,this.presoModel=null,this.playerOptions=null,i.prototype.onRemove.call(this)},n.prototype.setVolume=function(t){this.presoModel.volume=t},n.prototype.load=function(){var t=this;return this.loadVideo().then((function(){var i=function(t){return t==Gn.ERROR||t==fi.ERROR};t.addEvents(Gn,t.adapterEventHandler,i),t.addEvents(fi,t.videoEventHandler,i)})).catch((function(t){var i=t.type?t.data:t;throw{name:Qn.VIDEO_START_ERROR,error:i}}))},n.prototype.play=function(){this.playVideo()},n.prototype.pause=function(){this.pauseVideo()},n.prototype.suspend=function(){this.pAdapter.suspend()},n.prototype.resume=function(){this.pAdapter.resume()},n.prototype.loadVideo=function(){var t=this;return this.respondToWaiting("loading",!0),this.pAdapter.load().then((function(){t.respondToWaiting("loading",!1)}))},n.prototype.playVideo=function(){this.pAdapter&&this.pAdapter.play()},n.prototype.pauseVideo=function(){this.pAdapter&&this.pAdapter.pause()},n.prototype.muteVideo=function(t){t||this.presoModel.userHasUnmuted||(this.presoModel.userHasUnmuted=!0),this.presoModel.isMuted=t},n.prototype.seekVideo=function(t){this.pAdapter&&this.pAdapter.seek(t)},n.prototype.checkVideoBuffering=function(t){var i,n=Math.max(Math.floor(this.bufferingSampleRate/Ne.INTERVAL),1);if(!(isFinite(n)&&t%n)){var e=(null===(i=this.pAdapter)||void 0===i?void 0:i.buffering)||!1;this.contentIsBuffering!==e&&(this.contentIsBuffering=e,this.notify(Qn.CONTENT_BUFFERING,{value:e}),this.respondToWaiting("buffering",e))}},Object.defineProperty(n.prototype,"video",{get:function(){return this.viewControl},enumerable:!1,configurable:!0}),n.prototype.notify=function(t,i){this.sendNotification(t,i||null,Hn.INTERNAL)},n.prototype.respondToIsPlayingLiveChange=function(t){this.notify(Qn.CONTENT_IS_LIVE_CHANGED,{value:t})},n.prototype.respondToStreamTypeChange=function(t){var i=this.contentPlaybackStateProxy.model;this.streamType!=t&&(this.streamType=t,i.streamType=t,this.notify(Qn.STREAM_TYPE_CHANGE,{value:t}))},n.prototype.respondToWaiting=function(i,n){this.previousPlaybackState.overrides[i]=n;var e=!this.previousPlaybackState.state||w.includes(w.values(this.previousPlaybackState.overrides),!0);this.respondToPlaybackStateChange(e?t.PlaybackState.WAITING:this.previousPlaybackState.state)},n.prototype.respondToPlaybackStateChange=function(i){var n=this.contentPlaybackStateProxy.model,e=i!==t.PlaybackState.WAITING;if(n.state!=i){if(i!==t.PlaybackState.IDLE&&e&&(this.previousPlaybackState.state=i),this.seeking&&e)return;n.state=i,this.notify(Qn.PLAYBACK_STATE_CHANGE,{value:i})}},n.prototype.respondToTtOffsetRequest=function(i){if(this.facade.retrieveService(Jt.System).browser===t.Browser.FIREFOX)this.monitorTtCues(i);else{var n=this.facade.retrieveProxy(yn.PlayerDomProxy);n&&n.setControlVisibility(i)}},n.prototype.monitorTtCues=function(i){var n=w.find(this.video.textTracks,(function(i){return w.isTextTrack(i.kind)&&i.mode===t.TextTrackMode.SHOWING})),e=null==n?void 0:n.activeCues;if(this.isMonitoringCueEvents=i,e)for(var r=0,s=e.length||0;r<s;r++)this.respondToTtCue(e[r])},n.prototype.respondToTtCue=function(t){t.line=this.isMonitoringCueEvents?14:"auto"},n.prototype.handleNotification=function(t){switch(t.name){case Qn.TIMER_TIC:this.respondToBufferingStatusCheck(t.body.count),this.checkSize();break;case Qn.FULLSCREEN_CHANGE:var i=t.body;this.presoModel.isFullscreen=i.isFullscreen,this.respondToFullscreenChange(i.isFullscreen);break;case Qn.AUTO_QUALITY_SWITCHING:this.notify(Qn.QUALITY_INFO_CHANGE,this.contentPlaybackStateProxy.model.qualityInfo);break;case Qn.TT_OFFSET_REQUEST:this.offsetTtOnControlVis&&this.respondToTtOffsetRequest(t.body.controlsVisible)}},n.prototype.listNotificationInterests=function(){return[Qn.TIMER_TIC,Qn.FULLSCREEN_CHANGE,Qn.TT_OFFSET_REQUEST]},n.prototype.onRegister=function(){i.prototype.onRegister.call(this),this.contentPlaybackStateProxy=this.facade.retrieveProxy(yn.ContentPlaybackStateProxy),this.resourceProxy=this.facade.retrieveProxy(yn.ResourceProxy),this.performanceProxy=this.facade.retrieveProxy(yn.PerformanceProxy),this.presoModel=this.getModel(Kn.PresentationState),this.playerOptions=this.getModel(Kn.PlayerOptions);var t=this.resourceProxy.resource.overrides;w.isNumber(null==t?void 0:t.minDvrDuration)&&(this.minDvrDuration=t.minDvrDuration),this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted&&(this.muteVideo(!0),this.presoModel.isMuted=!0),this.offsetTtOnControlVis=this.playerOptions.offsetTextOnControlsVisible,this.bufferingSampleRate=this.performanceProxy.bufferingSampleRate},n.prototype.prepareForPlayback=function(t){if(void 0===t&&(t=!1),!this.initializing){var i={system:this.systemService,capabilities:this.facade.retrieveService(Jt.MediaCapabilities).capabilities,playerOptions:this.playerOptions,resource:this.resourceProxy.resource,performanceSettings:this.performanceProxy,textTrackSettings:this.facade.retrieveProxy(yn.TextTrackProxy),video:this.viewControl,logger:this.logger};this.adapterTask=this.initializeAdapter(i,t).catch(this.onLoadError)}},n.prototype.sendErrorNotification=function(i,n){this.logger.log(t.LogLevel.ERROR,n),this.notify(i,n)},n.prototype.getAdapter=function(i){return h(this,void 0,void 0,(function(){var n,e,r,s;return l(this,(function(u){switch(u.label){case 0:return[4,Kr.getAdapter(i)];case 1:return(n=u.sent())?[2,n]:(e=this.facade.retrieveProxy(yn.AdapterProxy),r=new Rr,[4,e.createAdapter(t.AdapterRole.PLAYBACK,i.resource,(function(){return r}))]);case 2:return s=u.sent(),[2,new Ir(i,s,r)]}}))}))},n.prototype.initializeAdapter=function(t,i){var n;return h(this,void 0,void 0,(function(){var e,r,s,u,o;return l(this,(function(a){switch(a.label){case 0:if(a.trys.push([0,,9,10]),this.initializing=!0,this.closing)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getAdapter(t)];case 2:return e=a.sent(),this.closing?[2]:(this.pAdapter=e,r=function(t){return t!=Gn.ERROR&&t!=fi.ERROR},this.addEvents(Gn,this.adapterEventHandler,r),this.addEvents(fi,this.videoEventHandler,r),this.addEvents(hi,this.textTrackEventHandler),this.pAdapter.initialize(),!0===(null===(n=t.playerOptions.overrides)||void 0===n?void 0:n.exposePlaybackAdapter)&&(s=this.facade.retrieveMediator(Un.APPLICATION),s.getAppApi().adapter=this.pAdapter.adapter||this.pAdapter),[3,4]);case 3:throw u=a.sent(),{name:Qn.RESOURCE_ERROR,error:u};case 4:return a.trys.push([4,7,,8]),this.preloadContent?[4,this.load()]:[3,6];case 5:a.sent(),a.label=6;case 6:return this.closing?[2]:this.presoModel.isAutoplay||i?(this.play(),[3,8]):[2];case 7:throw o=a.sent(),{name:Qn.VIDEO_PLAYBACK_ERROR,error:o};case 8:return[3,10];case 9:return this.initializing=!1,[7];case 10:return[2]}}))}))},n.prototype.hPlaybackAdaptorEvents=function(i){var n=this,e=this.contentPlaybackStateProxy.model;switch(i.type){case Gn.ABR_QUALITY_LOADED:if(this.contentPlaybackStateProxy.isAbrSwitchingAvailable){var r=this.contentPlaybackStateProxy.qualityInfo,s=this.contentPlaybackStateProxy.manifestQualities[i.data.index].bitrate,u=w.getIndexForBitrate(r.qualities,s,!1),o=r.qualities[u];r.quality&&r.quality.bitrate===o.bitrate||(this.contentPlaybackStateProxy.quality=o,e.bitrate=o.bitrate,this.respondToQualityChange(o))}break;case Gn.ABR_CONSTRAINTS_CHANGE:this.contentPlaybackStateProxy.isAbrSwitchingAvailable?e.qualityInfo&&(this.contentPlaybackStateProxy.updateQualityProfile(i.data.minIndex,i.data.maxIndex,i.data.manifestQualities),this.log(t.LogLevel.INFO,"Quality Info: ",e.qualityInfo),this.notify(Qn.QUALITY_INFO_CHANGE,e.qualityInfo)):(this.logger.log(t.LogLevel.INFO,Mi.messages.ABR_UNAVAILABLE),this.contentPlaybackStateProxy.qualitySwitchingMode=t.QualityMode.UNAVAILABLE);break;case Gn.AUDIO_TRACK_UPDATED:this.contentPlaybackStateProxy.updateAudioTracks(i.data.track,i.data.tracks),this.notify(Qn.AUDIO_TRACK_INFO_CHANGE,i.data);break;case Gn.AUDIO_TRACK_CHANGE:this.contentPlaybackStateProxy.updateAudioTracks(i.data.track),this.notify(Qn.AUDIO_TRACK_CHANGE,i.data.track);break;case Gn.FRAGMENT_LOADED:this.contentPlaybackStateProxy.maxBandwidth=i.data.bandwidth;break;case Gn.FRAGMENT_PARSED:e.framerate=i.data.rate;break;case Gn.MANIFEST_PARSED:this.contentPlaybackStateProxy.processQualityProfile(i.data.profile),this.contentPlaybackStateProxy.manifestQualities=i.data.profile;break;case Gn.LOADED_METADATA:this.notify(Qn.STREAM_METADATA,i.data);try{var a=this.facade.retrieveProxy(yn.Playlist).currentResource.location.thumbnailTrackUrl;!this.contentPlaybackStateProxy.thumbnailTrack&&a&&ii.create(a).then((function(t){n.contentPlaybackStateProxy.thumbnailTrack=t,n.notify(Qn.THUMBNAIL_TRACK_AVAILABLE,t)})).catch((function(i){return n.log(t.LogLevel.WARN,"Could not load thumbnail track")}))}catch(i){this.log(t.LogLevel.WARN,"Could not load thumbnail track")}break;case Gn.ERROR:this.respondToError(i.data);break;case Gn.MULTI_CDN:var c=i.data.cdn;c!==e.cdn&&(e.cdn=c,this.notify(Qn.CDN_CHANGE,i.data));break;case Gn.DRM_KEYSYSTEM_CREATED:e.drmType=i.data.keysystem,this.notify(Qn.DRM_KEYSYSTEM_CREATED,i.data)}},n.prototype.hVideoAdapterEvents=function(t){var i=this.contentPlaybackStateProxy.model;switch(t.type){case fi.PROGRESS:i.bufferLength=this.pAdapter.bufferLength,i.averageDroppedFps=this.pAdapter.droppedVideoFrames,i.framerate=this.pAdapter.framerate,this.respondToVideoProgress();break;case fi.CAN_PLAY_THROUGH:this.loadComplete||(this.loadComplete=!0,this.notify(Qn.VIDEO_LOAD_COMPLETE));break;case fi.LOADED_METADATA:this.updateLiveStreamInfo(),this.notify(Qn.VIDEO_LOADED_METADATA);break;case fi.TIME_UPDATE:clearTimeout(this.endFreezeTimeoutHandle);var n=this.pAdapter.time,e=this.presoModel.streamDuration;this.pAdapter.isLiveStream?this.updateLiveStreamInfo():!isNaN(e)&&e-n<=.15&&this.protectAgainstEndFreeze(250),this.respondToVideoTimeUpdate(n);break;case fi.PLAYING:this.updateLiveStreamInfo(),this.respondToVideoPlaying();break;case fi.PAUSE:this.respondToVideoPaused();break;case fi.SEEKING:this.seeking=!0,this.respondToVideoSeeking(),this.respondToWaiting("seeking",!0);break;case fi.SEEKED:this.seeking=!1,this.respondToVideoSeeked(),this.respondToWaiting("seeking",!1);break;case fi.ENDED:clearTimeout(this.endFreezeTimeoutHandle),this.respondToVideoEnd();break;case fi.DURATION_CHANGE:var r=this.pAdapter.duration;r>0&&this.respondToDurationChange(r);break;case fi.VOLUME_CHANGE:var s=t.data.target||t.data;this.notify(Qn.VOLUME_CHANGE,{value:s.volume,muted:s.muted});break;case fi.AUTOPLAY_BLOCKED:this.sendNotification(Qn.AUTOPLAY_BLOCKED,t.data,Hn.INTERNAL)}},n.prototype.hTextTrackEvents=function(i){var n=this.facade.retrieveProxy(yn.TextTrackProxy);switch(i.type){case hi.METADATA_CUEPOINT:this.respondToId3Data(i.data);break;case hi.TEXT_CUEPOINT:this.isMonitoringCueEvents&&this.respondToTtCue(i.data),this.notify(Qn.TEXT_CUEPOINT,i.data);break;case hi.TEXT_TRACK_DISPLAY_MODE_CHANGE:var e=i.data.mode!==t.TextTrackMode.DISABLED;n.mode=i.data.mode,this.notify(Qn.TEXT_TRACK_DISPLAY_MODE_CHANGE,{enabled:e}),this.respondToTextTrackModeChange(e);break;case hi.TEXT_TRACK_ADDED:this.contentPlaybackStateProxy.addTextTrack(i.data),this.respondToTextTrackInfoChange();break;case hi.TEXT_TRACK_CHANGE:var r=i.data;this.contentPlaybackStateProxy.textTrack=r,this.notify(Qn.TEXT_TRACK_CHANGE,this.contentPlaybackStateProxy.textTrack),this.respondToTextTrackInfoChange();break;case hi.TEXT_TRACK_AVAILABLE:this.notify(Qn.TEXT_TRACK_AVAILABLE)}},n.prototype.respondToTextTrackInfoChange=function(){this.notify(Qn.TEXT_TRACK_INFO_CHANGE,this.contentPlaybackStateProxy.textTrackInfo)},n.prototype.protectAgainstEndFreeze=function(t){var i=this;clearTimeout(this.endFreezeTimeoutHandle),this.endFreezeTimeoutHandle=setTimeout((function(){i.respondToVideoEnd()}),t)},n.prototype.addEvents=function(t,i,n){var e=this;void 0===n&&(n=function(t){return!0}),this.pAdapter&&w.values(t).filter(n).forEach((function(t){return e.pAdapter.on(t,i)}))},n.prototype.removeEvents=function(t,i){var n=this;this.pAdapter&&w.values(t).forEach((function(t){return n.pAdapter.off(t,i)}))},n.prototype.calculateStreamType=function(){if(this.pAdapter.isLiveStream){var i=this.pAdapter.liveStreamInfo.dvrWindowSize;return i<this.minDvrDuration||isNaN(i)?t.StreamType.LIVE:t.StreamType.DVR}return t.StreamType.VOD},n.prototype.updateLiveStreamInfo=function(){if(this.pAdapter.isLiveStream){var i=this.contentPlaybackStateProxy.model,n=this.pAdapter.liveStreamInfo;i.liveStreamInfo=n;var e=this.calculateStreamType();this.respondToStreamTypeChange(e);var r=e==t.StreamType.LIVE||n.isPlayingLive;this.isPlayingLive!=r&&(this.isPlayingLive=r,this.respondToIsPlayingLiveChange(r)),i.streamType==t.StreamType.DVR&&this.respondToDurationChange(n.relativeDuration)}else this.respondToStreamTypeChange(t.StreamType.VOD)},n}(Yn),Hr=function(i){function n(){var t=null!==i&&i.apply(this,arguments)||this;return t.uim=null,t.contentDurationReleased=!1,t.resumeTimeMaxProximityToAdBreak=5,t.isClickToPlay=!1,t.fullscreenRestrictedDuringAdPlay=!1,t.hasContent=!0,t.contentComplete=!1,t.timeSpent={startTime:null,lastTime:0,sessionTime:0,playbackTime:0,elapsedTime:0},t}return u(n,i),n.prototype.onRemove=function(){this.uim=null,i.prototype.onRemove.call(this)},n.prototype.start=function(){var t=this.resourceProxy.location.mediaUrl;this.hasContent=w.isString(t)&&!w.isEmpty(t)},n.prototype.close=function(){var i,n=this;if(this.closing)return this.closing;var e=null===(i=this.contentPlaybackStateProxy)||void 0===i?void 0:i.model,r=(null==e?void 0:e.time)||0,s=(null==e?void 0:e.duration)||0,u=this.isAdPlaying();return this.respondToPlaybackStateChange(t.PlaybackState.STOPPED),this.contentPlaybackStateProxy.isReady=!1,this.closing=this.adapterTask.then((function(){n.pause(),n.log(t.LogLevel.INFO,"Closing Presentation"),n.closeAds()})).then((function(){return n.adapter?n.adapter.destroy():null})).then((function(){u||n.hasContent&&!n.isContentComplete()?n.sendNotification(Qn.RESOURCE_INTERRUPTED,{contentTime:r,contentDuration:s,adInterrupted:u}):n.notify(Qn.RESOURCE_END)})).catch((function(t){throw j.error(t),t})).then((function(){n.closing=null}))},n.prototype.setAdPlaying=function(){this.uiMediator&&(this.uiMediator.hideClickCatcher(!0),this.fullscreenRestrictedDuringAdPlay&&this.uiMediator.disableFullscreen())},n.prototype.getPlayerVersionInfo=function(){return"".concat(ai.playerName,"_").concat(ai.playerVersion)},n.prototype.startContentSegment=function(){this.uiMediator&&!this.contentPlaybackStateProxy.model.liveStreamInfo&&this.uiMediator.setSeekable(!0),this.fullscreenRestrictedDuringAdPlay&&this.uiMediator&&(this.uiMediator.setFullScreenAccessRestricted(!1),this.uiMediator.enableFullscreen())},n.prototype.closeAds=function(){},n.prototype.beforePlayOnUserGesture=function(){},n.prototype.playOnUserGesture=function(){this.uiMediator&&this.uiMediator.displayPoster(!1),this.notify(Qn.VIDEO_LOAD_START),this.prepareForPlayback(!0)},n.prototype.mute=function(t){this.muteVideo(t),this.uiMediator&&this.uiMediator.setMuteState(t)},n.prototype.seek=function(t){this.seekVideo(t)},n.prototype.setVolume=function(t){this.domProxy&&this.domProxy.setVideoVolume(t),i.prototype.setVolume.call(this,t)},n.prototype.getAdBreakTimes=function(){return[]},n.prototype.releaseContentDuration=function(t){this.contentDurationReleased=!0,this.notify(Qn.CONTENT_DURATION_AVAILABLE,{contentDuration:t})},n.prototype.updateTimeSpent=function(){var i=Date.now();null===this.timeSpent.startTime&&(this.timeSpent.startTime=i),null===this.timeSpent.lastTime&&(this.timeSpent.lastTime=i);var n=i-this.timeSpent.startTime;return this.timeSpent.elapsedTime=n,this.timeSpent.sessionTime=n/1e3,this.contentPlaybackStateProxy.model.state!==t.PlaybackState.PAUSED&&(this.timeSpent.playbackTime+=(i-this.timeSpent.lastTime)/1e3,this.timeSpent.lastTime=i),this.timeSpent},n.prototype.adjustStartTimeForAdBreakProximity=function(t,i){for(var n=0,e=i.length;n<e;n++){var r=i[n].startTime-t;if(r>=0&&r<this.resumeTimeMaxProximityToAdBreak)return t-this.resumeTimeMaxProximityToAdBreak}return t},Object.defineProperty(n.prototype,"uiMediator",{get:function(){return this.uim},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"domProxy",{get:function(){return this.facade.retrieveProxy(yn.PlayerDomProxy)},enumerable:!1,configurable:!0}),n.prototype.muteVideo=function(t){i.prototype.muteVideo.call(this,t),this.domProxy&&this.domProxy.muteVideo(t)},n.prototype.respondToPlaybackStateChange=function(t){i.prototype.respondToPlaybackStateChange.call(this,t),this.timeSpent.lastTime=null},n.prototype.respondToFullscreenChange=function(t){this.checkSize(),this.notify(t?Qn.FULLSCREEN_ENTER:Qn.FULLSCREEN_EXIT)},n.prototype.respondToVideoPaused=function(){this.respondToPlaybackStateChange(t.PlaybackState.PAUSED),this.notify(Qn.RESOURCE_PAUSED)},n.prototype.respondToVideoPlaying=function(){this.presoModel.started||(this.presoModel.started=!0,this.uiMediator&&(this.uiMediator.displayPoster(!1),this.uiMediator.hideClickCatcher(!0),this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted&&this.uiMediator.showUnmutePrompt(),this.setTransportType()),this.notify(Qn.ENABLE_UI)),this.respondToPlaybackStateChange(t.PlaybackState.PLAYING),this.notify(Qn.RESOURCE_PLAYING)},n.prototype.respondToVideoSeeking=function(){this.notify(Qn.CONTENT_SEEKING)},n.prototype.respondToVideoSeeked=function(){this.notify(Qn.CONTENT_SEEKED)},n.prototype.respondToVideoProgress=function(){this.notify(Qn.VIDEO_PROGRESS)},n.prototype.respondToQualityChange=function(t){void 0===t&&(t=null),this.notify(Qn.QUALITY_CHANGE,t)},n.prototype.respondToError=function(i){this.uiMediator&&this.uiMediator.displaySpinner(!1),i.message||(i.message=Mi.messages.UNSPECIFIED_ERROR),i.code||(i.code=t.ErrorCode.UNSPECIFIED_VIDEO_PLAYBACK_ERROR),this.sendErrorNotification(Qn.VIDEO_PLAYBACK_ERROR,i)},n.prototype.respondToVideoEnd=function(){this.notify(Qn.DISABLE_UI),this.notify(Qn.RESOURCE_COMPLETE)},n.prototype.respondToBufferingStatusCheck=function(t){var i=this.presoModel.streamTime;!isNaN(i)&&i>0&&this.checkVideoBuffering(t)},n.prototype.respondToId3Data=function(t){this.notify(Qn.METADATA_CUEPOINT,t)},n.prototype.respondToVideoTimeUpdate=function(i){var n=this.contentPlaybackStateProxy.model,e=n.duration,r=n.liveStreamInfo,s=n.streamType,u=n.time;this.updateTimeSpent();var o={contentTime:u,contentDuration:e,streamTime:i,streamDuration:this.presoModel.streamDuration,sessionTime:this.timeSpent.sessionTime,playbackTime:this.timeSpent.playbackTime};if(s!==t.StreamType.VOD){var a=r.relativeTime,c=r.relativeDuration;o.contentTime=a,o.contentDuration=c,o.elapsedTimeMs=this.timeSpent.elapsedTime,n.time=a,n.duration=c}this.notify(Qn.CONTENT_TIME_UPDATE,o)},n.prototype.respondToDurationChange=function(t){},n.prototype.respondToSizeChange=function(){this.adapter&&this.adapter.resize()},n.prototype.respondToTextTrackModeChange=function(t){this.uiMediator&&this.uiMediator.setClosedCaptionState(t)},n.prototype.checkSize=function(){if(this.domProxy){var t=this.domProxy.getPresentationRect();t.width===this.currentRect.width&&t.height===this.currentRect.height||(this.currentRect=t,this.respondToSizeChange(),this.notify(Qn.PRESENTATION_SIZE_CHANGE,{width:this.currentRect.width,height:this.currentRect.height}))}},n.prototype.setTransportType=function(i){void 0===i&&(i=this.contentPlaybackStateProxy.model.streamType);var n=i!=t.StreamType.LIVE;this.uiMediator&&(this.uiMediator.setSeekable(n),this.uiMediator.setTransportType(i),this.uiMediator.setIsPlayingLive(this.isPlayingLive))},n.prototype.setForClickToPlay=function(){var t=this;if(this.uiMediator)this.uiMediator.displayPoster(!0),this.uiMediator.activatePoster();else if(this.getModel(Kn.PlayerOptions).useNativeControls){var i=this.domProxy.getMain(),n=function(){i.removeEventListener("click",n),t.notify(Qn.PLAY_ON_USER_GESTURE)};i.addEventListener("click",n)}},n.prototype.setPausedState=function(){this.uiMediator&&(this.uiMediator.setClickCatcherState(t.PlaybackState.PAUSED),this.uiMediator.hideClickCatcher(!1))},n.prototype.setPlayingState=function(){this.uiMediator&&(this.uiMediator.setClickCatcherState(t.PlaybackState.PLAYING),this.uiMediator.hideClickCatcher(!1))},n.prototype.isContentComplete=function(){if(this.contentComplete)return!0;var i=this.contentPlaybackStateProxy.model;return i.streamType!=t.StreamType.LIVE&&i.streamType!=t.StreamType.DVR&&!(isNaN(i.time)||i.time<i.duration)},n.prototype.isAdPlaying=function(){return this.presoModel.isCurrentVideoAd},n.prototype.handleNotification=function(t){i.prototype.handleNotification.call(this,t)},n.prototype.listNotificationInterests=function(){return i.prototype.listNotificationInterests.call(this).concat([])},n.prototype.onRegister=function(){i.prototype.onRegister.call(this);var n=this.playerOptions.overrides;n.resumeTimeMaxProximityToAdBreak&&(this.resumeTimeMaxProximityToAdBreak=n.resumeTimeMaxProximityToAdBreak),this.isClickToPlay=!this.presoModel.isAutoplay;var e=this.facade.retrieveMediator(Un.UI);e&&(this.uim=e);var r=this.facade.retrieveService(Jt.System);this.fullscreenRestrictedDuringAdPlay=r.isIos||r.isAndroid,this.uim&&(this.uim.disableFullscreen(),this.uim.setFullScreenAccessRestricted(this.fullscreenRestrictedDuringAdPlay)),this.setTransportType(t.StreamType.VOD),this.domProxy&&(this.currentRect=this.domProxy.getPresentationRect())},n}(Qr),qr=function(t){function i(i,n){return t.call(this,i,n)||this}return u(i,t),i.prototype.onRegister=function(){var t=this.facade.retrieveProxy(yn.ModelCollectionProxy);this.breakModel=t.getModel(Kn.AdBreakInfo),this.adItemModel=t.getModel(Kn.AdItem)},i.prototype.onRemove=function(){this.breakModel=null,this.adItemModel=null,t.prototype.onRemove.call(this)},i.prototype.resetAll=function(){this.breakModel.reset(),this.resetAd()},i.prototype.resetAd=function(){this.adItemModel.reset()},Object.defineProperty(i.prototype,"breakInfo",{get:function(){return this.breakModel.data},set:function(t){var i=this.breakModel.model;for(var n in i)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"adInfo",{get:function(){return this.adItemModel.data},set:function(t){var i=this.adItemModel.model;for(var n in i)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])},enumerable:!1,configurable:!0}),i}(re),zr="sz",Wr="640x480",Gr="640x483",Xr="".concat(zr,"=").concat(Wr),Yr="".concat(zr,"=").concat(Gr),$r="imafw__fw_h_referer",Zr="imafw_host";function Jr(){var t=String(Math.round(1e15+9e15*Math.random()));if(t.length<16)for(;t.length<16;)t+="0";return t.length>16&&(t=t.substr(0,17)),t}function ts(){return new URL(window.location.href).host}function is(){return null===document||void 0===document?void 0:document.referrer}var ns,es=function(){function i(t,i,n){this.breaks={pre:null,mid:[],post:null},this.breaksById={},t?this.createBreaksFromTimes(t):i&&this.createBreaksFromCuepoints(i,n)}return i.prototype.destroy=function(){this.breaks=null,this.breaksById=null,this.breaks=null},Object.defineProperty(i.prototype,"adBreaks",{get:function(){return this.breaks},enumerable:!1,configurable:!0}),i.prototype.hasMidRolls=function(){return!!this.breaks.mid.length},i.prototype.hasPostRoll=function(){return!!this.breaks.post},i.prototype.getBreakById=function(t){return this.breaksById[t]||null},i.prototype.updateBreaks=function(t){for(var i,n=[],e=t.length;e--;)t[e].played&&n.push(t[e].start);for(var r in this.breaksById)!(i=this.breaksById[r]).hasPlayed&&n.indexOf(i.streamStartTime)>=0&&(i.hasPlayed=!0)},i.prototype.isBreakPending=function(t,i){return!!this.processMid((function(n){return n.startTime>t&&n.startTime-t<=i?!n.hasPlayed||-1:null}))},i.prototype.getBreakForContentSeekTime=function(t){return this.processMid((function(i){return i.startTime<=t?i.hasPlayed?-1:i:null}))},i.prototype.hasPlayed=function(t){return this.breaksById[t]&&!0===this.breaksById[t].hasPlayed},i.prototype.markPlayed=function(t){this.breaksById[t]&&(this.breaksById[t].hasPlayed=!0)},i.prototype.processMid=function(t){if(!this.hasMidRolls())return null;for(var i,n=this.breaks.mid,e=n.length;e--;){if(-1==(i=t(n[e])))return null;if(i)return i}return null},i.prototype.createBreaksFromCuepoints=function(i,n){var e,r,s,u,o,a,c=1;i.sort((function(t,i){return t.start-i.start}));for(var h=0,l=0,f=i.length;l<f;l++)e=i[l].start,u=(r=i[l].end)-e,o=e,e-h>=n&&(e=-1),h+=u,s=this.makeBrkId(e,e>0?c++:null),(a=this.makeBreak(e,s,o,t.AdTechnology.SSAI)).endTime=r,a.duration=u,this.addBreak(e,a,s)},i.prototype.createBreaksFromTimes=function(i){var n,e,r=1;i.sort((function(t,i){return t-i}));for(var s=0,u=i.length;s<u;s++)n=i[s],e=this.makeBrkId(n,n>0?r++:null),this.addBreak(n,this.makeBreak(n,e,null,t.AdTechnology.CSAI),e)},i.prototype.addBreak=function(t,i,n){var e=n.split("_")[0];t<=0?this.breaks[e]=i:this.breaks.mid.push(i),this.breaksById[n]=i},i.prototype.makeBreak=function(i,n,e,r){return void 0===e&&(e=null),{adTechnology:r,startTime:i,hasPlayed:!1,streamStartTime:null!==e?e:null,breakId:n,type:0===i?t.AdBreakType.PRE:-1===i?t.AdBreakType.POST:t.AdBreakType.MID}},i.prototype.makeBrkId=function(t,i){return(0===t?"pre":-1===t?"post":"mid")+(t>0?"_".concat(i):"_0")},i}(),rs=function(i){function n(t,n){var e=i.call(this,null)||this;return e.streamInfo={},e.adBreakSchedule=null,e.pStreamDuration=NaN,e.pContentDuration=NaN,e.breakMetadataPending=!1,e.cuesReleased=!1,e.adBreakInProgress=!1,e.breakCount=0,e.unlockedBreaks=[],e.rawScheduleReleased=!1,e.isIgnoringEvents=!1,e.omEnabled=!0,e.cuePoints=[],e.adService=t,e.sdk=e.adService.sdk,e.mgr=e.adService.getStreamManager(),e.omEnabled=n,e.streamEventHandler=function(t){e.hStreamEvent(t)},e.initialize(),e}return u(n,i),n.prototype.destroy=function(){this.listenToStreamManager(!1),this.cuePoints=null,this.adService=null,this.sdk=null,this.adBreakSchedule=null,this.mgr=null},n.prototype.getCuePoints=function(){return this.cuePoints||[]},n.prototype.getCuePointsInContentTime=function(){var t=this.cuePoints,i=[];if(!t)return i;for(var n=0,e=t.length;n<e;n++){var r=t[n],s=r.end-r.start,u=this.contentTimeForStreamTime(r.start);i.push({streamTimeStart:r.start,streamTimeEnd:r.start+s,start:u,duration:s,played:r.played})}return i},n.prototype.ignoreAdEvents=function(t){this.isIgnoringEvents=t},n.prototype.setUnlockedBreaks=function(t){this.unlockedBreaks=t},n.prototype.getUnlockedBreaks=function(){return this.unlockedBreaks},n.prototype.addUnlockedBreak=function(t){this.unlockedBreaks.push(t)},n.prototype.hasPostRoll=function(){var t;return!!(null===(t=this.adBreakSchedule)||void 0===t?void 0:t.hasPostRoll())},n.prototype.checkForAdPeriod=function(t,i){for(var e,r,s,u,o=this.cuePoints.length,a=0;a<o;a++)if(s=(r=t-(e=this.cuePoints[a]).start)>-.3&&r<2,u=e.end-t>=3,this.isUnlockedBreak(e)&&s&&u)return this.emit(n.event.AD_PERIOD_STARTED,{streamResumeTime:e.end}),!0;return!1},n.prototype.isUnlockedBreak=function(t){for(var i=this.unlockedBreaks.length;i--;)if(Math.floor(this.unlockedBreaks[i])===Math.floor(t.start))return!0;return!1},n.prototype.getPermittedSeekTime=function(t){if(this.adBreakSchedule&&this.adBreakSchedule.hasMidRolls()){var i=this.mgr.streamTimeForContentTime(t),n=this.adBreakSchedule.getBreakForContentSeekTime(i);if(n){for(var e=this.unlockedBreaks.length;e--;)if(Math.floor(this.unlockedBreaks[e])===Math.floor(n.streamStartTime))return n.hasPlayed=!0,t;return n.startTime}}return t},Object.defineProperty(n.prototype,"streamDuration",{get:function(){return this.pStreamDuration||NaN},set:function(t){this.pStreamDuration=t,this.pContentDuration=this.mgr.contentTimeForStreamTime(t),this.pendingCues&&!this.cuesReleased&&(this.updateBreakSchedule(this.pendingCues),this.releaseCues(this.pendingCues),this.pendingCues=null)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contentDuration",{get:function(){return this.pContentDuration||NaN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"streamId",{get:function(){return this.streamInfo.streamId},enumerable:!1,configurable:!0}),n.prototype.onTimedMetadata=function(t){var i={TXXX:t.TXXX||t.msg};this.mgr.onTimedMetadata(i)},n.prototype.contentTimeForStreamTime=function(t){return this.mgr.contentTimeForStreamTime(t)},n.prototype.streamTimeForContentTime=function(t){return this.mgr.streamTimeForContentTime(t)},n.prototype.requestVODStream=function(t,i){void 0===i&&(i=null);var n=new this.sdk.VODStreamRequest(t);this.enableOmFullAccess(n),this.isLiveStream=!1,this.mgr.requestStream(n,i)},n.prototype.requestLiveStream=function(t,i){void 0===i&&(i=null);var n=new this.sdk.LiveStreamRequest(t);this.enableOmFullAccess(n),this.isLiveStream=!0,this.mgr.requestStream(n,i)},n.prototype.enableOmFullAccess=function(t){var i;!this.adService.usesDaiApi&&this.omEnabled&&(t.omidAccessModeRules={},t.omidAccessModeRules[null===(i=this.sdk.OmidAccessMode)||void 0===i?void 0:i.FULL]=[new RegExp(".*")])},n.prototype.hStreamEvent=function(t){if(this.sdk&&this.adService&&!this.isIgnoringEvents){var i=t.type,e=this.sdk.StreamEvent.Type,r=n.event;switch(i){case e.LOADED:this.handleStreamLoaded(t);break;case e.STREAM_INITIALIZED:var s=t.getStreamData();this.streamInfo.streamId=s.streamId,this.emit(r.STREAM_ID_AVAILABLE,{streamId:s.streamId});break;case e.AD_PERIOD_STARTED:break;case e.CUEPOINTS_CHANGED:var u=t.getStreamData().cuepoints;this.rawScheduleReleased||(this.emit(r.RAW_AD_SCHEDULE_AVAILABLE,{schedule:this.getRawSchedule(u)}),this.rawScheduleReleased=!0),this.updateBreakSchedule(u),isNaN(this.contentDuration)||this.cuesReleased?this.pendingCues=u:this.releaseCues(u);break;case e.AD_BREAK_STARTED:this.adBreakInProgress=!0,this.breakMetadataPending=!0,this.emit(r.AD_BREAK_START);break;case e.STARTED:var o=t.getAd();this.handleAdStart(o,e.STARTED);break;case e.AD_PROGRESS:if(this.adBreakInProgress){var a=t.getStreamData().adProgressData;this.emit(r.AD_PROGRESS,a)}break;case e.FIRST_QUARTILE:this.adBreakInProgress&&(this.trackQuartile(e.FIRST_QUARTILE),this.emit(r.AD_FIRST_QUARTILE));break;case e.MIDPOINT:this.adBreakInProgress&&(this.trackQuartile(e.MIDPOINT),this.emit(r.AD_MIDPOINT));break;case e.THIRD_QUARTILE:this.adBreakInProgress&&(this.trackQuartile(e.THIRD_QUARTILE),this.emit(r.AD_THIRD_QUARTILE));break;case e.COMPLETE:this.adBreakInProgress&&this.handleAdComplete(e.COMPLETE);break;case e.AD_BREAK_ENDED:case e.AD_PERIOD_ENDED:this.adBreakInProgress&&this.emit(r.AD_BREAK_COMPLETE),this.updateUnlockedBreaks(),this.adBreakInProgress=!1;break;case e.CLICK:this.adBreakInProgress&&this.emit(r.AD_CLICK);break;case e.ERROR:this.adBreakInProgress=!1,this.emitError(t.getStreamData().errorMessage,t.data?t.data.code:null)}}},n.prototype.handleAdComplete=function(t){this.adService.usesDaiApi||(this.adService.trackAdEvent({context:this.adService.getAdContext(),eventName:t,volume:this.adService.videoInterface.volume}),this.adService.untrackAd()),this.emit(n.event.AD_COMPLETE)},n.prototype.trackQuartile=function(t){!this.adService.usesDaiApi&&this.adService.trackAdEvent({context:this.adService.getAdContext(),eventName:t,volume:this.adService.videoInterface.volume})},n.prototype.handleAdStart=function(i,e){var r=this.adService.assembleAdBreakInfo(i,t.AdTechnology.SSAI),s=this.adService.assembleAdInfo(i,{mediaUrl:this.mediaUrl}),u=n.event;!this.breakMetadataPending&&this.adBreakInProgress||(this.breakMetadataPending=!1,this.adBreakInProgress=!0,this.isLiveStream&&(r.adBreakPosition=++this.breakCount,r.adBreakType=t.AdBreakType.MID),this.emit(u.AD_BREAK_METADATA,r)),this.adService&&(this.adService.usesDaiApi||(this.adService.trackAd(s),this.adService.trackAdEvent({context:this.adService.getAdContext(),eventName:e,volume:this.adService.videoInterface.volume})),this.emit(u.AD_START,s))},n.prototype.handleStreamLoaded=function(t){var i=t.getStreamData(),e=i.url;w.isString(e)&&""!=e?(this.mediaUrl=e,this.streamInfo.streamId=i.streamId,this.emit(n.event.STREAM_ID_AVAILABLE,{streamId:i.streamId}),this.emit(n.event.MEDIA_URL_AVAILABLE,{mediaUrl:e})):this.emitError(Mi.messages.DAI_MISSING_ASSET_URL)},n.prototype.updateUnlockedBreaks=function(){var t,i=null===(t=this.adBreakSchedule)||void 0===t?void 0:t.adBreaks;if(i)for(var n in i)"pre"===n?this.updateUnlockedScheduleItems([i[n]]):this.updateUnlockedScheduleItems(i[n])},n.prototype.updateUnlockedScheduleItems=function(t){for(var i=t?t.length:0;i--;){var n=t[i];n&&n.hasPlayed&&-1===this.unlockedBreaks.indexOf(n.startTime)&&this.addUnlockedBreak(n.startTime)}},n.prototype.getRawSchedule=function(i){for(var n=[],e=0,r=i.length;e<r;e++){var s=i[e];n[e]={adTechnology:t.AdTechnology.SSAI,start:this.mgr.contentTimeForStreamTime(s.start),streamTimeStart:s.start,end:this.mgr.contentTimeForStreamTime(s.end),streamTimeEnd:s.end,played:!1}}return n},n.prototype.releaseCues=function(t){for(var i=[],e=t||this.cuePoints,r=e.length;r--;)i.unshift(this.contentTimeForStreamTime(e[r].start));this.cuesReleased=!0,this.emit(n.event.AD_CUEPOINTS_AVAILABLE,{cuepoints:i})},n.prototype.emitError=function(i,e){this.emit(n.event.AD_ERROR,{message:i,code:e||t.ErrorCode.DAI_DATA_ERROR,streamId:this.streamInfo.streamId||null})},n.prototype.listenToStreamManager=function(t){var i,n=t?"addEventListener":"removeEventListener",e=this.getEventInterests();if(this.sdk)for(var r=0,s=e.length;r<s;r++)i=this.sdk.StreamEvent.Type[e[r]],this.mgr[n](i,this.streamEventHandler)},n.prototype.getEventInterests=function(){return["LOADED","STREAM_INITIALIZED","CUEPOINTS_CHANGED","AD_BREAK_STARTED","AD_BREAK_ENDED","STARTED","COMPLETE","AD_PERIOD_STARTED","AD_PERIOD_ENDED","AD_PROGRESS","FIRST_QUARTILE","MIDPOINT","THIRD_QUARTILE","CLICK","ERROR"]},n.prototype.updateBreakSchedule=function(i){var n=i&&i.length;if(this.cuePoints=[],n&&this.contentDuration){for(var e=void 0,r=0,s=i.length;r<s;r++)e=i[r],this.cuePoints.push({adTechnology:t.AdTechnology.SSAI,start:e.start,played:e.played,end:e.end});!this.adBreakSchedule&&(this.adBreakSchedule=new es(null,i,this.contentDuration))}n&&this.adBreakSchedule&&this.adBreakSchedule.updateBreaks(i)},n.prototype.initialize=function(){this.listenToStreamManager(!0)},n.event={MEDIA_URL_AVAILABLE:"mediaUrlAvailable",STREAM_ID_AVAILABLE:"streamIdAvailable",AD_PERIOD_STARTED:"adPeriodStarted",AD_CUEPOINTS_AVAILABLE:"adCuepointsAvailable",AD_BREAK_START:"adBreakStarted",AD_BREAK_METADATA:"adBreakMetadata",AD_BREAK_COMPLETE:"adBreakEnded",AD_ERROR:"adError",AD_START:"adStarted",AD_COMPLETE:"adComplete",AD_PROGRESS:"adProgress",AD_CLICK:"adClick",AD_FIRST_QUARTILE:"firstQuartile",AD_MIDPOINT:"midpoint",AD_THIRD_QUARTILE:"thirdQuartile",RAW_AD_SCHEDULE_AVAILABLE:"rawAdScheduleAvailable"},n}(T),ss={cmsid:2289,output:"xml_vmap1",unviewed_position_start:1,correlator:"1",gdfp_req:1,env:"vp"},us=function(){function t(){}return t.prototype.assembleStdParams=function(i,n){var e,r=ss,s=i.ad.adTagParameters,u=i.ad.viewabilityTracking,o={};for(e in r)o[e]=s[e]||r[e];for(e in s)"cust_params"===e||w.isEmpty(s[e])||(o[e]=s[e]);for(e in u)o[e]=u[e];if(o.sz===t.SZ_DEFAULT){var a=this.getSzStringForPlayback(n.mutedPlayback);a&&(o.sz=a)}return o},t.prototype.getSzStringForPlayback=function(i){return i?t.SZ_MUTED:null},t.prototype.substituteStringForMutedPlayback=function(i){var n=this.getSzStringForPlayback(!0);if(n){var e=new RegExp("sz=".concat(t.SZ_DEFAULT),"g");return i.replace(e,"sz=".concat(n))}return i},t.prototype.queryStrFromObj=function(t,i){return $t.encode(t)},t.prototype.objFromQueryStr=function(t){return $t.decode(t)},t.SZ_DEFAULT="640x480",t.SZ_MUTED="640x483",t}(),os=function(t){function i(){return t.call(this)||this}return u(i,t),i.prototype.assembleStreamRequest=function(t,n,e,r){void 0===e&&(e=!1);var s=this.assembleStdParams(t,n),u=t.ad.dai;u.filterOutPremiumAudioCodecs&&(s["dai-excl"]=i.FILTER_OUT_PREMIUM_AUDIO);var o=w.assign({},s);for(var a in o.cust_params=this.queryStrFromObj(t.ad.adTagParameters.cust_params,[]),delete o.output,r)a.indexOf("imafw_")<0&&(o[a]=r[a]);var c={apiKey:u.apiKey,authToken:u.authToken||null,assetKey:u.assetKey||null,streamActivityMonitorId:u.streamActivityMonitorId||null,adTagParameters:o,videoId:u.daiVideoId||null,contentSourceId:u.contentSourceId||null};return w.isString(u.format)&&(c.format=u.format),c},i.FILTER_OUT_PREMIUM_AUDIO="codec:ac-3,codec:ec-3",i}(us),as=function(i){function n(t,n){var e=i.call(this,t,n)||this;return e.contentSegmentStarted=!1,e.contentStartReleased=!1,e.pendingSeekTime=null,e.contentCompleteReleased=!1,e.presoComplete=!1,e.rawAdSchedule=null,ee.warn("The internal ad service is deprecated. Please use the @cbsinteractive/avia-js-gam plugin. Access to this property will be completely removed July 1st, 2022"),e}return u(n,i),n.prototype.onRemove=function(){var t;this.listenToStreamManager(!1),this.adService&&this.adService.reset(),null===(t=this.streamManager)||void 0===t||t.destroy(),this.streamManager=null,this.adDataProxy=null,i.prototype.onRemove.call(this)},n.prototype.closeAds=function(){var t,i;this.listenToStreamManager(!1),null===(t=this.domProxy)||void 0===t||t.showAdContainer(!1),null===(i=this.adService)||void 0===i||i.reset()},n.prototype.start=function(){var t,i,n=this.presoModel;this.uiMediator&&(this.uiMediator.setMuteState(n.isMuted),!0===(null===(i=null===(t=this.resourceProxy)||void 0===t?void 0:t.ad)||void 0===i?void 0:i.suppressAdUi)&&(this.uiMediator.adViewSuppressed=!0)),this.adService.setMuted(n.isMuteAtPlayStart&&!n.userHasUnmuted),this.presoModel.usesSsai=!0,this.initStreamManager()},n.prototype.getAdBreakTimes=function(){return this.streamManager?this.streamManager.getCuePointsInContentTime():null},n.prototype.initStreamManager=function(){var t=this,i=this.assembleStreamRequest(),n=this.getModel(Kn.PlayerOptions),e=!w.isEmpty(i.assetKey);this.streamManager=new rs(this.adService,this.playerOptions.enableOm),this.streamEventHandler=function(i){t.hStreamEvent(i)},this.listenToStreamManager(!0),e?this.streamManager.requestLiveStream(i,n.networkErrorRecovery):this.streamManager.requestVODStream(i,n.networkErrorRecovery)},n.prototype.assembleStreamRequest=function(){var t,i,n,e,r,s=this.facade.retrieveProxy(yn.ResourceProxy).resource,u={buildEnv:ai.env,platform:this.adService.getGamPlatformString(),mutedPlayback:this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted},o=!w.isEmpty((null===(t=s.ad.dai)||void 0===t?void 0:t.daiVideoId)||(null===(i=s.ad.dai)||void 0===i?void 0:i.assetKey)),a=((null===(n=s.ad.ssai)||void 0===n?void 0:n.videoId)||(null===(e=s.ad.ssai)||void 0===e?void 0:e.assetKey))&&!w.isEmpty(null===(r=s.ad.ssai)||void 0===r?void 0:r.adParameters);if(o)return(new os).assembleStreamRequest(s,u,!1,{playername_version:this.getPlayerVersionInfo()});if(a){var c=this.facade.retrieveService(Jt.System);return function(t,i,n,e){var r=i.muted;void 0===n&&(n=!1);var s=t.adParameters,u=!1,o=!1;for(var a in t.filterOutPremiumAudioCodecs&&(s["dai-excl"]="codec:ac-3,codec:ec-3"),s)a==zr&&r&&s[a]==Wr&&(s[a]=Gr),"[RANDOM]"==s[a]&&(s[a]=Jr()),a==Zr&&(u=!0),a==$r&&(o=!0);for(var c in n||(u||(s.imafw_host=ts()),o||(s[$r]=is())),e)c.indexOf("imafw_")>=0&&(s[c]=e[c]);var h={apiKey:t.apiKey,authToken:t.authToken||null,assetKey:t.assetKey||null,adTagParameters:s,videoId:t.videoId||null,contentSourceId:t.contentSourceId||null};return ni.isString(t.format)&&(h.format=t.format),h}(s.ad.ssai,{muted:this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted,autoplay:this.presoModel.isAutoplay},!(c.isDesktop||c.isMobile),{imafw_playername_version:this.getPlayerVersionInfo()})}return null},n.prototype.mute=function(t){this.muteVideo(t),this.uiMediator&&this.uiMediator.setMuteState(t),this.adService.setMuted(t)},n.prototype.seek=function(t){if(!this.isAdPlaying()){var i=this.streamManager.getPermittedSeekTime(t),n=i===t?this.streamManager.streamTimeForContentTime(i):i;i!==t&&(this.notify(Qn.SEEK_REDIRECT_START,{requestedSeekTime:t,actualSeekTime:i}),this.pendingSeekTime=this.streamManager.streamTimeForContentTime(t)),this.seekVideo(n)}},n.prototype.respondToId3Data=function(n){var e=w.isEmpty(n.info)?w.isEmpty(n.data)?null:n.data:n.info;!e||"google_dai"!==n.id&&n.id!=nr.GOOGLE_DAI?i.prototype.respondToId3Data.call(this,n):(this.log(t.LogLevel.INFO,"metadata received - id: ".concat(n.id," msg ").concat(e)),this.streamManager.onTimedMetadata({TXXX:e}))},n.prototype.respondToVideoPlaying=function(){this.presoModel.started||(this.presoModel.started=!0,this.uiMediator&&(this.uiMediator&&this.uiMediator.displayPoster(!1),this.uiMediator&&this.uiMediator.hideClickCatcher(!0),this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted&&this.uiMediator.showUnmutePrompt(),this.setTransportType()),this.notify(Qn.ENABLE_UI)),i.prototype.respondToVideoPlaying.call(this),this.isAdPlaying()?this.notify(Qn.AD_PLAYING):this.contentSegmentStarted&&(this.respondToPlaybackStateChange(t.PlaybackState.PLAYING),this.setPlayingState(),this.notify(Qn.CONTENT_PLAYING))},n.prototype.respondToVideoPaused=function(){i.prototype.respondToVideoPaused.call(this),this.isAdPlaying()?this.notify(Qn.AD_PAUSED):(this.respondToPlaybackStateChange(t.PlaybackState.PAUSED),this.setPausedState(),this.notify(Qn.CONTENT_PAUSED))},n.prototype.respondToVideoTimeUpdate=function(n){if(!this.contentComplete){var e=this.contentPlaybackStateProxy.model;this.adService.setCurrentTime(n),this.streamManager.ignoreAdEvents(!1),this.presoModel.streamTime=n,e.time=this.streamManager.contentTimeForStreamTime(n);var r=this.streamManager.checkForAdPeriod(n);this.isAdPlaying()||r||(n>.75&&!this.contentSegmentStarted&&(this.contentSegmentStarted=!0,this.contentPlaybackStateProxy.model.started=!0,this.domProxy&&this.domProxy.showAdContainer(!1),this.setPlayingState(),this.setTransportType(),!this.contentStartReleased&&this.signalContentStart(),this.fullscreenRestrictedDuringAdPlay&&this.uiMediator&&(this.uiMediator.setFullScreenAccessRestricted(!1),this.uiMediator.enableFullscreen()),this.notify(Qn.CONTENT_SEGMENT_START)),this.contentSegmentStarted&&i.prototype.respondToVideoTimeUpdate.call(this,n),e.streamType!==t.StreamType.LIVE&&e.time>=e.duration&&!this.contentCompleteReleased&&this.signalContentComplete())}},n.prototype.respondToVideoEnd=function(){this.contentComplete=!0,this.contentCompleteReleased||this.signalContentComplete(),this.presoComplete=!0,i.prototype.respondToVideoEnd.call(this)},n.prototype.respondToDurationChange=function(t){var i=this.streamManager.contentTimeForStreamTime(t);this.contentPlaybackStateProxy.model.duration=i,this.presoModel.streamDuration=t,this.adService.setDuration(t),!this.contentDurationReleased&&i&&!isNaN(i)&&i>0&&this.releaseContentDuration(i),this.streamManager.streamDuration=t},n.prototype.isContentComplete=function(){return this.presoComplete},n.prototype.signalContentStart=function(){this.contentStartReleased=!0,this.notify(Qn.CONTENT_START)},n.prototype.signalContentComplete=function(){this.contentCompleteReleased=!0,this.notify(Qn.CONTENT_SEGMENT_END),this.notify(Qn.CONTENT_COMPLETE)},Object.defineProperty(n.prototype,"adService",{get:function(){return this.facade.retrieveService(Jt.DaiAd)},enumerable:!1,configurable:!0}),n.prototype.handleMediaUrlAvailable=function(t){var i=this.resourceProxy.playback.startTime,n=this.resourceProxy.ad.showPrerollOnNonZeroStart;if(!isNaN(i)&&i>0){var e=this.rawAdSchedule.map((function(t){return t.streamTimeStart})),r=this.adjustStartTimeForAdBreakProximity(i,this.rawAdSchedule),s=this.streamManager.streamTimeForContentTime(r);if(this.checkForBreaksToUnlock(e),n)this.resourceProxy.playback.startTime=NaN,this.pendingSeekTime=s;else"dash"==this.resourceProxy.ad.dai.format&&this.streamManager.ignoreAdEvents(!0),this.resourceProxy.playback.startTime=s}this.resourceProxy.location.mediaUrl=t,this.adService.initViewabilityTracking(),this.isClickToPlay?this.setForClickToPlay():(this.notify(Qn.VIDEO_LOAD_START),this.prepareForPlayback())},n.prototype.checkForBreaksToUnlock=function(t){if(t&&t.length){var i=this.resourceProxy.playback.startTime,n=this.resourceProxy.ad.showPrerollOnNonZeroStart,e=this.streamManager.streamTimeForContentTime(i),r=[];if(e>0){!0!==n&&r.push(0);for(var s=t.length;s--;)if(s>0&&e>t[s]){r.push(t[s]);break}this.streamManager&&this.streamManager.setUnlockedBreaks(r)}}},n.prototype.hStreamEvent=function(i){var n=rs.event;switch(i.type){case n.RAW_AD_SCHEDULE_AVAILABLE:this.rawAdSchedule=i.data.schedule;break;case n.STREAM_ID_AVAILABLE:this.presoModel.streamId=this.streamManager.streamId,this.notify(Qn.STREAM_ID_AVAILABLE,{streamId:this.streamManager.streamId});break;case n.MEDIA_URL_AVAILABLE:this.handleMediaUrlAvailable(i.data.mediaUrl);break;case n.AD_CUEPOINTS_AVAILABLE:this.notify(Qn.AD_CUEPOINTS_AVAILABLE,i.data);break;case n.AD_PERIOD_STARTED:this.seekVideo(i.data.streamResumeTime);break;case n.AD_BREAK_START:this.contentSegmentStarted&&(this.contentSegmentStarted=!1,this.notify(Qn.CONTENT_SEGMENT_END)),this.domProxy&&this.domProxy.showAdContainer(!0),this.presoModel.isCurrentVideoAd=!0,this.uiMediator&&this.uiMediator.hideClickCatcher(!0),this.notify(Qn.AD_BREAK_START);break;case n.AD_BREAK_METADATA:var e=i.data;this.adDataProxy.breakInfo=e,this.notify(Qn.AD_BREAK_METADATA,{adBreakInfo:e});break;case n.AD_START:var r=i.data;this.adDataProxy.adInfo=r,this.notify(Qn.AD_START,{adInfo:r}),this.contentPlaybackStateProxy.model.state===t.PlaybackState.PAUSED&&this.notify(Qn.AD_PAUSED);break;case n.AD_PROGRESS:var s=this.contentPlaybackStateProxy.model;if(s.state===t.PlaybackState.PLAYING){var u={currentTime:i.data.currentTime,duration:i.data.duration,streamTime:this.presoModel.streamTime,streamDuration:this.presoModel.streamDuration};s.streamType===t.StreamType.LIVE&&(u.elapsedTimeMs=this.updateTimeSpent().elapsedTime),this.notify(Qn.AD_TIME_UPDATE,u)}break;case n.AD_FIRST_QUARTILE:this.notify(Qn.AD_FIRST_QUARTILE);break;case n.AD_MIDPOINT:this.notify(Qn.AD_MIDPOINT);break;case n.AD_THIRD_QUARTILE:this.notify(Qn.AD_THIRD_QUARTILE);break;case n.AD_COMPLETE:this.notify(Qn.AD_COMPLETE);break;case n.AD_BREAK_COMPLETE:this.domProxy&&this.domProxy.showAdContainer(!1),this.presoModel.isCurrentVideoAd=!1,this.notify(Qn.AD_BREAK_COMPLETE),this.pendingSeekTime&&(this.contentPlaybackStateProxy.model.started&&this.notify(Qn.SEEK_REDIRECT_COMPLETE),this.seekVideo(this.pendingSeekTime),this.pendingSeekTime=null);break;case n.AD_CLICK:this.pause();break;case n.AD_ERROR:i.data.fatal=!0,this.notify(Qn.RESOURCE_ERROR,i.data)}},n.prototype.listenToStreamManager=function(t){if(this.streamManager){var i=rs.event,n=t?"on":"off";for(var e in i)this.streamManager[n](i[e],this.streamEventHandler)}},n.prototype.onRegister=function(){i.prototype.onRegister.call(this),this.domProxy&&this.domProxy.showAdContainer(!1),this.adDataProxy=new qr(yn.AdDataProxy,null),this.facade.registerProxy(this.adDataProxy)},n}(Hr);!function(t){t.DISABLED="DISABLED",t.ENABLED="ENABLED",t.INSECURE="INSECURE"}(ns||(ns={}));var cs,hs=function(t){function i(i){var n=t.call(this,i)||this;return n.eMap={errorHandler:null,adsMgrLoadedHandler:null},n.initialized=!1,n.omEnabled=!0,n.adService=n.opts.adService,n.sdk=n.adService.sdk,n.omEnabled=n.opts.enableOm,n.eMap.errorHandler=function(t){return n.hError(t)},n.eMap.adsMgrLoadedHandler=function(t){return n.hAdsMgrLoaded(t)},n}return u(i,t),i.prototype.destroy=function(){this.adsLoader&&(this.adsLoader.removeEventListener(this.sdk.AdErrorEvent.Type.AD_ERROR,this.eMap.errorHandler),this.adsLoader.removeEventListener(this.sdk.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.eMap.adsMgrLoadedHandler),this.adsLoader.destroy()),this.adsLoader=null,this.adService=null,this.sdk=null,t.prototype.destroy.call(this)},i.prototype.initialize=function(){var t=this.opts,i=this.sdk;if(!i||!i.AdsLoader)return!1;if(this.initialized)return!0;var n=new i.AdDisplayContainer(t.adContainer,t.video,t.adClickEl);n.initialize(),this.adsLoader=new i.AdsLoader(n);var e=this.adsLoader.getSettings();return this.populateSdkSettings(e),this.adsLoader.addEventListener(i.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.eMap.adsMgrLoadedHandler),this.adsLoader.addEventListener(i.AdErrorEvent.Type.AD_ERROR,this.eMap.errorHandler),this.initialized=!0,!0},i.prototype.requestAds=function(t,i){var n,e=this.sdk;this.omEnabled&&(t.omidAccessModeRules={},t.omidAccessModeRules[null===(n=e.OmidAccessMode)||void 0===n?void 0:n.FULL]=[new RegExp(".*")]),this.adsLoader&&this.adsLoader.requestAds(t)},i.prototype.getSdkVersion=function(){return this.adsLoader.getVersion()},i.prototype.contentComplete=function(){this.adsLoader&&this.adsLoader.contentComplete()},i.prototype.getSettings=function(){return this.adsLoader?this.adsLoader.getSettings():null},i.prototype.hAdsMgrLoaded=function(t){this.emit(i.event.ADS_MANAGER_LOADED,t)},i.prototype.hError=function(t){var n=this.parseAdErrorEvent(t);this.emit(i.event.ADS_LOADER_ERROR,n)},i.prototype.parseAdErrorEvent=function(t){return this.adService.parseAdError(t)},i.prototype.populateSdkSettings=function(t){var i=this.opts.sdkSettings,n=this.sdk.ImaSdkSettings.VpaidMode[i.vpaidMode];t.setVpaidMode(n),t.setDisableCustomPlaybackForIOS10Plus(i.disableCustomPlaybackForIOS10Plus),t.setPlayerType(i.playerType),t.setPlayerVersion(i.playerVersion)},i.event={ADS_MANAGER_LOADED:"adsManagerLoaded",ADS_LOADER_ERROR:"adsLoaderError"},i}(T),ls=function(i){function n(n){return i.call(this,n,t.AdContext.IMA)||this}return u(n,i),n.prototype.destroy=function(){this.pAdsLoader&&this.pAdsLoader.destroy(),this.pAdsLoader=null,this.pAdsLoaderOptions=null,i.prototype.destroy.call(this)},Object.defineProperty(n.prototype,"sdk",{get:function(){var t=this.getService(Jt.System).global;return t&&t.google&&t.google.ima||null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sdkSettings",{get:function(){return{vpaidMode:ns.INSECURE,disableCustomPlaybackForIOS10Plus:!1,playerType:ai.playerName,playerVersion:ai.playerVersion}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"defaultRenderingSettings",{get:function(){return{bitrate:900,enablePreloading:!1,loadVideoTimeout:-1,playAdsAfterTime:void 0,restoreCustomPlaybackStateOnAdBreakComplete:!1}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"adsLoaderOptions",{set:function(t){this.pAdsLoaderOptions=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"adsLoader",{get:function(){return this.pAdsLoader},enumerable:!1,configurable:!0}),n.prototype.getSdkVersion=function(){var t;return null===(t=this.adsLoader)||void 0===t?void 0:t.getSdkVersion()},n.prototype.createAdsLoader=function(){var t;this.pAdsLoader||(this.pAdsLoaderOptions.enableOm=!0===(null===(t=this.getModel(Kn.PlayerOptions))||void 0===t?void 0:t.enableOm),this.pAdsLoader=new hs(this.pAdsLoaderOptions))},n.prototype.initializeAdsLoader=function(){return this.createViewabilityTracker(),this.pAdsLoader.initialize()},n.prototype.parseAdError=function(t){var i=t.getError(),n=t.getUserRequestContext(),e=i.getInnerError();return{type:this.getAdErrorType(i),errorCode:i.getErrorCode(),vastErrorCode:i.getVastErrorCode(),message:i.getMessage(),innerErrorMessage:w.isString(e)?e:null,sdkVersion:this.sdk.VERSION,requestContext:n||null}},n.prototype.getAdErrorType=function(t){return t.getType()==this.sdk.AdError.Type.AD_LOAD?"adLoad":"adPlay"},n}(wr);!function(t){t.DEV="dev",t.STAGE="stage",t.PROD="prod"}(cs||(cs={}));var fs,ds=function(t){function i(){return t.call(this)||this}return u(i,t),i.prototype.assembleAdCall=function(t,n,e){var r=i.adCallTemplate,s=this.assembleStdParams(t,n),u=w.assign({},s),o=this.queryStrFromObj(t.ad.adTagParameters.cust_params);for(var a in u.cust_params=o,n.buildEnv===cs.DEV&&(u.pp="vpaid_js"),e)a.indexOf("imafw")<0&&(u[a]=e[a]);return r+this.queryStrFromObj(u,["description_url","url","iu","partner","cust_params","playername_version","sdkv"])},i.adCallTemplate="http://pubads.g.doubleclick.net/gampad/ads?",i}(us),vs=function(i){function n(t){var n=i.call(this,t)||this;n.pIsFullscreen=!1,n.inProgressAd=null,n.inProgressBreakId=null,n.isPaused=!1,n.breakStartReleased=!1,n.pendingSeekedBreakId=null,n.markedAsPlayed=null,n.logger=null,n.adProgressData={lastRecordedTime:0,addTzero:null,pollTzero:null,timeoutHandle:null,stallThreshold:5,adId:null,duration:null,pollInterval:2e3},n.adCallUrl=t.adCallUrl,n.presentationContainer=t.presentationContainer,n.adService=t.adService,n.sdk=n.adService.sdk,n.adsLoader=n.adService.adsLoader,n.adProgressData.stallThreshold=t.stallThreshold||n.adProgressData.stallThreshold,n.logger=t.logger,delete n.opts.presentationContainer,n.adsLoaderEventMap={};var e=hs.event;return n.adsLoaderEventMap[e.ADS_LOADER_ERROR]=function(t){return n.hAdsLoaderError(t)},n.adsLoaderEventMap[e.ADS_MANAGER_LOADED]=function(t){return n.hAdsMgrLoaded(t)},n.adEventHandler=function(t){return n.hAdEvent(t)},n.errorEventHandler=function(t){return n.hAdsManagerAdError(t)},n.initialize(),n}return u(n,i),n.prototype.destroy=function(){var t,n;clearTimeout(this.adProgressData.timeoutHandle),this.listenToAdsLoader(!1),this.listenToAdsManager(!1),null===(t=this.adsManager)||void 0===t||t.destroy(),null===(n=this.adsLoader)||void 0===n||n.contentComplete(),this.adBreakSchedule&&this.adBreakSchedule.destroy(),this.presentationContainer=null,this.adsManager=null,this.sdk=null,this.adsLoader=null,this.adEventHandler=null,this.adBreakSchedule=null,this.renderingSettings=null,this.logger=null,i.prototype.destroy.call(this)},Object.defineProperty(n.prototype,"adBreaks",{get:function(){return this.adBreakSchedule?this.adBreakSchedule.adBreaks:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contentBitrate",{set:function(t){this.renderingSettings&&this.adsManager&&(this.renderingSettings.bitrate=t,this.adsManager.updateAdsRenderingSettings(this.renderingSettings))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"volume",{set:function(t){this.adsManager&&this.adsManager.setVolume(w.clampValue(t,0,1))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isFullscreen",{set:function(t){this.pIsFullscreen=t},enumerable:!1,configurable:!0}),n.prototype.pauseAd=function(){var t;clearTimeout(this.adProgressData.timeoutHandle),this.isPaused=!0,null===(t=this.adsManager)||void 0===t||t.pause()},n.prototype.resumeAd=function(){var t;clearTimeout(this.adProgressData.timeoutHandle),this.isPaused=!1,null===(t=this.adsManager)||void 0===t||t.resume()},n.prototype.mute=function(){this.volume=0},n.prototype.unmute=function(t){this.volume=t},n.prototype.hasPostRoll=function(){var t;return!!(null===(t=this.adBreakSchedule)||void 0===t?void 0:t.hasPostRoll())},n.prototype.hasMidRolls=function(){var t;return!!(null===(t=this.adBreakSchedule)||void 0===t?void 0:t.hasMidRolls())},n.prototype.startAds=function(){var i=this.getRect(),e=this.pIsFullscreen?this.sdk.ViewMode.FULLSCREEN:this.sdk.ViewMode.NORMAL;try{this.adsManager.init(i.width,i.height,e),this.adsManager.start()}catch(i){this.log("AdsManager init failure."),this.emit(n.event.AD_INIT_ERROR,{code:t.ErrorCode.IMA_INIT_FAILURE,message:i.getMessage?i.getMessage():Mi.messages.UNSPECIFIED_ERROR})}},n.prototype.markAsPlayed=function(t){this.markedAsPlayed?this.markedAsPlayed=this.markedAsPlayed.concat(t):this.markedAsPlayed=t},n.prototype.getBreakForSeekTime=function(t){if(this.adBreakSchedule&&this.adBreakSchedule.hasMidRolls()){var i=this.adBreakSchedule.getBreakForContentSeekTime(t);if(i&&(!this.markedAsPlayed||-1===this.markedAsPlayed.indexOf(i.breakId)))return this.pendingSeekedBreakId=i.breakId,i}return null},n.prototype.cancelPendingBreak=function(t){this.pendingSeekedBreakId===t&&(this.pendingSeekedBreakId=null)},n.prototype.isUsingContentVideoElement=function(){return this.adsManager&&this.adsManager.isCustomPlaybackUsed()},n.prototype.isUsingCustomClickTracker=function(){return!(!this.adsManager||!this.adsManager.isCustomClickTrackingUsed())},n.prototype.setContentComplete=function(){var t;null===(t=this.adsLoader)||void 0===t||t.contentComplete()},n.prototype.updateSize=function(t){var i=this.getRect();if(this.adsManager){var n=t?this.sdk.ViewMode.FULLSCREEN:this.sdk.ViewMode.NORMAL;this.adsManager.resize(i.width,i.height,n)}},n.prototype.hAdsManagerAdError=function(i){var e=this.adService.parseAdError(i);this.log("AdsManager ERROR",e),this.emit(n.event.AD_ERROR,{code:t.ErrorCode.IMA_AD_ERROR,message:e&&e.message||Mi.messages.UNSPECIFIED_ERROR,data:e})},n.prototype.hAdEvent=function(t){var i=this,e=this.sdk.AdEvent.Type,r=t.getAd(),s=t.getAdData(),u=n.event;clearTimeout(this.adProgressData.timeoutHandle);var o=!1!==this.opts.enableStalledAdCheck;switch(t.type){case e.CONTENT_PAUSE_REQUESTED:o=!1,this.pendingSeekedBreakId=null,this.emit(u.CONTENT_PAUSE_REQUESTED);break;case e.CONTENT_RESUME_REQUESTED:this.log("IMA SDK requested content resume."),o=!1,this.pendingSeekedBreakId=null,this.processBreakComplete();break;case e.LOADED:o=!1,this.processAdLoadOrStart(r,s,e.LOADED);break;case e.STARTED:o=!1,this.inProgressBreakId&&!this.breakStartReleased&&(this.breakStartReleased=!0,this.emit(n.event.AD_BREAK_START,{adBreakId:this.inProgressBreakId})),this.processAdLoadOrStart(r,s,e.STARTED),this.checkForCustomClickTracking(),this.beginPollForProgress(this.inProgressAd);break;case e.AD_PROGRESS:this.processProgress();break;case e.FIRST_QUARTILE:this.processQuartile(e.FIRST_QUARTILE,u.AD_FIRST_QUARTILE);break;case e.MIDPOINT:this.processQuartile(e.MIDPOINT,u.AD_MIDPOINT);break;case e.THIRD_QUARTILE:this.processQuartile(e.THIRD_QUARTILE,u.AD_THIRD_QUARTILE);break;case e.COMPLETE:o=!1,this.processAdComplete(e.COMPLETE);break;case e.ALL_ADS_COMPLETED:o=!1,this.processAllComplete();break;case e.AD_BUFFERING:this.emit(u.AD_BUFFERING);break;case e.CLICK:o=!1,this.adsManager.pause(),this.emit(u.AD_CLICK,{ad:this.inProgressAd});break;case e.PAUSED:o=!1,this.isPaused=!0,this.emit(u.AD_PAUSED);break;case e.RESUMED:this.isPaused=!1,this.emit(u.AD_RESUMED);break;case e.SKIPPED:o=!1,this.processSkip(e.SKIPPED);break;case e.LOG:o=!1,this.processLogEvent(s);break;case e.USER_CLOSE:o=!1,this.killAd();break;case e.VOLUME_CHANGED:case e.VOLUME_MUTED:this.processVolumeChange(t.type)}!this.isPaused&&o&&(this.adProgressData.timeoutHandle=setTimeout((function(){return i.checkAdProgress()}),this.adProgressData.pollInterval))},n.prototype.checkForCustomClickTracking=function(){this.isUsingCustomClickTracker()&&this.emit(n.event.AD_CLICK_ELEMENT_VISIBILITY_REQUESTED)},n.prototype.beginPollForProgress=function(t){var i=this;if(!0===this.opts.enableStalledAdCheck){var n=this.adProgressData;clearTimeout(n.timeoutHandle),n.duration=t.adDuration,n.adId=t.adId,n.pollTzero=Date.now(),n.timeoutHandle=setTimeout((function(){return i.checkAdProgress()}),n.pollInterval)}},n.prototype.checkAdProgress=function(){var i=this,e=this.adProgressData,r=e.duration-this.adsManager.getRemainingTime(),s=Date.now();if(clearTimeout(e.timeoutHandle),!this.isPaused)if(null===e.pollTzero&&(e.pollTzero=Date.now()),r>e.lastRecordedTime)e.lastRecordedTime=r,e.pollTzero=s,e.timeoutHandle=setTimeout((function(){return i.checkAdProgress()}),e.pollInterval);else if(.001*(s-e.pollTzero)>e.stallThreshold){var u=this.inProgressAd?w.assign({},this.inProgressAd):null;this.log("Ad stalled; discarding break"),this.emit(n.event.AD_STALLED,{code:t.ErrorCode.AD_STALLED,message:Mi.messages.AD_STALLED,data:{adInfo:u}}),this.killAd(),this.emit(n.event.AD_BREAK_DISCARDED),this.adsManager&&this.adsManager.discardAdBreak(),this.processBreakComplete()}},n.prototype.processAdLoadOrStart=function(i,e,r){var s=r===this.sdk.AdEvent.Type.STARTED,u=this.adService.assembleAdBreakInfo(i,t.AdTechnology.CSAI),o=this.adService.assembleAdInfo(i,e,s),a=u.adBreakPosition,c=0===a?"pre_0":-1===a?"post_0":"mid_"+a;if(this.markedAsPlayed&&this.markedAsPlayed.indexOf(c)>=0)return this.adBreakSchedule.markPlayed(c),void this.adsManager.discardAdBreak();s?(this.inProgressAd=o,this.adService.trackAd(o),this.adService.trackAdEvent({context:t.AdContext.IMA,eventName:r,volume:this.adsManager.getVolume()}),this.emit(n.event.AD_BREAK_METADATA,u),this.emit(n.event.AD_START,o)):(this.adBreakSchedule.hasPlayed(c)||(this.adBreakSchedule.markPlayed(c),this.inProgressBreakId=c),this.emitAdLoaded(o))},n.prototype.emitAdLoaded=function(t){this.emit(n.event.AD_LOADED,t)},n.prototype.processProgress=function(){if(this.inProgressAd){var t=this.inProgressAd.adDuration,i=this.adsManager&&this.adsManager.getRemainingTime();isNaN(t)||isNaN(i)||i<0||this.emit(n.event.AD_PROGRESS,{currentTime:Math.min(t,Math.max(0,t-i)),duration:t})}},n.prototype.processQuartile=function(i,n){this.emit(n,{ad:this.inProgressAd}),this.adService.trackAdEvent({context:t.AdContext.IMA,eventName:i,volume:this.adsManager.getVolume()})},n.prototype.processAdComplete=function(i){this.adService.trackAdEvent({context:t.AdContext.IMA,eventName:i,volume:this.adsManager.getVolume()}),this.killAd()},n.prototype.processSkip=function(i){this.emit(n.event.AD_SKIPPED,{ad:this.inProgressAd}),this.adService.trackAdEvent({context:t.AdContext.IMA,eventName:i,volume:this.adsManager.getVolume()}),this.killAd()},n.prototype.processBreakComplete=function(){this.inProgressAd&&this.killAd(),this.inProgressBreakId&&(this.emit(n.event.AD_BREAK_COMPLETE,{adBreakId:this.inProgressBreakId}),this.inProgressBreakId=null),this.breakStartReleased=!1,this.emit(n.event.CONTENT_RESUME_REQUESTED)},n.prototype.processVolumeChange=function(i){this.adService.trackAdEvent({context:t.AdContext.IMA,eventName:i,volume:this.adsManager.getVolume()})},n.prototype.processAllComplete=function(){this.inProgressBreakId&&this.processBreakComplete(),this.emit(n.event.ALL_ADS_COMPLETED)},n.prototype.processLogEvent=function(i){this.pendingSeekedBreakId&&this.log("IMA SDK LOG event; break is pending."),i&&i.adError&&(this.log("LOG event; Ad data has error: msg = "+i.adError.getMessage()||"no message available"),this.emit(n.event.AD_ERROR,{code:t.ErrorCode.IMA_AD_ERROR,message:i.adError.getMessage()||Mi.messages.UNSPECIFIED_ERROR,data:{errorCode:i.adError.getErrorCode()}}),this.log("LOG event; Discarding Ad break"),this.emit(n.event.AD_BREAK_DISCARDED),this.adsManager&&this.adsManager.discardAdBreak())},n.prototype.killAd=function(){this.adService.untrackAd(),this.emit(n.event.AD_COMPLETE,{ad:this.inProgressAd}),this.inProgressAd=null;var t=this.adProgressData;clearTimeout(t.timeoutHandle),t.pollTzero=null,t.lastRecordedTime=null},n.prototype.requestAds=function(){var t=new this.sdk.AdsRequest,i=this.getRect();t.adTagUrl=this.adCallUrl,t.linearAdSlotWidth=i.width,t.linearAdSlotHeight=i.height,t.nonLinearAdSlotWidth=i.width,t.nonLinearAdSlotHeight=i.height,t.setAdWillAutoPlay(this.opts.initialPlayState.autoplay),t.setAdWillPlayMuted(this.opts.initialPlayState.muted),this.adsLoader.requestAds(t)},n.prototype.hAdsMgrLoaded=function(t){var i=t.data;this.renderingSettings=this.getRenderingSettings(),this.adsManager=i.getAdsManager(this.opts.playheadInterface,this.renderingSettings),this.createAdBreakSchedule(this.adsManager.getCuePoints()),this.listenToAdsManager(!0),this.startAds()},n.prototype.getRenderingSettings=function(){var t=new this.sdk.AdsRenderingSettings,i=this.opts.ad,n=this.adService.defaultRenderingSettings,e=i.ima.loadVideoTimeoutMs,r=i.ima.enableAdPreloading;return t.bitrate=n.bitrate,t.enablePreloading=w.isBoolean(r)?r:n.enablePreloading,t.loadVideoTimeout=isNaN(e)?n.loadVideoTimeout:e,t.restoreCustomPlaybackStateOnAdBreakComplete=n.restoreCustomPlaybackStateOnAdBreakComplete,t},n.prototype.createAdBreakSchedule=function(t){w.isEmpty(t)&&(t=[0]),this.adBreakSchedule=new es(t),this.emit(n.event.RAW_AD_SCHEDULE_AVAILABLE,{cuepoints:t}),this.emit(n.event.AD_CUEPOINTS_AVAILABLE,{cuepoints:t})},n.prototype.hAdsLoaderError=function(i){this.emit(n.event.AD_ERROR,{code:t.ErrorCode.IMA_AD_ERROR,message:i.data.message,data:i.data}),this.log("AdsLoader ERROR",i.data),this.emit(n.event.CONTENT_RESUME_REQUESTED)},n.prototype.listenToAdsManager=function(t){if(this.adsManager){for(var i,n=t?"addEventListener":"removeEventListener",e=this.getEventInterests(),r=0,s=e.length;r<s;r++)i=this.sdk.AdEvent.Type[e[r]],this.adsManager[n](i,this.adEventHandler);this.adsManager[n](this.sdk.AdErrorEvent.Type.AD_ERROR,this.errorEventHandler)}},n.prototype.listenToAdsLoader=function(t){var i=this.adsLoaderEventMap,n=[hs.event.ADS_MANAGER_LOADED,hs.event.ADS_LOADER_ERROR];if(this.adsLoader)for(var e=n.length;e--;)this.adsLoader[t?"on":"off"](n[e],i[n[e]])},n.prototype.getEventInterests=function(){return["CONTENT_PAUSE_REQUESTED","CONTENT_RESUME_REQUESTED","LOADED","STARTED","AD_PROGRESS","FIRST_QUARTILE","MIDPOINT","THIRD_QUARTILE","COMPLETE","ALL_ADS_COMPLETED","AD_BUFFERING","CLICK","PAUSED","RESUMED","SKIPPED","LOG","USER_CLOSE"]},n.prototype.getRect=function(){return this.presentationContainer.getBoundingClientRect()},n.prototype.initialize=function(){this.listenToAdsLoader(!0),this.requestAds()},n.prototype.log=function(i,n){var e,r;if(null===(e=this.logger)||void 0===e||e.log(t.LogLevel.DEBUG,"ImaAdPlayer: ".concat(i)),n)for(var s in n)null===(r=this.logger)||void 0===r||r.log(t.LogLevel.DEBUG,"".concat(s,": ").concat(n[s]))},n.event={CONTENT_PAUSE_REQUESTED:"contentPauseRequested",CONTENT_RESUME_REQUESTED:"contentResumeRequested",AD_CLICK_ELEMENT_VISIBILITY_REQUESTED:"adClickElementVisibilityRequested",AD_CUEPOINTS_AVAILABLE:"adCuepointsAvailable",AD_INIT_ERROR:"adInitError",AD_BREAK_START:"adBreakStart",AD_BREAK_METADATA:"adBreakMetadata",AD_LOADED:"adLoaded",AD_START:"adStarted",AD_PROGRESS:"adProgress",AD_FIRST_QUARTILE:"adFirstQuartile",AD_MIDPOINT:"adMidpoint",AD_THIRD_QUARTILE:"adThirdQuartile",AD_COMPLETE:"adComplete",ALL_ADS_COMPLETED:"allAdsCompleted",AD_BREAK_COMPLETE:"adBreakComplete",AD_BREAK_DISCARDED:"adBreakDiscarded",AD_BUFFERING:"adBuffering",AD_PAUSED:"paused",AD_RESUMED:"resumed",AD_SKIPPED:"adSkipped",AD_CLICK:"adClick",AD_ERROR:"adError",AD_VOLUME_CHANGED:"adVolumeChanged",AD_MUTED:"adMuted",AD_STALLED:"adStalled",RAW_AD_SCHEDULE_AVAILABLE:"rawAdScheduleAvailable"},n}(T),bs=function(i){function n(t,n){var e=i.call(this,t,n)||this;return e.contentSegmentStarted=!1,e.pendingSeekTime=null,e.contentStartReleased=!1,e.fatalContentErrorReceived=!1,e.breaksToSkip=null,e.breakMetaDataReleased=!1,e.pendingBreak=null,e.preloadContent=!1,ee.warn("The internal ad service is deprecated. Please use the @cbsinteractive/avia-js-gam plugin. Access to this property will be completely removed July 1st, 2022"),e}return u(n,i),n.prototype.onRemove=function(){this.killAdPlayer(),this.adDataProxy=null,i.prototype.onRemove.call(this)},n.prototype.closeAds=function(){var t,i;this.listenToAdPlayer(!1),null===(t=this.domProxy)||void 0===t||t.showAdContainer(!1),null===(i=this.adPlayer)||void 0===i||i.destroy()},n.prototype.start=function(){var t,i,n=this.resourceProxy.playback.startTime,e=this.resourceProxy.ad.showPrerollOnNonZeroStart,r=!isNaN(n)&&n>0,s=this.resourceProxy.location.mediaUrl;if(this.hasContent=w.isString(s)&&!w.isEmpty(s),this.uiMediator&&!0===(null===(i=null===(t=this.resourceProxy)||void 0===t?void 0:t.ad)||void 0===i?void 0:i.suppressAdUi)&&(this.uiMediator.adViewSuppressed=!0),r){var u=this.resourceProxy.ad.adTagParameters.cust_params;this.breaksToSkip=u&&u.skippod||null,e||null!==this.breaksToSkip||(this.breaksToSkip="1")}r&&e&&(this.resourceProxy.playback.startTime=NaN,this.pendingSeekTime=n),this.mute(this.presoModel.isMuted),this.isClickToPlay?this.setForClickToPlay():this.hasContent?(this.notify(Qn.VIDEO_LOAD_START),this.prepareForPlayback()):this.play()},n.prototype.play=function(){this.presoModel.started?this.isAdPlaying()?this.adPlayer.resumeAd():this.playVideo():(this.adService.initializeAdsLoader(),this.domProxy&&this.domProxy.showAdContainer(!0),this.createAdPlayer())},n.prototype.playOnUserGesture=function(){this.facade.retrieveProxy(yn.ResourceProxy).resource.ad.context===t.AdContext.IMA_AD_ONLY?this.play():i.prototype.playOnUserGesture.call(this)},n.prototype.pause=function(){this.isAdPlaying()&&this.adPlayer?this.adPlayer.pauseAd():this.pauseVideo()},n.prototype.mute=function(t){this.muteVideo(t),this.adPlayer&&(t&&this.adPlayer.mute(),!t&&this.adPlayer.unmute(this.domProxy.getVideoVolume())),this.uiMediator&&this.uiMediator.setMuteState(t)},n.prototype.seek=function(t){var i=t;if(this.adPlayer){var n=this.adPlayer.getBreakForSeekTime(t);n&&(i=n.startTime,this.pendingSeekTime=t,this.pendingBreak=n,this.notify(Qn.SEEK_REDIRECT_START,{requestedSeekTime:t,actualSeekTime:i}))}this.seekVideo(i)},n.prototype.getAdBreakTimes=function(){var i=[],n=this.adPlayer&&this.adPlayer.adBreaks;if(!n)return i;if(n.pre&&i.push({start:n.pre.startTime,duration:n.pre.endTime-n.pre.startTime,played:n.pre.hasPlayed,adTechnology:t.AdTechnology.CSAI}),n.mid)for(var e=n.mid.length,r=void 0;e--;)r=n.mid[e],i.unshift({start:r.startTime,duration:r.endTime-r.startTime,played:r.hasPlayed,adTechnology:t.AdTechnology.CSAI});return n.post&&i.push({start:n.post.startTime,duration:n.post.endTime-n.post.startTime,played:n.post.hasPlayed,adTechnology:t.AdTechnology.CSAI}),i},n.prototype.respondToVideoPlaying=function(){this.startPreso(),i.prototype.respondToVideoPlaying.call(this),this.isAdPlaying()?this.notify(Qn.AD_PLAYING):this.contentSegmentStarted&&(this.respondToPlaybackStateChange(t.PlaybackState.PLAYING),this.setPlayingState(),this.notify(Qn.CONTENT_PLAYING))},n.prototype.respondToVideoPaused=function(){i.prototype.respondToVideoPaused.call(this),this.isAdPlaying()?this.notify(Qn.AD_PAUSED):(this.respondToPlaybackStateChange(t.PlaybackState.PAUSED),this.setPausedState(),this.notify(Qn.CONTENT_PAUSED))},n.prototype.respondToVideoTimeUpdate=function(n){if(!this.contentComplete&&this.contentPlaybackStateProxy.isReady){var e=this.contentPlaybackStateProxy.model,r=this.isAdPlaying();if(this.setAdPlayerBitrate(),!r){if(this.presoModel.streamTime=n,e.time=n,this.pendingBreak&&n-this.pendingBreak.startTime>1){var s=this.resourceProxy.ad.ima.ignoreAnomalousConditionOnSeek;return this.log(t.LogLevel.DEBUG,"IMA PM: stream time: "+n+"; threshold exceeded for brk @ "+this.pendingBreak.startTime),!s&&this.adPlayer&&this.adPlayer.markAsPlayed([this.pendingBreak.breakId]),this.pendingSeekTime&&this.seek(this.pendingSeekTime),this.pendingBreak=null,void this.notify(Qn.SEEK_REDIRECT_COMPLETE)}n>.75&&!this.contentSegmentStarted&&this.startContentSegment(),this.contentSegmentStarted&&i.prototype.respondToVideoTimeUpdate.call(this,n)}}},n.prototype.respondToVideoEnd=function(){var t,n;this.contentComplete=!0,this.contentSegmentStarted&&(this.contentSegmentStarted=!1,this.notify(Qn.CONTENT_SEGMENT_END)),this.notify(Qn.CONTENT_COMPLETE),null===(t=this.adPlayer)||void 0===t||t.setContentComplete(),(null===(n=this.adPlayer)||void 0===n?void 0:n.hasPostRoll())||i.prototype.respondToVideoEnd.call(this)},n.prototype.respondToDurationChange=function(t){if(this.contentPlaybackStateProxy.model.duration=t,this.presoModel.streamDuration=t,!isNaN(t)&&t>0&&(!this.contentDurationReleased&&this.releaseContentDuration(t),this.pendingCuepoints)){var i=this.pendingCuepoints;this.pendingCuepoints=null,this.notify(Qn.AD_CUEPOINTS_AVAILABLE,{cuepoints:i})}},n.prototype.respondToBufferingStatusCheck=function(t){this.isAdPlaying()||i.prototype.respondToBufferingStatusCheck.call(this,t)},n.prototype.respondToQualityChange=function(t){void 0===t&&(t=null),this.setAdPlayerBitrate(),i.prototype.respondToQualityChange.call(this,t)},n.prototype.respondToSizeChange=function(){this.adPlayer&&this.adPlayer.updateSize(this.presoModel.isFullscreen)},n.prototype.respondToError=function(t){this.fatalContentErrorReceived=t.fatal,i.prototype.respondToError.call(this,t)},n.prototype.startPreso=function(){this.presoModel.started||(this.presoModel.started=!0,this.uiMediator&&(this.uiMediator.displayPoster(!1),this.uiMediator.hideClickCatcher(!0),this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted&&this.uiMediator.showUnmutePrompt()),this.notify(Qn.ENABLE_UI))},n.prototype.startContentSegment=function(){this.contentSegmentStarted=!0,this.contentPlaybackStateProxy.model.started=!0,this.domProxy&&this.domProxy.showAdContainer(!1),this.setPlayingState(),this.uiMediator&&!this.contentPlaybackStateProxy.model.liveStreamInfo&&this.uiMediator.setSeekable(!0),this.contentStartReleased||(this.contentStartReleased=!0,this.notify(Qn.CONTENT_START)),this.fullscreenRestrictedDuringAdPlay&&this.uiMediator&&(this.uiMediator.setFullScreenAccessRestricted(!1),this.uiMediator.enableFullscreen()),this.notify(Qn.CONTENT_SEGMENT_START)},n.prototype.setAdPlayerBitrate=function(){if(this.adPlayer){var t=this.contentPlaybackStateProxy.model.bitrate;t&&!isNaN(t)&&(this.adPlayer.contentBitrate=.001*t)}},n.prototype.hAdPlayerEvent=function(i){var n=vs.event;switch(i.type){case n.AD_CLICK_ELEMENT_VISIBILITY_REQUESTED:this.domProxy.showAdClickElement(!0);break;case n.AD_CLICK:this.notify(Qn.AD_CLICK,i.data);break;case n.AD_SKIPPED:this.notify(Qn.AD_SKIPPED,i.data);break;case n.RAW_AD_SCHEDULE_AVAILABLE:break;case n.AD_CUEPOINTS_AVAILABLE:this.pendingCuepoints=i.data.cuepoints;break;case n.CONTENT_PAUSE_REQUESTED:this.breakMetaDataReleased=!1,this.respondToPauseRequestFromAdPlayer();break;case n.CONTENT_RESUME_REQUESTED:this.resumeContentPlay();break;case n.AD_BREAK_START:this.pendingBreak=null,this.respondToContentEnd(),this.respondToAdBreakStart();break;case n.AD_BREAK_METADATA:this.pendingBreak=null,this.respondToAdBreakMetadata(i.data);break;case n.AD_LOADED:this.pendingBreak=null,this.respondToAdLoaded(i.data);break;case n.AD_START:this.respondToPlaybackStateChange(t.PlaybackState.PLAYING),this.pendingBreak=null,this.respondToAdStart(i.data);break;case n.AD_PROGRESS:this.respondToAdProgress(i.data);break;case n.AD_PAUSED:this.respondToPlaybackStateChange(t.PlaybackState.PAUSED),this.notify(Qn.AD_PAUSED),this.notify(Qn.RESOURCE_PAUSED);break;case n.AD_RESUMED:this.respondToPlaybackStateChange(t.PlaybackState.PLAYING),this.notify(Qn.AD_PLAYING),this.notify(Qn.RESOURCE_PLAYING);break;case n.AD_FIRST_QUARTILE:this.notify(Qn.AD_FIRST_QUARTILE);break;case n.AD_MIDPOINT:this.notify(Qn.AD_MIDPOINT);break;case n.AD_THIRD_QUARTILE:this.notify(Qn.AD_THIRD_QUARTILE);break;case n.AD_COMPLETE:this.respondToAdComplete(),this.domProxy.showAdClickElement(!1),this.notify(Qn.AD_COMPLETE);break;case n.AD_BREAK_COMPLETE:this.breakMetaDataReleased=!1,this.respondToAdBreakComplete();break;case n.ALL_ADS_COMPLETED:this.breakMetaDataReleased=!1,this.killAdPlayer();break;case n.AD_BREAK_DISCARDED:this.breakMetaDataReleased=!1,this.domProxy.showAdClickElement(!1),this.notify(Qn.AD_BREAK_DISCARDED);break;case n.AD_BUFFERING:break;case n.AD_STALLED:this.adDataProxy.resetAll(),this.notify(Qn.AD_STALLED,i.data);break;case n.AD_ERROR:this.domProxy.showAdClickElement(!1),this.contentSegmentStarted=!1,this.notify(Qn.AD_ERROR,i.data);break;case n.AD_INIT_ERROR:this.killAdPlayer(),this.notify(Qn.AD_ERROR,i.data),this.resumeContentPlay()}},n.prototype.respondToPauseRequestFromAdPlayer=function(){this.presoModel.started?this.pauseVideo():this.startPreso()},n.prototype.resumeContentPlay=function(){var t=this;if(this.domProxy.showAdClickElement(!1),this.fatalContentErrorReceived)this.notify(Qn.DISABLE_UI);else if(this.hasContent&&!this.contentComplete)if(this.contentSegmentStarted)this.resumeContentPlayComplete();else{if(!this.contentStartReleased){var n=this.resourceProxy.playback.startTime;if(!isNaN(n)&&n>0){var e=this.getAdBreakTimes(),r=this.adjustStartTimeForAdBreakProximity(n,e);this.resourceProxy.playback.startTime=r}}this.load().then((function(){t.resumeContentPlayComplete(),t.startContentSegment()})).catch(this.onLoadError)}else i.prototype.respondToVideoEnd.call(this)},n.prototype.resumeContentPlayComplete=function(){this.pendingSeekTime&&(this.notify(Qn.SEEK_REDIRECT_COMPLETE),this.seekVideo(this.pendingSeekTime),this.pendingSeekTime=null),this.startPreso(),this.play()},n.prototype.respondToContentEnd=function(){this.contentSegmentStarted&&(this.contentSegmentStarted=!1,this.notify(Qn.CONTENT_SEGMENT_END))},n.prototype.respondToAdBreakStart=function(){this.domProxy&&this.domProxy.showAdContainer(!0),this.presoModel.isCurrentVideoAd=!0,this.uiMediator&&(this.uiMediator.hideClickCatcher(!0),this.fullscreenRestrictedDuringAdPlay&&this.uiMediator.disableFullscreen()),this.notify(Qn.AD_BREAK_START)},n.prototype.respondToAdBreakMetadata=function(t){this.breakMetaDataReleased||(this.adDataProxy.breakInfo=t,this.breakMetaDataReleased=!0,this.notify(Qn.AD_BREAK_METADATA,{adBreakInfo:t}))},n.prototype.respondToAdStart=function(t){this.adDataProxy.adInfo=t,this.notify(Qn.AD_START,{adInfo:t}),this.notify(Qn.RESOURCE_PLAYING),this.checkPreload()},n.prototype.checkPreload=function(){var t=this,i=!0===this.resourceProxy.ad.ima.preloadContentAtEndOfPreRoll,n=this.adDataProxy.adInfo.adPosition===this.adDataProxy.breakInfo.adTotal,e=this.facade.retrieveService(Jt.System);if(i&&n&&!e.isIos){var r=function(i){var n=i.data,e=w.clampValue(Math.ceil(n.duration/4),2,10);Math.round(n.currentTime)>=e&&(t.adPlayer.off(vs.event.AD_PROGRESS,r),t.load().catch(t.onLoadError))};this.adPlayer.on(vs.event.AD_PROGRESS,r)}},n.prototype.respondToAdComplete=function(){this.adDataProxy.resetAd()},n.prototype.respondToAdLoaded=function(t){this.adDataProxy.adInfo=t},n.prototype.respondToAdProgress=function(t){this.notify(Qn.AD_TIME_UPDATE,{currentTime:t.currentTime,duration:t.duration})},n.prototype.respondToAdBreakComplete=function(){this.domProxy&&this.domProxy.showAdContainer(!1),this.presoModel.isCurrentVideoAd=!1,this.notify(Qn.AD_BREAK_COMPLETE)},Object.defineProperty(n.prototype,"adService",{get:function(){return this.facade.retrieveService(Jt.ImaAd)},enumerable:!1,configurable:!0}),n.prototype.assembleAdContextInfo=function(t){var i=this.facade.retrieveService(Jt.System);return{buildEnv:ai.env,platform:i.platform,mutedPlayback:t}},n.prototype.listenToAdPlayer=function(t){var i=this;if(this.adPlayer){var n=vs.event,e=t?"on":"off";for(var r in n)this.adPlayer[e](n[r],t?function(t){return i.hAdPlayerEvent(t)}:null)}},n.prototype.createAdPlayer=function(){var t,i,n=this.facade.retrieveProxy(yn.ResourceProxy).resource,e=this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted,r={presentationContainer:this.domProxy.getMain(),playheadInterface:this.domProxy.getVideo(),initialPlayState:{autoplay:this.presoModel.isAutoplay,muted:e},playAdsAfterTime:this.breaksToSkip&&null!==this.breaksToSkip.match(/^1/)?0:null,adService:this.adService,logger:this.logger,ad:n.ad,adCallUrl:this.getAdCallUrl(n,e),enableStalledAdCheck:!1!==(null===(t=n.ad.ima)||void 0===t?void 0:t.enableStalledAdCheck),stallThreshold:(null===(i=n.ad.ima)||void 0===i?void 0:i.stalledAdThreshold)||5};if(this.adPlayer=new vs(r),this.breaksToSkip){for(var s=this.breaksToSkip.split(",").map((function(t){return parseInt(t)})),u=[],o=s.length;o--;){var a=s[o],c=1===a?"pre_0":"mid_"+String(a-1);u.push(c)}this.adPlayer.markAsPlayed(u)}this.listenToAdPlayer(!0)},n.prototype.getAdCallUrl=function(t,i){var n,e,r=null===(n=t.ad.ima)||void 0===n?void 0:n.adCallUrl,s=!w.isEmpty(r),u=null===(e=t.ad.csai)||void 0===e?void 0:e.adCallUrl,o=!w.isEmpty(u),a=new ds;if(s)return i?a.substituteStringForMutedPlayback(r):r;if(o){var c=this.facade.retrieveService(Jt.System);return function(t,i,n,e){return i.muted&&(t=t.replace(Xr,Yr)),w.template(t,{get RANDOM(){return Jr()},get HOST(){return ts()},get REFERER(){return n?"":is()},get PLAYERINFO(){return"".concat(e.playername_version)},get SDK(){return"".concat(e.ima_sdkv)}},"\\[","\\]")}(u,{autoplay:this.presoModel.isAutoplay,muted:i},!(c.isDesktop||c.isMobile),this.getVersionInfo())}return a.assembleAdCall(t,this.assembleAdContextInfo(i),this.getVersionInfo())},n.prototype.getVersionInfo=function(){var t=this.adService.getSdkVersion(),i=this.getPlayerVersionInfo();return{imafw_ima_sdkv:t,ima_sdkv:t,playername_version:i,imafw_playername_version:i}},n.prototype.killAdPlayer=function(){this.adPlayer&&(this.listenToAdPlayer(!1),this.adPlayer.destroy(),this.adPlayer=null)},n.prototype.onRegister=function(){i.prototype.onRegister.call(this),this.domProxy&&this.domProxy.showAdContainer(!1),this.adDataProxy=new qr(yn.AdDataProxy,null),this.facade.registerProxy(this.adDataProxy)},n}(Hr),As=function(i){function n(t,n){var e=i.call(this,t,n)||this;return e.isReady=!1,e.pUserQualityCategory=null,e}return u(n,i),n.prototype.onRegister=function(){i.prototype.onRegister.call(this);var n=this.facade.retrieveProxy(yn.ModelCollectionProxy);this.contentPlaybackState=n.getModel(Qe.modelName),this.contentPlaybackState.qualityInfo={mode:t.QualityMode.AUTO,quality:null,qualities:[]},this.contentPlaybackState.textTracks={track:null,tracks:[]},this.contentPlaybackState.audioTracks={track:null,tracks:[]},this.pTextTracks={},this.isReady=!0},n.prototype.onRemove=function(){this.contentPlaybackState=null,this.pTextTracks=null,this.thumbnailTrack=null,i.prototype.onRemove.call(this)},n.prototype.processQualityProfile=function(t){this.tagQualities(t),this.contentPlaybackState.qualityInfo.qualities=t},n.prototype.updateQualityProfile=function(t,i,n){var e=n.slice(t,i+1);this.processQualityProfile(e)},n.prototype.updateAudioTracks=function(t,i){var n=this.contentPlaybackState.audioTracks;n.track=t,i&&(n.tracks=i)},n.prototype.addTextTrack=function(t){this.contentPlaybackState.textTracks.tracks.push(t),this.pTextTracks[t.id]=t},n.prototype.getTextTrackById=function(t){return this.pTextTracks[t]},n.prototype.tagQualities=function(t){t.forEach((function(t){t.category||(t.category=["".concat(String(ae.getQualityCategoryForVideoHeight(t.height))),"".concat(t.height,"p"),"".concat(Math.round(t.bitrate/1e3)," kbps")])}))},n.prototype.getThumbnail=function(t){var i;return null===(i=this.thumbnailTrack)||void 0===i?void 0:i.getCueAt(t)},Object.defineProperty(n.prototype,"textTrackInfo",{get:function(){return this.contentPlaybackState.textTracks},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrack",{get:function(){return this.contentPlaybackState.textTracks.track},set:function(t){this.contentPlaybackState.textTracks.track=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isAbrSwitchingAvailable",{get:function(){return!!this.manifestQualities&&this.manifestQualities.length>1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"userQualityCategory",{get:function(){return this.pUserQualityCategory},set:function(t){this.pUserQualityCategory=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qualitySwitchingMode",{get:function(){return this.contentPlaybackState.qualityInfo.mode},set:function(t){this.contentPlaybackState.qualityInfo.mode=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"manifestQualities",{get:function(){return this.contentPlaybackState.manifestQualities},set:function(t){this.contentPlaybackState.manifestQualities=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBandwidth",{set:function(t){this.contentPlaybackState.maxBandwidth=isNaN(this.contentPlaybackState.maxBandwidth)?t:Math.max(t,this.contentPlaybackState.maxBandwidth)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"model",{get:function(){return this.contentPlaybackState},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minIndex",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxIndex",{get:function(){return this.contentPlaybackState.qualityInfo.qualities?this.contentPlaybackState.qualityInfo.qualities.length-1:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minBitrate",{get:function(){return this.contentPlaybackState.qualityInfo.qualities[this.minIndex].bitrate},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBitrate",{get:function(){return this.contentPlaybackState.qualityInfo.qualities[this.maxIndex].bitrate},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qualityInfo",{get:function(){return this.contentPlaybackState.qualityInfo},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"quality",{set:function(t){this.contentPlaybackState.qualityInfo.quality=t},enumerable:!1,configurable:!0}),n}(re),ms=function(t){function i(i,n){return t.call(this,i,n)||this}return u(i,t),i.prototype.mock=function(t){this.pResource=t},i.prototype.onRemove=function(){this.pResource=null,t.prototype.onRemove.call(this)},i.prototype.onRegister=function(){t.prototype.onRegister.call(this),this.pResource=this.data},Object.defineProperty(i.prototype,"resource",{get:function(){return this.pResource},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"location",{get:function(){return this.pResource.location},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"playback",{get:function(){return this.pResource.playback},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"metadata",{get:function(){return this.pResource.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"ad",{get:function(){return this.pResource.ad},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"adTrackingSettings",{get:function(){return this.pResource.ad.viewabilityTracking},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hasValidMediaUrl",{get:function(){return!w.isEmpty(this.location.mediaUrl)},enumerable:!1,configurable:!0}),i}(re),gs=function(i){function n(t,n){var e=i.call(this,t,n)||this;return e.pAdAdapter=null,e.adAdapterStarted=!1,e.contentSegmentStarted=!1,e.contentStartReleased=!1,e.contentCompleteReleased=!1,e.fatalContentErrorReceived=!1,e.presoComplete=!1,e.hasMidRolls=!1,e.pendingSeekTime=null,e.currentAd=null,e.currentBreak=null,e.preloadContent=!1,e}return u(n,i),Object.defineProperty(n.prototype,"adAdapter",{get:function(){return this.pAdAdapter},set:function(t){this.pAdAdapter=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"adInProgress",{get:function(){return this.presoModel.isCurrentVideoAd},enumerable:!1,configurable:!0}),n.prototype.onRemove=function(){var t,n;null===(n=null===(t=this.pAdAdapter)||void 0===t?void 0:t.destroy)||void 0===n||n.call(t),this.pAdAdapter=null,i.prototype.onRemove.call(this)},n.prototype.closeAds=function(){var t,i;null===(t=this.domProxy)||void 0===t||t.showAdContainer(!1),null===(i=this.adAdapter)||void 0===i||i.destroy(),this.pAdAdapter=null},n.prototype.beforePlayOnUserGesture=function(){var t;null===(t=this.adAdapter)||void 0===t||t.playClicked()},n.prototype.start=function(){var t,n,e,r=this.resourceProxy.playback.startTime,s=this.resourceProxy.ad.showPrerollOnNonZeroStart,u=!isNaN(r)&&r>0;if(i.prototype.start.call(this),this.mute(this.presoModel.isMuted),u&&s&&(this.pendingSeekTime=r),this.isClickToPlay)this.setForClickToPlay();else{var o=this.resourceProxy.resource;(null===(n=null===(t=o.ad)||void 0===t?void 0:t.csai)||void 0===n?void 0:n.adCallUrl)&&!(null===(e=o.location)||void 0===e?void 0:e.mediaUrl)?this.play():(this.notify(Qn.VIDEO_LOAD_START),this.prepareForPlayback())}},n.prototype.getAdBreakTimes=function(){var t=[];return this.breakSchedule.forEach((function(i){t.push(a({start:i.startTime,streamTimeStart:i.streamStartTime,end:i.endTime,streamTimeEnd:i.streamStartTime+i.duration,played:i.hasPlayed},i))})),t},n.prototype.getDelegate=function(){return be({},this)},n.prototype.play=function(){var t;if(this.presoModel.started){if(this.adInProgress)return void((null===(t=this.adAdapter)||void 0===t?void 0:t.resume)?this.adAdapter.resume():this.playVideo());this.playVideo()}else this.presoModel.started=!0,this.adAdapterStarted=!0,this.adAdapter.start()},n.prototype.pause=function(){var t;this.adInProgress&&(null===(t=this.adAdapter)||void 0===t?void 0:t.pause)?this.adAdapter.pause():this.pauseVideo()},n.prototype.mute=function(t){var n;return h(this,void 0,void 0,(function(){return l(this,(function(e){return null===(n=this.adAdapter)||void 0===n||n.setMuteState(t),i.prototype.mute.call(this,t),[2]}))}))},n.prototype.setVolume=function(t){var n;null===(n=this.adAdapter)||void 0===n||n.setVolume(t),i.prototype.setVolume.call(this,t)},n.prototype.seek=function(t){var i,n,e=t;if(this.hasMidRolls&&this.adAdapter){var r=this.adAdapter.getPermittedSeekTime(t);r!=t&&(this.pendingSeekTime=(null===(n=(i=this.adAdapter).streamTimeForContentTime)||void 0===n?void 0:n.call(i,t))||r,e=r,this.notify(Qn.SEEK_REDIRECT_START,{requestedSeekTime:t,actualSeekTime:r}))}this.seekVideo(e)},n.prototype.skipAd=function(){var t;null===(t=this.adAdapter)||void 0===t||t.skipAd()},n.prototype.pauseContent=function(){var t;this.pauseVideo(),null===(t=this.domProxy)||void 0===t||t.showAdContainer(!0)},n.prototype.resumeContent=function(){var t,n,e=this;if(this.currentAd=null,this.currentBreak=null,null===(t=this.domProxy)||void 0===t||t.showAdClickElement(!1),null===(n=this.domProxy)||void 0===n||n.showAdContainer(!1),this.fatalContentErrorReceived)this.notify(Qn.DISABLE_UI);else if(this.hasContent&&!this.contentComplete)if(this.contentSegmentStarted)this.resumeContentPlayComplete();else{if(!this.contentStartReleased){var r=this.resourceProxy.playback.startTime;if(!isNaN(r)&&r>0){var s=this.getAdBreakTimes(),u=this.adjustStartTimeForAdBreakProximity(r,s);this.resourceProxy.playback.startTime=u}}this.load().then((function(){e.resumeContentPlayComplete()})).catch(this.onLoadError)}else i.prototype.respondToVideoEnd.call(this)},n.prototype.streamIdAvailable=function(t){this.notify(Qn.STREAM_ID_AVAILABLE,{streamId:t})},n.prototype.applyHook=function(t,i){var n=this;return new Promise((function(e){n.getProxy(yn.HookProxy).applyHook(t,i).then((function(t){return e(t)}))}))},n.prototype.adSegmentStarted=function(){this.contentSegmentStarted=!1,this.presoModel.isCurrentVideoAd=!0,this.notify(Qn.AD_SEGMENT_START)},n.prototype.adSegmentEnded=function(){this.contentSegmentStarted=!1,this.presoModel&&(this.presoModel.isCurrentVideoAd=!1),this.notify(Qn.AD_SEGMENT_END)},n.prototype.adBreaksAvailable=function(i){this.hasMidRolls=i.some((function(i){return i.type===t.AdBreakType.MID})),this.breakSchedule=i;var n=i.map((function(t){return t.startTime}));this.notify(Qn.AD_CUEPOINTS_AVAILABLE,{cuepoints:n})},n.prototype.seekToStreamTime=function(t){this.seekVideo(t)},n.prototype.adBreakStart=function(){var t;this.endContentSegment(),this.updateSize(),null===(t=this.domProxy)||void 0===t||t.showAdContainer(!0),this.presoModel.isCurrentVideoAd=!0,this.setAdPlaying(),this.notify(Qn.AD_BREAK_START)},n.prototype.adBreakMetadata=function(t){this.currentBreak=t,this.notify(Qn.AD_BREAK_METADATA,{adBreakInfo:t})},n.prototype.adLoaded=function(){},n.prototype.adStart=function(t){this.currentAd=t,this.notify(Qn.AD_START,{adInfo:t})},n.prototype.adProgress=function(t,i){this.notify(Qn.AD_TIME_UPDATE,{currentTime:t,duration:i,streamTime:this.presoModel.streamTime,streamDuration:this.presoModel.streamDuration}),this.checkPreload(t,i)},n.prototype.adFirstQuartile=function(){this.notify(Qn.AD_FIRST_QUARTILE)},n.prototype.adMidpoint=function(){this.notify(Qn.AD_MIDPOINT)},n.prototype.adThirdQuartile=function(){this.notify(Qn.AD_THIRD_QUARTILE)},n.prototype.adComplete=function(){this.currentAd=null,this.notify(Qn.AD_COMPLETE)},n.prototype.adBreakComplete=function(){var t,i;if(this.currentBreak=null,this.currentAd=null,null===(t=this.domProxy)||void 0===t||t.showAdContainer(!1),null===(i=this.domProxy)||void 0===i||i.showAdClickElement(!1),this.presoModel.isCurrentVideoAd=!1,this.notify(Qn.AD_BREAK_COMPLETE),this.pendingSeekTime){var n=this.pendingSeekTime;this.pendingSeekTime=null,this.contentPlaybackStateProxy.model.started&&this.notify(Qn.SEEK_REDIRECT_COMPLETE),this.seekVideo(n)}},n.prototype.adClicked=function(){var i,n;(null===(n=null===(i=this.contentPlaybackStateProxy)||void 0===i?void 0:i.model)||void 0===n?void 0:n.state)===t.PlaybackState.PLAYING&&this.pause()},n.prototype.adError=function(t){this.currentAd=null,t.message||(t.message=Mi.messages.UNSPECIFIED_ERROR),this.notify(Qn.AD_ERROR,t)},n.prototype.adPaused=function(){this.respondToPlaybackStateChange(t.PlaybackState.PAUSED),this.notify(Qn.AD_PAUSED)},n.prototype.adResumed=function(){this.notify(Qn.AD_BUFFERING,{value:!1}),this.notify(Qn.AD_PLAYING)},n.prototype.adStalled=function(){this.notify(Qn.AD_STALLED)},n.prototype.adBreakDiscarded=function(){this.notify(Qn.AD_BREAK_DISCARDED)},n.prototype.adSkipped=function(){this.notify(Qn.AD_SKIPPED)},n.prototype.allAdsComplete=function(){this.hasMidRolls=!1},n.prototype.adBuffering=function(t){},n.prototype.displayAdClickElement=function(){var t;null===(t=this.domProxy)||void 0===t||t.showAdClickElement(!0)},n.prototype.resumeContentPlayComplete=function(){this.pendingSeekTime&&(this.notify(Qn.SEEK_REDIRECT_COMPLETE),this.seekVideo(this.pendingSeekTime),this.pendingSeekTime=null),this.play()},n.prototype.handleNotification=function(t){var n=t.name;switch(n){case Qn.FULLSCREEN_EXIT:case Qn.FULLSCREEN_ENTER:this.adAdapter.setFullscreenState(n==Qn.FULLSCREEN_ENTER)}i.prototype.handleNotification.call(this,t)},n.prototype.updateSize=function(){var t,i=null===(t=this.domProxy)||void 0===t?void 0:t.getPresentationRect();i&&this.adAdapter.updateSize(i)},n.prototype.respondToSizeChange=function(){this.updateSize()},n.prototype.respondToId3Data=function(t){t.info&&(t.msg=t.info),this.adAdapter.handleTimedMetadata(t),i.prototype.respondToId3Data.call(this,t)},n.prototype.respondToVideoPaused=function(){i.prototype.respondToVideoPaused.call(this),this.adInProgress?this.notify(Qn.AD_PAUSED):(this.respondToPlaybackStateChange(t.PlaybackState.PAUSED),this.setPausedState(),this.notify(Qn.CONTENT_PAUSED))},n.prototype.respondToVideoPlaying=function(){i.prototype.respondToVideoPlaying.call(this),this.adAdapterStarted||(this.adAdapterStarted=!0,this.adAdapter.start()),this.contentPlaybackStateProxy.model.time>.5&&(this.adInProgress?this.notify(Qn.AD_PLAYING):this.contentSegmentStarted&&(this.respondToPlaybackStateChange(t.PlaybackState.PLAYING),this.setPlayingState(),this.notify(Qn.CONTENT_PLAYING)))},n.prototype.respondToVideoTimeUpdate=function(n){var e,r,s,u,o,a=this.contentPlaybackStateProxy.model;this.presoModel.streamTime=n,null===(e=this.adAdapter)||void 0===e||e.setStreamTime(n),a.time=(null===(r=this.adAdapter)||void 0===r?void 0:r.contentTimeForStreamTime)?null===(s=this.adAdapter)||void 0===s?void 0:s.contentTimeForStreamTime(n):n,this.adInProgress||(n>.75&&!this.contentSegmentStarted&&(a.started=!0,null===(u=this.domProxy)||void 0===u||u.showAdClickElement(!1),null===(o=this.domProxy)||void 0===o||o.showAdContainer(!1),this.setPlayingState(),this.setTransportType(),!this.contentStartReleased&&this.signalContentStart(),this.contentSegmentStarted=!0,this.hasMidRolls||a.streamType==t.StreamType.LIVE||a.streamType==t.StreamType.DVR?this.notify(Qn.CONTENT_SEGMENT_START):this.notify(Qn.CONTENT_PLAYING)),this.contentSegmentStarted&&i.prototype.respondToVideoTimeUpdate.call(this,n),a.streamType!==t.StreamType.LIVE&&a.time>=a.duration&&!this.contentCompleteReleased&&this.signalContentComplete())},n.prototype.endContentSegment=function(){this.contentSegmentStarted&&(this.contentSegmentStarted=!1,this.notify(Qn.CONTENT_SEGMENT_END))},n.prototype.respondToVideoEnd=function(){this.contentComplete=!0,this.contentCompleteReleased||this.signalContentComplete(),this.presoComplete=!0,i.prototype.respondToVideoEnd.call(this)},n.prototype.respondToDurationChange=function(t){var i,n;if(t&&!isNaN(t)&&t>0){this.adAdapter.setStreamDuration(t),this.presoModel.streamDuration=t;var e=(null===(n=(i=this.adAdapter).contentTimeForStreamTime)||void 0===n?void 0:n.call(i,t))||t;this.contentPlaybackStateProxy.model.duration=e,this.contentDurationReleased||this.releaseContentDuration(t)}},n.prototype.respondToError=function(t){this.fatalContentErrorReceived=t.fatal,i.prototype.respondToError.call(this,t)},n.prototype.isContentComplete=function(){return this.presoComplete},n.prototype.startContentSegment=function(){var t;this.contentSegmentStarted=!0,this.contentPlaybackStateProxy.model.started=!0,null===(t=this.domProxy)||void 0===t||t.showAdContainer(!1),this.setPlayingState(),this.contentStartReleased||(this.contentStartReleased=!0,this.notify(Qn.CONTENT_START)),i.prototype.startContentSegment.call(this),this.notify(Qn.CONTENT_SEGMENT_START)},n.prototype.checkPreload=function(t,i){var n,e,r=!0===this.resourceProxy.ad.csai.preloadContentAtEndOfPreRoll,s=this.facade.retrieveService(Jt.System);if(r){var u=(null===(n=this.currentAd)||void 0===n?void 0:n.adPosition)===(null===(e=this.currentBreak)||void 0===e?void 0:e.adTotal);if(r&&u&&!s.isIos){var o=w.clampValue(Math.ceil(i/4),2,10);Math.round(t)>=o&&this.load().catch(this.onLoadError)}}},n.prototype.signalContentStart=function(){this.contentStartReleased=!0,this.notify(Qn.CONTENT_START)},n.prototype.signalContentComplete=function(){this.contentCompleteReleased=!0,this.contentSegmentStarted&&this.notify(Qn.CONTENT_SEGMENT_END),this.notify(Qn.CONTENT_COMPLETE)},n.prototype.listNotificationInterests=function(){return i.prototype.listNotificationInterests.call(this).concat([Qn.FULLSCREEN_ENTER,Qn.FULLSCREEN_EXIT,Qn.PRESENTATION_SIZE_CHANGE])},n.prototype.onRegister=function(){var t,n;i.prototype.onRegister.call(this),null===(t=this.domProxy)||void 0===t||t.showAdContainer(!1),null===(n=this.domProxy)||void 0===n||n.showAdClickElement(!1)},c([de()],n.prototype,"pauseContent",null),c([de()],n.prototype,"resumeContent",null),c([de()],n.prototype,"streamIdAvailable",null),c([de()],n.prototype,"applyHook",null),c([de()],n.prototype,"adSegmentStarted",null),c([de()],n.prototype,"adSegmentEnded",null),c([de()],n.prototype,"adBreaksAvailable",null),c([de()],n.prototype,"seekToStreamTime",null),c([de()],n.prototype,"adBreakStart",null),c([de()],n.prototype,"adBreakMetadata",null),c([de()],n.prototype,"adLoaded",null),c([de()],n.prototype,"adStart",null),c([de()],n.prototype,"adProgress",null),c([de()],n.prototype,"adFirstQuartile",null),c([de()],n.prototype,"adMidpoint",null),c([de()],n.prototype,"adThirdQuartile",null),c([de()],n.prototype,"adComplete",null),c([de()],n.prototype,"adBreakComplete",null),c([de()],n.prototype,"adClicked",null),c([de()],n.prototype,"adError",null),c([de()],n.prototype,"adPaused",null),c([de()],n.prototype,"adResumed",null),c([de()],n.prototype,"adStalled",null),c([de()],n.prototype,"adBreakDiscarded",null),c([de()],n.prototype,"adSkipped",null),c([de()],n.prototype,"allAdsComplete",null),c([de()],n.prototype,"adBuffering",null),c([de()],n.prototype,"displayAdClickElement",null),n}(Hr),ps=function(t){function i(i,n){return t.call(this,i,n)||this}return u(i,t),i.prototype.start=function(){var t=this.presoModel;this.uiMediator&&this.uiMediator.setMuteState(t.isMuted),this.isClickToPlay?this.setForClickToPlay():this.notify(Qn.VIDEO_LOAD_START)},i.prototype.respondToVideoPlaying=function(){var i=!1;this.contentPlaybackStateProxy.model.started=!0,this.presoModel.started||(this.presoModel.started=!0,this.started=!0,this.uiMediator&&(this.uiMediator.displayPoster(!1),this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted&&this.uiMediator.showUnmutePrompt(),this.notify(Qn.ENABLE_UI),this.uiMediator.setFullScreenAccessRestricted(!1),this.uiMediator.enableFullscreen(),this.setTransportType()),i=!0),t.prototype.respondToVideoPlaying.call(this),this.setPlayingState(),i&&this.notify(Qn.CONTENT_START),this.notify(Qn.CONTENT_PLAYING)},i.prototype.respondToVideoTimeUpdate=function(i){if(!this.contentComplete){var n=this.contentPlaybackStateProxy.model;this.presoModel.started&&(this.presoModel.streamTime=i,n.time=i,t.prototype.respondToVideoTimeUpdate.call(this,i))}},i.prototype.respondToVideoPaused=function(){t.prototype.respondToVideoPaused.call(this),this.setPausedState(),this.notify(Qn.CONTENT_PAUSED)},i.prototype.respondToIsPlayingLiveChange=function(i){this.uiMediator&&this.uiMediator.setIsPlayingLive(i),t.prototype.respondToIsPlayingLiveChange.call(this,i)},i.prototype.respondToVideoEnd=function(){this.contentComplete=!0,this.notify(Qn.CONTENT_COMPLETE),t.prototype.respondToVideoEnd.call(this)},i.prototype.respondToDurationChange=function(t){this.presoModel.streamDuration=t,this.contentPlaybackStateProxy.model.duration=t,this.contentDurationReleased||this.releaseContentDuration(t)},i.prototype.onRegister=function(){t.prototype.onRegister.call(this),this.domProxy&&this.domProxy.showAdContainer(!1),!this.isClickToPlay&&this.prepareForPlayback()},i}(Hr),ys=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(t){var i=this,n=this.facade.retrieveService(Jt.System),e=t.body;if(n.global&&n.global.document){var r=this.getModel(Kn.PresentationState),s=this.getModel(Kn.PlayerOptions),u=this.isAutoplayRequested(s.autoplay);this.facade.registerProxy(new As(yn.ContentPlaybackStateProxy)),n.isWebMaf||n.isTizenSmartTv||n.isXboxOne?(this.processAutoplaySupport({supportsMutedAutoplay:!0,supportsUnmutedAutoplay:!0},r,s),this.createPresentation(n,e,r,s)):!r.skipAutoplayCheck&&u?this.checkAutoplay(s).then((function(t){i.processAutoplaySupport(t,r,s),i.createPresentation(n,e,r,s)})):this.createPresentation(n,e,r,s)}else this.sendNotification(Qn.VIDEO_START_ERROR,{error:Mi.messages.ENVIRONMENT_NOT_SUPPORTED,fatal:!0})},n.prototype.createPresentation=function(t,i,n,e){return h(this,void 0,void 0,(function(){var r;return l(this,(function(s){switch(s.label){case 0:return[4,this.getPresoMediator(t,i,n,e)];case 1:return(r=s.sent())?(this.facade.registerMediator(r),this.sendNotification(Qn.START_PRESENTATION),[2]):[2]}}))}))},n.prototype.getPresoMediator=function(i,n,e,r){var s;return h(this,void 0,void 0,(function(){var u,o,a,c,h,f,d,v,b,A,m,g,p;return l(this,(function(l){switch(l.label){case 0:if(u=this.facade.retrieveProxy(yn.PlayerDomProxy),o=this.getVideo(i,u,r),a=n.ad,c=a&&a.context||null,h=Un.PRESENTATION_MEDIATOR,f=null,null===o)return this.sendNotification(Qn.RESOURCE_ERROR,{code:t.ErrorCode.UNEXPECTED_CONDITION,message:Mi.messages.VIDEO_PLAYBACK_UNAVAILABLE,fatal:!0}),[2,f];switch((c&&c!==t.AdContext.NONE||e.isAutoplay)&&(null==u||u.setVideoAttribute("playsinline","")),c){case t.AdContext.IMA:case t.AdContext.IMA_AD_ONLY:return[3,1];case t.AdContext.DAI_SDK:case t.AdContext.DAI_API:return[3,2];case t.AdContext.DAI_SSB:return[3,3]}return[3,4];case 1:return(d=this.createImaAdService(n))?f=new bs(h,o):this.sendNotification(Qn.RESOURCE_ERROR,{code:t.ErrorCode.IMA_SDK_MISSING,message:Mi.messages.IMA_SDK_MISSING,fatal:!0}),[3,12];case 2:return v=c===t.AdContext.DAI_API,(d=this.createDaiAdService(u,n,v,i))&&(f=new as(h,o)),!d&&this.sendNotification(Qn.RESOURCE_ERROR,{code:t.ErrorCode.DAI_SDK_MISSING,message:Mi.messages.DAI_SDK_UNAVAILABLE,fatal:!0}),[3,12];case 3:return a.dai.ssbStreamUrl&&(n.location.mediaUrl=a.dai.ssbStreamUrl),f=new ps(h,o),[3,12];case 4:if(!0!==a.enabled)return[3,10];l.label=5;case 5:return l.trys.push([5,8,,9]),b=new gs(h,o),A=b.getDelegate(),[4,this.facade.retrieveProxy(yn.AdapterProxy).createAdapter(t.AdapterRole.AD,n,(function(){return A}))];case 6:return m=l.sent(),b.adAdapter=m,[4,null===(s=m.getResource)||void 0===s?void 0:s.call(m)];case 7:return(g=l.sent())&&(n=g),f=b,[3,9];case 8:return p=l.sent(),this.sendNotification(Qn.RESOURCE_ERROR,{code:t.ErrorCode.AD_ADAPTER_ERROR,message:p.message,data:p,fatal:!0}),[3,9];case 9:return[3,11];case 10:f=new ps(h,o),l.label=11;case 11:return[3,12];case 12:return this.createResourceProxy(n),[2,f]}}))}))},n.prototype.createResourceProxy=function(t){var i=new ms(yn.ResourceProxy,t);this.facade.registerProxy(i)},n.prototype.createDaiAdService=function(t,i,n,e){var r,s,u,o,a,c;if(this.facade.retrieveService(Jt.DaiAd))return!0;var h=this.getModel(Kn.PlayerOptions);n||!0!==h.enableOm||null===(c=null===(a=null===(o=null===(u=null===(s=null===(r=e.global)||void 0===r?void 0:r.google)||void 0===s?void 0:s.ima)||void 0===u?void 0:u.dai)||void 0===o?void 0:o.api)||void 0===a?void 0:a.DaiSdkSettings)||void 0===c||c.setFeatureFlags({enableOmidBeta:!0});var l=new Tr(Jt.DaiAd,n?kr:null);if(this.facade.registerService(l),!l.sdk)return l.destroy(),this.facade.removeService(Jt.DaiAd),!1;var f=i.ad.viewabilityTracking;t&&l.setContainer(t.getElement(Fn.AD_CONTAINER));var d=n?e.createSimpleVideoInterface():t.getVideo();return l.setVideoInterface(d),l.setTrackingData({pageType:f.pageType,viewGuid:f.viewGuid,partner:f.partner}),!0},n.prototype.getVideoInterface=function(t){return t.createSimpleVideoInterface()},n.prototype.getVideo=function(t,i,n){var e;return t.isWebMaf?t.webMafPlayer:i?(!1===(null===(e=n.overrides)||void 0===e?void 0:e.reuseVideoElement)&&i.recreateVideo(),i.getVideo()):null},n.prototype.createImaAdService=function(t){var i;if(this.facade.retrieveService(Jt.ImaAd))return!0;var n=new ls(Jt.ImaAd);this.facade.registerService(n);var e=n.sdk;if(null!==e){var r=this.facade.retrieveProxy(yn.PlayerDomProxy),s=r.getElement(Fn.AD_CONTAINER),u=this.getModel(Kn.PlayerOptions);!0===u.enableOm&&(null===(i=e.settings)||void 0===i||i.setFeatureFlags({enableOmidBeta:!0})),n.setContainer(s),n.adsLoaderOptions={enableOm:!0===u.enableOm,adContainer:s,adClickEl:r.getElement(Fn.AD_CLICK_EL),video:r.getVideo(),sdkSettings:n.sdkSettings,adService:n};var o=t.ad.viewabilityTracking;return n.setTrackingData({pageType:o.pageType,viewGuid:o.viewGuid,partner:o.partner}),n.createAdsLoader(),!0}return this.facade.removeService(Jt.ImaAd),!1},n.prototype.processAutoplaySupport=function(i,n,e){var r=e.autoplay,s=i.supportsMutedAutoplay,u=i.supportsUnmutedAutoplay,o=r===t.Autoplay.ATTEMPT_MUTED||r===t.Autoplay.ATTEMPT_UNMUTED_THEN_MUTED,a=r===t.Autoplay.ATTEMPT_UNMUTED,c=o&&!s||a&&!u;!n.isAutoplay&&c&&this.sendNotification(Qn.AUTOPLAY_BLOCKED,new Error("Autoplay capability conflict."),Hn.INTERNAL),n.autoplaySupport={supportsMutedAutoplay:s,supportsUnmutedAutoplay:u},n.isMuteAtPlayStart=r===t.Autoplay.ATTEMPT_MUTED&&s||r===t.Autoplay.ATTEMPT_UNMUTED_THEN_MUTED&&!u&&s,n.isAutoplay=this.shouldAutoplay(r,i)},n.prototype.isAutoplayRequested=function(i){return!w.isEmpty(i)&&i!==t.Autoplay.NONE},n.prototype.shouldAutoplay=function(i,n){if(w.isEmpty(i)||i===t.Autoplay.NONE)return!1;var e=n.supportsMutedAutoplay,r=n.supportsUnmutedAutoplay,s=i===t.Autoplay.ATTEMPT_MUTED&&e,u=i===t.Autoplay.ATTEMPT_UNMUTED&&r,o=!u&&i===t.Autoplay.ATTEMPT_UNMUTED_THEN_MUTED&&e;return s||u||o},n.prototype.checkAutoplay=function(t){var i;return this.getService(Jt.AutoplayCapabilities).detectCapabilities(null===(i=t.overrides)||void 0===i?void 0:i.blankVideoUrl)},n}(ge),ks=function(){function i(){}return i.validate=function(t){if(w.isEmpty(t))return{error:!0,msg:Mi.messages.RESOURCE_MISSING};var i=this.hasRootKeys(t);if(i.error)return i;var n=this.canAccessMedia(t,t.ad.enabled);return n.error?n:{error:!1,msg:""}},i.hasRootKeys=function(t){var i=[],n=new Wn,e=null;return Object.keys(n).forEach((function(n){n in t||i.push(n)})),i.length&&(e="One or more configuration properties not found: ".concat(i.join(", "))),{error:!!e,msg:e}},i.canAccessMedia=function(i,n){var e=!w.isEmpty(i.location.cms),r=!w.isEmpty(i.location.tokenMap)||!w.isEmpty(i.location.cmsUri),s=!w.isEmpty(i.location.mediaUrl)||i.ad.context===t.AdContext.IMA_AD_ONLY,u=!i.ad.context&&!n&&s||i.ad.context===t.AdContext.DAI_SSB&&!w.isEmpty(i.ad.dai.ssbStreamUrl),o=this.hasValidDaiSettings(i,n),a=!(u||s||e&&r),c=o.error?o.msg:a?"Media not specified":"";return{error:a&&o.error,msg:c}},i.hasValidDaiSettings=function(i,n){var e,r,s=i.ad,u=null==s?void 0:s.ssai,o=null==s?void 0:s.dai,a=null==s?void 0:s.context,c=!1,h="";if(!s)return{error:c,msg:h};var l=null,f=!1;return(null==o?void 0:o.assetKey)||(null==o?void 0:o.contentSourceId)||o.ssbStreamUrl&&a==t.AdContext.DAI_SSB?l=o:((null==u?void 0:u.assetKey)||(null==u?void 0:u.contentSourceId))&&(l=u,f=!0),n||!a?{error:c,msg:h}:(a===t.AdContext.DAI_SDK||a===t.AdContext.DAI_API?l.isLive?(c=w.isEmpty(l.assetKey),h="Missing assetKey"):(c=f&&w.isEmpty(l.videoId)||!f&&w.isEmpty(l.daiVideoId),h="Missing video id"):a===t.AdContext.DAI_SSB&&(c=!f&&w.isEmpty(l.ssbStreamUrl)&&w.isEmpty(null===(e=i.location)||void 0===e?void 0:e.mediaUrl)||f&&w.isEmpty(null===(r=i.location)||void 0===r?void 0:r.mediaUrl),h="Missing asset url for SSB"),{error:c,msg:c?h:""})},i}(),Os=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(t){switch(t.name){case Qn.PREP_RESOURCE_COLLECTION:this.prepResourceCollection(t);break;case Qn.REGISTER_RESOURCE:this.registerResource(t)}},n.prototype.prepResourceCollection=function(t){if(t.body.resource){var i=new Wn(t.body.resource);this.validateResource(i)}else this.invalidResource(Mi.messages.RESOURCE_MISSING)},n.prototype.validateResource=function(t){var i=ks.validate(t);i.error?this.invalidResource(i.msg):this.facade.sendNotification(this.cmsDataRetrievalRequired(t)?Qn.RETRIEVE_RESOURCE:Qn.TRANSFORM_RESOURCE,{resource:t},Hn.INTERNAL)},n.prototype.registerResource=function(t){var i=t.body.resource;this.facade.sendNotification(Qn.PLAY_RESOURCE,i,Hn.INTERNAL)},n.prototype.cmsDataRetrievalRequired=function(t){return!(w.isEmpty(t.location.cms)||w.isEmpty(t.location.tokenMap)&&w.isEmpty(t.location.cmsUri))},n.prototype.invalidResource=function(i){this.log(t.LogLevel.ERROR,Mi.messages.INVALID_RESOURCE),this.facade.sendNotification(Qn.RESOURCE_ERROR,{message:"".concat(Mi.messages.INVALID_RESOURCE,": ").concat(i),code:t.ErrorCode.INVALID_RESOURCE_FORMAT,fatal:!0},Hn.INTERNAL)},n}(ge),ws=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return u(i,t),i.prototype.execute=function(t){var i;switch(t.name){case Qn.RESOURCE_COMPLETE:var n=this.getProxy(yn.Playlist);return void(n&&n.next());case Qn.RESOURCE_END:case Qn.RESOURCE_INTERRUPTED:this.facade.retrieveMediator(Un.TIMER_MEDIATOR).killTimer(),this.sendNotification(Qn.KILL_RESOURCE_PRESENTATION);var e=this.facade.retrieveMediator(Un.UI);e&&e.resetUi();break;case Qn.CONTENT_BUFFERING:case Qn.AD_BUFFERING:var r=this.facade.retrieveProxy(yn.PlayerDomProxy),s=null==r?void 0:r.getMain();null==s||s.setAttribute("aria-busy",t.body.value.toString());break;case Qn.AD_BREAK_START:var u=this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR);null===(i=null==u?void 0:u.adapter)||void 0===i||i.clearCue()}this.sendNotification(Qn.APP_EVENT,{notificationName:t.name,data:t.body})},i}(ge),Ts=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return u(i,t),i.prototype.execute=function(t){var i=t.name,n=t.body,e=this.facade.retrieveProxy(yn.PlayerDomProxy);if(e){var r=e.getMain();r.setAttribute("role","region");var s=r.getAttribute("tabindex")||"0";r.setAttribute("tabindex",s)}this.sendNotification(Qn.APP_EVENT,{notificationName:i,data:n})},i}(ge),Es=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return u(i,t),i.prototype.execute=function(t){var i=this.getModel(Kn.PresentationState),n=this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR);i.suspended=!1,n.resume();var e=this.getProxy(yn.ContentPlaybackStateProxy);this.sendNotification(Qn.PLAYBACK_RESUMED,{contentTime:e.model.time})},i}(ge),js=function(){function t(t){var i=t.errorRecovery||null,n=null;if(t.url)this.retrieveResource(t.url,t.responseType,t.callback,i,t.timeout);else if(t.uriTemplate&&t.tokenMap){var e=this.replaceUriTokens(t.uriTemplate,t.tokenMap);this.retrieveResource(e,t.responseType,t.callback,i,t.timeout)}else n="Invalid options passed to CmsDataRetriever.";n&&t.callback&&t.callback(null,{status:0,error:!0,url:"n/a",message:n})}return t.prototype.replaceUriTokens=function(t,i){var n=t;if(i)for(var e in i)n=n.replace(e,i[e]);return n},t.prototype.retrieveResource=function(t,i,n,e,r){void 0===e&&(e=null),Zt({responseType:i,timeout:r,url:t,errorRecovery:e}).then((function(t){return null==n?void 0:n(t,null)})).catch((function(t){return null==n?void 0:n(null,t)}))},t}(),Ns=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(i){var n=this,e=i.body.resource,r=e&&e.location,s=r&&r.cms||null,u=this.getConfig(s);if(u&&(u.uriTemplate&&r.tokenMap||r.cmsUri)){var o=this.getModel(Kn.PlayerOptions),a={uriTemplate:u.uriTemplate,tokenMap:r&&r.tokenMap||null,url:r&&r.cmsUri||null,responseType:u.responseType,errorRecovery:o.networkErrorRecovery,timeout:u.timeout||o.networkTimeout,callback:function(i,r){if(r)return n.log(t.LogLevel.ERROR,r.status,r.message),void n.sendNotification(Qn.RESOURCE_ERROR,{code:t.ErrorCode.SELECTOR_CALL_ERROR,message:r.message,fatal:!0},Hn.INTERNAL);n.sendNotification(Qn.TRANSFORM_RESOURCE,{resource:e,data:i},Hn.INTERNAL)}};new js(a)}else this.log(t.LogLevel.ERROR,"RetrieveResourceCommand: ".concat(Mi.messages.UNEXPECTED_CONDITION,"; CMS config error."))},n.prototype.getConfig=function(t){var i=this.getModel(Kn.PlayerOptions).dataTransformers;return t&&i&&i[t]&&i[t].objectRef&&i[t].responseType?i[t]:null},n}(ge),Ss=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return u(i,t),i.prototype.execute=function(t){var i=this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR);this.sendNotification(Qn.RESOURCE_START),i.start()},i}(ge),Rs=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return u(i,t),i.prototype.execute=function(t){var i=this.getModel(Kn.PresentationState);this.facade.retrieveMediator(Un.PRESENTATION_MEDIATOR).suspend(),i.suspended=!0;var n=this.getProxy(yn.ContentPlaybackStateProxy);this.sendNotification(Qn.PLAYBACK_SUSPENDED,{contentTime:n.model.time})},i}(ge),Is=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return u(n,i),n.prototype.execute=function(t){var i,n,e=this,r=t.body.resource,s=t.body.data||null,u=null===(n=null===(i=this.getModel(Kn.PlayerOptions).dataTransformers)||void 0===i?void 0:i[r.location.cms])||void 0===n?void 0:n.objectRef;Promise.resolve().then((function(){return u?e.transform(r,s,u):r})).then((function(t){e.sendNotification(Qn.REGISTER_RESOURCE,{resource:t},Hn.INTERNAL)})).catch((function(t){var i=e.getCodeForError(t),n=t.message||Mi.messages.CMS_RESOURCE_UNAVAILABLE;e.sendNotification(Qn.RESOURCE_ERROR,{code:i,message:n,fatal:!0},Hn.INTERNAL)}))},n.prototype.transform=function(i,n,e){var r,s=w.isFunction(e.transform)?e:new e,u=null===(r=s.transform)||void 0===r?void 0:r.call(s,n,i);return Promise.resolve(u).then((function(i){if(null==i?void 0:i.error)throw i.data;var n=ks.validate(i);if(n.error){var e=new Error(n.msg);throw e.code=t.ErrorCode.INVALID_RESOURCE_FORMAT,e}return i}))},n.prototype.getCodeForError=function(i){return"mpx"===i.cms?this.getCodeForMpxError(i):i.code?i.code:t.ErrorCode.RESOURCE_UNAVAILABLE},n.prototype.getCodeForMpxError=function(i){switch(i?i.exception:null){case"DomainBlocked":return t.ErrorCode.DOMAIN_BLOCKED;case"GeoLocationBlocked":return t.ErrorCode.GEO_LOCATION_BLOCKED;case"IpBlocked":return t.ErrorCode.IP_BLOCKED;case"SatelliteProviderBlocked":return t.ErrorCode.SATELLITE_PROVIDER_BLOCKED;case"Expired":return t.ErrorCode.EXPIRED;default:return t.ErrorCode.RESOURCE_UNAVAILABLE}},n}(ge),Cs=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.copyNoticeStyle="position: absolute; z-Index: 900000000; top: 0; right: 0; width: 180px; background: #fc0; color: #000; font-family: Arial, sans-serif; text-align: center; height: 64px; line-height: 64px; font-size: 32px",i}return u(i,t),i.prototype.execute=function(t){var i=t.body&&t.body.action;switch(i){case ri.DIAGNOSTIC_PLUGIN:var n=this.facade.retrieveMediator(Un.PLUGIN_MEDIATOR);n&&n.toggleDiagnosticPlugin();break;case ri.CONFIG_TO_CLIPBOARD:case ri.CONFIG_TO_TEST_PAGE:var e=i===ri.CONFIG_TO_CLIPBOARD,r=this.getSerializedData();e&&(this.copyToClipboard(r),this.displayCopyNotice());break;default:this.sendNotification(Qn.APP_EVENT,{notificationName:t.name,data:t.body})}},i.prototype.displayCopyNotice=function(){var t=this.facade.retrieveProxy(yn.PlayerDomProxy).getMain(),i=document.createElement("div");i.setAttribute("style",this.copyNoticeStyle),i.innerHTML="Copied!",t.appendChild(i),setTimeout((function(){return t.removeChild(i)}),2500)},i.prototype.copyToClipboard=function(t){var i=document.createElement("textarea");i.setAttribute("style","position: absolute; top: -120px;"),document.body.appendChild(i),i.value=t,i.select(),document.execCommand("copy"),document.body.removeChild(i)},i.prototype.getSerializedData=function(){return this.facade.retrieveMediator(Un.APPLICATION).getConfigAsJson()},i}(ge),Ps=((fs={})[Qn.DEFAULT]=null,fs[Qn.BOOT_APP]=or,fs[Qn.READY]=Ts,fs[Qn.PLAY_ON_USER_GESTURE]=vr,fs[Qn.PLAY]=vr,fs[Qn.PAUSE]=vr,fs[Qn.STOP]=vr,fs[Qn.SEEK]=vr,fs[Qn.SEEK_FORWARD]=vr,fs[Qn.SEEK_BACK]=vr,fs[Qn.SEEK_TO_LIVE]=vr,fs[Qn.MUTE]=vr,fs[Qn.UNMUTE]=vr,fs[Qn.VOLUME_CHANGE]=vr,fs[Qn.SWITCH_AUDIO_TRACK]=vr,fs[Qn.SWITCH_TEXT_TRACK]=vr,fs[Qn.SWITCH_TEXT_MODE]=vr,fs[Qn.PLAYBACK_STATE_CHANGE]=ws,fs[Qn.SUSPEND_PLAYBACK]=Rs,fs[Qn.RESUME_PLAYBACK]=Es,fs[Qn.SWITCH_BITRATE]=pe,fs[Qn.SWITCH_QUALITY_CATEGORY]=pe,fs[Qn.AUTO_QUALITY_SWITCHING]=pe,fs[Qn.MIN_BITRATE]=pe,fs[Qn.MAX_BITRATE]=pe,fs[Qn.PREP_RESOURCE_COLLECTION]=Os,fs[Qn.REGISTER_RESOURCE]=Os,fs[Qn.REGISTER_RESOURCE]=Os,fs[Qn.RETRIEVE_RESOURCE]=Ns,fs[Qn.TRANSFORM_RESOURCE]=Is,fs[Qn.START_PRESENTATION]=Ss,fs[Qn.PLAYLIST_ADVANCED]=br,fs[Qn.PLAYLIST_COMPLETE]=br,fs[Qn.PLAYLIST_CLEARED]=br,fs[Qn.PLAYLIST_CURRENT_RESOURCE_CLEARED]=br,fs[Qn.PLAY_RESOURCE]=ys,fs[Qn.KILL_RESOURCE_PRESENTATION]=lr,fs[Qn.RESOURCE_INTERRUPTED]=ws,fs[Qn.VIDEO_START_ERROR]=hr,fs[Qn.VIDEO_PLAYBACK_ERROR]=hr,fs[Qn.RESOURCE_ERROR]=hr,fs[Qn.AD_ERROR]=hr,fs[Qn.AD_STALLED]=hr,fs[Qn.PLAYBACK_SUSPENDED]=ws,fs[Qn.PLAYBACK_RESUMED]=ws,fs[Qn.POSTER_CLICK]=ws,fs[Qn.PLAYLIST_CHANGE]=ws,fs[Qn.RESOURCE_START]=ws,fs[Qn.VIDEO_PROGRESS]=ws,fs[Qn.QUALITY_CHANGE]=ws,fs[Qn.QUALITY_INFO_CHANGE]=ws,fs[Qn.CDN_CHANGE]=ws,fs[Qn.DRM_KEYSYSTEM_CREATED]=ws,fs[Qn.PRESENTATION_SIZE_CHANGE]=ws,fs[Qn.FULLSCREEN_ENTER]=ws,fs[Qn.FULLSCREEN_EXIT]=ws,fs[Qn.CONTENT_TIME_UPDATE]=ws,fs[Qn.CONTENT_BUFFERING]=ws,fs[Qn.CONTENT_START]=ws,fs[Qn.CONTENT_DURATION_AVAILABLE]=ws,fs[Qn.CONTENT_SEGMENT_START]=ws,fs[Qn.CONTENT_PLAYING]=ws,fs[Qn.CONTENT_PAUSED]=ws,fs[Qn.CONTENT_SEEKING]=ws,fs[Qn.CONTENT_SEEKED]=ws,fs[Qn.SEEK_REDIRECT_START]=ws,fs[Qn.SEEK_REDIRECT_COMPLETE]=ws,fs[Qn.CONTENT_SEGMENT_END]=ws,fs[Qn.CONTENT_COMPLETE]=ws,fs[Qn.CONTENT_IS_LIVE_CHANGED]=ws,fs[Qn.STREAM_TYPE_CHANGE]=ws,fs[Qn.STREAM_METADATA]=ws,fs[Qn.STREAM_ID_AVAILABLE]=ws,fs[Qn.RESOURCE_END]=ws,fs[Qn.RESOURCE_COMPLETE]=ws,fs[Qn.AD_SEGMENT_START]=ws,fs[Qn.AD_SEGMENT_END]=ws,fs[Qn.AD_CUEPOINTS_AVAILABLE]=ws,fs[Qn.AD_BREAK_START]=ws,fs[Qn.AD_BREAK_METADATA]=ws,fs[Qn.AD_BREAK_COMPLETE]=ws,fs[Qn.AD_START]=ws,fs[Qn.AD_PAUSED]=ws,fs[Qn.AD_PLAYING]=ws,fs[Qn.AD_TIME_UPDATE]=ws,fs[Qn.AD_FIRST_QUARTILE]=ws,fs[Qn.AD_MIDPOINT]=ws,fs[Qn.AD_THIRD_QUARTILE]=ws,fs[Qn.AD_COMPLETE]=ws,fs[Qn.AD_BREAK_COMPLETE]=ws,fs[Qn.AD_STALLED]=ws,fs[Qn.AD_STALLED]=ws,fs[Qn.AD_BUFFERING]=ws,fs[Qn.AD_CLICK]=ws,fs[Qn.AD_SKIPPED]=ws,fs[Qn.VIDEO_LOAD_COMPLETE]=ws,fs[Qn.METADATA_CUEPOINT]=ws,fs[Qn.TEXT_CUEPOINT]=ws,fs[Qn.TEXT_TRACK_DISPLAY_MODE_CHANGE]=ws,fs[Qn.TEXT_TRACK_CHANGE]=ws,fs[Qn.TEXT_TRACK_INFO_CHANGE]=ws,fs[Qn.TEXT_TRACK_AVAILABLE]=ws,fs[Qn.AUDIO_TRACK_INFO_CHANGE]=ws,fs[Qn.AUDIO_TRACK_CHANGE]=ws,fs[Qn.THUMBNAIL_TRACK_AVAILABLE]=ws,fs[Qn.BEFORE_CONTROLS_VISIBLE]=ws,fs[Qn.BEFORE_CONTROLS_HIDDEN]=ws,fs[Qn.CONTROLS_VISIBLE]=ws,fs[Qn.CONTROLS_HIDDEN]=ws,fs[Qn.MOUSE_ENTER_PRESENTATION]=ws,fs[Qn.MOUSE_LEAVE_PRESENTATION]=ws,fs[Qn.USER_PAUSE]=ws,fs[Qn.USER_SETTINGS_REQUEST]=ws,fs[Qn.AUTOPLAY_BLOCKED]=ws,fs[Qn.PLAYLIST_OUT_OF_RANGE]=ws,fs[Qn.HOTKEY_ACTION]=ws,fs[Qn.CHANGE_LANGUAGE]=fr,fs[Qn.LANGUAGE_CHANGE]=fr,fs[Qn.USER_KEY_COMMAND]=Cs,fs[Qn.METRIC]=dr,fs),_s=function(i){function n(t){var n=i.call(this,w.assign({commandMap:Ps,id:t.playerOptions.id||null},t))||this;return n.pIsReady=!1,n.api=be({},n),n.target=n.api,n.init(),n}return u(n,i),n.prototype.initialize=function(){var i=this,n=this.modelCollectionProxy.getModel(Kn.PlayerOptions),e=n.plugins||[],r=this.getApi(),s={name:Qn.CHANGE_LANGUAGE,body:{value:n.language},type:Hn.INTERNAL};return this.addNativePlugins(e,n),r.registerPlugins(e).then((function(){return i.localization.registerLocalizationData(n.localization),i.sendAsyncNotification(s,[t.PlayerEvent.LANGUAGE_CHANGE])})).then((function(){return i.pIsReady=!0,i.sendNotification(Qn.READY,r),r})).catch((function(t){throw j.error(t),t}))},n.prototype.destroy=function(){var t=this,n=i.prototype.destroy.bind(this);return this.killCurrentResource().then((function(){t.appMediator&&t.appMediator.prepForPlayerRemoval(),t.apiAccessors=null,t.apiMethods=null,n()})).catch((function(t){throw j.error(t),t}))},n.prototype.getApi=function(){return this.api},n.prototype.killCurrentResource=function(){return this.appMediator.killCurrentResource()},n.prototype.hasListenerFor=function(t){return i.prototype.hasListenerFor.call(this,ee.checkEventName(t))},n.prototype.on=function(t,n){i.prototype.on.call(this,ee.checkEventName(t),n)},n.prototype.once=function(t,n){i.prototype.once.call(this,ee.checkEventName(t),n)},n.prototype.off=function(t,n){i.prototype.off.call(this,ee.checkEventName(t),n)},Object.defineProperty(n.prototype,"isReady",{get:function(){return this.pIsReady},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.appId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dimensions",{get:function(){return this.appMediator.getDimensions()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"muted",{get:function(){return this.appMediator.getMuteState()},set:function(t){var i=t?Qn.MUTE:Qn.UNMUTE;this.transmitExtRequest(i)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"volume",{get:function(){return this.appMediator.getVolume()},set:function(t){this.transmitExtRequest(Qn.VOLUME_CHANGE,{value:t})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"language",{get:function(){return this.localization.language},set:function(t){this.transmitExtRequest(Qn.CHANGE_LANGUAGE,{value:t})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contentTime",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.time:0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contentDuration",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.duration:NaN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"streamTime",{get:function(){return this.modelCollectionProxy.getModel(Kn.PresentationState).streamTime},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"streamDuration",{get:function(){return this.modelCollectionProxy.getModel(Kn.PresentationState).streamDuration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playbackState",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.state:t.PlaybackState.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playlist",{get:function(){var t=this.facade.retrieveProxy(yn.Playlist);return t?t.getApi():null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"autoQualitySwitching",{get:function(){return!!this.contentPlaybackStateProxy&&this.contentPlaybackStateProxy.qualitySwitchingMode===t.QualityMode.AUTO},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest(Qn.AUTO_QUALITY_SWITCHING,{value:t}):this.log(Mi.messages.CONTENT_PLAYBACK_SETTING_IGNORED)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qualityInfo",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.qualityInfo:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bitrate",{get:function(){var t=this.qualityInfo.quality||{bitrate:NaN};return null!=t.bitrate?t.bitrate:NaN},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest(Qn.SWITCH_BITRATE,{value:t}):this.log(Mi.messages.CONTENT_PLAYBACK_SETTING_IGNORED)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"qualityCategory",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.userQualityCategory:null},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest(Qn.SWITCH_QUALITY_CATEGORY,{value:t}):this.log(Mi.messages.CONTENT_PLAYBACK_SETTING_IGNORED)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minBitrate",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.minBitrate:NaN},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest(Qn.MIN_BITRATE,{value:t}):this.log(Mi.messages.CONTENT_PLAYBACK_SETTING_IGNORED)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxBitrate",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.maxBitrate:NaN},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest(Qn.MAX_BITRATE,{value:t}):this.log(Mi.messages.CONTENT_PLAYBACK_SETTING_IGNORED)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"audioTrackInfo",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.audioTracks:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"audioTrack",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.audioTracks.track:null},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest(Qn.SWITCH_AUDIO_TRACK,{value:t}):this.log(Mi.messages.CONTENT_PLAYBACK_SETTING_IGNORED)},enumerable:!1,configurable:!0}),n.prototype.attachResource=function(t){return this.appMediator.attachResource(t)},Object.defineProperty(n.prototype,"resource",{get:function(){return this.appMediator.getCurrentResource()},set:function(t){ee.setResource(this.appMediator,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackEnabled",{get:function(){return this.facade.retrieveProxy(yn.TextTrackProxy).enabled},set:function(t){this.transmitExtRequest(Qn.SWITCH_TEXT_MODE,{value:t})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrack",{get:function(){return this.textTrackInfo?this.textTrackInfo.track:null},set:function(t){this.contentPlaybackStateReady?this.transmitExtRequest(Qn.SWITCH_TEXT_TRACK,{value:t}):this.log(Mi.messages.CONTENT_PLAYBACK_SETTING_IGNORED)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"textTrackInfo",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.textTrackInfo:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"streamType",{get:function(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.streamType:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isPlayingLive",{get:function(){var t=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return!0===(null==t?void 0:t.isPlayingLive)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"liveStreamUtcStart",{get:function(){var t=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return t?t.absoluteStart:NaN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"liveStreamUtcTime",{get:function(){var t=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return t?t.absoluteTime:NaN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"liveStreamUtcDuration",{get:function(){var t=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return t?t.absoluteDuration:NaN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSuspended",{get:function(){return this.appMediator.isPlaybackSuspended()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fullscreenElement",{get:function(){return this.appMediator.getFullscreenElement()},set:function(t){this.appMediator.setFullscreenElement(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pausable",{get:function(){var i;return!0===(null===(i=this.opts.playerOptions.overrides)||void 0===i?void 0:i.liveStreamPausable)||this.streamType!==t.StreamType.LIVE},enumerable:!1,configurable:!0}),n.prototype.enterFullscreen=function(){this.transmitExtRequest(Qn.ENTER_FULLSCREEN_REQUEST)},n.prototype.exitFullscreen=function(){this.transmitExtRequest(Qn.EXIT_FULLSCREEN_REQUEST)},n.prototype.play=function(){this.recordMetric(t.MetricType.API,t.ApiMetric.PLAY),this.appMediator.isPlaybackSuspended()&&this.transmitExtRequest(Qn.RESUME_PLAYBACK);var i={name:Qn.PLAY,type:Hn.EXTERNAL};return this.sendAsyncNotification(i,[t.PlayerEvent.CONTENT_PLAYING,t.PlayerEvent.AD_PLAYING],[t.PlayerEvent.AUTOPLAY_BLOCKED,t.PlayerEvent.VIDEO_PLAYBACK_ERROR,t.PlayerEvent.AD_ERROR])},n.prototype.pause=function(){if(this.recordMetric(t.MetricType.API,t.ApiMetric.PAUSE),this.pausable){var i={name:Qn.PAUSE,type:Hn.EXTERNAL};return this.sendAsyncNotification(i,[t.PlayerEvent.CONTENT_PAUSED,t.PlayerEvent.AD_PAUSED])}return this.log(Mi.messages.PAUSING_LINEAR_LIVE_STREAM_NOT_ALLOWED),this.stop()},n.prototype.togglePlayPause=function(){return this.playbackState===t.PlaybackState.PLAYING?this.pause():this.play()},n.prototype.seek=function(i){var n=this.appMediator.validateSeek(i,this.contentDuration);if(null===n)return Promise.resolve();this.recordMetric(t.MetricType.API,t.ApiMetric.SEEK,i);var e={name:Qn.SEEK,body:{value:n},type:Hn.EXTERNAL};return this.sendAsyncNotification(e,[t.PlayerEvent.SEEK_COMPLETE],[t.PlayerEvent.VIDEO_PLAYBACK_ERROR,t.PlayerEvent.AD_ERROR])},n.prototype.getModelSnapshot=function(){return ee.getModelSnapShot(this.appMediator)},n.prototype.getAdBreakTimes=function(){return this.appMediator.getAdBreakTimes()||[]},n.prototype.grabFrame=function(){return this.appMediator.grabFrame()},n.prototype.getThumbnail=function(t){var i;return null===(i=this.contentPlaybackStateProxy)||void 0===i?void 0:i.getThumbnail(t)},n.prototype.getContainerRect=function(){return this.appMediator.getContainerRect()},n.prototype.registerPlugins=function(t,i){var n=this;return new Promise((function(e,r){n.transmitExtRequest(Qn.LOAD_PLUGINS,{plugins:t,callback:function(){"function"==typeof i&&i(),e()}})}))},n.prototype.removePlugin=function(t){this.transmitExtRequest(Qn.REMOVE_PLUGIN,{name:t})},n.prototype.registerAdapter=function(t){return this.adapters.registerAdapter(t)},n.prototype.retrieveAdapter=function(t){return this.adapters.retrieveAdapter(t)},n.prototype.removeAdapter=function(t){return this.adapters.removeAdapter(t)},n.prototype.registerHook=function(t,i){return this.hooks.registerHook(t,i)},n.prototype.removeHook=function(t,i){return this.hooks.removeHook(t,i)},n.prototype.getPlugin=function(t){return this.appMediator.getPlugin(t)},n.prototype.loadNativePlugin=function(t,i){return this.appMediator.loadNativePlugin(t,i).then((function(i){if(!i)throw new Error("Unable to load plugin ".concat(t));return i}))},n.prototype.stop=function(){return this.appMediator.stopPresentation()},n.prototype.goLive=function(){this.streamType&&this.streamType!==t.StreamType.VOD&&(this.recordMetric(t.MetricType.API,t.ApiMetric.GO_LIVE),this.transmitExtRequest(Qn.SEEK_TO_LIVE))},n.prototype.skipAd=function(){this.appMediator.skipAd()},n.prototype.focus=function(t){var i=this.dom.getMain();i&&i.focus(t)},n.prototype.blur=function(){var t=this.dom.getMain();t&&t.blur()},n.prototype.getConfigAsJson=function(t){return this.appMediator.getConfigAsJson(t)},n.prototype.getAutoplayCapabilities=function(){return this.appMediator.getAutoplayCapabilities()},n.prototype.suspendPlayback=function(){var t=this;this.appMediator.isPlaybackSuspended()||this.pause().then((function(){t.transmitExtRequest(Qn.SUSPEND_PLAYBACK)}))},n.prototype.resumePlayback=function(){this.appMediator.isPlaybackSuspended()&&this.transmitExtRequest(Qn.RESUME_PLAYBACK)},n.prototype.recordMetric=function(t,i,n){this.sendNotification(Qn.METRIC,new dn(i,n,t))},n.prototype.sendEvent=function(t,i){this.emit(t,i)},n.prototype.sendErrorEvent=function(t){this.dispatchEvt(t)},n.prototype.addNativePlugins=function(t,i){var n=i.nativePlugins;(null==n?void 0:n.length)&&n.forEach((function(n){t.push(ae.getNativePluginConfig(n,i))}))},Object.defineProperty(n.prototype,"contentPlaybackStateProxy",{get:function(){return this.facade.retrieveProxy(yn.ContentPlaybackStateProxy)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"contentPlaybackStateReady",{get:function(){var t;return(null===(t=this.contentPlaybackStateProxy)||void 0===t?void 0:t.isReady)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localization",{get:function(){return this.facade.retrieveProxy(yn.LocalizationProxy)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dom",{get:function(){return this.facade.retrieveProxy(yn.PlayerDomProxy)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"adapters",{get:function(){return this.facade.retrieveProxy(yn.AdapterProxy)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hooks",{get:function(){return this.facade.retrieveProxy(yn.HookProxy)},enumerable:!1,configurable:!0}),n.prototype.transmitExtRequest=function(t,i){this.sendNotification(t,i,Hn.EXTERNAL)},n.prototype.log=function(i,n){var e=n||t.LogLevel.DEBUG;this.facade.log(e,i)},n.prototype.init=function(){this.facade.registerProxy(new ue(yn.HookProxy));var i=this.opts.globalServices,n=this.opts.playerOptions.logLevel?this.opts.playerOptions.logLevel:t.LogLevel.OFF;this.createLoggingService(n),this.facade.log(t.LogLevel.INFO,"".concat(ai.playerName,"; Ver. ").concat(ai.playerVersion,"  ").concat(ai.buildTime)),this.registerGlobalServices(i),this.createApplicationMediator(Un.APPLICATION),delete this.opts.globalServices,this.sendNotification(Qn.BOOT_APP,{playerOptions:this.opts.playerOptions||null,app:this},Hn.INTERNAL)},n.prototype.sendAsyncNotification=function(i,n,e){var r=this;return void 0===e&&(e=[]),new Promise((function(s,u){var o;e.push(t.PlayerEvent.FATAL_ERROR);var a=function(t){o=setTimeout((function(){h(),s(t)}),0)},c=function(t){clearTimeout(o),h(),u(t)},h=function(){n.forEach((function(t){return r.off(t,a)})),e.forEach((function(t){return r.off(t,c)}))};try{n.forEach((function(t){return r.on(t,a)})),e.forEach((function(t){return r.on(t,c)})),r.sendNotification(i.name,i.body,i.type)}catch(t){c(t)}}))},c([de()],n.prototype,"hasListenerFor",null),c([de()],n.prototype,"on",null),c([de()],n.prototype,"once",null),c([de()],n.prototype,"off",null),c([ve()],n.prototype,"isReady",null),c([ve()],n.prototype,"id",null),c([ve()],n.prototype,"dimensions",null),c([ve()],n.prototype,"muted",null),c([ve()],n.prototype,"volume",null),c([ve()],n.prototype,"language",null),c([ve()],n.prototype,"contentTime",null),c([ve()],n.prototype,"contentDuration",null),c([ve()],n.prototype,"streamTime",null),c([ve()],n.prototype,"streamDuration",null),c([ve()],n.prototype,"playbackState",null),c([ve()],n.prototype,"playlist",null),c([ve()],n.prototype,"autoQualitySwitching",null),c([ve()],n.prototype,"qualityInfo",null),c([ve()],n.prototype,"bitrate",null),c([ve()],n.prototype,"qualityCategory",null),c([ve()],n.prototype,"minBitrate",null),c([ve()],n.prototype,"maxBitrate",null),c([ve()],n.prototype,"audioTrackInfo",null),c([ve()],n.prototype,"audioTrack",null),c([de()],n.prototype,"attachResource",null),c([ve()],n.prototype,"resource",null),c([ve()],n.prototype,"textTrackEnabled",null),c([ve()],n.prototype,"textTrack",null),c([ve()],n.prototype,"textTrackInfo",null),c([ve()],n.prototype,"streamType",null),c([ve()],n.prototype,"isPlayingLive",null),c([ve()],n.prototype,"liveStreamUtcStart",null),c([ve()],n.prototype,"liveStreamUtcTime",null),c([ve()],n.prototype,"liveStreamUtcDuration",null),c([ve()],n.prototype,"isSuspended",null),c([ve()],n.prototype,"fullscreenElement",null),c([ve()],n.prototype,"pausable",null),c([de()],n.prototype,"enterFullscreen",null),c([de()],n.prototype,"exitFullscreen",null),c([de()],n.prototype,"play",null),c([de()],n.prototype,"pause",null),c([de()],n.prototype,"togglePlayPause",null),c([de()],n.prototype,"seek",null),c([de()],n.prototype,"getModelSnapshot",null),c([de()],n.prototype,"getAdBreakTimes",null),c([de()],n.prototype,"grabFrame",null),c([de()],n.prototype,"getThumbnail",null),c([de()],n.prototype,"getContainerRect",null),c([de()],n.prototype,"registerPlugins",null),c([de()],n.prototype,"removePlugin",null),c([de()],n.prototype,"registerAdapter",null),c([de()],n.prototype,"retrieveAdapter",null),c([de()],n.prototype,"removeAdapter",null),c([de()],n.prototype,"registerHook",null),c([de()],n.prototype,"removeHook",null),c([de()],n.prototype,"getPlugin",null),c([de()],n.prototype,"loadNativePlugin",null),c([de()],n.prototype,"stop",null),c([de()],n.prototype,"goLive",null),c([de()],n.prototype,"skipAd",null),c([de()],n.prototype,"focus",null),c([de()],n.prototype,"blur",null),c([de()],n.prototype,"getConfigAsJson",null),c([de()],n.prototype,"getAutoplayCapabilities",null),c([de()],n.prototype,"suspendPlayback",null),c([de()],n.prototype,"resumePlayback",null),c([de()],n.prototype,"recordMetric",null),n}(fe),Ds=function(){function t(){}return t.createVideoPlayer=function(t,i){this.initialized?this.createVideoPlayerApp({options:t,callback:i}):(this.pendingPlayerRequests.push({options:t,callback:i}),null===this.initializing&&this.initialize(t))},t.createVideoPlayerApp=function(t){var i=t.options.container,n=!1;if((this.serviceCollection[Jt.System].isWebMaf||null!=i&&(i.constructor===HTMLDivElement||"object"==typeof i&&"function"==typeof i.getBoundingClientRect||"string"==typeof i&&null!=document.querySelector(i)))&&(n=!0),!n){var e="Invalid player configuration: Missing presentation container.";j.error(e),t.callback(null,{message:e})}try{var r=new _s({globalServices:this.serviceCollection,playerOptions:t.options});this.playerCollection[r.appId]=r,r.initialize().then((function(i){return t.callback(i,null)})).catch((function(i){return t.callback(null,i)}))}catch(i){i.key&&(i.message='A player with id "'.concat(i.key,'" a already exists')),t.callback(null,i)}},t.retrieveVideoPlayer=function(t){var i=this.playerCollection[t];if(i)return Promise.resolve(i);var n=this.pendingPlayerDestroys[t];if(n)return n.then((function(){return null}));var e=w.find(this.pendingPlayerRequests,(function(i){return i.options.id==t}));return e?new Promise((function(t,i){var n=e.callback;e.callback=function(e,r){n(e,r),r?i(r):t(e)}})):Promise.resolve(null)},t.removeVideoPlayer=function(t){var i=this,n=this.pendingPlayerDestroys[t];if(n)return n;var e=this.playerCollection[t];return e?(delete this.playerCollection[t],this.pendingPlayerDestroys[t]=e.destroy().then((function(){delete i.pendingPlayerDestroys[t],j.log('[Avia] Player with id "'.concat(t,'" removed.'))}))):Promise.resolve()},t.createResourceConfig=function(t){return new Wn(t)},t.getSysInfoForUser=function(){if(null===this.serviceCollection)return null;var t=w.assign({},Dn.info),i=this.serviceCollection[Jt.MediaCapabilities].capabilities;return t.hasMediaSource=i.hasMediaSource,t.supportsNativeHls=i.supportsNativeHls,t},t.getPlatformInfo=function(){return new Promise((function(t,i){var n=Ln.getInstance();(null==n?void 0:n.info)?t(n.info):i(null)}))},t.processPending=function(){for(var t=this.pendingPlayerRequests.length,i=0;i<t;i++)this.createVideoPlayerApp(this.pendingPlayerRequests[i]),this.pendingPlayerRequests[i]=null;this.pendingPlayerRequests=[]},t.initialize=function(t){var i=this;this.initializing=!0;var n=Ln.getInstance();n.appNamespace=Ks;var e=zn.getInstance(),r=Vn.getInstance(),s=t.overrides,u=!0===(null==s?void 0:s.deferAutoplayDetection);return Promise.all([e.detectCapabilities(),!u&&r.detectCapabilities(null==s?void 0:s.blankVideoUrl)]).then((function(){var t;i.serviceCollection=((t={})[Jt.System]=n,t[Jt.MediaCapabilities]=e,t[Jt.AutoplayCapabilities]=r,t),i.initialized=!0,i.initializing=!1,i.processPending()}))},t.serviceCollection=null,t.playerCollection={},t.initialized=!1,t.initializing=null,t.pendingPlayerRequests=[],t.pendingPlayerDestroys={},t}();function Ms(t,i){return new Promise((function(n,e){Ds.createVideoPlayer(t,(function(t,r){ni.isFunction(i)&&i(t,r),null!=r?e(r):n(t)}))}))}function xs(t){return Ds.retrieveVideoPlayer(t)}function Ls(t){return Ds.removeVideoPlayer(t)}function Vs(t){return Ds.createResourceConfig(t)}function Bs(){return Ds.getSysInfoForUser()}function Us(){return Ds.getPlatformInfo()}function Fs(t){return Vn.getInstance().detectCapabilities(t)}var Ks=a(a({},Tn),{createVideoPlayer:Ms,retrieveVideoPlayer:xs,removeVideoPlayer:Ls,createResourceConfig:Vs,getSystemInfo:Bs,getPlatformInfo:Us,getAutoplayCapabilities:Fs});e.polyfill(),t.BaseClass=v,t.CoreEvent=b,t.Emitter=T,t.ErrorMessage=wn,t.FileExtensionToMimeType=p,t.HookError=gn,t.Logger=j,t.Metric=dn,t.PlaybackAdapterBase=fn,t.PlayerError=pn,t.QueryString=$t,t.Timer=kn,t.Util=ni,t.WILDCARD="*",t.buildInfo=ai,t.core=vn,t.createResourceConfig=Vs,t.createVideoPlayer=Ms,t.getAutoplayCapabilities=Fs,t.getPlatformInfo=Us,t.getSystemInfo=Bs,t.removeVideoPlayer=Ls,t.request=Zt,t.retrieveVideoPlayer=xs,t.util=On,t.waitForEvent=Li,t.waitForTime=Vi,t.waitUntil=xi,Object.defineProperty(t,"__esModule",{value:!0})})),Object.defineProperty(self,"cvp",{get:()=>(avia.Logger.deprecated("The cvp namespace is deprecated. Access will be completely removed April 1st, 2022"),self.avia),enumerable:!1,configurable:!1});
//# sourceMappingURL=avia.min.js.map
"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[492],{76384:(e,n,t)=>{t.d(n,{I:()=>h});var i=t(24831),r=t(93754),a=Math.pow(2,32);function s(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[n]<<8)+(e[n+1]||0)}function o(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[n]<<24>>>0)+(e[n+1]<<16)+(e[n+2]<<8)+(e[n+3]||0)}function u(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return o(e,n)*a+o(e,n+4)}var d=t(92183),f="undefined"!=typeof window,c=f&&navigator.userAgent.toLocaleLowerCase(),l=(f&&/^((?!chrome|android).)*safari/.test(c),f&&c.includes("firefox")),v=f&&c.includes("android"),p=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"getRateIndexByRate",value:function(n){return e.FREQ.indexOf(n)}},{key:"parseADTS",value:function(n,t){for(var i=n.length,r=0;r+2<i&&(255!==n[r]||240!=(246&n[r+1]));)r++;if(!(r>=i)){var a=r,s=[],o=(60&n[r+2])>>>2,u=e.FREQ[o];if(!u)throw new Error("Invalid sampling index: ".concat(o));for(var d,f,c=1+((192&n[r+2])>>>6),l=(1&n[r+2])<<2|(192&n[r+3])>>>6,v=e._getConfig(o,l,c),p=v.config,h=v.codec,m=0,y=e.getFrameDuration(u);r+7<i;)if(255===n[r]&&240==(246&n[r+1])){if(i-r<(f=(3&n[r+3])<<11|n[r+4]<<3|(224&n[r+5])>>5))break;d=2*(1&~n[r+1]),s.push({pts:t+m*y,data:n.subarray(r+7+d,r+f)}),m++,r+=f}else r++;return{skip:a,remaining:r>=i?void 0:n.subarray(r),frames:s,samplingFrequencyIndex:o,sampleRate:u,objectType:c,channelCount:l,codec:h,config:p,originCodec:"mp4a.40.".concat(c)}}}},{key:"parseAudioSpecificConfig",value:function(n){if(n.length){var t=n[0]>>>3,i=(7&n[0])<<1|n[1]>>>7,r=(120&n[1])>>>3,a=e.FREQ[i];if(!a)throw new Error("Invalid sampling index: ".concat(i));var s=e._getConfig(i,r,t);return{samplingFrequencyIndex:i,sampleRate:a,objectType:t,channelCount:r,config:s.config,codec:s.codec,originCodec:"mp4a.40.".concat(t)}}}},{key:"getFrameDuration",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return 1024*n/e}},{key:"_getConfig",value:function(e,n,t){var i,r,a=[];return l?e>=6?(i=5,r=e-3):(i=2,r=e):v?(i=2,r=e):(i=t,r=e,e>=6?r=e-3:1===n&&(i=2,r=e)),a[0]=i<<3,a[0]|=(14&e)>>1,a[1]=(1&e)<<7,a[1]|=n<<3,5===i&&(a[1]|=(14&r)>>1,a[2]=(1&r)<<7,a[2]|=8,a[3]=0),{config:a,codec:"mp4a.40.".concat(i)}}},{key:"getSilentFrame",value:function(e,n){if("mp4a.40.2"===e){if(1===n)return new Uint8Array([0,200,0,128,35,128]);if(2===n)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===n)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===n)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===n)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===n)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===n)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===n)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===n)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}]),e}();(0,d.Z)(p,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]);var h=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"findBox",value:function(n,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if(!n)return r;for(var a=0,s="",d=0;n.length>7;){if(a=o(n),s=String.fromCharCode.apply(null,n.subarray(4,8)),d=8,1===a?(a=u(n,8),d+=8):a||(a=n.length),!t[0]||s===t[0]){var f=n.subarray(0,a);if(!(t.length<2))return e.findBox(f.subarray(d),t.slice(1),i+d);r.push({start:i,size:a,headerSize:d,type:s,data:f})}i+=a,n=n.subarray(a)}return r}},{key:"moof",value:function(n){return g(n,!1,(function(n,t,i){n.mfhd=e.mfhd(e.findBox(t,["mfhd"])[0]),n.traf=[],e.findBox(t,["traf"]).map((function(t){n.traf.push(e.traf(t))}))}))}},{key:"traf",value:function(n){return g(n,!1,(function(n,t){n.tfhd=e.tfhd(e.findBox(t,["tfhd"])[0]),n.tfdt=e.tfdt(e.findBox(t,["tfdt"])[0]),n.trun=e.trun(e.findBox(t,["trun"])[0])}))}},{key:"mfhd",value:function(e){return g(e,!0,(function(e,n){e.sequence_number=o(n)}))}},{key:"trun",value:function(e){var n=this;return g(e,!0,(function(e,t){e.samples=[];var i,r=1&e.flags,a=4&e.flags,s=256&e.flags,u=512&e.flags,d=1024&e.flags,f=2048&e.flags,c=o(t),l=4;for(r&&(e.dataOffset=o(t,l),l+=4),a&&c&&(i={flags:n.parseSampleFlags([t[l],t[l+1],t[l+2],t[l+3]])},l+=4,s&&(i.duration=o(t,l),l+=4),u&&(i.size=o(t,l),l+=4),f&&(i.compositionTimeOffset=o(t,l),l+=4),e.samples.push(i),c--);c--;)i={},s&&(i.duration=o(t,l),l+=4),u&&(i.size=o(t,l),l+=4),d&&(i.flags=n.parseSampleFlags([t[l],t[l+1],t[l+2],t[l+3]]),l+=4),f&&(i.compositionTimeOffset=o(t,l),l+=4),e.samples.push(i)}))}},{key:"tfdt",value:function(e){return g(e,!0,(function(e,n){1===e.version?e.baseMediaDecodeTime=u(n):e.baseMediaDecodeTime=o(n)}))}},{key:"tfhd",value:function(e){return g(e,!0,(function(e,n){e.track_id=o(n);var t=4,i=1&e.flags,r=2&e.flags,a=8&e.flags,s=16&e.flags,u=32&e.flags;i&&(t+=4,e.baseDataOffset=o(n,t),t+=4),r&&(e.sampleDescriptionIndex=o(n,t),t+=4),a&&(e.defaultSampleDuration=o(n,t),t+=4),s&&(e.defaultSampleSize=o(n,t),t+=4),u&&(e.defaultSampleFlags=o(n,t))}))}},{key:"sidx",value:function(e){return g(e,!0,(function(e,n){var t=0;e.reference_ID=o(n,t),t+=4,e.timescale=o(n,t),t+=4,0===e.version?(e.earliest_presentation_time=o(n,t),t+=4,e.first_offset=o(n,t),t+=4):(e.earliest_presentation_time=u(n,t),t+=8,e.first_offset=u(n,t),t+=8),t+=2,e.references=[];var i=s(n,t);t+=2;for(var r=0;r<i;r++){var a={};e.references.push(a);var d=o(n,t);t+=4,a.reference_type=d>>31&1,a.referenced_size=2147483647&d,a.subsegment_duration=o(n,t),d=o(n,t+=4),t+=4,a.starts_with_SAP=d>>31&1,a.SAP_type=d>>28&7,a.SAP_delta_time=268435455&d}}))}},{key:"moov",value:function(n){return g(n,!1,(function(n,t,i){n.mvhd=e.mvhd(e.findBox(t,["mvhd"],i)[0]),n.trak=e.findBox(t,["trak"],i).map((function(n){return e.trak(n)})),n.pssh=e.pssh(e.findBox(t,["pssh"],i)[0])}))}},{key:"mvhd",value:function(e){return g(e,!0,(function(e,n){var t=0;1===e.version?(e.timescale=o(n,16),e.duration=u(n,20),t+=28):(e.timescale=o(n,8),e.duration=o(n,12),t+=16),e.nextTrackId=o(n,t+76)}))}},{key:"trak",value:function(n){return g(n,!1,(function(n,t,i){n.tkhd=e.tkhd(e.findBox(t,["tkhd"],i)[0]),n.mdia=e.mdia(e.findBox(t,["mdia"],i)[0])}))}},{key:"tkhd",value:function(e){return g(e,!0,(function(e,n){var t=0;1===e.version?(e.trackId=o(n,16),e.duration=u(n,24),t+=32):(e.trackId=o(n,8),e.duration=o(n,16),t+=20),e.width=o(n,t+52),e.height=o(n,t+56)}))}},{key:"mdia",value:function(n){return g(n,!1,(function(n,t,i){n.mdhd=e.mdhd(e.findBox(t,["mdhd"],i)[0]),n.hdlr=e.hdlr(e.findBox(t,["hdlr"],i)[0]),n.minf=e.minf(e.findBox(t,["minf"],i)[0])}))}},{key:"mdhd",value:function(e){return g(e,!0,(function(e,n){var t=0;1===e.version?(e.timescale=o(n,16),e.duration=u(n,20),t+=28):(e.timescale=o(n,8),e.duration=o(n,12),t+=16);var i=s(n,t);e.language=String.fromCharCode(96+(i>>10&31),96+(i>>5&31),96+(31&i))}))}},{key:"hdlr",value:function(e){return g(e,!0,(function(e,n){0===e.version&&(e.handlerType=String.fromCharCode.apply(null,n.subarray(4,8)))}))}},{key:"minf",value:function(n){return g(n,!1,(function(n,t,i){n.vmhd=e.vmhd(e.findBox(t,["vmhd"],i)[0]),n.smhd=e.smhd(e.findBox(t,["smhd"],i)[0]),n.stbl=e.stbl(e.findBox(t,["stbl"],i)[0])}))}},{key:"vmhd",value:function(e){return g(e,!0,(function(e,n){e.graphicsmode=s(n),e.opcolor=[s(n,2),s(n,4),s(n,6)]}))}},{key:"smhd",value:function(e){return g(e,!0,(function(e,n){e.balance=s(n)}))}},{key:"stbl",value:function(n){return g(n,!1,(function(n,t,i){n.stsd=e.stsd(e.findBox(t,["stsd"],i)[0]),n.stts=e.stts(e.findBox(t,["stts"],i)[0]),n.ctts=e.ctts(e.findBox(t,["ctts"],i)[0]),n.stsc=e.stsc(e.findBox(t,["stsc"],i)[0]),n.stsz=e.stsz(e.findBox(t,["stsz"],i)[0]),n.stco=e.stco(e.findBox(t,["stco"],i)[0]),n.stss=e.stss(e.findBox(t,["stss"],i)[0]),n.senc=e.senc(e.findBox(t,["senc"],i)[0])}))}},{key:"senc",value:function(e){return g(e,!0,(function(e,n){var t=0,i=o(n,t);t+=4,e.samples=[];for(var r=0;r<i;r++){var a={};if(a.InitializationVector=[n[t],n[t+1],n[t+2],n[t+3],n[t+4],n[t+5],n[t+6],n[t+7]],t+=8,2&e.flags){a.subsamples=[];var u=s(n,t);t+=2;for(var d=0;d<u;d++){var f={};f.BytesOfClearData=s(n,t),t+=2,f.BytesOfProtectedData=o(n,t),t+=4,a.subsamples.push(f)}}e.samples.push(a)}}))}},{key:"pssh",value:function(e){return g(e,!0,(function(e,n,t){for(var i=[],r=[],a=0;a<16;a++)r.push(C(n[t+a]));if(t+=16,e.version>0)for(var s=o(n,t),u=0;u<(""+s).length;u++)for(var d=0;d<16;d++){var f=n[t];t+=1,i.push(C(f))}var c=o();e.data_size=c,t+=c,e.kid=i,e.system_id=r,e.buffer=n}))}},{key:"stsd",value:function(n){return g(n,!0,(function(n,t,i){n.entryCount=o(t),n.entries=e.findBox(t.subarray(4),[],i+4).map((function(n){switch(n.type){case"avc1":case"avc2":case"avc3":case"avc4":return e.avc1(n);case"hvc1":case"hev1":return e.hvc1(n);case"mp4a":return e.mp4a(n);case"enca":return g(n,!1,(function(n,t,i){n.channelCount=s(t,16),n.samplesize=s(t,18),n.sampleRate=o(t,24)/65536,t=t.subarray(28),n.sinf=e.sinf(e.findBox(t,["sinf"],i)[0]),n.esds=e.esds(e.findBox(t,["esds"],i)[0])}));case"encv":return g(n,!1,(function(n,t,i){n.width=s(t,24),n.height=s(t,26),n.horizresolution=o(t,28),n.vertresolution=o(t,32),t=t.subarray(78),n.sinf=e.sinf(e.findBox(t,["sinf"],i)[0]),n.avcC=e.avcC(e.findBox(t,["avcC"],i)[0]),n.hvcC=e.hvcC(e.findBox(t,["hvcC"],i)[0]),n.pasp=e.pasp(e.findBox(t,["pasp"],i)[0])}))}})).filter(Boolean)}))}},{key:"tenc",value:function(e){return g(e,!1,(function(e,n){var t=6;e.default_IsEncrypted=n[t],t+=1,e.default_IV_size=n[t],t+=1,e.default_KID=[];for(var i=0;i<16;i++)e.default_KID.push(C(n[t])),t+=1}))}},{key:"schi",value:function(n){return g(n,!1,(function(n,t,i){n.tenc=e.tenc(e.findBox(t,["tenc"],i)[0])}))}},{key:"sinf",value:function(n){return g(n,!1,(function(n,t,i){n.schi=e.schi(e.findBox(t,["schi"],i)[0]),n.frma=e.frma(e.findBox(t,["frma"],i)[0])}))}},{key:"frma",value:function(e){return g(e,!1,(function(e,n){e.data_format="";for(var t=0;t<4;t++)e.data_format+=String.fromCharCode(n[t])}))}},{key:"avc1",value:function(n){return g(n,!1,(function(n,t,i){var r=y(n,t),a=t.subarray(r);i+=r,n.avcC=e.avcC(e.findBox(a,["avcC"],i)[0]),n.pasp=e.pasp(e.findBox(a,["pasp"],i)[0])}))}},{key:"avcC",value:function(e){return g(e,!1,(function(e,n){e.configurationVersion=n[0],e.AVCProfileIndication=n[1],e.profileCompatibility=n[2],e.AVCLevelIndication=n[3],e.codec=function(e){for(var n,t="avc1.",i=0;i<3;i++)(n=e[i].toString(16)).length<2&&(n="0".concat(n)),t+=n;return t}([n[1],n[2],n[3]]),e.lengthSizeMinusOne=3&n[4],e.spsLength=31&n[5],e.sps=[];for(var t=6,i=0;i<e.spsLength;i++){var r=s(n,t);t+=2,e.sps.push(n.subarray(t,t+r)),t+=r}e.ppsLength=n[t],t+=1,e.pps=[];for(var a=0;a<e.ppsLength;a++){var o=s(n,t);t+=2,e.pps.push(n.subarray(t,t+=o)),t+=o}}))}},{key:"hvc1",value:function(n){return g(n,!1,(function(n,t,i){var r=y(n,t),a=t.subarray(r);i+=r,n.hvcC=e.hvcC(e.findBox(a,["hvcC"],i)[0]),n.pasp=e.pasp(e.findBox(a,["pasp"],i)[0])}))}},{key:"hvcC",value:function(e){return g(e,!1,(function(n,t){n.data=e.data,n.codec="hev1.1.6.L93.B0",n.configurationVersion=t[0];var i=t[1];n.generalProfileSpace=i>>6,n.generalTierFlag=(32&i)>>5,n.generalProfileIdc=31&i,n.generalProfileCompatibility=o(t,2),n.generalConstraintIndicatorFlags=t.subarray(6,12),n.generalLevelIdc=t[12],n.avgFrameRate=s(t,19),n.numOfArrays=t[22],n.vps=[],n.sps=[],n.pps=[];for(var r=23,a=0,u=0,d=0,f=0;f<n.numOfArrays;f++){a=63&t[r],u=s(t,r+1),r+=3;for(var c,l=[],v=0;v<u;v++)d=s(t,r),r+=2,l.push(t.subarray(r,r+d)),r+=d;if(32===a)(c=n.vps).push.apply(c,l);else if(33===a){var p;(p=n.sps).push.apply(p,l)}else if(34===a){var h;(h=n.pps).push.apply(h,l)}}}))}},{key:"pasp",value:function(e){return g(e,!1,(function(e,n){e.hSpacing=o(n),e.vSpacing=o(n,4)}))}},{key:"mp4a",value:function(n){return g(n,!1,(function(n,t,i){var r=function(e,n){return e.dataReferenceIndex=s(n,6),e.channelCount=s(n,16),e.sampleSize=s(n,18),e.sampleRate=o(n,24)/65536,28}(n,t);n.esds=e.esds(e.findBox(t.subarray(r),["esds"],i+r)[0])}))}},{key:"esds",value:function(e){return g(e,!0,(function(e,n){e.codec="mp4a.";for(var t=0,i=0,r=0,a=0;n.length;){for(a=n[t=0],i=n[t+1],t+=2;128&i;)r=(127&i)<<7,i=n[t],t+=1;if(r+=127&i,3===a)n=n.subarray(t+3);else{if(4!==a){if(5===a){var s=e.config=n.subarray(t,t+r),o=(248&s[0])>>3;return 31===o&&s.length>=2&&(o=32+((7&s[0])<<3)+((224&s[1])>>5)),e.objectType=o,void(e.codec+=o.toString(16))}return}e.codec+=(n[t].toString(16)+".").padStart(3,"0"),n=n.subarray(t+13)}}}))}},{key:"stts",value:function(e){return g(e,!0,(function(e,n){for(var t=o(n),i=[],r=4,a=0;a<t;a++)i.push({count:o(n,r),delta:o(n,r+4)}),r+=8;e.entryCount=t,e.entries=i}))}},{key:"ctts",value:function(e){return g(e,!0,(function(e,n){var t=o(n),i=[],r=4;if(1===e.version)for(var a=0;a<t;a++)i.push({count:o(n,r),offset:o(n,r+4)}),r+=8;else for(var s=0;s<t;s++)i.push({count:o(n,r),offset:-(1+~o(n,r+4))}),r+=8;e.entryCount=t,e.entries=i}))}},{key:"stsc",value:function(e){return g(e,!0,(function(e,n){for(var t=o(n),i=[],r=4,a=0;a<t;a++)i.push({firstChunk:o(n,r),samplesPerChunk:o(n,r+4),sampleDescriptionIndex:o(n,r+8)}),r+=12;e.entryCount=t,e.entries=i}))}},{key:"stsz",value:function(e){return g(e,!0,(function(e,n){var t=o(n),i=o(n,4),r=[];if(!t)for(var a=8,s=0;s<i;s++)r.push(o(n,a)),a+=4;e.sampleSize=t,e.sampleCount=i,e.entrySizes=r}))}},{key:"stco",value:function(e){return g(e,!0,(function(e,n){for(var t=o(n),i=[],r=4,a=0;a<t;a++)i.push(o(n,r)),r+=4;e.entryCount=t,e.entries=i}))}},{key:"stss",value:function(e){return g(e,!0,(function(e,n){for(var t=o(n),i=[],r=4,a=0;a<t;a++)i.push(o(n,r)),r+=4;e.entryCount=t,e.entries=i}))}},{key:"parseSampleFlags",value:function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}}},{key:"moovToTrack",value:function(e,n,t){var i=e.trak;if(i&&i.length){var r=i.find((function(e){var n,t;return"vide"===(null===(n=e.mdia)||void 0===n||null===(t=n.hdlr)||void 0===t?void 0:t.handlerType)})),a=i.find((function(e){var n,t;return"soun"===(null===(n=e.mdia)||void 0===n||null===(t=n.hdlr)||void 0===t?void 0:t.handlerType)}));if(r&&n){var s,o,u,d,f,c,l=n;l.tkhdDuration=r.tkhd.duration,l.mvhdDurtion=e.mvhd.duration,l.mvhdTimecale=e.mvhd.timescale,l.timescale=l.formatTimescale=r.mdia.mdhd.timescale,l.duration=r.mdia.mdhd.duration;var v,h,m,y,g,k,C,x,_=r.mdia.minf.stbl.stsd.entries[0];if(l.width=_.width,l.height=_.height,_.pasp&&(l.sarRatio=[_.pasp.hSpacing,_.pasp.vSpacing]),_.hvcC)l.codecType="hevc",l.codec=_.hvcC.codec,l.vps=_.hvcC.vps,l.sps=_.hvcC.sps,l.pps=_.hvcC.pps,l.hvcC=_.hvcC.data;else{if(!_.avcC)throw new Error("unknown video stsd entry");l.codec=_.avcC.codec,l.sps=_.avcC.sps,l.pps=_.avcC.pps}l.present=!0,l.ext={},l.ext.stss=null===(s=r.mdia)||void 0===s||null===(o=s.minf)||void 0===o||null===(u=o.stbl)||void 0===u?void 0:u.stss,l.ext.ctts=null===(d=r.mdia)||void 0===d||null===(f=d.minf)||void 0===f||null===(c=f.stbl)||void 0===c?void 0:c.ctts,_&&"encv"===_.type&&(l.isVideoEncryption=!0,_.default_KID=null===(v=_.sinf)||void 0===v||null===(h=v.schi)||void 0===h?void 0:h.tenc.default_KID,_.default_IsEncrypted=null===(m=_.sinf)||void 0===m||null===(y=m.schi)||void 0===y?void 0:y.tenc.default_IsEncrypted,_.default_IV_size=null===(g=_.sinf)||void 0===g||null===(k=g.schi)||void 0===k?void 0:k.tenc.default_IV_size,l.videoSenc=r.mdia.minf.stbl.senc.samples,_.data_format=null===(C=_.sinf)||void 0===C||null===(x=C.frma)||void 0===x?void 0:x.data_format,l.useEME=e.useEME,l.kidValue=e.kidValue,l.pssh=e.pssh,l.encv=_)}if(a&&t){var b,S,B,z,E,I,D,A,w=t;w.tkhdDuration=a.tkhd.duration,w.mvhdDurtion=e.mvhd.duration,w.mvhdTimecale=e.mvhd.timescale,w.timescale=w.formatTimescale=a.mdia.mdhd.timescale,w.duration=a.mdia.mdhd.duration;var T,R,V,O,F,L,P,U,K=a.mdia.minf.stbl.stsd.entries[0];w.sampleSize=K.sampleSize,w.sampleRate=K.sampleRate,w.channelCount=K.channelCount,w.sampleDuration=p.getFrameDuration(w.sampleRate,w.timescale),w.objectType=(null===(b=K.esds)||void 0===b?void 0:b.objectType)||2,K.esds&&(w.config=Array.from(K.esds.config)),w.codec=(null===(S=K.esds)||void 0===S?void 0:S.codec)||"mp4a.40.2",w.sampleRateIndex=p.getRateIndexByRate(w.sampleRate),w.ext={},w.ext.stss=null===(B=a.mdia)||void 0===B||null===(z=B.minf)||void 0===z||null===(E=z.stbl)||void 0===E?void 0:E.stss,w.ext.ctts=null===(I=a.mdia)||void 0===I||null===(D=I.minf)||void 0===D||null===(A=D.stbl)||void 0===A?void 0:A.ctts,w.present=!0,K&&"enca"===K.type&&(t.isAudioEncryption=!0,t.isVideoEncryption=n.isVideoEncryption,n.isAudioEncryption=t.isAudioEncryption,w.isAudioEncryption=!0,K.data_format=null===(T=K.sinf)||void 0===T||null===(R=T.frma)||void 0===R?void 0:R.data_format,K.default_KID=null===(V=K.sinf)||void 0===V||null===(O=V.schi)||void 0===O?void 0:O.tenc.default_KID,K.default_IsEncrypted=null===(F=K.sinf)||void 0===F||null===(L=F.schi)||void 0===L?void 0:L.tenc.default_IsEncrypted,K.default_IV_size=null===(P=K.sinf)||void 0===P||null===(U=P.schi)||void 0===U?void 0:U.tenc.default_IV_size,w.audioSenc=a.mdia.minf.stbl.senc.samples,w.useEME=e.useEME,w.kidValue=e.kidValue,w.enca=K)}return n.isVideoEncryption=t.isVideoEncryption,(n.encv||t.enca)&&(n.kid=(n.encv.default_KID||t.enca.default_KID).join(""),t.kid=n.kid),(n.isVideoEncryption||t.isAudioEncryption)&&e.useEME?(n.flags=3585,t.flags=513):(n.flags=3841,t.flags=1793),{videoTrack:n,audioTrack:t}}}},{key:"moovToSamples",value:function(e){var n=e.trak;if(n&&n.length){var t=n.find((function(e){var n,t;return"vide"===(null===(n=e.mdia)||void 0===n||null===(t=n.hdlr)||void 0===t?void 0:t.handlerType)})),i=n.find((function(e){var n,t;return"soun"===(null===(n=e.mdia)||void 0===n||null===(t=n.hdlr)||void 0===t?void 0:t.handlerType)}));if(t||i){var r,a,s=[];if(t){var o,u,d,f=null===(o=t.mdia)||void 0===o||null===(u=o.minf)||void 0===u?void 0:u.stbl;if(!f)return;var c=f.stts,l=f.stsc,v=f.stsz,p=f.stco,h=f.stss,y=f.ctts;if(!(c&&l&&v&&p&&h))return;var g=null===(d=t.mdia.mdhd)||void 0===d?void 0:d.timescale;r=m(c,l,v,p,y,h);for(var k=0,C=0;C<r.length;C++)r[C].keyframe&&s.push(k/g),k+=r[C].duration}if(i){var x,_,b,S=null===(x=i.mdia)||void 0===x||null===(_=x.minf)||void 0===_?void 0:_.stbl;if(!S)return;var B=null===(b=i.mdia.mdhd)||void 0===b?void 0:b.timescale,z=S.stts,E=S.stsc,I=S.stsz,D=S.stco;if(!(B&&z&&E&&I&&D))return;a=m(z,E,I,D);for(var A=0,w=0,T=0;T<a.length;T++)A+=a[T].duration,a[T].gopId=w,A/B>=s[w+1]&&w<s.length-1&&(w+=1)}return{videoSamples:r,audioSamples:a}}}}}]),e}();function m(e,n,t,i,r,a){var s,o,u,d=[],f=null==r?void 0:r.entries,c=n.entries,l=i.entries,v=t.entrySizes,p=null==a?void 0:a.entries;p&&(s={},p.forEach((function(e){s[e-1]=!0}))),f&&(o=[],f.forEach((function(e){for(var n=e.count,t=e.offset,i=0;i<n;i++)o.push(t)})));var h=-1,m=0,y=0,g=0,k=0,C=0,x=c[0].samplesPerChunk,_=c[1]?c[1].firstChunk-1:1/0;return e.entries.forEach((function(e){for(var n=e.count,i=e.delta,r=0;r<n;r++)u={dts:m,duration:i,size:v[y]||t.sampleSize,offset:l[g]+C,index:y},p&&(u.keyframe=s[y],u.keyframe&&h++,u.gopId=h),u.timeOffset=0,o&&o[y]&&(u.pts=u.dts+o[y],u.timeOffset=o[y],0===y&&(u.pts=u.dts,u.timeOffset=0)),d.push(u),m+=i,++y<x?C+=u.size:(g++,C=0,g>=_&&(k++,_=c[k+1]?c[k+1].firstChunk-1:1/0),x+=c[k].samplesPerChunk)})),d}function y(e,n){return e.dataReferenceIndex=s(n,6),e.width=s(n,24),e.height=s(n,26),e.horizresolution=o(n,28),e.vertresolution=o(n,32),e.frameCount=s(n,40),e.depth=s(n,74),78}function g(e,n,t){if(e){if(e.size!==e.data.length)throw new Error("box ".concat(e.type," size !== data.length"));var i={start:e.start,size:e.size,headerSize:e.headerSize,type:e.type};return n&&(i.version=e.data[e.headerSize],i.flags=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[n]<<16)+(e[n+1]<<8)+(e[n+2]||0)}(e.data,e.headerSize+1),i.headerSize+=4),t(i,e.data.subarray(i.headerSize),i.start+i.headerSize),i}}var k=function(e,n,t){for(var i=String(t),r=n>>0,a=Math.ceil(r/i.length),s=[],o=String(e);a--;)s.push(i);return s.join("").substring(0,r-o.length)+o},C=function(){for(var e=[],n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];return t.forEach((function(n){e.push(k(Number(n).toString(16),2,0))})),e[0]}}}]);
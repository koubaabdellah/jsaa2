"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[7494],{28227:(e,t,n)=>{n.d(t,{Z:()=>Z});var r=n(71704),i=n(85307),a=n(24831),o=n(93754),s=n(92183),u=(n(33809),n(7941),n(7237),n(41844),n(92578),n(83765),n(9778),n(93956),n(58935),n(24179)),d=n.n(u),c=n(69458),l=n(8747),h=n(19515),f=n(76384);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=(0,o.Z)((function e(t,n){(0,a.Z)(this,e),this.type="file",this.message=t,this.data=n})),p=function(){function e(){(0,a.Z)(this,e),(0,s.Z)(this,"_data",Object.create(null))}return(0,o.Z)(e,[{key:"set",value:function(e,t){this._data[e]=t}},{key:"get",value:function(e){return this._data[e]}},{key:"clear",value:function(){this._data=Object.create(null)}}]),e}(),x=n(60104);function b(e,t){var n=e.trak;if(n&&n.length){var r=n.find((function(e){var t,n;return"vide"===(null===(t=e.mdia)||void 0===t||null===(n=t.hdlr)||void 0===n?void 0:n.handlerType)})),i=n.find((function(e){var t,n;return"soun"===(null===(t=e.mdia)||void 0===t||null===(n=t.hdlr)||void 0===n?void 0:n.handlerType)}));if(r||i){var a,o=[],s=[];if(r){var u,d,c,l=null===(u=r.mdia)||void 0===u||null===(d=u.minf)||void 0===d?void 0:d.stbl;if(!l)return;var h=null===(c=r.mdia.mdhd)||void 0===c?void 0:c.timescale,f=l.stts,v=l.stsc,m=l.stsz,g=l.stco,p=l.stss;if(!(h&&f&&v&&m&&g&&p))return;a=(o=y(t,h,f,v,m,g,p)).map((function(e){return e.duration}))}if(i){var x,b,k,S=null===(x=i.mdia)||void 0===x||null===(b=x.minf)||void 0===b?void 0:b.stbl;if(!S)return;var w=null===(k=i.mdia.mdhd)||void 0===k?void 0:k.timescale,_=S.stts,O=S.stsc,Z=S.stsz,D=S.stco;if(!(w&&_&&O&&Z&&D))return;s=y(t,w,_,O,Z,D,null,a)}return{videoSegments:o,audioSegments:s}}}}function y(e,t,n,r,i,a,o,s){var u,d,c,l=[],h=[],f=[],v=r.entries,m=a.entries,g=i.entrySizes,p=null==o?void 0:o.entries;p&&(u={},p.forEach((function(e){u[e-1]=!0})));var b=0,y=0,k=0,S=0,w=0,_=v[0].samplesPerChunk,O=v[1]?v[1].firstChunk-1:1/0;n.entries.forEach((function(e){var t=e.count,n=e.delta;c=n;for(var r=0;r<t;r++)d={startTime:b,duration:c,size:g[y]||i.sampleSize,offset:m[k]+w,index:y},p&&(d.keyframe=u[y],d.keyframe?(h.push([d]),f.push(d.duration)):(h[h.length-1].push(d),f[h.length-1]+=d.duration)),l.push(d),b+=c,++y<_?w+=d.size:(k++,w=0,k>=O&&(S++,O=v[S+1]?v[S+1].firstChunk-1:1/0),_+=v[S].samplesPerChunk)}));var Z=l.length;if(Z&&(!o||l[0].keyframe)){var D,I=[],T=[],j=0,L=function(e){var n;D=T[T.length-1],I.push({index:I.length,startTime:(null===(n=I[I.length-1])||void 0===n?void 0:n.endTime)||T[0].startTime/t,endTime:(D.startTime+D.duration)/t,duration:e,range:[T[0].offset,D.offset+D.size],frames:T}),j=0,T=[]};if(o)for(var P=0,E=0,M=h.length;E<M;E++){var C,z;j+=f[E],(C=T).push.apply(C,(0,x.Z)(h[E])),E+1<M?(P=j+f[E+1])>=e&&(P-e<Math.abs(e-j)?((z=T).push.apply(z,(0,x.Z)(h[E+1])),j+=f[E+1],L((f[E]+f[E+1])/t),E++):L(f[E]/t)):L(f[E]/t)}else for(var B=(s=s||[])[0]||e,A=0;A<Z;A++)T.push(l[A]),j+=l[A].duration,(A+1>=Z||j/t>=B)&&(L(j/t),B=s[I.length]||e);return I}}function k(e){var t="",n="",r=0,i=0,a=0,o=0,s=0;e.mvhd&&(s=e.mvhd.duration/e.mvhd.timescale);var u=e.trak;if(u){var d,c,l,h,f,v,m,g,p,x,b,y,k,S=u.find((function(e){var t,n;return"vide"===(null===(t=e.mdia)||void 0===t||null===(n=t.hdlr)||void 0===n?void 0:n.handlerType)})),w=u.find((function(e){var t,n;return"soun"===(null===(t=e.mdia)||void 0===t||null===(n=t.hdlr)||void 0===n?void 0:n.handlerType)})),_=null;return S&&(_=null===(c=S.mdia)||void 0===c||null===(l=c.minf)||void 0===l||null===(h=l.stbl)||void 0===h?void 0:h.stsd.entries[0])&&(r=_.width,i=_.height,t=null===(f=_.avcC||_.hvcC)||void 0===f?void 0:f.codec,"encv"===_.type&&(d=null===(v=_.sinf)||void 0===v||null===(m=v.schi)||void 0===m?void 0:m.tenc.default_KID)),w&&(_=null===(g=w.mdia)||void 0===g||null===(p=g.minf)||void 0===p||null===(x=p.stbl)||void 0===x?void 0:x.stsd.entries[0])&&(a=_.channelCount,o=_.sampleRate,n=null===(b=_.esds)||void 0===b?void 0:b.codec,"enca"===_.type&&(d=d||(null===(y=_.sinf)||void 0===y||null===(k=y.schi)||void 0===k?void 0:k.tenc.default_KID))),{kid:d?d.join(""):null,videoCodec:t,audioCodec:n,width:r,height:i,audioChannelCount:a,audioSampleRate:o,duration:s,moov:e}}}function S(e){return"number"==typeof e&&!isNaN(e)}n(95964),n(70806),n(61046),n(45548);var w=["vid","moovEnd","segmentDuration","cache","maxDownloadInfoSize"];function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(){function e(t){(0,a.Z)(this,e),(0,s.Z)(this,"vid",""),(0,s.Z)(this,"url",""),(0,s.Z)(this,"meta",{}),(0,s.Z)(this,"downloadInfo",[]),(0,s.Z)(this,"videoSegments",[]),(0,s.Z)(this,"audioSegments",[]),(0,s.Z)(this,"cache",null),(0,s.Z)(this,"_currentSegmentIndex",-1),(0,s.Z)(this,"_currentLoadingSegmentIndex",-1),(0,s.Z)(this,"_transformError",(function(e){return e})),this._config=m(m({vid:"",moovEnd:8e3,segmentDuration:0,maxDownloadInfoSize:30,cache:null},t),{},{responseType:"arraybuffer"});var n=this._config,r=n.vid;n.moovEnd,n.segmentDuration;var o=n.cache;n.maxDownloadInfoSize;var u=(0,i.Z)(n,w);this.cache=o||new p,this.vid=r||u.url,this.url=u.url,u.transformError=this._transformError,this.logger=new c.Y("MP4Loader_"+this.vid),t.openLog&&c.Y.enable(),u.logger=this.logger,this._loader=new l.mf(u)}var t,n,u,v,x,y,_,Z,D,I;return(0,o.Z)(e,[{key:"isMetaLoaded",get:function(){return this.videoSegments.length||this.audioSegments.length}},{key:"setCurrentSegment",value:function(e){S(e)&&(this._currentSegmentIndex=e)}},{key:"isLastSegment",value:function(e){var t,n;return!!S(e)&&e===((null===(t=this.videoSegments[this.videoSegments.length-1])||void 0===t?void 0:t.index)||(null===(n=this.audioSegments[this.audioSegments.length-1])||void 0===n?void 0:n.index)||0)}},{key:"isSegmentLoading",value:function(e){return e===this._currentLoadingSegmentIndex}},{key:"changeUrl",value:(I=(0,r.Z)(d().mark((function e(t){var n,r,i,a=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:t,r=a.length>2?a[2]:void 0,i=a.length>3?a[3]:void 0,e.next=5,this.reset(i);case 5:t&&(this.url=t),n&&(this.vid=n),r&&(this._config.moovEnd=r);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"getOrLoadMeta",value:(D=(0,r.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isMetaLoaded){e.next=3;break}return e.next=3,this.loadMeta(t);case 3:return e.abrupt("return",this.meta);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"loadMeta",value:(Z=(0,r.Z)(d().mark((function e(t,n){var r,i,a,o,s,u,c,l,v;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],this.logger.debug("[loadMeta start]"),e.next=4,this.loadData([0,n||this._config.moovEnd],t);case 4:if(i=e.sent){e.next=7;break}return e.abrupt("return");case 7:if(r.push(i),a=f.I.findBox(i.data,["moov"])[0]){e.next=23;break}if(o=f.I.findBox(i.data,["mdat"])[0]){e.next=13;break}throw new g("cannot find moov or mdat box",i.data);case 13:return s=o.start+o.size,e.next=16,this.loadData([s],t);case 16:if(i=e.sent){e.next=19;break}return e.abrupt("return");case 19:if(r.push(i),a=f.I.findBox(i.data,["moov"],s)[0]){e.next=23;break}throw new g("cannot find moov box",i.data);case 23:if(!(a.size>a.data.length)){e.next=31;break}return e.next=26,this.loadData([i.data.length,a.start+a.size-1],t);case 26:if(i=e.sent){e.next=29;break}return e.abrupt("return");case 29:r.push(i),a.data=(0,h.gJ)(a.data,i.data);case 31:if(u=f.I.moov(a)){e.next=34;break}throw new g("cannot parse moov box",a.data);case 34:if(c=b(u,this._config.segmentDuration)){e.next=37;break}throw new g("cannot parse segments",a.data);case 37:return this.meta=k(u),l=c.videoSegments,v=c.audioSegments,this.videoSegments=l,this.audioSegments=v,this.logger.debug("[load moov end!!!!!]"),e.abrupt("return",{meta:this.meta,videoSegments:l,audioSegments:v,responses:r});case 43:case"end":return e.stop()}}),e,this)}))),function(e,t){return Z.apply(this,arguments)})},{key:"getSegmentByTime",value:function(e){var t,n;return this.videoSegments.length?(t=this.videoSegments.find((function(t){return t.startTime<=e&&t.endTime>e})))&&(n=this.audioSegments[t.index]):n=this.audioSegments.find((function(t){return t.startTime<=e&&t.endTime>e})),{video:t,audio:n}}},{key:"loadSegmentByTime",value:(_=(0,r.Z)(d().mark((function e(t,n){var r,i,a,o,s,u=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(u.length>2&&void 0!==u[2])||u[2],i=u.length>3&&void 0!==u[3]?u[3]:{},this.isMetaLoaded){e.next=5;break}return e.next=5,this.loadMeta(n);case 5:return a=this.getSegmentByTime(t),o=a.video,s=a.audio,e.abrupt("return",this._loadSegment(o,s,n,r,i));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return _.apply(this,arguments)})},{key:"loadNextSegment",value:(y=(0,r.Z)(d().mark((function e(t){var n,r,i,a,o=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(o.length>1&&void 0!==o[1])||o[1],r=o.length>2&&void 0!==o[2]?o[2]:{},this.isMetaLoaded){e.next=5;break}return e.next=5,this.loadMeta();case 5:return i=this.videoSegments[this._currentSegmentIndex+1],a=this.audioSegments[this._currentSegmentIndex+1],e.abrupt("return",this._loadSegment(i,a,t,n,r));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"preload",value:(x=(0,r.Z)(d().mark((function e(t){var n,i,a,o,s,u,c,l=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isMetaLoaded){e.next=3;break}return e.next=3,this.loadMeta(!0);case 3:if(t&&!(t<0)){e.next=5;break}return e.abrupt("return");case 5:if(n=this.getSegmentByTime(t),i=n.video,a=n.audio,o=Math.max((null==i?void 0:i.index)||0,(null==a?void 0:a.index)||0)){e.next=9;break}return e.abrupt("return");case 9:return s=this.videoSegments.slice(0,o),u=this.audioSegments.slice(0,o),c=function(){var e=(0,r.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>o)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,l._loadSegment(s[t],u[t],!0,!1);case 4:return e.next=6,c(t+1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=14,c(0);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"cancel",value:function(){return this._loader.cancel()}},{key:"reset",value:(v=(0,r.Z)(d().mark((function e(){var t=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length>0&&void 0!==t[0]&&t[0]){e.next=5;break}return this.logger.debug("[MP4loader reset func call loader.cancel]"),e.next=5,this._loader.cancel();case 5:this.vid=this.url="",this.meta={},this.downloadInfo=[],this.videoSegments=[],this.audioSegments=[],this._currentSegmentIndex=-1,this._currentLoadingSegmentIndex=-1;case 12:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"destroy",value:(u=(0,r.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cancel();case 2:this.cache.clear();case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"_loadSegment",value:(n=(0,r.Z)(d().mark((function e(t,n,r,i,a){var o,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||n){e.next=2;break}return e.abrupt("return");case 2:return o=(null==t?void 0:t.index)||(null==n?void 0:n.index)||0,this._currentLoadingSegmentIndex=o,e.prev=4,e.next=7,this.loadData([Math.min((null==t?void 0:t.range[0])||1/0,(null==n?void 0:n.range[0])||1/0),Math.max((null==t?void 0:t.range[1])||0,(null==n?void 0:n.range[1])||0)],r,a);case 7:s=e.sent;case 8:return e.prev=8,this._currentLoadingSegmentIndex=-1,e.finish(8);case 11:if(s){e.next=13;break}return e.abrupt("return");case 13:return i&&(this._currentSegmentIndex=o),s.video=t,s.audio=n,e.abrupt("return",s);case 17:case"end":return e.stop()}}),e,this,[[4,,8,11]])}))),function(e,t,r,i,a){return n.apply(this,arguments)})},{key:"loadData",value:(t=(0,r.Z)(d().mark((function e(t,n,r){var i,a,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._getCacheKey(t),e.next=3,this.cache.get(i);case 3:if(a=e.sent){e.next=10;break}return e.next=7,this._loader.load(this.url,O({range:t,vid:this.vid},r));case 7:o=e.sent,e.next=11;break;case 10:o={data:a,state:!0,options:{fromCache:!0,range:t,vid:this.vid}};case 11:if(o){e.next=13;break}return e.abrupt("return");case 13:return a||(o.data&&this.downloadInfo.push({startTime:o.startTime,endTime:o.endTime,size:o.data.byteLength,range:t}),this.downloadInfo&&this.downloadInfo.length>this._config.maxDownloadInfoSize&&(this.downloadInfo=this.downloadInfo.slice(-this._config.maxDownloadInfoSize))),e.abrupt("return",o);case 16:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"_getCacheKey",value:function(e){return(this.vid||this.url)+":"+e}}],[{key:"speed",value:function(){return l.mf.getSpeed()}},{key:"realTimeSpeed",value:function(){return l.mf.getRealTimeSpeed()}},{key:"RTT",value:function(){return l.mf.getRTT()}}]),e}()}}]);
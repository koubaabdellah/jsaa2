"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9395],{59395:function(a,b,c){c.r(b),c.d(b,{useUser:function(){return y},UserProvider:function(){return D}});var d=c(32390),e=c.n(d),f=c(52010),g=c(37076),h=c(85964),i=c(64804),j=c(42503),k=c(76687),l=c(22468),m=c(53736),n=c.n(m);function o(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=a[c];return d}function p(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function q(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){p(f,d,e,g,h,"next",a)}function h(a){p(f,d,e,g,h,"throw",a)}g(void 0)})}}function r(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function s(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){r(a,b,c[b])})}return a}function t(a,b){return(function(a){if(Array.isArray(a))return a})(a)||(function(a,b){var c,d,e=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=e){var f=[],g=!0,h=!1;try{for(e=e.call(a);!(g=(c=e.next()).done)&&(f.push(c.value),!b||f.length!==b);g=!0);}catch(i){h=!0,d=i}finally{try{g||null==e.return||e.return()}finally{if(h)throw d}}return f}})(a,b)||u(a,b)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function u(a,b){if(a){if("string"==typeof a)return o(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return o(a,b)}}var v=function(){return{authID:"",email:"",emailVerified:!1,updatedAt:"",fullName:"",omedaCustomerEncryptedID:""}},w=(0,k.createContext)(void 0);function x(a,b){switch(b.type){case g.c.SavedToStorage:return s({},a,{shouldSave:!1});case g.c.Logout:return s({},a,{ssoUser:v(),accessToken:"",isAuthenticated:!1,shouldSave:!0,hasLoadedFromStorage:!0,hasLoadedFromAuth0:!0,shouldLoadFromApi:!1});case g.c.LoadFromStorage:return s({},a,{ssoUser:s({},a.ssoUser,b.fullUser),hasLoadedFromStorage:!0});case g.c.LoadFromAuth0:var c,d,e,f,h,i,j,k,l,m,n,p,q=!!a.ssoUser.fullName&&!!a.ssoUser.omedaCustomerEncryptedID;return b.isAuthenticated?s({},a,{ssoUser:s({},a.ssoUser,{authID:(null==b?void 0:null===(d=b.authZeroUser)|| void 0===d?void 0:d.authID)||"",email:(null==b?void 0:null===(e=b.authZeroUser)|| void 0===e?void 0:e.email)||"",emailVerified:(null==b?void 0:null===(f=b.authZeroUser)|| void 0===f?void 0:f.emailVerified)||!1}),accessToken:b.accessToken||"",isAuthenticated:!0,hasLoadedFromAuth0:!0,shouldLoadFromApi:!q}):s({},a,{isAuthenticated:!1,hasLoadedFromAuth0:!0});case g.c.LoadFromApi:return s({},a,{ssoUser:s({},a.ssoUser,{fullName:(null==b?void 0:null===(h=b.apiUser)|| void 0===h?void 0:h.fullName)||"",omedaCustomerEncryptedID:(null==b?void 0:null===(i=b.apiUser)|| void 0===i?void 0:i.omedaCustomerEncryptedID)||"",updatedAt:(null==b?void 0:null===(j=b.apiUser)|| void 0===j?void 0:j.updatedAt)||"",isEditor:null==b?void 0:null===(k=b.apiUser)|| void 0===k?void 0:k.isEditor}),shouldSave:!0,shouldLoadFromApi:!1});case g.c.ErrorOccurred:return s({},a,{error:b.error,hasLoadedFromStorage:!0,hasLoadedFromAuth0:!0,shouldLoadFromApi:!1});case g.c.CreateUser:case g.c.UpdateUser:return s({},a,{ssoUser:s({},a.ssoUser,{email:(null==b?void 0:null===(l=b.apiUser)|| void 0===l?void 0:l.email)||"",fullName:(null==b?void 0:null===(m=b.apiUser)|| void 0===m?void 0:m.fullName)||"",omedaCustomerEncryptedID:(null==b?void 0:null===(n=b.apiUser)|| void 0===n?void 0:n.omedaCustomerEncryptedID)||"",updatedAt:(null==b?void 0:null===(p=b.apiUser)|| void 0===p?void 0:p.updatedAt)||""})});case g.c.TokenExpired:return s({},a,{hasAccessTokenExpired:!0});case g.c.UserIdentifiedByTracker:return!b.tracker||a.identifiedByTrackers.includes(b.tracker)?a:s({},a,{identifiedByTrackers:((function(a){if(Array.isArray(a))return o(a)})(c=a.identifiedByTrackers)||(function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)})(c)||u(c)||(function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()).concat([b.tracker,])});default:throw new Error("Unhandled action type: ".concat(String(b.type)))}}var y=function(){var a=(0,k.useContext)(w);if(void 0===a)throw new Error("useUser must be used within a UserProvider");return a};function z(){return(z=q(e().mark(function a(b){var c,d,f,h,i,k,l,m;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(c=b.isLoading,d=b.isAuthenticated,f=b.hasLoadedFromAuth0,h=b.user,i=b.dispatch,k=b.getIdTokenClaims,!(!f&&!c)){a.next=20;break}if(!(d&&h)){a.next=19;break}return localStorage.setItem("ssoRegistrationValues","{}"),a.prev=4,a.next=7,k();case 7:l=a.sent,i({type:g.c.LoadFromAuth0,authZeroUser:{authID:h.sub||"",email:h.email||"",emailVerified:h.email_verified||!1},accessToken:l.__raw,isAuthenticated:!0}),(m=1000*Number(l.exp)-Date.now())>0?setTimeout(function(){return i({type:g.c.TokenExpired})},m):i({type:g.c.ErrorOccurred,error:new Error("Token expiration is incorrect: ".concat(Number(l.exp)))}),a.next=17;break;case 13:a.prev=13,a.t0=a.catch(4),(0,j.cM)(a.t0),i({type:g.c.ErrorOccurred,error:(0,j.Jb)()});case 17:a.next=20;break;case 19:i({type:g.c.LoadFromAuth0,isAuthenticated:!1});case 20:case"end":return a.stop()}},a,null,[[4,13]])}))).apply(this,arguments)}function A(){return(A=q(e().mark(function a(b){var c,d,f,h,j,k,l,m,n,o,p,q;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(c=b.shouldLoadFromApi,d=b.user,f=b.token,h=b.dispatch,!(c&&d)){a.next=10;break}return a.t0=t,a.next=5,(0,i.PR)(d.sub||"",f);case 5:a.t1=a.sent,k=(j=(0,a.t0)(a.t1,2))[0],l=j[1],l?h({type:g.c.ErrorOccurred,error:l}):(m=k.email,n=k.fullName,o=k.omedaCustomerEncryptedID,p=k.updatedAt,q=k.isEditor,h({type:g.c.LoadFromApi,apiUser:{email:m,fullName:n,omedaCustomerEncryptedID:o,updatedAt:p,isEditor:q}}));case 10:case"end":return a.stop()}},a)}))).apply(this,arguments)}var B=function(a){var b=a.shouldSave,c=a.user,d=a.dispatch;b&&(localStorage.setItem("ssoUser",JSON.stringify({email:c.email,fullName:c.fullName,omedaCustomerEncryptedID:c.omedaCustomerEncryptedID,updatedAt:c.updatedAt})),d({type:g.c.SavedToStorage}))},C=function(a){var b=a.children,c=(0,k.useReducer)(x,{ssoUser:v(),isAuthenticated:!1,shouldSave:!1,hasLoadedFromStorage:!1,hasLoadedFromAuth0:!1,shouldLoadFromApi:!1,accessToken:"",hasAccessTokenExpired:!1,identifiedByTrackers:[]}),d=c[0],e=c[1],i=(0,h.D3)(),j=i.isLoading,l=i.isAuthenticated,m=i.error,n=i.user,o=i.logout,p=i.getIdTokenClaims;(0,k.useEffect)(function(){!function(a){var b=a.hasLoadedFromStorage,c=a.dispatch;if(!b){var d=JSON.parse(localStorage.getItem("ssoUser")||"{}"),e=d.email,f=d.fullName,h=d.omedaCustomerEncryptedID,i=d.updatedAt;c({type:g.c.LoadFromStorage,apiUser:{email:e||"",fullName:f||"",omedaCustomerEncryptedID:h||"",updatedAt:i||""}})}}({hasLoadedFromStorage:d.hasLoadedFromStorage,dispatch:e})},[d.hasLoadedFromStorage]),(0,k.useEffect)(function(){(function(a){z.apply(this,arguments)})({isLoading:j,isAuthenticated:l,hasLoadedFromAuth0:d.hasLoadedFromAuth0,user:n,dispatch:e,getIdTokenClaims:p})},[j,l,d.hasLoadedFromAuth0,n,p,]),(0,k.useEffect)(function(){(function(a){A.apply(this,arguments)})({shouldLoadFromApi:d.shouldLoadFromApi,user:n,token:d.accessToken,dispatch:e})},[d.accessToken,d.shouldLoadFromApi,n]),(0,k.useEffect)(function(){B({shouldSave:d.shouldSave,user:d.ssoUser,dispatch:e})},[d.shouldSave,d.ssoUser]);var q={user:d.ssoUser,isLoading:!d.hasLoadedFromStorage||!d.hasLoadedFromAuth0||d.shouldLoadFromApi||j,isAuthenticated:d.isAuthenticated,error:d.error||m,dispatch:e,logout:function(){e({type:g.c.Logout}),o({returnTo:"".concat(String("https://www.scmagazine.com"),"/sso")})},accessToken:d.accessToken,hasAccessTokenExpired:d.hasAccessTokenExpired,isUserIdentifiedByTracker:function(a){return d.identifiedByTrackers.includes(a)}};return(0,f.jsx)(w.Provider,{value:q,children:b})},D=function(a){var b=a.children,c=a.auth0ClientId,d=a.auth0RedirectHost,e=a.auth0Domain;return(0,f.jsx)(l.Z,{children:(0,f.jsx)(h.tw,{domain:null!=e?e:"",clientId:null!=c?c:"",redirectUri:n()(d,"/sso"),children:(0,f.jsx)(C,{children:b})})})};b.default=D},37076:function(a,b,c){var d,e,f,g;c.d(b,{f:function(){return d},c:function(){return e}}),(f=d||(d={})).hum="hum",f.olytics="olytics",(g=e||(e={})).CreateUser="CreateUser",g.UpdateUser="UpdateUser",g.Logout="Logout",g.LoadFromStorage="LoadFromStorage",g.LoadFromAuth0="LoadFromAuth0",g.LoadFromApi="LoadFromApi",g.SavedToStorage="SavedToStorage",g.ErrorOccurred="ErrorOccurred",g.TokenExpired="TokenExpired",g.UserIdentifiedByTracker="UserIdentifiedByTracker"}}])
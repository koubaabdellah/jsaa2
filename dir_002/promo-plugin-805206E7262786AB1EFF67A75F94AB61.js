
jQuery.cookie=function(key,value,options){if(arguments.length>1&&String(value)!=="[object Object]"){options=jQuery.extend({},options);if(value===null||value===undefined){options.expires=-1;};if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);};value=String(value);return(document.cookie=[encodeURIComponent(key),'=',options.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));};options=value||{};var result,decode=options.raw?function(s){return s;}:decodeURIComponent;return(result=new RegExp('(?:^|; )'+encodeURIComponent(key)+'=([^;]*)').exec(document.cookie))?decode(result[1]):null;};if(typeof($fc)=='undefined')var $fc={};(function(fc,$){fc.openLB=function startOverlay(html,width,height,backgroundclose){var newContent=$(html);width=width||425;height=height||355;$("body").append('<div class="overlay" style="position:absolute;top:0;left:0;height:100%;width:100%;background:#000;opacity:0;filter:alpha(opacity=0);z-index:1000;'+(backgroundclose>0?'cursor:pointer;':'')+'"></div>').append('<div class="overlaycontainer" style="position:absolute;opacity:0;filter:alpha(opacity=0);left:-9999em;z-index:1001;"></div>').css({"overflow-y":"hidden"});var overlay=$(".overlay").animate({"opacity":"0.6"},400,"linear");if(backgroundclose>0)overlay.bind("click",function(){fc.closeLB();});var overlaycontainer=$(".overlaycontainer");overlaycontainer.html(html).css({"top":$(document).scrollTop()+$(window).height()/2,"left":"50%","width":width,"height":height}).css({"margin-top":-(overlaycontainer.height()/2),"margin-left":-(overlaycontainer.width()/2)}).animate({"opacity":"1"},400,"linear").find(".closeLB").bind("click",function(){fc.closeLB();return false;});setTimeout(function(){overlaycontainer.css({"margin-top":-(overlaycontainer.height()/2),"margin-left":-(overlaycontainer.width()/2)});},200);};fc.closeLB=function removeOverlay(){$(".overlaycontainer, .overlay").animate({"opacity":"0"},200,"linear",function(){$(".overlaycontainer, .overlay").remove();$("body").css({"overflow-y":""});});};})($fc,jQuery);(function(fc,$){var aPromos=[];var bDebug=window.location.href.search(/[\?&]debug=1/)>-1&&typeof console!==undefined&&console.log;function debug(message){if(bDebug)
console.log("[PROMO PLUGIN] "+message);};function getSessionTimeout(){var d=new Date();d.setMinutes(d.getMinutes()+20);return d;};function getLifetimeTimeout(){var d=new Date();d.setFullYear(d.getFullYear()+20);return d;};function getSessionID(){var id=$.cookie("promo-session-id");if(id===null)id=Math.floor(Math.random()*10000000)+1;else id=parseInt(id);$.cookie("promo-session-id",id,{expires:getSessionTimeout(),path:"/"});return id;};function checkPromoTrigger(promo,cookie){if(cookie.shown){debug("["+promo.title+"] cookie => already shown");return false;}
if(cookie.hits>=promo.triggerMax){debug("["+promo.title+"] cookie => shown enough times");return false;}
if(promo.triggerType=="visit"&&cookie.visits<promo.triggerNumber){debug("["+promo.title+"] cookie => not enough visits");return false;}
if(promo.triggerType=="page"&&cookie.pages<promo.triggerNumber){debug("["+promo.title+"] cookie => not enough pages");return false;}
if(promo.customTrigger===false){debug("["+promo.title+"] customTrigger => false");return false;}
if(promo.customTrigger.length){var type="string";for(var i=0;i<promo.customTrigger.length;i++){if(promo.customTrigger[i].search(/^cookie\./)===-1)
promo.customTrigger[i]=$.cookie(promo.customTrigger[i].replace(/^cookie\./,""));else if(promo.customTrigger[i].search(/^["'].*["']$/)>-1)
promo.customTrigger[i]=promo.customTrigger[i].slice(1,-1);if(promo.customTrigger[i].search(/^\d+$/)>-1)
type="numeric";}
if(type==="numeric"){promo.customTrigger[0]=parseFloat(promo.customTrigger[0]);promo.customTrigger[2]=parseFloat(promo.customTrigger[2]);}
if(promo.customTrigger[1]==="eq"&&promo.customTrigger[0]!=promo.customTrigger[2]){debug("["+promo.title+"] customTrigger => "+promo.customTrigger.join(" "));return false;}
else if(promo.customTrigger[1]==="neq"&&promo.customTrigger[0]==promo.customTrigger[2]){debug("["+promo.title+"] customTrigger => "+promo.customTrigger.join(" "));return false;}
else if(promo.customTrigger[1]==="contains"&&promo.customTrigger[0].indexOf(promo.customTrigger[2])===-1){debug("["+promo.title+"] customTrigger => "+promo.customTrigger.join(" "));return false;}
else if(promo.customTrigger[1]==="gt"&&promo.customTrigger[0]<=promo.customTrigger[2]){debug("["+promo.title+"] customTrigger => "+promo.customTrigger.join(" "));return false;}
else if(promo.customTrigger[1]==="gte"&&promo.customTrigger[0]<promo.customTrigger[2]){debug("["+promo.title+"] customTrigger => "+promo.customTrigger.join(" "));return false;}
else if(promo.customTrigger[1]==="lt"&&promo.customTrigger[0]>=promo.customTrigger[2]){debug("["+promo.title+"] customTrigger => "+promo.customTrigger.join(" "));return false;}
else if(promo.customTrigger[1]==="lte"&&promo.customTrigger[0]>promo.customTrigger[2]){debug("["+promo.title+"] customTrigger => "+promo.customTrigger.join(" "));return false;}}
return true;};function getPromoHistory(promo){var promo_history={};if(promo.storage==="cookie"){var session=getSessionID();var dl=($.cookie("promo-"+promo.id+'-l')||"0,0,0").split(",");var ds=($.cookie("promo-"+promo.id+'-s')||"0,0,0").split(",");if(parseInt(ds[2])!=session)ds=["0","0",session.toString()];var promo_history={session:session,visits:parseInt(dl[0]),hits:parseInt(dl[1]),lastsession:parseInt(dl[2]),pages:parseInt(ds[0]),shown:parseInt(ds[1]),currentsession:parseInt(ds[2])};if(promo_history.lastsession!=session){promo_history.visits+=1;promo_history.lastsession=session;$.cookie("promo-"+promo.id+'-l',promo_history.visits.toString()+','+promo_history.hits.toString()+','+promo_history.lastsession.toString(),{expires:getLifetimeTimeout(),path:"/"});};promo_history.pages+=1;$.cookie("promo-"+promo.id+'-s',promo_history.pages.toString()+','+promo_history.shown.toString()+','+promo_history.currentsession.toString(),{path:"/"});}
else if(promo.storage==="profile"){promo_history=promo.history;}
debug("["+promo.title+"] "+promo.storage+" session="+promo_history.session+", visits="+promo_history.visits+", hits="+promo_history.hits+", lastsession="+promo_history.lastsession+", pages="+promo_history.pages+", shown="+promo_history.shown+", currentsession="+promo_history.currentsession);return promo_history;};function rememberPromoHit(promo,promo_history){promo_history.hits+=1;promo_history.shown=1;if(promo.storage==="cookie"){$.cookie("promo-"+promo.id+'-l',promo_history.visits.toString()+','+promo_history.hits.toString()+','+promo_history.lastsession.toString(),{expires:getLifetimeTimeout(),path:"/"});$.cookie("promo-"+promo.id+'-s',promo_history.pages.toString()+','+promo_history.shown.toString()+','+promo_history.currentsession.toString(),{path:"/"});debug("["+promo.title+"] "+promo.storage+" hit stored");}
else if(promo.storage==="profile"){debug("["+promo.title+"] "+promo.storage+" storing hit ...");$.getJSON(promo.rememberHitURL,function(res){for(var k in res)
promo_history[k]=res[k];debug("["+promo.title+"] "+promo.storage+" hit stored");});}};function showPromo(promo,promo_history){rememberPromoHit(promo,promo_history);var promourl=promo.url;if(promo.devicetype=="mobile"){promourl=promo.mobileurl;}
$(function(){if(fc.displayPromo)return fc.displayPromo(promo);$.ajax({type:"GET",url:promourl,cache:false,timeout:20000,success:function(html){if(promo.devicetype=="mobile"){var el=$("<div/>").html(html).contents();el.prependTo("body");$("#farcrypromobile").slideUp(0).slideDown(500);window.scrollTo(0,0);}
else{fc.openLB(html,promo.width,promo.height,promo.backgroundclose);if(promo.timeout>0)setTimeout(function(){fc.closeLB();},promo.timeout*1000);}}});});};fc.declarePromos=function declarePromos(promos){var promoShown=false;if(fc.skipPromo())return;for(var i=0;i<promos.length;i++){promo_history=getPromoHistory(promos[i]);if(!promoShown&&checkPromoTrigger(promos[i],promo_history)){showPromo(promos[i],promo_history);promoShown=true;}}};if(typeof(fc.skipPromo)=='undefined'){fc.skipPromo=function(){return false;};}})($fc,jQuery);$fc.declarePromos([]);
